(window.webpackJsonptheoWebApp=window.webpackJsonptheoWebApp||[]).push([[102],{"1geK":function(e,t,r){"use strict";r.r(t);var o=r("wHG3"),a=r("ApVh"),n=r.n(a),s=r("Uwho"),i=r.n(s),l=r("UFvF"),c=r.n(l),d=r("lulf"),u=r("MGCh"),p=r.n(u),h=r("65r0");function g(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}const{GraphTransportUtils:m}=o.PixiJSApp,f=new d.default,b=p.a.channel("web-animation-snapi");class y extends Error{constructor(...e){super(...e),g(this,"response",void 0)}}const S=new class{constructor(){g(this,"endpoint","https://"+i.a.postsnapi),g(this,"invocationMode","async"),f.loadFeatures().then(()=>{(f.featureEnabled("post-use-new-postsnapi-server")||Object(h.b)())&&(this.endpoint="https://"+i.a.postsnapi2,this.invocationMode="sync")})}getEtag(e){const t=`https://${i.a.ss}/assets/adobe-theo/${e}/manifest`,r=c.a.defer();return n.a.ajax({url:t,type:"GET",headers:{"x-api-key":i.a.key},success:(t,o,a)=>(b.debug(`snapi: get etag succeeded [projectId: ${e}]`),r.resolve(a.getResponseHeader("ETag"))),error:(t,o,a)=>(b.error(`snapi: error - fail to get etag, [projectId: ${e}], [message: ${o}], [error: ${a}], [response: ${JSON.stringify(t,null,2)}]`),r.reject(t))}),r.promise}pollUntilReady(e,t,r,o,a,s,l){if(!r){const t=new Error("called without full xhr");return b.error(`snapi: error - polling 1 [requestId: ${s}], [error:${t}]`),e.reject(t)}if(200===r.status){let n;if("object"==typeof t)n=t;else try{n=JSON.parse(t.replace(/^[^{]*/,""))}catch(t){return b.error(`snapi: error - polling 2 [requestId: ${s}], [error:${t}]`),e.reject(t)}if(n["error-response"]){const t=new y("poll returned error from server: "+JSON.stringify(n));return b.error(`snapi: error - polling 3 [requestId: ${s}], [error: ${t}]`),t.response=n,e.reject(t)}return o&&"function"==typeof l&&l("progress",100,a),n.xRequestId=r.getResponseHeader("x-request-id"),e.resolve(n)}if(202!==r.status){const t=new Error("unexpected status in poll "+r.status);return b.error(`snapi: error - polling 4 [requestId: ${s}], [status: ${r.status}], [error: ${t}]`),e.reject(t)}let d;if(t.href)d=t;else try{d=JSON.parse(t)}catch(t){return b.error(`snapi: error - polling 5 [requestId: ${s}], [error: ${t}]`),e.reject(t)}if(!d||!d.href){const t=new Error("publish failed: "+r.response);return b.error(`snapi: error - polling 6 [requestId: ${s}], [error: ${t}]`),e.reject(t)}const u=d.progress>0?d.progress:1;let p;try{p=r.getResponseHeader("retry-after"),isNaN(p)&&(p=5)}catch(e){p=5}p=1,o&&"function"==typeof l&&l("progress",u,a);const h=d.href,g=this;return c.a.delay(1e3*p).then(()=>{n.a.ajax({url:`${this.endpoint}/${h}`,type:"GET",headers:{"x-api-key":i.a.cid,"x-request-id":s},success(t,r,n){s!==n.getResponseHeader("x-request-id")&&b.warn(`snapi: warn - polling 7 [message: x-request-id mismatch] [expected:${s}, got:${n.getResponseHeader("x-request-id")}]`),b.debug(`snapi: polling... [requestId:${s}], [response: ${JSON.stringify(t,null,2)}]`),g.pollUntilReady(e,t,n,o,a,s,l)},error:(t,r,o)=>(b.error(`snapi: error - polling 8 [href: ${h}], [requestId: ${s}], [message: ${r}], [error: ${o}], [response:${JSON.stringify(t,null,2)}]`),e.reject(t))})}),e.promise}sendPgmPublishRequestImpl(e,t,r,o,a){const s=this;return this.getEtag(t).then(l=>{const d=c.a.defer();return n.a.ajax({type:"POST",url:e,dataType:"json",contentType:"application/json",headers:{"Content-Type":"application/json","x-project-etag":l,"x-api-key":i.a.cid},data:JSON.stringify(r),success(e,r,n){const i=n.getResponseHeader("x-request-id");b.debug(`snapi: about to poll [requestId:${i}], ${JSON.stringify(e,null,2)}`),a&&(a.value=i),s.pollUntilReady(d,e,n,!0,t,i,o)},error:(t,r,o)=>(b.error(`snapi: error - send pgm publish failed, response: ${JSON.stringify(t,null,2)}, message: ${r}, error: ${o}, snapiUrl: ${e}`),d.reject(t))}),d.promise})}validatePgmResourcesSection(e){if(!e.resources)throw new Error("Pgm graph missing resources section.");e.resources.forEach((e,t)=>{if(!t.storage||!t.storage.kind)throw new Error("Pgm resource missing storage data.");if(t.contentType&&t.contentType.startsWith("image")&&"content-literal"===t.storage.kind)throw new Error("Pgm has temporary image resource.")})}getPgmGraphForPublish(e){if(!e)throw new Error("coreWrapper is null.");e.generateKeyFrames();const t=e.getGraph(!0);if(t.duration<=0)throw b.warn("Zero PGM duration"),new Error("Animation duration is 0.");const r=m.convertAllLocalCompositeToExternalCC(t,e.documentId());return this.validatePgmResourcesSection(r),r}sendPgmPublishRequestForUpload(e,t,r,o,a){const n=`${this.endpoint}/project/${e}/pgmpublish?invocation_mode=${this.invocationMode}&partial=1&pubType=1&cpDest=${t}`;return this.sendPgmPublishRequestImpl(n,e,r,a,o)}sendPgmPublishRequestForDownload(e,t,r){const o=`${this.endpoint}/project/${e}/pgmpublish?invocation_mode=${this.invocationMode}&partial=3&pubType=1`;return this.sendPgmPublishRequestImpl(o,e,t,r,null)}getPublishRequestBody(e){const t=e.publishTitle||"",r=e.authorFull||"",o=!e.isPublic;return{metadata:{title:t,custom:{author:r,sub_title:"",removeBranding:!!e.removeBranding},sub_category_ids:["other"],category_id:"theos",undiscoverable:o},update:!1,options:{withoutBranding:!!e.removeBranding}}}};t.default=S},"2PxR":function(e,t,r){"use strict";r.r(t),r.d(t,"IMAGE_SOURCES",(function(){return l})),r.d(t,"getImageMediaMetadata",(function(){return c}));var o=r("UzQk"),a=r.n(o);function n(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,o)}return r}function s(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?n(Object(r),!0).forEach((function(t){i(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):n(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function i(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}let l;function c(e,t=!1){let r={};if(e){let t="unknown",o="unknown";const a={};e.source&&e.source.name&&(e.source.name===l.STOCK?t="adobestock":e.source.name===l.UNSPLASH||e.source.name===l.PIXABAY||e.source.name===l.NOUN?t="dooplo":e.source.name===l.CCL?t="ccl":e.source.name===l.CCLIGHTDESIGNASSETS&&(t="cclight"),e.source.name===l.NOUN?o=e.id:e.source.name===l.CCL?o=e.assetID:e.image_id?o=e.image_id.toString():e.id&&(o=e.id),e.source.name===l.CCL?a.ccl={created_date:e.created_date,modified_date:e.modified_date,library_id:e.albumId,library_name:e.albumName}:e.source.name===l.CCLIGHTDESIGNASSETS&&(a.cclight={search_props:e.searchProps,created_date:e.created_date,modified_date:e.modified_date,design_intent:e.design_intent})),r={source:t,search:e.searchText,rootProperties:s({license:{asset_id:o,owner:e.owner?e.owner.name:"unknown",photo_name:e.title,source_name:e.source?e.source.name:"unknown",source_url:e.context?e.context.href:"unknown",tags:e.tags instanceof Array?e.tags.join(","):"",type:e.license?e.license.short_name:"unknown"}},a)}}const o=a.a.MediaMetadata.fromProperties(r);return o&&t&&(o.designIntent=a.a.MediaMetadata.DESIGNINTENT_LOGO),o}!function(e){e.STOCK="Adobe Stock",e.UNSPLASH="Unsplash",e.PIXABAY="pixabay",e.NOUN="The Noun Project",e.CCL="Creative Cloud Libraries",e.CCLIGHTDESIGNASSETS="CC Light Design Assets"}(l||(l={}))},"5d+0":function(e,t,r){"use strict";r.r(t),r.d(t,"ShortcutConstants",(function(){return o}));const o={kConfirmText:"confirmText",kRotation:"rotation",kSendForward:"sendForward",kSendToFront:"sendToFront",kSendBackward:"sendBackward",kSendToBack:"sendToBack",kDuplication:"duplication",kGroup:"group",kUngroup:"ungroup",kNudge:"nudge",kMarqueeSelect:"marqueeSelect",kMultiselect:"multiselect",kDeselectAll:"deselectAll",kSelectAll:"selectAll",kRedo:"redo",kUndo:"undo",kExitSpecialSelectionMode:"exitSpecialSelectionMode",kSelectSibling:"selectSibling",kSelectParent:"selectParent",kSelectChild:"selectChild",kActualSize:"actualSize",kFitToView:"fitToView",kFillToView:"fillToView",kZoomOut:"zoomOut",kZoomIn:"zoomIn",kPanView:"panView",kPanKey:"panKey",kZoomInKey:"zoomInKey",kZoomOutKey:"zoomOutKey"}},"65r0":function(e,t,r){"use strict";r.d(t,"b",(function(){return n}));var o=r("ApVh"),a=r.n(o);function n(){const e=a.a.getUserEmail();return/@adobe(test)?.com$/gi.test(e)}t.a=n},"8DU0":function(e,t,r){"use strict";r.r(t),r.d(t,"default",(function(){return s}));var o=r("ApVh"),a=r.n(o);function n(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class s{static getSetting(e){return new Promise((t,r)=>{s.hasSetting(e)?t(s.settings[e]):s.getSettings().then(r=>{s.settings=r,t(s.settings[e])}).catch(e=>{r(e)})})}static setSetting(e,t){return e?void 0===t?Promise.reject(new Error("UserSettings: cannot set setting to an undefined value")):(s.settings[e]=t,new Promise((r,o)=>{a.a.getAccessToken().then(a=>{const n=s.apiEndPoint+encodeURIComponent(e),i={headers:{Authorization:"Bearer "+a,"Content-Type":"application/json;charset=UTF-8"},method:"PUT",body:JSON.stringify({value:t})};fetch(n,i).then(t=>{t.ok?r(t):o(new Error(`UserSettings: Error trying to set key=${e}: [${t.status}] ${t.statusText}`))}).catch(o)})})):Promise.reject(new Error("UserSettings: cannot set an undefined key"))}static hasSetting(e){return void 0!==s.settings[e]}static getSettings(){return s.getSettingsPromise&&s.promiseResolved||(s.getSettingsPromise=new Promise((e,t)=>{a.a.getAccessToken().then(r=>{const o={headers:{Authorization:"Bearer "+r}};fetch(s.apiEndPoint,o).then(r=>{if(r.ok)e(r.json()),s.promiseResolved=!0;else{const e=new Error(`UserSettings: Error trying to get settings: [${r.status}] ${r.statusText}`);t(e)}}).catch(e=>{t(e)})})})),s.getSettingsPromise}}n(s,"apiEndPoint","/api/post/v1/usersettings/"),n(s,"getSettingsPromise",void 0),n(s,"settings",{}),n(s,"promiseResolved",!1)},"8Jtx":function(e,t,r){"use strict";async function o(e,t){let r=null;const o=new Promise((e,o)=>{r=setTimeout(()=>{o(new Error(`Request timed out after ${t} ms.`))},t)});try{return await Promise.race([e,o])}finally{r&&clearTimeout(r)}}r.r(t),r.d(t,"resolvePromiseOrTimeout",(function(){return o})),t.default=o},"9SnX":function(e,t,r){var o,a;o=[r("ApVh"),r("xeH2"),r("UFvF"),r("Uwho"),r("MGCh"),r("Pbp+"),r("lulf"),r("bBG2")],void 0===(a=function(e,t,r,o,a,n,s,i){const l=i.default;var c={},d=a.channel("design-variations");return c.getVariations=function(a,n){return function(a){const n=r.defer(),s=performance.now();return e.getAccessToken().then(e=>{t.ajax({type:"POST",url:o.designVariationsServiceV2Endpoint+"/suggestions",contentType:"application/json",data:JSON.stringify(a.metadata),dataType:"json",headers:{Authorization:"Bearer "+e,"x-api-key":o.cid}}).fail((function(e,t){d.error("Failed to fetch response from Design Variations Service V2"),n.reject(t)})).done((function(e){const t=performance.now()-s;d.info("Design Variations Service V2 response in: "+t),l.publish("designVariationsServiceV2Used",{contextualData1:t}),n.resolve(e)}))}),n.promise}(a)},c}.apply(t,o))||(e.exports=a)},Dcjk:function(e,t,r){var o;void 0===(o=function(){var e=window.navigator.userAgent;return e.indexOf("Trident/")>0?11:e.indexOf("MSIE ")>0?10:e.indexOf("Edge/")>0&&12}.apply(t,[]))||(e.exports=o)},Dvuo:function(e,t,r){var o,a;o=[r("3xm6"),r("UzQk")],void 0===(a=function(e,t){var r={numberStringForValue:function(e,r){const o=t.PageFacade.getNumDecimalPlacesForUnits(r);return t.Host.locale.formatNumber(e,o)},getUnitsOptionString:function(){for(var e=[],o=t.PageExportFormat.PIXELS;o<=t.PageExportFormat.INCHES;o++)e.push(r.getUnitsStringForFormat(o));var a="";return e.forEach((function(e){a+="<option>"+e+"</option>"})),a},getUnitsStringForFormat:function(r){var o;switch(r){case t.PageExportFormat.PIXELS:o=e.translate("forms.custom-size.kPixelsAbbr");break;case t.PageExportFormat.MILLIMETERS:o=e.translate("forms.custom-size.kMillimetersAbbr");break;case t.PageExportFormat.INCHES:o=e.translate("forms.custom-size.kInchesAbbr");break;default:log.assert(!1,"invalid units format: "+r),o="px"}return o},currentUnitToPixels:function(e,r,o,a){var n=t.PageFacade.unitsToPixelsFactor(o,a);return new t.TheoSize(e*n,r*n)},pixelsToCurrentUnit:function(e,r,o,a){var n=t.PageFacade.unitsToPixelsFactor(o,a);return new t.TheoSize(e/n,r/n)}};return r}.apply(t,o))||(e.exports=a)},EUgP:function(e,t,r){"use strict";r.d(t,"a",(function(){return O}));var o=r("KpqY"),a=r("qcxC"),n=r("MOGj"),s=r.n(n);async function i(e,t,r,o){const n=Object(a.default)();return s.a.AdobeDCXCompositeXfer.uploadComponent(e,t,r,o,async(t,o)=>{if(t)throw t;r.current.updateComponentWithUploadResults(e,o),n.resolve(r)}),n.promise}async function l(e,t,r,o,n,i,l,c){const d=Object(a.default)();return s.a.AdobeDCXCompositeXfer.uploadNewComponent(t,r,l,e,c,async(e,t)=>{if(e)throw e;l.current.addComponentWithUploadResults(o,n,i,l.current.rootNode,t),d.resolve(l)}),d.promise}var c=r("j5+N"),d=r.n(c),u=r("UzQk"),p=r.n(u),h=r("uTW7"),g=r("14LO"),m=r("3xm6"),f=r.n(m),b=r("MGCh"),y=r.n(b),S=r("ApVh"),C=r.n(S),w=r("Uwho"),v=r.n(w),k=r("tY4j"),P=r.n(k),T=r("1geK"),x=r("2ofD"),I=r.n(x);let F;!function(e){e[e.FAILED=0]="FAILED",e[e.IN_PROGRESS=1]="IN_PROGRESS",e[e.PASSED=2]="PASSED"}(F||(F={}));const A=["Other"],E=window.location.protocol,D=window.location.host.includes("local.adobeprojectm.com")?E+"//dev.adobeprojectm.com":`${E}//${window.location.host}`;function R(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}const L=y.a.channel("modules:util:cp-publisher");class O{constructor(e){R(this,"apiKey",void 0),R(this,"communitySession",void 0),R(this,"coreWrapper",void 0),R(this,"currentJob",void 0),R(this,"waitForQuietSaveToFinish",void 0),R(this,"getDocumentRendition",void 0),R(this,"storageSession",void 0),this.currentJob={progress:{localCompositeCreated:!1,localCompositeBound:!1,localCompositeTransformed:!1,compositeCopyPushed:!1,compositePublished:!1,sourceDocumentUpdatedWithPublishData:!1,remixURLCreated:!1,publishedCompositeUpdated:!1}},this.apiKey=v.a.key,this.coreWrapper=e.coreWrapper,this.waitForQuietSaveToFinish=e.waitForQuietSaveToFinish,this.getDocumentRendition=e.getDocumentRendition,this.storageSession=s.a.dcxSession,this.communitySession=s.a.dcx.createCommunitySession(s.a.dcxService,`${E}//${v.a.cps}`)}async publishDoc(e){const{associatedCategories:t,categories:r,keyTerms:o,language:a,title:n,task:i}=e;if(this.currentJob.status=F.IN_PROGRESS,I.a.currentDoc.isPublished()){L.error("[publishDoc] Republishing currently not supported.");const e=F.FAILED;return this.currentJob.status=e,this.resetPublisher(),Promise.reject({status:e,errorMessage:f.a.translate("app.templatePublisher.templateRepublishFailure.kContentText")})}const l="/pubs/"+s.a.AdobeDCXUtil.generateUuid();this.currentJob.compositeCopy=await this.copyAndTransformComposite(I.a.currentDoc.getDCXComposite(),l),this.currentJob.alias=await this.reserveAliasWithRetry();const c=this.getRemixData(),d=this.getPublicationRecord(t,r,this.currentJob.compositeCopy,o,a,l,n,i),u=this.getMachineTags(t),p=await this.publishComposite(d,c,u);return this.resetPublisher(),p}async copyAndTransformComposite(e,t){const r=this.copyComposite(e);this.currentJob.progress.localCompositeCreated=!0;const o=await this.createCompositeCopy(r,t);this.currentJob.progress.localCompositeBound=!0;const a=await this.transformCompositeBeforePublish(o);this.currentJob.progress.localCompositeTransformed=!0;const n=await this.pushCompositeCopy(a);return this.currentJob.progress.compositeCopyPushed=!0,n}copyComposite(e){return s.a.AdobeDCXComposite.newCompositeAsCopyOf(e,e.current.name,e.current.type)}async createCompositeCopy(e,t){try{return await async function(e,t,r,o){const n=Object(a.default)();return s.a.AdobeDCXCompositeXfer.createComposite(e,t,r,o,async(t,r)=>{if(t)throw t;n.resolve(e)}),n.promise}(e,t,!1,this.storageSession)}catch(e){L.error("[createCompositeCopy] Unable to create composite copy.",e);const t=F.FAILED;return this.currentJob.status=t,await this.handleFailure(),Promise.reject({status:t,errorMessage:f.a.translate("app.templatePublisher.templatePublishFailure.contentText.kCreateCompositeCopyFailure")})}}async transformCompositeBeforePublish(e){const t=await this.setUsageReportedFlagsToFalse(e),r=this.getComponentIdForPreview(t)?t:await this.addPreviewImageToComposite(t),o=this.coreWrapper.hasAnimationStyle()?await this.addVideoRenditionToComposite(r):r;return await this.clearCompositeCopyPublishData(o)}async setUsageReportedFlagsToFalse(e){if(!this.coreWrapper.hasReportedIcons())return e;const t=new g.DCXDocumentComposite({composite:e}),r=t.current;if(r&&p.a.DocumentPersistenceFactory.usesJsonDocumentEncoding(r)){const t=p.a.JSONDocumentDecoder.getRequiredSynchronousComponents(r);await Promise.all(t.map(async t=>{const o=await s.a.getComponent(t,e),a=JSON.parse(o);r.registerContentForComponent(t,a)}))}const a=p.a.TheoDocument.decodeDocument(t,e=>{throw r.releaseRegisteredContent(),e});try{r&&r.releaseRegisteredContent(),a.history.postEntry("open,src=CC,was-vers="+a.versionDecoded.rawValue);const e=o.default.beginTransaction(a,"updatePublishData");a.content.root.visitAll(e=>{e instanceof p.a.VectorContentNode&&e.isUsageReported()&&e.setUsageReported(!1)}),o.default.endTransaction(e,!0);const n=new h.DCXDocumentBranch({branch:t.dcxComposite.current}),s=p.a.DocumentPersistenceFactory.encoderFor(n);a.encode(s),s.finish();const l=n.getDeferredComponents().find(e=>"dom"===e.relationship);if(!l)throw new Error("[setUsageReportedFlagsToFalse] Failed to find deferred DOM Component.");const c=l.content,d=t.dcxComposite,u=d.current.getComponentWithId(l.componentId);if(!u)throw new Error(`[setUsageReportedFlagsToFalse] Failed to find DOM Component with id: ${l.componentId}.`);return await i(u,JSON.stringify(c),d,this.storageSession)}catch(e){L.error("[setUsageReportedFlagsToFalse] Failed to update usage reported to no where applicable.",e);const t=F.FAILED;return this.currentJob.status=t,await this.handleFailure(),Promise.reject({status:t,errorMessage:f.a.translate("app.templatePublisher.templatePublishFailure.contentText.kUpdateUsageReportedFailure")})}}getComponentIdForPreview(e){let t;const r=this.getPreviewComponent(e);return r?t=r.id:e.current.getComponentWithId("preview")&&(t="preview"),t}getPreviewComponent(e){var t,r;const o=null!==(t=e.current)&&void 0!==t?t:{},a=(null!==(r=o.rootNode)&&void 0!==r?r:{}).absolutePath,n=a&&"/"!==a?a+"/preview.jpg":"/preview.jpg";return o.getComponentWithAbsolutePath(n)}async addPreviewImageToComposite(e){try{const t=1200,r=.94,o=await this.getDocumentRendition({imageQuality:r,width:t});if(!o)throw new Error("[addPreviewImageToComposite] Failed to generate preview rendition.");const a=s.a.AdobeDCXUtil.generateUuid();return await l(a,o,"image/jpeg","preview.jpg","rendition","preview.jpg",e,this.storageSession)}catch(e){L.error("[addPreviewImageToComposite] Failed to upload preview rendition component.",e);const t=F.FAILED;return this.currentJob.status=t,await this.handleFailure(),Promise.reject({status:t,errorMessage:f.a.translate("app.templatePublisher.templatePublishFailure.contentText.kAddPreviewRenditionFailure")})}}async addVideoRenditionToComposite(e){const t=await this.downloadVideoRendition(),r=await this.addOrUpdateVideoRendition(e,t.fileBlob),o=r.current.getComponentWithId("videoRendition");return await this.setVideoRenditionMetadata(r,o,t)}async downloadVideoRendition(){const e=this.coreWrapper.getDocument().id;let t=null;try{t=T.default.getPgmGraphForPublish(this.coreWrapper)}catch(t){L.error(`[downloadVideoRendition] PGM Graph Error for documentId:${e} = ${t}`);const r=F.FAILED;return this.currentJob.status=r,await this.handleFailure(),Promise.reject({status:r,errorMessage:f.a.translate("app.templatePublisher.templatePublishFailure.contentText.kDownloadVideoRenditionFailure")})}const r=T.default.getPublishRequestBody({publishTitle:"",authorFull:"",isPublic:!0,removeBranding:!1});r.pgmGraph=t.encode();const o=this.coreWrapper.getCurrentAnimationStyle();o?r.animationType=o.asString:L.error("[mp4 download] error, current animationStyle is null");const a=t.bounds.aspectRatio,n=a<1?1280:Math.round(1280/a),s=a<1?Math.round(1280*a):1280;r.renderOptions={videoHeight:n,videoWidth:s,scaleType:0};const i=(await T.default.sendPgmPublishRequestForDownload(e,r,(e,t,r)=>{"progress"===e&&100===t&&L.info("Video rendition download completed.")})).downloadUrl,l=await C.a.getAccessToken(),c={headers:{"X-Api-Key":this.apiKey,Authorization:"Bearer "+l}};return fetch(i,c).then(e=>{if(!e.ok)throw new Error(`[downloadVideoRendition] Failed to download video at URL:${i}. [${e.status}] ${e.statusText}`);return e.blob()}).then(e=>Promise.resolve({fileBlob:e,videoHeight:n,videoWidth:s})).catch(async e=>{L.error(`[downloadVideoRendition] Failed to download video at URL:${i}. Error: ${e.message}`);const t=F.FAILED;return this.currentJob.status=t,await this.handleFailure(),Promise.reject({status:t,errorMessage:f.a.translate("app.templatePublisher.templatePublishFailure.contentText.kDownloadVideoRenditionFailure")})})}async addOrUpdateVideoRendition(e,t){const r=e.current.getComponentWithId("videoRendition");try{let o;return o=r?await i(r,t,e,this.storageSession):await l("videoRendition",t,"video/mp4","videoRendition","rendition","videoRendition.mp4",e,this.storageSession),o}catch(e){L.error("[addOrUpdateVideoRendition] Failed to add or update video rendition component.",e);const t=r?"app.templatePublisher.templatePublishFailure.contentText.kUpdateVideoRenditionFailure":"app.templatePublisher.templatePublishFailure.contentText.kCreateVideoRenditionFailure",o=F.FAILED;return this.currentJob.status=o,await this.handleFailure(),Promise.reject({status:o,errorMessage:f.a.translate(t)})}}async setVideoRenditionMetadata(e,t,r){try{const{fileBlob:o,videoHeight:a,videoWidth:n}=r;t.width=n,t.height=a,t.name="videoRendition";return await i(t,o,e,this.storageSession)}catch(e){L.error("[setVideoRenditionMetadata] Failed to update video rendition component with video metadata.",e);const t=F.FAILED;return this.currentJob.status=t,await this.handleFailure(),Promise.reject({status:t,errorMessage:f.a.translate("app.templatePublisher.templatePublishFailure.contentText.kAddVideoRenditionMetadataFailure")})}}async clearCompositeCopyPublishData(e){return e.current.rootNode.removeValue("cp#projectId"),e.current.rootNode.removeValue("cp#shortId"),e.current.rootNode.removeValue("cp#assetId"),e.current.rootNode.removeValue("cp#publishedEtag"),e.current.rootNode.removeValue("theo#cp-discoverable"),e}async pushCompositeCopy(e){try{return await async function(e,t,r){const o=Object(a.default)();return s.a.AdobeDCXCompositeXfer.pushComposite(e,t,r,async(t,r)=>{if(t)throw t;o.resolve(e)}),o.promise}(e,!1,this.storageSession)}catch(e){L.error("[pushCompositeCopy] Unable to push composite copy.",e);const t=F.FAILED;return this.currentJob.status=t,await this.handleFailure(),Promise.reject({status:t,errorMessage:f.a.translate("app.templatePublisher.templatePublishFailure.contentText.kPushCompositeCopyFailure")})}}async reserveAliasWithRetry(){const e=P()(this.reserveAlias.bind(this),{maxAttempts:3});try{return await e()}catch(e){const t=F.FAILED;return this.currentJob.status=t,await this.handleFailure(),Promise.reject({status:t,errorMessage:f.a.translate("app.templatePublisher.templatePublishFailure.contentText.kReserveAliasFailure")})}}async reserveAlias(){const e=`${E}//${v.a.cps}/api/v2/theo/alias/`,t=await C.a.getAccessToken(),r={headers:{"X-Api-Key":this.apiKey,Authorization:"Bearer "+t},method:"POST"};return fetch(e,r).then(e=>{if(!e.ok)throw new Error(`[reserveAlias] Error reserving alias: [${e.status}] ${e.statusText}`);return e.json()}).then(e=>e.alias).catch(e=>{L.error("[reserveAlias] Unable to fetch published template to perform updates. Error: "+e.message,e);const t=new Error("[reserveAlias] "+e.message);return Promise.reject(t)})}getRemixData(){const e=s.a.dcx.createRemixData();return e.originURL=`${E}//${v.a.cps}/api/v2/theo/assets/${this.currentJob.alias}`,e.licenseType="by-nc",e}getPublicationRecord(e,t,r,o,a,n,i,l){var c;const d=this.getMetadata(r),u=this.getTags(e,t,o,a,l),p=null!==(c=this.coreWrapper.getCurrentDocumentDescription())&&void 0!==c?c:"",h=s.a.dcx.createCommunityPublicationRecord();return h.communityId="theo",h.title=i,h.description=p,h.alias=this.currentJob.alias,h.discoverable=!0,h.tags=u,h.categoryId="Theos",h.subCategoryIds=A,h.custom=d,h.resourcePath=n,h.artworkComponentId=this.getComponentIdForPreview(r),h}getMetadata(e){var t,r;const o={remixable:!0,creator:"theo",documentFormatVersion:p.a.TheoDocument.CURRENT_VERSION,sparkTemplate:!0,publishOrigin:"web"},a=(null!==(t=this.getPreviewComponent(e))&&void 0!==t?t:{}).etag;a&&(o.contentEtag=a);const n=null!==(r=window.adobeIMS.getUserProfile().displayName)&&void 0!==r?r:f.a.translate("app.templatePublisher.kAccountUnknownLabel");return o.author=n,o}getTags(e,t,r,o,a){const n=[];return e.forEach(e=>{"remixpaid"!==e&&"remixanimation"!==e&&"remixpending"!==e||n.push(e)}),t.forEach(e=>{n.push("explore-"+e)}),r.forEach(e=>{n.push("spterm-"+e)}),n.push("sploc-"+o),n.push("spcase-"+a),n}getMachineTags(e){const t=["remixable"];return e.includes("remixpending")&&t.push("remixpending"),t}async publishComposite(e,t,r){const o=Object(a.deferred)();try{return s.a.AdobeCommunityPlatform.publishCompositeAlreadyPushedToPubs(this.currentJob.compositeCopy,e,t,"theo",this.communitySession,async(t,a)=>{if(t)throw t;{this.currentJob.progress.compositePublished=!0;const t=await this.publishSuccessHandler(r,e.tags);o.resolve(t)}}),o.promise}catch(e){return this.publishFailureHandler(e)}}async publishSuccessHandler(e,t){let r;if(!this.currentJob.alias||!this.currentJob.compositeCopy)return L.error("[publishSuccessHandler] alias and/or compositeCopy is undefined"),r=F.FAILED,this.currentJob.status=r,await this.handleFailure(),Promise.reject({status:r,errorMessage:f.a.translate("app.templatePublisher.templatePublishFailure.contentText.kPublishFailure")});const o=await this.fetchAssetWithRetry(this.currentJob.alias),a=await this.generateBranchURLString(o),n=a&&""!==a?a:this.getURLforPost(this.currentJob.alias,!0);return this.currentJob.progress.remixURLCreated=!0,await this.updateAssetWithRetry(o,a,e,t),this.currentJob.progress.publishedCompositeUpdated=!0,await this.updateCompositeWithPublishData(this.currentJob.compositeCopy,o),this.currentJob.progress.sourceDocumentUpdatedWithPublishData=!0,r=F.PASSED,this.currentJob.status=r,Promise.resolve({status:r,remixURL:n})}async fetchAssetWithRetry(e){const t=P()(this.fetchAsset.bind(this),{maxAttempts:3});try{return await t(e)}catch(e){const t=F.FAILED;return this.currentJob.status=t,await this.handleFailure(),Promise.reject({status:t,errorMessage:f.a.translate("app.templatePublisher.templatePublishFailure.contentText.kFetchAssetFailure")})}}async fetchAsset(e){const t=`${E}//${v.a.cps}/api/v2/theo/assets/${e}`,r=await C.a.getAccessToken(),o={headers:{"X-Api-Key":this.apiKey,Authorization:"Bearer "+r},method:"GET"};return fetch(t,o).then(e=>{if(!e.ok)throw new Error(`[fetchAsset] Error fetching published template: [${e.status}] ${e.statusText}`);return e.json()}).catch(t=>{L.error("[fetchAsset] Unable to fetch published template to perform updates. Error: "+t.message,t);const r=new Error(`[fetchAsset] ${t.message} for ${e}`);return Promise.reject(r)})}async generateBranchURLString(e){const t=`${D}/sp/design-remix/post/${e.alias}`,r=e._links.rendition.href.replace("{format}","jpg").replace("{dimension}","width").replace("{size}","1200"),o={campaign:"seodefaulttask",channel:"seolandingpagetemplates",feature:"userGeneratedRemixablePostFeature",data:{$marketing_title:"seoautogenerated",$desktop_url:t,remixable_post_cpid:e.alias,$og_title:f.a.translate("app.templatePublisher.branchIOData.kBranchIODescription"),$og_description:f.a.translate("app.templatePublisher.branchIOData.kBranchIOTitle"),$canonical_url:t,$canonical_identifier:t}};return r&&(o.data.$og_image_url=r),d.a.link(o).catch(t=>(L.error(`[generateBranchURLString] Failed to generate branchURL for ${e.alias}. Error: ${t.message}`,t),Promise.resolve("")))}getURLforPost(e,t){let r="";if(t){const e=new Date("2001-01-01T00:00:00.000Z");r="?w="+10*((new Date).getTime()-e.getTime())}return`${D}/post/${e}${r}`}async updateAssetWithRetry(e,t,r,o){const a=P()(this.updateAsset.bind(this),{maxAttempts:3});try{return await a(e,t,r,o)}catch(e){const t=F.FAILED;return this.currentJob.status=t,await this.handleFailure(),Promise.reject({status:t,errorMessage:f.a.translate("app.templatePublisher.templatePublishFailure.contentText.kUpdateAssetFailure")})}}async updateAsset(e,t,r,o){const{alias:a,custom:n}=e,s=`${E}//${v.a.cps}/api/v2/theo/assets/${a}`,i=await C.a.getAccessToken();t&&""!==t&&(n.branchURL=t);const l={custom:n,tags:o,machine_tags:r,sub_category_ids:A},c={body:JSON.stringify(l),headers:{"X-Api-Key":this.apiKey,"Content-Type":"application/json",Authorization:"Bearer "+i},method:"PUT"};return fetch(s,c).then(e=>{if(!e.ok)throw new Error(`[updateAsset] Error updating published template: [${e.status}] ${e.statusText}`)}).catch(e=>{L.error("[updateAsset] Unable to update published template with branch URL and other metadata. Error: "+e.message,e);const t=new Error(`[updateAsset] ${e.message} for ${a}`);return Promise.reject(t)})}async updateCompositeWithPublishData(e,t){var r;const o=t.resource_path,a=t.id,n=t.alias,s=(null!==(r=this.getPreviewComponent(e))&&void 0!==r?r:{}).etag||"";this.coreWrapper.updatePublishData({cPProjectID:o,cPAlias:n,cPAssetID:a,cPublishedEtag:s}),I.a.currentDoc.saveChanges(e=>{e.setValue("cp#projectId",o),e.setValue("cp#shortId",n),e.setValue("cp#assetId",a),e.setValue("cp#publishedEtag",s)}),await this.waitForQuietSaveToFinish()}async publishFailureHandler(e){L.error("[publishFailureHandler] Unable to publish template to the Community Platform.",e);const t=F.FAILED;return this.currentJob.status=t,await this.handleFailure(),Promise.reject({status:t,errorMessage:f.a.translate("app.templatePublisher.templatePublishFailure.contentText.kPublishFailure")})}async deleteAssetWithRetry(){if(!this.currentJob.alias){L.error("[deleteAssetWithRetry] Failed to delete published asset after error was thrown copy - alias is undefined");const e=new Error("[deleteAssetWithRetry] Failed to delete published asset after error was thrown copy - alias is undefined");return Promise.reject(e)}const e=P()(this.deleteAsset.bind(this),{maxAttempts:3});return await e(this.currentJob.alias)}async deleteAsset(e){const t=`${E}//${v.a.cps}/api/v2/theo/assets/${e}`,r=await C.a.getAccessToken(),o={headers:{"X-Api-Key":this.apiKey,Authorization:"Bearer "+r},method:"DELETE"};return fetch(t,o).then(e=>{if(!e.ok)throw new Error(`[deleteAsset] Error deleting published template: [${e.status}] ${e.statusText}`)}).catch(t=>{L.error(`[deleteAsset] Failed to delete published template.Please delete manually remove template with ${e}. Error: ${t.message}`,t);const r=new Error(`[deleteAsset] ${t.message} for ${e}`);return Promise.reject(r)})}async handleFailure(){var e;const{progress:t}=null!==(e=this.currentJob)&&void 0!==e?e:{};if(t)try{const{compositeCopyPushed:e,compositePublished:r}=t;e&&await this.deletePushedCompositeCopy(),r&&await this.deleteAssetWithRetry()}catch(e){L.error("[handleFailure] Cleanup task failed.",e)}this.resetPublisher()}async deletePushedCompositeCopy(){if(!this.currentJob.compositeCopy)throw L.error("[deletePushedCompositeCopy] Failed to delete composite copy. `this.currentJob.compositeCopy` is undefined"),new Error("[deletePushedCompositeCopy] Failed to delete composite copy. `this.currentJob.compositeCopy` is undefined");const e=Object(a.deferred)();this.storageSession.deleteComposite(this.currentJob.compositeCopy,t=>{t?(L.error("[deletePushedCompositeCopy] Unable to delete composite copy.",t),e.reject(t)):e.resolve()}),await e.promise}resetPublisher(){this.currentJob={alias:void 0,compositeCopy:void 0,progress:{localCompositeCreated:!1,localCompositeBound:!1,localCompositeTransformed:!1,compositeCopyPushed:!1,compositePublished:!1,remixURLCreated:!1,publishedCompositeUpdated:!1,sourceDocumentUpdatedWithPublishData:!1}}}}},EbV1:function(e,t,r){"use strict";r.r(t),r.d(t,"default",(function(){return V}));var o=r("UzQk"),a=r("3xm6"),n=r.n(a),s=r("9KYx"),i=r("f5T3"),l=r("YLtl");const c=window.THEO_BUNDLE_PATH,d=[{id:"2",name:"row",backing:o.LockupBacking.Rows,artworkID:"none"},{id:"9",name:"banner",backing:o.LockupBacking.BannerHorizontal,artworkID:"none"},{id:"11",name:"knockout",backing:o.LockupBacking.Knockout,artworkID:"none"}],u={title:n.a.translate("app.textPanel.title"),ctaText:n.a.translate("app.helpModal.kCtaText"),ctaLink:"https://adobespark.zendesk.com/hc/en-us/categories/202688167-Adobe-Spark",assetUrl:`https://${window.location.host}/images/help-videos/edit_text.gif`,placement:"bottom-left",id:"editText"};function p(e,t,r){const a=e.map(e=>o.Host.locale.formatNumber(e,1));return Object(l.uniq)(a).map(e=>({emphasized:t,value:e,id:`${r}${e}`,separatorBefore:!1}))}function h(e,t,r,a){const l=e.controller,h=l.styleController,g=h.targetedLockupStyle,m="Highlight"===h.targetedLockupStyleName,f=o.LockupStyle.isPath(e.style.layout),b=o.LockupStyle.isLetterGrid(e.style.layout),y=h.targetedTextLook;let S=t.getUserFontSizeOfSelectedForma();S=isNaN(S)?0:S,S=o.Host.locale.formatNumber(S,1);const C=function(e,t){const r=[];for(const a of d){const n="banner"===a.name,s="knockout"===a.name,i=!e;t&&!o.ShapeLibrary.isBackingShapeStyleCompatible(t,a.backing,null)||(e&&(n||s&&!i)||r.push(a))}const a=o.ShapeLibrary.displayOrderForCategories();for(let s=0;s<a.length;s++){const i=a[s];if(e&&"SOCIAL"===i)continue;const l=t?t.layout:o.LockupLayout.Standard,c=t&&t.pathID,d=o.ShapeLibrary.displayOrderForCompatibleShapeIDs(i,l,c,e,!0);for(var n=0;n<d.length;n++)r.push({id:d[n],name:d[n],backing:o.LockupBacking.SVGBackground,artworkID:d[n]})}return r.map(e=>e.backing===o.LockupBacking.SVGBackground?{id:e.id,url:`${c}/images/images/shapes/icon/${e.id}.svg`,backing:e.backing,artworkID:e.artworkID}:{id:e.id,url:`${c}/images/images/shapes/icon/backing_icon_${e.name}.png`,backing:e.backing,artworkID:e.artworkID})}(t.inCharStyleMode,e.style);let w=t.getShapeOfSelectedLockup();b&&m&&-1===w&&(w=t.getShapeOfSelectedLockup(null,!0));const v=(!m||!f)&&(0!==w&&-1!==w),k=l.getCharacterStyleRanges().length>0||t.inCharStyleMode,P=!t.isSpacingAvailableForSelectedLockup(),T=t.inCharStyleMode;let x=p(t.getUserFontSizesInDocument(),!0,"doc");const I=p(o.TextFacade.getStandardFontSizes(),!1,"std");I.length&&(I[0].separatorBefore=!0),x=x.concat(I);const F=o.LockupStyle.isShadowLook(y),A=o.LockupStyle.isOutlineLook(y),E=o.LockupStyle.isKnockoutLook(y),D=o.LockupStyle.isOutlineWithTransparentTextLook(y),R=function(e,t,r){const o={};return t||(o.textColor={color:e.colors.fieldPrimary.hex}),r&&(o.effectsColor={color:e.colors.fieldSecondary.hex}),o.borderColor={color:e.colors.border.hex},o.shadowColor={color:e.colors.shadow.hex},o}(g,E||D,v),{disableKnockout:L,disableOutlineWithTransparentText:O,disableShadow:M,disableOutline:U}=function(e,t,r,a,n,s){let i=!1,l=!1;if(r&&(l=!0),a&&(i=!0),!i){const e=s.find(e=>{const t=parseInt(e.id,10);return isNaN(t)?e.id===n:t===n}),t=e?o.ShapeLibrary.shapeDictionary[Object(o.getBackingStringForBackingEnumAndArtworkId)(e.backing,e.artworkID)]:null;i=!(null==t?void 0:t.filled)}return{disableKnockout:i,disableOutlineWithTransparentText:l,disableShadow:!1,disableOutline:!1}}(0,0,E,D,w,C),{disableShape:B,disableShapePicker:j,disableAllAlignments:$,currentAlignment:N}=function(e,t){const r=e.getLockupLayouts(),a=e.getLockupAlignments(),n=e.getSelectedForma().style,s=n.layout;let l=!1,c=!1,d=-1;switch(s){case o.LockupLayout.FitJustified:d=i.a.capitalizeAndFit;break;case r.Standard:case r.LetterGrid:switch(e.getAlignmentOfSelectedLockup()){case a.Center:d=s===r.Standard?i.a.center:i.a.gridCenter;break;case a.Right:d=s===r.Standard?i.a.right:i.a.gridRight;break;default:d=s===r.Standard?i.a.left:i.a.gridLeft}break;case r.Path:l=t,c=t;const u=n.pathID,p=e.getTextPathIDs();switch(u){case p.Circle:d=i.a.circle;break;case p.SemiCircleUp:d=i.a.semicircle;break;case p.SemiCircleDown:d=i.a.semicircleInverted}break;case r.Auto:switch(o.TextFacade.getCategoryForAutoAlignment(n.alignment)){case o.TypographyLayoutCategory.DropCap:d=i.a.autoDropCap;break;case o.TypographyLayoutCategory.Rotate:d=i.a.autoRotate;break;case o.TypographyLayoutCategory.Triplet:d=i.a.autoTriplet;break;case o.TypographyLayoutCategory.RotateFit:d=i.a.autoFitRotate}}return s===r.FitJustified&&(d=3),{disableShape:c,disableShapePicker:l,disableAllAlignments:!1,currentAlignment:d}}(t,m),{label:V,postScriptName:W}=h.targetedFont.fontData,_=s.default.isStandardFontSelectable(W)?V:n.a.translate("panels.textstyles.kLegacyFont"),H=t.getOpacityValuesOfLockupAsScalars(),J=!E||F||A,G=(window.localStorage.getItem("text-area-focused-count")?Number(window.localStorage.getItem("text-area-focused-count")):0)<3,z=[];return t.hasValidAutoAlignmentByCategory(o.TypographyLayoutCategory.DropCap)&&z.push(o.TypographyLayoutCategory.DropCap),t.hasValidAutoAlignmentByCategory(o.TypographyLayoutCategory.Rotate)&&z.push(o.TypographyLayoutCategory.Rotate),t.hasValidAutoAlignmentByCategory(o.TypographyLayoutCategory.Triplet)&&z.push(o.TypographyLayoutCategory.Triplet),t.hasValidAutoAlignmentByCategory(o.TypographyLayoutCategory.RotateFit)&&z.push(o.TypographyLayoutCategory.RotateFit),{currentFont:_,hasShadow:F,hasOutline:A,currentFontSize:S,listOfShapes:C,selectedShapeId:w,disableKnockout:L,disableShadow:M,disableOutline:U,fontSizes:x,hasSecondaryStyle:k,disableShape:B,disableShapePicker:j,disableAllAlignments:$,autoAlignmentSupported:z,currentAlignment:N,hideLineHeight:P,hideLetterSpacing:T,colorInfo:R,showCoachmark:G,isOutlineOnly:D,disableOutlineOnly:O,selectedMSLTab:m?"secondary":"main",primarySwatch:"text",currentLineHeight:t.getSelectedFormaLineHeightAsScalar(),currentLetterSpacing:t.getSelectedFormaLetterSpacingAsScalar(),hasShapes:v,shapePadding:t.getSelectedFormaShapePaddingAsScalar(),shapeMaskText:E,shadowDistance:t.getSelectedFormaShadowDistanceAsScalar(),shadowDirection:t.getSelectedFormaShadowAngleAsScalar(),outlineThickness:t.getSelectedFormaOutlineThicknessAsScalar(),currentOpacity:H.text,shapeOpacity:H.shape,selectedItemsCanBeDeleted:!0,selectedItemsCanBeEdited:!1,disableTextOpacity:!J||E&&!A,disableShapeSizeSlider:11===w,textPanelHelpModalContent:u}}function g(e,t){return{colorInfo:{color:e.style.colors.fieldPrimary.hex},selectedItemsCanBeDeleted:t.getGridForma().style.numBackgroundCells>1,selectedItemsCanReordered:!1}}function m(e,t,r){let o={};const a=[],n=r.getCurrentBrandElements();let s=!0;return n&&(n.logos&&n.logos.forEach(e=>{e.acRoles.indexOf("primary-logo")>=0?o={id:e.id,url:e.fullResUrl}:a.push({id:e.id,url:e.fullResUrl})}),s=!n.belongsToUser),{primaryLogo:o,secondaryLogos:a,disableAddLogo:s,isLogoSelected:e&&e.isLogo&&e.isLogo(),currentOpacity:t.getOpacityValueOfSelectedFormaAsScalar(),selectedItemsCanBeDeleted:!0,selectedItemsCanBeReplaced:!0}}function f(e,t){return{currentOpacity:t.getOpacityValueOfSelectedFormaAsScalar(),colorInfo:{color:e.style.colors.fieldPrimary.hex},selectedItemsCanBeDeleted:!0,selectedItemsCanBeReplaced:!0,selectedItemsHaveSourceInfo:t.hasImageAttribution(),showBlendMode:t.canHaveBlendMode(e),currentBlendMode:t.getAppliedBlendMode(e)}}function b(e,t){return{currentOpacity:t.getOpacityValueOfSelectedFormaAsScalar(),disableUngroup:!t.getGroupFeatures().canUngroup,selectedItemsCanBeDeleted:!0,selectedItemsCanReordered:t.getNumLayers()-1!=0}}function y(e,t){return{currentHorizontalAlignment:-1,currentVerticalAlignment:-1,hasGroupSelected:t.getGroupFeatures().canUngroup,selectedItemsCanBeDeleted:!0,selectedItemsCanReordered:!1}}var S=r("UFvF"),C=r.n(S),w=r("wHG3"),v=r("TdwW"),k=r.n(v);const P=window.THEO_BUNDLE_PATH,{PNGEncoding:T,TargetRenderParameters:x,TargetTransformTypeEnum:I}=w.PixiJSApp,F={None:"none",Greyscale:"grayscale",Darken:"darken",Overlay:"contrast",Blend:"matte",Multiply:"multiply",DuoTone:"colorize",Screen:"lighten",NewDuoTone:"duotone"},A={blur:0,brightness:.5,contrast:.5,highlight:.5,saturation:.5,shadow:.5,sharpen:0,warmth:.5},E={title:n.a.translate("app.imagePanel.title"),ctaText:n.a.translate("app.helpModal.kCtaText"),ctaLink:"https://adobespark.zendesk.com/hc/en-us/categories/202688167-Adobe-Spark",assetUrl:`https://${window.location.host}/images/help-videos/edit_image.gif`,placement:"bottom-left",id:"editImage"};let D,R,L=[];function O(e,t,r,a,n){const s=o.ImageFacade.getMaskForForma(e),{blur:i,sharpness:l,contrast:c,saturation:d,brightness:u,shadows:p,highlights:h,warmth:g}=t.getSelectedFormaImageAdjustmentsAsScalars(),m={blur:i,contrast:c,saturation:d,brightness:u,warmth:g,shadow:p,sharpen:l,highlight:h},f=null!==e.controller.cutout,b=e.isImage()&&!e.isVideo(),y=t.getImageFormaBackgroundColor(e),S=null!==y,C={color:(null==y?void 0:y.rgbColor.hex)||"ffffffff"},w=t.getImagePreviewData(e),v=w.styleFilter.name,k=v===o.ImageStyle.NAME_NEWDUOTONE,T=t.getDocument().controller.selection,x=T.inCropMode,I=T.inRefineCutoutMode,O=t.getCutoutBrushMode(),M=t.getCutoutBrushSize(),U=t.getCutoutEffectiveBrushSize(),B=t.isCutoutPreviewVisible(),j=t.isAutoCutoutEnabled(),$=t.isClearCutoutEnabled(),N=t.isInvertCutoutEnabled(),V=!e.controller.moveable;let W=!1;for(const e in m)if("blur"!==e&&m[e]!==A[e]){W=!0;break}0===L.length&&(L=o.CropAssetLibrary.getListOfShapes().map(e=>({id:e.id,url:`${P}/images/images/shapes/svg/${e.id}.svg`})));const _=m.blur!==A.blur,H=e.controller.userGroupMember||e.isVideo();if(n&&!k){const e=t.getDocument().firstPage.imageFilterLibrary.getDefaultDuotonePreset(!0);R={shadows:e.shadows.rgbHex,highlights:e.highlights.rgbHex}}else{var J,G,z,K;R={shadows:k?null==w||null===(J=w.styleFilter)||void 0===J||null===(G=J.colors)||void 0===G?void 0:G.fieldShadows.rgbHex:R.shadows,highlights:k?null==w||null===(z=w.styleFilter)||void 0===z||null===(K=z.colors)||void 0===K?void 0:K.fieldHighlights.rgbHex:R.highlights}}return D||(D=t.getDocument().firstPage.imageFilterLibrary.getDuotonePresets().map(e=>({shadows:e.shadows.rgbHex,highlights:e.highlights.rgbHex,category:e.category}))),{hasBackgroundColor:S,colorInfo:C,imageEnhancements:m,showEnhancementsPanel:W,showBlurPanel:_,isBackgroundRemoved:f,isRemoveBackgroundEnabled:b,isCropMode:x,isCutoutMode:I,cutoutBrushMode:O,isCutoutPreviewVisible:B,isAutoCutoutEnabled:j,isRestoreBackgroundEnabled:$,isInvertMaskEnabled:N,cutoutBrushSize:M,cutoutEffectiveBrushSize:U,cutoutBrushRange:[1,100],isInBackgroundLayer:V,duotoneColorPairs:D,currentDuotoneColorPair:R,disableBGcheckbox:H,listOfCropShapes:L,backgroundColor:null==y?void 0:y.rgbColor.hex,imageRotation:t.getSelectedFormaRotationAsScalar(),imageScale:t.getSelectedFormaScaleAsScalar(),imageOpacity:t.getOpacityValueOfSelectedFormaAsScalar(),imageCropRotation:t.getSelectedFormaRotationAsScalar(),imageCropScale:t.getSelectedFormaScaleAsScalar(),selectedCropShapeId:s&&s.id,currentFilter:F[v],showBlendMode:t.canHaveBlendMode(e),currentBlendMode:t.getAppliedBlendMode(e),imagePanelHelpModalContent:E,selectedItemsCanBeReplaced:!x&&!I,selectedItemsCanBeDeleted:!x&&!I,selectedItemsHaveSourceInfo:!x&&!I&&t.hasImageAttribution(),selectedItemsCanBeDuplicated:!x&&!I&&t.allowDuplication(e),selectedItemsCanReordered:!x&&!I&&!V&&t.getNumLayers()-1!=0}}var M=r("LbXs");function U(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class B{constructor(){U(this,"_state",void 0),U(this,"_stringifiedState",void 0),this._state={isReplaceMode:!1,selectedItemType:"",selectedItemId:"",listOfLoadingAssets:[],selectedLayerMaxIndex:0,selectedLayerCurIndex:0,selectedItemsCanBeGrouped:!1,selectedItemsCanBeUngrouped:!1,selectedItemsCanBeDuplicated:!1,selectedItemsCanReordered:!1,selectedItemsCanBeDeleted:!1,selectedItemsCanBeReplaced:!1,selectedItemsCanBeEdited:!1,selectedItemsHaveSourceInfo:!1,isInBackgroundLayer:!1,isBackgroundRemoved:!1,isRemoveBackgroundEnabled:!1,isCropMode:!1,isCutoutMode:!1,isCutoutPreviewVisible:!1,isAutoCutoutEnabled:!1,isRestoreBackgroundEnabled:!1,isInvertMaskEnabled:!1,cutoutBrushMode:M.RefineCutoutBrushMode.NONE,cutoutBrushSize:0,cutoutEffectiveBrushSize:0,cutoutBrushRange:[0,0],imageRotation:0,imageScale:0,imageOpacity:0,imageCropRotation:0,imageCropScale:0,selectedCropShapeId:"",hasBackgroundColor:!1,listOfCropShapes:[],imageEnhancements:{},showEnhancementsPanel:!1,showBlurPanel:!1,disableBGcheckbox:!1,listOfFilters:[],currentFilter:"",duotoneColorPairs:[],currentDuotoneColorPair:{},imagePanelHelpModalContent:{},annotationPriority:-1,annotationTitle:"",text:"",focusText:!1,selectAllText:!1,formaID:"",selectedMSLTab:"",fontSizes:[],currentFont:"",currentFontSize:"",primarySwatch:"",currentAlignment:0,currentLineHeight:0,currentLetterSpacing:0,hasShapes:!1,listOfShapes:[],selectedShapeId:"",shapePadding:0,shapeMaskText:!1,hasShadow:!1,shadowDistance:0,shadowDirection:0,hasOutline:!1,isOutlineOnly:!1,outlineThickness:0,hasSecondaryStyle:!1,disableKnockout:!1,disableOutlineOnly:!1,disableShadow:!1,disableOutline:!1,disableShape:!1,disableShapePicker:!1,disableAllAlignments:!1,autoAlignmentSupported:[],hideLineHeight:!1,hideLetterSpacing:!1,shapeOpacity:1,disableTextOpacity:!1,disableShapeSizeSlider:!1,showCoachmark:!0,textPanelHelpModalContent:{},isLogoSelected:!1,primaryLogo:{id:"0",url:"logo1.com"},secondaryLogos:[{id:"1",url:"logo2.com"},{id:"2",url:"logo3.com"}],disableAddLogo:!1,isLogoReplaceMode:!1,currentHorizontalAlignment:0,currentVerticalAlignment:0,hasGroupSelected:!0,colorInfo:{color:"ffffff",key:"2"},enableHelpModal:!1,currentOpacity:75,assetRailSelectedId:"",designAssetsState:{},backgroundsState:{},currentBlendMode:"normal",showBlendMode:!1,disableUngroup:!1},this._stringifiedState=""}destroy(){this._state={},this._stringifiedState=""}dirtyState(){this._stringifiedState=""}setProperties(e){let t=!1;for(const[r,o]of Object.entries(e))this._state.hasOwnProperty(r)&&o!==this._state[r]&&(this._state[r]=o,t=!0);t&&this.dirtyState()}get stringifiedState(){return this._stringifiedState||(this._stringifiedState=JSON.stringify(this._state)),this._stringifiedState}get state(){return JSON.parse(this.stringifiedState)}}var j=r("rCSV"),$=r("bBG2");function N(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class V{constructor(e,t,r){N(this,"model",void 0),N(this,"coreWrapper",void 0),N(this,"brandkitWrapper",void 0),N(this,"postFeatureController",void 0),N(this,"events",void 0),N(this,"nodeStateGetterMap",{cell:g,image:O,text:h,logo:m,icon:f,group:b,multiselect:y}),this.coreWrapper=e,this.brandkitWrapper=t,this.postFeatureController=r,this.events=new j.default,this.model=new B,this.updateStateForSelectedItem(!1),this.events.publish("ui-state-updated")}clearSelectedItemState(){this.model.setProperties({listOfCropShapes:[],imageEnhancements:{},listOfFilters:[],fontSizes:[],listOfShapes:[],colorInfo:{}})}asyncUpdateFiltersListForSelectedImage(e){const t=this.coreWrapper.getImagePreviewData(e).styleFilter.name,r=this.coreWrapper.getDocument().controller.selection.inCropMode,a=this.coreWrapper.inRefineCutoutMode();"none"===t||r||a||function(e,t,r){const a=t.getImageFilters(),n=t.getImagePreviewData(e),s=n.styleFilter.detachFromDatabase(),i={},l=[],c=Math.round(82*e.bounds.width/Math.min(e.bounds.width,e.bounds.height)),d=Math.round(82*e.bounds.height/Math.min(e.bounds.width,e.bounds.height));for(let u=0;u<a.length;u++){a[u].name===s.name?(a[u].colorLibrary=n.forma.page.colorLibrary,a[u]=s):(a[u].adjustments=s.adjustments,a[u].name===o.ImageStyle.NAME_NEWDUOTONE&&(a[u].colors.fieldShadows=k.a.hex2SolidColor(R.shadows),a[u].colors.fieldHighlights=k.a.hex2SolidColor(R.highlights)));const p=t.beginTransaction("apply_styles_for_filter_thumbnails");o.ImageFacade.getImageFormaForForma(e).applyStyle(a[u]);const h=e.getGraph(o.PGMExportSettings.STATIC);p.rollback(),l.push(r.render(h,new x(I.FillCentered,c,d,T.AsDataURL())).then(e=>{const t=F[a[u].name];i[t]=e.data}))}return C.a.allSettled(l).then(()=>i)}(e,this.coreWrapper,this.coreWrapper.imageQueue()).then(t=>{this.model._state.selectedItemId===e.formaID&&(this.model.setProperties({listOfFilters:t}),this.events.publish("ui-state-updated",this.model.state))})}updateStateForSelectedItem(e){if(this.coreWrapper.isReordering())return;const t=this.coreWrapper.getSelectedForma(),r=this.coreWrapper.getSelectedFormaType(),a=this.coreWrapper.getSelectedFormaId(),n=this.nodeStateGetterMap[r],s=this.coreWrapper.getNumLayers()-1,i=this.coreWrapper.getLayerSliderValueOfSelectedForma(),l=this.coreWrapper.getGroupFeatures(),c=l.canGroup,d=l.canUngroup,u=!!t&&this.coreWrapper.allowDuplication(t),p=!!t&&0!==s;let h,g;if(h=this.coreWrapper.getTextForSelectedLockup(),h===o.TextFacade.kEmptyLockupString&&(h=""),g=this.coreWrapper.getSelectedFormaId(),this.model.setProperties({text:h,formaID:g,selectedItemType:r,selectedItemId:a,selectedLayerMaxIndex:s,selectedLayerCurIndex:i,selectedItemsCanBeGrouped:c,selectedItemsCanBeUngrouped:d,selectedItemsCanBeDuplicated:u,selectedItemsCanReordered:p,selectedItemsCanBeDeleted:!1,selectedItemsCanBeReplaced:!1,selectedItemsCanBeEdited:!1,selectedItemsHaveSourceInfo:!1}),n){const r=n(t,this.coreWrapper,this.brandkitWrapper,this.postFeatureController,e);this.model.setProperties(r)}"image"===r&&this.asyncUpdateFiltersListForSelectedImage(t)}forceUiStateUpdate(){this.updateStateForSelectedItem(!1),this.events.publish("ui-state-updated")}handleDocumentUpdated(){this.updateStateForSelectedItem(!1),this.events.publish("ui-state-updated")}handleEnterReplaceMode(){this.model.setProperties({isReplaceMode:!0}),this.events.publish("ui-state-updated")}handleLeaveReplaceMode(){this.model.setProperties({isReplaceMode:!1}),this.events.publish("ui-state-updated")}handleDoubleTapToEditText(e){this.model.setProperties({selectAllText:e,focusText:!0}),this.events.publish("ui-state-updated")}onFocusTextRequestHandled(){this.model.setProperties({focusText:!1,selectAllText:!1}),this.events.publish("ui-state-updated")}handleSelectionChanged(){if(this.coreWrapper.isReordering())return;this.model.setProperties({isReplaceMode:!1}),this.clearSelectedItemState(),this.updateStateForSelectedItem(!0),this.events.publish("ui-state-updated");const e=this.coreWrapper.getSelectedForma();let t="0";e&&e.kind===w.Core.RootForma.KIND?t="root":e&&(t=e.controller.getZOrder());const r={contextualData2:"method:"+(this.coreWrapper.selectFromLayerStack()?"layerWidget":"canvas"),contextualData3:"layer:"+t},o=this.coreWrapper.getSelectedFormaType();this.coreWrapper.inCharStyleMode||this.coreWrapper.exitingCharStyleMode||"no-selection"!==o&&$.default.publish(`editor:${o}Selected`,r),this.coreWrapper.exitingCharStyleMode=!1}addLoadingAssetId(e){const t=this.model._state.listOfLoadingAssets;if(t.includes(e))return;const r=t.slice();r.push(e),this.model.setProperties({listOfLoadingAssets:r}),this.events.publish("ui-state-updated")}removeLoadingAssetId(e){const t=this.model._state.listOfLoadingAssets;if(t){const r=t.indexOf(e);if(r>=0){const e=t.slice();e.splice(r,1),this.model.setProperties({listOfLoadingAssets:e})}this.events.publish("ui-state-updated")}}handleAnnotationsChanged(e,t){this.model.setProperties({annotationPriority:e,annotationTitle:t}),this.events.publish("ui-state-updated",{immediate:!0})}handleAssetRailNavChanged(e){this.model.setProperties({assetRailSelectedId:e}),this.events.publish("ui-state-updated")}handleDesignAssetsChanged(e,t){const r=t+"State";this.model.setProperties({[r]:e}),this.events.publish("ui-state-updated")}handleLogoPanelChanged(e){const t={};Object.entries(e).forEach(([e,r])=>{t[e]=r}),this.model.setProperties(t),this.events.publish("ui-state-updated")}destroy(){this.model.destroy()}}},Gklz:function(e,t,r){"use strict";r.r(t);var o=r("TdwW"),a=r.n(o);function n(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}t.default=class{constructor(e,t,r){n(this,"colorPicker",void 0),n(this,"postEditorContent",void 0),n(this,"handleEyeDropperEventCallback",void 0),n(this,"colorPickerEventListeners",[]),n(this,"pickerVisible",!1),n(this,"coreWrapper",void 0),n(this,"clickOutsideHandler",void 0),n(this,"role",0),this.colorPicker=e,this.postEditorContent=t,this.handleEyeDropperEventCallback=r,this.clickOutsideHandler=this.handleClickOutsideColorPicker.bind(this)}handleShown(){setTimeout(()=>{window.addEventListener("click",this.clickOutsideHandler)},0)}handleHidden(){window.removeEventListener("click",this.clickOutsideHandler),this.unbindListeners()}unbindListeners(){this.colorPickerEventListeners.forEach(e=>{e.remove()}),this.colorPickerEventListeners=[]}handleClickOutsideColorPicker(e){const t=e.target,r="colorPicker"===t.id,o=t.closest(".post-color-eyedropper-target"),a=t.closest("#colorPicker");let n=!1;const s=e.composedPath&&e.composedPath();s&&s.length&&s.forEach(e=>{"THEO-COLOR-SWATCH"===e.tagName&&(n=!0)}),r||a||o||n||(this.colorPicker.hide(),this.pickerVisible=!1)}colorChangeModal(e){"begin"===e.type?this.pickerVisible=!0:"confirm"!==e.type&&"cancel"!==e.type||(this.pickerVisible=!1)}colorChanged(e,t){const r=this.coreWrapper.getSelectedForma();if(this.pickerVisible){const o=a.a.hex2rgb(e.color);"duotone: shadows"===t||"duotone: highlights"===t?this.coreWrapper.updateDuotoneFilterColor("duotone: shadows"===t,{red:o.r,green:o.g,blue:o.b,id:e.id,roles:[this.role]}).done():r&&r.isTypeLockup()?this.coreWrapper.setColorWithRolesForSelection([{red:o.r,green:o.g,blue:o.b,id:e.id,roles:[this.role]}]):this.coreWrapper.setColorForSelection([{red:o.r,green:o.g,blue:o.b,id:e.id,roles:e.roles}])}}handleEyeDropperChanged(e){this.handleEyeDropperEventCallback(e,this.colorPicker),"click"===e.type&&(this.postEditorContent.removeClass("eye-dropper-scrim"),this.postEditorContent.find(".full-scrim").remove())}handleEnterEyeDropperMode(){this.postEditorContent.addClass("eye-dropper-scrim").append('<div class="full-scrim"></div>')}getSuggestedColors(e,t){const r="effects"===t?1:0;let o;if(o=e.isTypeLockup()?this.coreWrapper.getSuggestedColorsForLockup(e):this.coreWrapper.getSuggestedColors(e),!o)return null;return o.map(e=>e[r]?e[r]:null).filter(e=>e)}getCurrentPalette(){return this.coreWrapper.getColorPalette().map(e=>a.a.hex2rgb(e.color))}show(e){if(!e.color||!e.anchor)return;this.colorPickerEventListeners.length&&this.unbindListeners(),this.coreWrapper=e.coreWrapper,this.role=e.role,this.colorPicker.setAnchorElement($(e.anchor)),this.colorPicker.setContainingElement($(e.containingElement));const t=e.color.length>6?e.color.substring(0,6):e.color;this.colorPicker.setCurrentColor(t);const r=this.coreWrapper.getSelectedForma(),o=this.getCurrentPalette(),a=this.getSuggestedColors(r,e.colorToEdit);this.colorPicker.update({currentColors:o,suggestedColors:a,compact:e.compact,label:e.label}),this.pickerVisible=!1,this.colorPickerEventListeners=this.colorPicker.bindToEventsWithHandlers({shown:this.handleShown.bind(this),hidden:this.handleHidden.bind(this),colorChangeModal:this.colorChangeModal.bind(this),colorChanged:t=>{this.colorChanged(t,e.colorToEdit)},"eyedropper-changed":this.handleEyeDropperChanged.bind(this),"eye-dropper-mode":this.handleEnterEyeDropperMode.bind(this)}),this.colorPicker.show()}hide(){this.pickerVisible&&this.colorPicker.hide(),this.pickerVisible=!1}}},GnB6:function(e,t,r){"use strict";function o(){let e="Unknown",t="Unknown";const r=function(){const e=document.createElement("canvas");if(e)return e.getContext("webgl")||e.getContext("experimental-webgl");return null}();if(r){const o=r.getExtension("WEBGL_debug_renderer_info");o&&(e=r.getParameter(o.UNMASKED_VENDOR_WEBGL),t=r.getParameter(o.UNMASKED_RENDERER_WEBGL))}const{platform:o,userAgent:a}=navigator;return{vendor:e,renderer:t,platform:o,userAgent:a}}function a(){const[e,t]=function(){let e="",t="";const r=document;void 0!==r.hidden?(e="hidden",t="visibilitychange"):void 0!==r.msHidden?(e="msHidden",t="msvisibilitychange"):void 0!==r.webkitHidden&&(e="webkitHidden",t="webkitvisibilitychange");return[e,t]}(),r=document;return{isHidden:()=>r[e],addListener(o){void 0!==r.addEventListener&&""!==e&&r.addEventListener(t,o,!1)},removeListener(e){void 0!==r.removeEventListener&&r.removeEventListener(t,e,!1)}}}r.r(t),r.d(t,"getWebGLSystemInfo",(function(){return o})),r.d(t,"getPageVisibilityInfo",(function(){return a})),t.default={getWebGLSystemInfo:o}},INJi:function(e,t,r){"use strict";r.r(t);var o=r("YLtl"),a=r("UzQk"),n=r.n(a),s=r("MGCh"),i=r.n(s),l=r("WpJZ"),c=r("bBG2");const d=r("92tI"),u=i.a.channel("text-style-module");let p,h,g=!1,m=!1;let f=[],b=0,y=null,S=null,C=null,w=!1,v=!1,k=null,P=null,T=0;function x(e,t){const r=p.getSelectedForma();if(null==r||!r.isTypeLockup())return;const o=r.controller.text;if(r&&(r.formaID!==S||o!==y||null==h||0===b||0===h.postTextStylesServiceInterface.getNumStylesInCache())){u.info("Resetting wheel parameters."),d.eraseTextStyleCache(),d.updateTextStyleSuggestionAtIndex(0,r.style.clone(),"current style"),h=new n.a.WheelSuggestionEvaluator(r),h.postTextStylesServiceInterface.advancedFeatures=g,P=p.getStyleServiceMetaDataString(r),S!==r.formaID&&(T=0),S=r.formaID,C=r.placement,y=o,k=null,b=0;const a=!0,s=!0;return d.resetStyleSuggestions(a,s,h,e,t).finally(()=>{u.info(`Styles: ${e} Emphasis: ${t}`)})}}function I(e,t){w&&e&&function(){const e=p.getFormaById(S);let t=Object(l.getLockupStyleStringWithRole)(e,p.getDocument()),r=null,o=null;if(h){const e=h.lockupStyleEvaluator.getOldReadabilityInformation();e&&(o=e.readabilityString);const t=h.lockupStyleEvaluator.getNewReadabilityInformation();t&&(r=t.readabilityString)}if(t.length>0){k&&(t+=`{sugID:${k}}`);const e="location:WheelSuggestion";c.default.publish("lockupStyleCaptured",{contextualData1:"styleString:"+t,contextualData2:e,contextualData3:"oldRead:"+o,contextualData4:"newRead:"+r,contextualData5:"meta:"+P,contextualData6:"emphasisUsed:"+v}),w=!1}}(),v&&t&&function(){const e=d.getEmphasisLoggingInfo(h),t=[];e.forEach(e=>{t.push(e)});const r=JSON.stringify(t);if(r.length>0){const e="location:WheelSuggestion";c.default.publish("lockupEmphasisCaptured",{contextualData1:"emphasisString:"+r,contextualData2:e}),v=!1}}()}function F(e,t){I(e,t),x(e,t)}function A(){I(!0,!0),h=null,P=null,w=!1,v=!1,d.eraseTextStyleCache()}function E(){const e=p.getSelectedForma();e&&e.isTypeLockup()||(S=null,f.forEach(e=>{e.remove()}),f=[],A())}const D=Object(o.throttle)(()=>{u.info("Forma updated. Clearing styles/emphasis promises, then resetting spinner."),F(!0,!0)},400);function R(){const e=p.getSelectedForma();n.a.TextFacade.setFitContainerToArea(e,m),e.formaID!==S&&(f.push(p.events.subscribe("forma-selected",E)),f.push(p.events.subscribe("forma-text-updated",D)),x(!0,!0)),e&&e.isTypeLockup()&&(e.formaID!==S||C!==e.placement)&&(e.formaID!==S&&F(!0,!0),C!==e.placement&&F(!0,!1))}const L=new class{setCoreWrapper(e){p=e,d.setCoreWrapper(e)}setAdvancedTextLayoutEnabled(e){g=e}setAdvancedTextLayoutEnableBoundingBoxArea(e){m=e}handleStyleSliderValueChange(){R(),T+=1;b=(T+5e3)%50,w=0!==b,d.applyTextStyleSuggestion(b,h).then(()=>{const{id:e}=d.getTextStyleSuggestionAtIndex(b);k=e||null}).done()}};t.default=L},J9tZ:function(e,t,r){"use strict";async function o(e,t,r){try{return[null,await e]}catch(e){return t&&Object.assign(e,t),"function"==typeof r&&r(e),[e,void 0]}}r.d(t,"a",(function(){return o}))},K7z8:function(e,t,r){"use strict";r.r(t),r.d(t,"BrandkitTemplateUtils",(function(){return C}));var o=r("U44B"),a=r.n(o),n=r("hHO/"),s=r.n(n),i=r("3xdQ"),l=r.n(i),c=r("b2xK"),d=r.n(c),u=r("qnb0"),p=r.n(u),h=r("mwMu"),g=r.n(h),m=r("wPbz"),f=r("YYuT"),b=r("btxu"),y=r("MGCh");const S=r.n(y).a.channel("brandkit-template-utils");class C{static async renderCoreToDataUrl(e,t){const r=new b.default(e);return await r.render(t)}static async renderCoreToCanvasContext(e,t,r){const o=new b.default(e);await o.renderToCanvas(t,r)}static async createEmptyPostTemplate(e){const t=await e.composite.acquireNestedMap("themes"),r=e.composite.addChildPath(void 0,void 0,t);return r.setValue("type","application/vnd.adobe.adobesparkpost.theme+json"),r.setValue("ac#format","post"),r}static async copyTemplate(e,t,r){const o=r||await C.createEmptyPostTemplate(e);o.setValue("theme#data",t.getValue("theme#data"));const a=new l.a({persistSource:g.a.fromTemplate(e,t),persistSave:p.a.toTemplateLocal(e,o,p.a.CommitChanges.AUTO)});await a.whenInitialized();const n=await C.renderCoreToDataUrl(a,{longestSide:500});return await a.saveWithRenditions(void 0,s()(n)),o}static async renderTemplate(e,t,r,o){const a=new l.a({persistSource:g.a.fromTemplate(e,t),persistSave:d.a.toBlackHole()});await a.whenInitialized(),await C.renderCoreToCanvasContext(a,r,{longestSide:o||500})}static async setUsedBrandElementsData(e,t,r,o){const a=r||new l.a({persistSource:g.a.fromTemplate(e,t),persistSave:p.a.toTemplateLocal(e,t,o?p.a.CommitChanges.NEVER:p.a.CommitChanges.AUTO)});let n,s,i=e.getAllFonts();try{n=(await e.getColors()).map(e=>e.getId()).filter(e=>a.isSparkColorInUse(e));i=(i&&0!==i.length?i:await e.getFonts()).map(e=>e.getId()).filter(e=>a.areSparkFontsInUse([e]));s=(await e.getAuthoringContextLogos()).map(e=>e.getId()).filter(e=>a.areSparkLogosInUse([e]));const r=t.getValue("theme#data")||{};r.colors=n,r.fonts=i,r.logos=s,t.setValue("theme#data",r)}catch(e){const t=e?e.message:"";S.error("setUsedBrandElementsData error: "+t,e)}}static async createEmptyBrandedTemplate(e,t){const r=t||await C.createEmptyPostTemplate(e),o=new l.a({persistSource:new m.a({}),persistSave:p.a.toTemplateLocal(e,r,p.a.CommitChanges.AUTO)});await o.whenInitialized();const n=await f.default.getCoreBrandForTemplateGeneration(e);n?(a.a.setAuthoringContext(n),await o.brandDocument(n)):S.error("Failed to add branding to default template: Core brand is undefined."),await C.setUsedBrandElementsData(e,r,o,!0);const i=await C.renderCoreToDataUrl(o,{longestSide:500});return await o.saveWithRenditions(null,s()(i)),r}static getTemplateName(e){return(e.getValue("theme#data")||{}).name||""}static setTemplateName(e,t){const r=e.getValue("theme#data")||{};r.name=t,e.setValue("theme#data",r)}static setTemplateSourceID(e,t){const r=e.getValue("theme#data")||{};r.sourceTemplateID=t,e.setValue("theme#data",r)}}t.default=C},Mbmg:function(e,t,r){"use strict";r.d(t,"a",(function(){return l}));var o=r("xeH2"),a=r.n(o),n=r("3xm6"),s=r.n(n);function i(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class l{static pageUnloadBlockingBegin(){window.addEventListener("beforeunload",l.pendingSavePageUnloadPrompt)}static pageUnloadBlockingEnd(){window.removeEventListener("beforeunload",l.pendingSavePageUnloadPrompt)}static beginTrackingPendingXhrRequests(){l.isTrackingXHRs||(l.isTrackingXHRs=!0,a()(document).on("ajaxSend",l.registerJqxhr),a()(document).on("ajaxComplete",l.unregisterJqxhr))}static endTrackingPendingXhrRequests(){l.isTrackingXHRs=!1,a()(document).off("ajaxSend",l.registerJqxhr),a()(document).off("ajaxComplete",l.unregisterJqxhr),l.xhrRequestsToAbortOnUnload=[]}static pendingSavePageUnloadPrompt(e){l.xhrRequestsToAbortOnUnload.forEach(e=>{e&&e.abort()});const t=s.a.translate("dialogs.savePageUnloadPrompt");return e&&(e.preventDefault(),e.returnValue=!!t),t}static registerJqxhr(e,t,r){l.xhrRequestsToAbortOnUnload.push(t)}static unregisterJqxhr(e,t,r){const o=l.xhrRequestsToAbortOnUnload.indexOf(t);l.xhrRequestsToAbortOnUnload.splice(o,1)}}i(l,"xhrRequestsToAbortOnUnload",[]),i(l,"isTrackingXHRs",!1),t.b=l},PsNr:function(e,t,r){var o,a;o=[r("xeH2"),r("YLtl"),r("UFvF"),r("eZ+Q")],void 0===(a=function(e,t,r,o){var a={cleanUpFiles:function(e){e=e.map((function(e){return e.source=o.getServiceSource(e),e}));for(var t=["original","preview","thumbnail","small"],r=0;r<e.length;r++)for(var a=e[r],n=0;n<t.length;n++){var s=t[n];!a[s]||a[s].link||a[s].blobPromise||delete a[s]}return e}};return a}.apply(t,o))||(e.exports=a)},RhVb:function(e,t,r){var o;void 0===(o=function(){var e={},t=!1;function r(){t="visible"===document.visibilityState}return e.getPostTabRecoveryStatus=function(){return t},e.setPostTabRecoveryStatus=function(e){t=e},e.startWatchPostTabVisibility=function(){document.addEventListener("visibilitychange",r,!1)},e.endWatchTabVisibility=function(){t=!1,document.removeEventListener("visibilitychange",r,!1)},e}.apply(t,[]))||(e.exports=o)},UNP3:function(e,t,r){"use strict";r.r(t),r.d(t,"reportNounProjectIds",(function(){return c}));var o=r("ApVh"),a=r.n(o),n=r("MGCh"),s=r.n(n),i=r("WpJZ");const l=s.a.channel("noun-project-reporter");function c(e,t,r){const o=Object(i.getUnreportedNounProjectIds)(e);if(!o.length)return Promise.resolve();const n=`https://${t.dooplo}/api/v1/report/usage?api_key=MarvelCP1`;return a.a.getAccessToken().then(a=>{const s={method:"POST",headers:{Authorization:"Bearer "+a,"X-Api-Key":t.key,Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({ids:o})};return fetch(n,s).then(t=>{if(t.status>=400){const e=new Error("reportNounProjectIds returned an HTTP error");l.error(`Requested ${n}. Got back ${t.statusText}`,e)}else Object(i.setNounProjectIdsReported)(o,e),r()}).catch(e=>{l.error("error reporting Noun Project icon Ids",`Requested ${n}. Got back ${e}`)})})}},Wqmg:function(e,t,r){"use strict";async function o(e,t=""){const r="/api/post/v1/proxy?url="+encodeURIComponent(e);let o;try{o=await fetch(r)}catch(e){throw new Error("image blob failed to load through proxy. error details: "+e)}if(!o.ok)throw new Error("image blob failed to load through proxy. status: "+o.status);try{const e=await o.arrayBuffer(),r=new Uint8Array(e),a=t||o.headers.get("Content-Type")||"image/jpeg";return new Blob([r],{type:a})}catch(e){throw new Error("image blob failed to get created. error details: "+e)}}r.d(t,"a",(function(){return o}))},Wxmc:function(e,t,r){var o,a;o=[r("3xm6"),r("UzQk"),r("Dvuo")],void 0===(a=function(e,t,r){var o={},a="px",n=0,s=300;return o.isValidParsedInput=function(e){var r="number"==typeof e?e:t.Host.locale.convertStringToNumber(e);if(isNaN(r))return NaN;var o=t.PageFacade.convertPixelsToUnitsString(r,n,s);return!!t.PageFacade.pageDimensionIsInRange(o,n,s)&&r},o.updateRangeAndUnits=function(e,t){a=r.getUnitsStringForFormat(e),n=e,s=t},o.validateAndReturnValueForInput=function(r){var i=o.isValidParsedInput(r);if(i||0===r.length)return 0===r.length&&(i=2560),{isValid:!0,errorMsg:"",value:i};if(isNaN(i))return{isValid:!1,errorMsg:e.translate("forms.custom-size.kInvalidInput"),value:r};{const o=t.PageFacade.getMinPageDimensionForUnits(n,s),i=t.PageFacade.getMaxPageDimensionForUnits(n,s),l=t.PageFacade.getNumDecimalPlacesForUnits(n),c=t.Host.locale.formatNumber(o,l),d=t.Host.locale.formatNumber(i,l);return{isValid:!1,errorMsg:e.translate("forms.custom-size.kInvalidSizeWithUnit",{minimum:c,maximum:d,units:a}),value:r}}},o.validateInputsAndCheckAspectRatio=function(r,a){var n=o.validateAndReturnValueForInput(r),s=o.validateAndReturnValueForInput(a),i="";return n.isValid&&s.isValid&&t.PageFacade.aspectRatioIsVeryTallOrWide({width:n.value,height:s.value})&&(i=e.translate("forms.custom-size.kAspectRatioTip")),{width:n,height:s,tip:i}},o}.apply(t,o))||(e.exports=a)},dcsN:function(e,t,r){"use strict";r.r(t);var o=r("Na8G"),a=r.n(o);t.default=class{constructor(e){this.postFeatureController=e}isEntitledToFeature(e){return this.postFeatureController.featureEnabled("entitle-brand-kit")}tryPremiumFeature(e){return!!this.isEntitledToFeature(String(e.touchpointName))||(a.a.showMerchPopover(e),!1)}}},dlJo:function(e,t,r){"use strict";t.a=class{static promiseFetch(e,t={}){return new Promise((r,o)=>{fetch(e,t).then(e=>{if(e.ok)r(e.json());else{const t=new Error(e.statusText);o(t)}}).catch(e=>{o(e)})})}}},f5T3:function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));const o={center:0,left:1,right:2,capitalizeAndFit:3,circle:4,semicircle:5,semicircleInverted:6,gridLeft:7,gridCenter:8,gridRight:9,autoDropCap:10,autoTriplet:11,autoRotate:12,autoFitRotate:13}},ibPQ:function(e,t,r){"use strict";r.r(t),r.d(t,"KeyboardShortcuts",(function(){return u}));var o=r("MGCh"),a=r.n(o),n=r("bBG2"),s=r("3xm6"),i=r.n(s),l=r("5d+0"),c=a.a.channel("keyboard-shorcuts"),d={confirmText:0,rotation:0,sendForward:0,sendToFront:0,sendBackward:0,sendToBack:0,duplication:0,group:0,ungroup:0,nudge:0,marqueeSelect:0,multiselect:0,selectSibling:0,selectParent:0,selectChild:0,exitSpecialSelectionMode:0,actualSize:0,fitToView:0,fillToView:0,zoomOut:0,zoomIn:0,panView:0,panKey:0,zoomInKey:0,zoomOutKey:0};class u{static get callbackKeys(){return{ENTER:"ENTER",SHIFT_ENTER:"SHIFT_ENTER",ESCAPE:"ESCAPE"}}constructor(){this.callCallbacksForKey=this.callCallbacksForKey.bind(this),this.addCallback=this.addCallback.bind(this),this.handleKeyEvent=this.handleKeyEvent.bind(this),this.getShortcutDescription=this.getShortcutDescription.bind(this),this.logShortcut=this.logShortcut.bind(this),this.callbacks={}}callCallbacksForKey(e,t){u.callbackKeys[e]?this.callbacks[e]&&(e===u.callbackKeys.SHIFT_ENTER&&this.logShortcut(l.ShortcutConstants.kConfirmText),this.callbacks[e].forEach((function(e){e(t)}))):c.error("can not call callback for unsupported key with value: "+e)}addCallback(e,t){u.callbackKeys[e]&&(this.callbacks[e]?this.callbacks[e].push(t):this.callbacks[e]=[t])}bindListeners(e,t,r){e.addEventListener(t,this.handleKeyEvent),r.forEach(e=>{this.addCallback(e.key,e.method)})}unbindListeners(e,t){e.removeEventListener(t,this.handleKeyEvent),this.callbacks={}}handleKeyEvent(e){if(0===e.type.indexOf("key")){var t=e.shiftKey;switch(e.which){case 13:if(t){this.callCallbacksForKey(u.callbackKeys.SHIFT_ENTER,e);break}this.callCallbacksForKey(u.callbackKeys.ENTER,e);break;case 27:this.callCallbacksForKey(u.callbackKeys.ESCAPE,e)}}else c.error("tried to process event of type : "+e.type+". should not try to process non-key events")}getShortcutDescription(e,t){var r="",o=navigator.appVersion.indexOf("Mac");return e.command&&(r+=o?i.a.translate("keyboard.kMacCommandKey"):i.a.translate("keyboard.kWinCtrlKey")),e.control&&o&&(r+=r.length>0?"+":"",r+=i.a.translate("keyboard.kMacControlKey")),e.option&&(r+=r.length>0?"+":"",r+=o?i.a.translate("keyboard.kMacOptionKey"):i.a.translate("keyboard.kWinAltKey")),e.shift&&(r+=r.length>0?"+":"",r+=i.a.translate("keyboard.kShiftKey")),r+=r.length<=1?t:"+"+t}logShortcut(e){d[e]+=1,n.default.publish("keyboardShortcut",{contextualData1:`actionCountInSession: ${e}_${d[e]}`,contextualData2:"actionDescription: "+e})}}},rnE3:function(e,t,r){"use strict";r.d(t,"a",(function(){return l}));var o=r("xeH2"),a=r.n(o),n=r("7mGH"),s=r.n(n),i=r("qcxC");class l{static getTemplateList(e){const t=Object(i.default)(),r=s.a.hasFeature("post-bktemplates-use-test-url")?"/api/post/v1-test/brandedtemplates":"/api/post/v1/brandedtemplates";let o;return o=e instanceof Array?e:"string"==typeof e?[e]:["modern"],s.a.hasFeature("post-bktemplates-use-hardcoded-list")?t.resolve(l.getTemplateListHardcodedData()):a.a.ajax({type:"GET",url:r,data:{font_categories:o.join(",")},dataType:"json"}).fail((e,r)=>{t.reject(r)}).done(e=>{t.resolve(e)}),t.promise}static getTemplateListHardcodedData(){return{documents:[{cpAssetId:"da41617f-dcba-4913-998f-9692b1d15a31",fontCategories:["modern"],title:"Thank You Note"},{cpAssetId:"dab66ebb-cf0e-4e5c-9236-4d0ef0ef0df8",fontCategories:["modern"],title:"Announcement"},{cpAssetId:"b4b558bd-f27e-409f-b4ee-4b17fad62e00",fontCategories:["modern"],title:"Quote"},{cpAssetId:"33f674a3-6214-4310-a87c-50e8536afbe9",fontCategories:["modern"],title:"Twitter Post"},{cpAssetId:"2f2548d7-1d9f-4b7d-801a-98060cc3f574",fontCategories:["modern"],title:"Facebook Ad"},{cpAssetId:"43adfdb5-e453-46a4-b48d-bdf189736cae",fontCategories:["modern"],title:"Facebook Post"},{cpAssetId:"f6956e61-82be-4be6-bdf0-361291439674",fontCategories:["modern"],title:"Instagram/Snapchat Story"},{cpAssetId:"6128f73e-f285-451f-89b6-e8a32e0c96a9",fontCategories:["modern"],title:"Poster"},{cpAssetId:"4dd7b216-e209-4863-9a9b-a8c21b32bb0f",fontCategories:["modern"],title:"Announcement "},{cpAssetId:"2cf62e84-fc0e-4c2a-963f-c100c3317afc",fontCategories:["modern"],title:"Business Card"}]}}}},yiIM:function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));class o{static reload(){window.location.reload()}static getLocationPathname(){return window.location.pathname}}},ys7E:function(e,t,r){"use strict";r.r(t);var o=r("wHG3"),a=r("3xm6"),n=r.n(a),s=r("MGCh"),i=r.n(s),l=r("tpS0"),c=r.n(l);const d=i.a.channel("controller");let u;t.default=class{constructor(e){this.uiStateController=e}handleAnnotationsChanged(e){let t=-1,r="";if(e){t=e.priority;const a=e.id;switch(a){case o.Core.AnnotationID.TextTruncated:r=n.a.translate("dialogs.annotations.kTextTruncatedTitle");break;case o.Core.AnnotationID.TooMuchCurvedText:case o.Core.AnnotationID.TooMuchGridText:r=n.a.translate("dialogs.annotations.kTooMuchTextTitle");break;case o.Core.AnnotationID.MultipleReturns:r=n.a.translate("dialogs.annotations.kMultipleReturnsTitle");break;default:t=-1,d.warn("Unhandled annotation "+a)}}this.uiStateController.handleAnnotationsChanged(t,r)}handleAnnotationClicked(e){let t,r;const{id:a}=e;switch(a){case o.Core.AnnotationID.TextTruncated:t=n.a.translate("dialogs.annotations.kTextTruncatedTitle"),r=n.a.translate("dialogs.annotations.kTextTruncatedMessage");break;case o.Core.AnnotationID.TooMuchCurvedText:t=n.a.translate("dialogs.annotations.kTooMuchTextTitle"),r=n.a.translate("dialogs.annotations.kTooMuchCurvedTextMessage");break;case o.Core.AnnotationID.TooMuchGridText:t=n.a.translate("dialogs.annotations.kTooMuchTextTitle"),r=n.a.translate("dialogs.annotations.kTooMuchGridTextMessage");break;case o.Core.AnnotationID.MultipleReturns:t=n.a.translate("dialogs.annotations.kMultipleReturnsTitle"),r=n.a.translate("dialogs.annotations.kMultipleReturnsMessage");break;default:d.warn("Unhandled annotation "+a)}t&&r&&(u&&(u.hide(),u=void 0),u=this.createAnnotationsModal(t,r),u.show())}createAnnotationsModal(e,t){return new c.a({headerText:e,contentText:t,dismissable:!0,buttons:[{class:"pill pill-primary-on-light",label:n.a.translate("common.kOKGotIt"),onClick:()=>{u&&(u.hide(),u=void 0)}}]})}}},ywYV:function(e,t,r){var o;void 0===(o=function(){var e={};function t(e){return e*Math.PI/180}return e.radians=t,e.degrees=function(e){return 180*e/Math.PI},e.degreesBetweenPoints=function(e,t){return 180*Math.atan2(t.y-e.y,t.x-e.x)/Math.PI},e.radiansBetweenPoints=function(r,o){return t(e.degreesBetweenPoints(r,o))},e.distanceSquared=function(e,t){return Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2)},e.distanceBetweenPoints=function(t,r){return Math.sqrt(e.distanceSquared(t,r))},e.rotatePoint=function(e,r,o){var a=t(o);return{x:Math.cos(a)*(e.x-r.x)-Math.sin(a)*(e.y-r.y)+r.x,y:Math.sin(a)*(e.x-r.x)+Math.cos(a)*(e.y-r.y)+r.y}},e.rotatePoints=function(t,r,o){for(var a=[],n=0;n<t.length;n++)a.push(e.rotatePoint(t[n],r,o));return a},e.closestPointOfLineToAPoint=function(t,r,o){var a=((t.x-r.x)*(o.x-r.x)+(t.y-r.y)*(o.y-r.y))/e.distanceSquared(r,o);return{x:r.x+a*(o.x-r.x),y:r.y+a*(o.y-r.y)}},e.midpointOfTwoPoints=function(e,t){return{x:e.x+(t.x-e.x)/2,y:e.y+(t.y-e.y)/2}},e.closestPointOnLineSegment=function(e,t,r){var o=e.x-t.x,a=e.y-t.y,n=r.x-t.x,s=r.y-t.y,i=(o*n+a*s)/(n*n+s*s);return i<0||t.x==r.x&&t.y==r.y?t:i>1?r:{x:t.x+i*n,y:t.y+i*s}},e.pointDistanceToLineSegment=function(t,r,o){var a=e.closestPointOnLineSegment(t,r,o),n=t.x-a.x,s=t.y-a.y;return Math.sqrt(n*n+s*s)},e.closestPointOnEdgeOfShape=function(t,r){var o=r.length;if(0===o)return t;if(1===o)return r[0];for(var a=0,n=t,s=0;s<o;s++){var i=s===o-1?0:s+1,l=r[s],c=r[i],d=e.pointDistanceToLineSegment(t,l,c);(0===s||d<a)&&(a=d,n=e.closestPointOnLineSegment(t,l,c))}return n},e.pointSomeDistanceTowardsPoint=function(e,t,r){var o=r.x-e.x,a=r.y-e.y,n=Math.sqrt(o*o+a*a),s=t/(n/o),i=t/(n/a);return{x:e.x+s,y:e.y+i}},e.isPointInsideShape=function(e,t){for(var r=!1,o=-1,a=t.length,n=a-1;++o<a;n=o)(t[o].y<=e.y&&e.y<t[n].y||t[n].y<=e.y&&e.y<t[o].y)&&e.x<(t[n].x-t[o].x)*(e.y-t[o].y)/(t[n].y-t[o].y)+t[o].x&&(r=!r);return r},e.getScaledShapeVertices=function(t,r,o){for(var a,n,s=[],i=o.length,l=0;l<i;l++)a=o[l],n=e.distanceBetweenPoints(t,a)*r,s.push(e.pointSomeDistanceTowardsPoint(t,n,a));return s},e.pointJustAboveShape=function(e){for(var t,r=e[0].x,o=r,a=e[0].y,n=0,s=e.length;n<s;n++)(t=e[n]).x<r&&(r=t.x),t.x>o&&(o=t.x),t.y>a&&(a=t.y);return{x:Math.round(r+(o-r)/2),y:a}},e.decomposeMatrix2d=function(e){var t=Math.atan2(e[1],e[0]),r=Math.pow(e[0],2)+Math.pow(e[1],2),o=Math.sqrt(r),a=(e[0]*e[3]-e[2]*e[1])/o,n=Math.atan2(e[0]*e[2]+e[1]*e[3],r);return{angle:t/(Math.PI/180),scaleX:o,scaleY:a,skewX:n/(Math.PI/180),skewY:0,translateX:e[4],translateY:e[5],translate:{x:e[4],y:e[5]}}},e.transformMatrix=function(e,t){var r=e[0],o=e[1],a=e[2],n=e[3],s=e[4],i=e[5],l=t[0],c=t[1],d=t[2],u=t[3],p=t[4],h=t[5];return e[0]=r*l+a*c,e[1]=o*l+n*c,e[2]=r*d+a*u,e[3]=o*d+n*u,e[4]=r*p+a*h+s,e[5]=o*p+n*h+i,e},e}.apply(t,[]))||(e.exports=o)},zvPW:function(e,t,r){var o,a;o=[r("xeH2"),r("YLtl"),r("hcqx"),r("UFvF"),r("Uwho"),r("2ofD"),r("7mGH"),r("oWUw"),r("4pbt"),r("chD/")],void 0===(a=function(e,t,o,a,n,s,i,l,c,d){return o.View.extend({events:{"click .theo-share-button":"handleShareButton"},initialize(){window.PIXI&&!window.ADOBE_POST_PIXI&&(window.ADOBE_POST_PIXI=window.PIXI),window.PIXI=window.ADOBE_POST_PIXI,e("body").addClass("post-app"),t.bindAll(this,"doRender"),this._setupTestHook()},_setupTestHook(){i.hasFeature("post-expose-model-to-ui-tests")&&(window._TheoBrowserTestUtils=r("qtK1"))},doRender(){const e=t.merge({},this.appConfig,function(){const e=o.history.getFragment().split("?")[1],t={};if(e){const r=e.split("&");for(let e=0;e<r.length;e++){const o=r[e].split("=");o[0]&&o[1]?t[decodeURIComponent(o[0])]=decodeURIComponent(o[1]):o[0]&&(t[decodeURIComponent(o[0])]="")}}return t}());i.hasFeature("post-debug-dump-manifest-on-load")&&console.info(JSON.stringify(s.currentDoc.attributes.compositeObj._current._data)),this.addAnalyticsContextData(e),"remix"===this.appConfig.operation&&"function"==typeof s.currentDoc.triggerProjectCreatedAnalytics&&s.currentDoc.triggerProjectCreatedAnalytics(),c.enable(this.el,e)},addAnalyticsContextData(e){e.contextString&&d.addContextData({contextString:e.contextString}),e.remixableAssetId&&d.addContextData({remixableAssetId:e.remixableAssetId})},render(){if("Chrome"===l.name&&l.majorVersion<=45)return window.alert("Sorry, you're using an older version of the Chrome browser that is not supported by Spark Post. Please update your browser to the latest version and try again."),window.marvel.events.trigger("hide-interstitial"),void marvel.navigate("/",{trigger:!0});marvel.events.on("designview-rendersubview-doc-loaded",this.doRender)},handleShareButton(){window.marvel.events.trigger("share-workflow-current-doc")},beforeUnload(){window.zE&&window.zE.hide&&window.zE.hide();const t=a.defer();return!1===c.enabled?(t.resolve(),t.promise):(d.removeContextData(["contextString","remixableAssetId"]),c.handleUnload().then((function(){e("body").removeClass("post-app"),c.disable(),t.resolve()})).catch((function(e){t.reject(e)})).done(),marvel.events.off("designview-rendersubview-doc-loaded",this.doRender),t.promise)}})}.apply(t,o))||(e.exports=a)}}]);
//# sourceMappingURL=theo-web-view_5a11b65b-de7149e3.js.map