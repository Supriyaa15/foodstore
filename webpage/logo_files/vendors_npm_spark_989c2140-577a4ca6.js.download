(window.webpackJsonptheoWebApp=window.webpackJsonptheoWebApp||[]).push([[38],{"FNB+":function(t,e,n){var r,o=e,i=n("oAGj"),a=n("HRWw"),s=n("ascj"),u=n("dJuF"),l=n("SmK9"),c=n("URxh"),h=n("H9Ol"),d=n("6ZWm"),m=n("G1DZ"),f=n("QbzR"),p=n("P83h"),g=n("9Lk3"),_=n("pnSN"),E=n("4mVB"),F=n("ZhwN"),T=n("iCxV"),P=n("fNpk"),C=n("tGKA"),v=n("Quhx"),y=n("K0Rh"),R=n("8t9B"),S=n("zjod");o.FormaPlatformView=i.defineProtocol("FormaPlatformView",{beginUpdate:"(FormaUpdateEvent) -> Void",endUpdate:"(FormaUpdateEvent) -> Void",formaDeleted:"() -> Void"}),o.FormaTraversal=i.defineEnum("FormaTraversal",{PreOrder:1,PostOrder:2,NearestAncestor:4,FurthestAncestor:5,JustChildren:6,PreOrderWithAuxiliaries:7,PostOrderWithAuxiliaries:8,JustAuxiliaries:9,JustChildrenAndAuxiliaries:10}),o.Forma=(r=function(){this.isFullCanvas=!1,this.stateChangeEvents=null,this.isModel_=!1},i.defineClass({name:"Forma",ctor:r,superName:"PostDCXObject",statics:{SCHEMA_CLASS_NAME:{get:function(){return"Forma"}},KIND:{get:function(){return""}},PROPERTY_KIND:"kind",PROPERTY_PLACEMENT:"placement",PROPERTY_STYLE:"style",PROPERTY_ANIMATION:"animation",PROPERTY_MOVEABLE:"moveable",PROPERTY_INTENT:"intent",PROPERTY_ORIGINAL_ID:"original-id",PROPERTY_SOURCE:"source",PROPERTY_TAGS:"tags",PROPERTY_CONTROLLER_KIND:"controller-kind",PROPERTY_CONTROLLER_METADATA:"controller-metadata",INTENT_LOGO:"logo",INTENT_PATTERN:"pattern",INTENT_ICON:"icon",INTENT_FLOATING_SHAPE:"floating-shape",INTENT_GRID_CELL:"grid-cell",INTENT_INFERRED_TEMP_GROUP:"inferred-temp-group",INTENT_STICKER:"sticker",INTENT_FLOATING_IMAGE:"floating-image",INTENT_TEMP_IMAGE_CROP:"temp-image-crop",INTENT_TEMP_IMAGE_REFINE_CUTOUT:"temp-image-refine-cutout",INTENT_IMAGE_MASK:"image-mask",INTENT_CUTOUT_MASK:"cutout-mask",INTENT_USER_GROUP:"user-group",TAG_IS_AUXILIARY:"is-auxiliary",TAG_CREATED_FROM_REMIX:"created-from-remix",ancestorsNearest:function(t,e,n){return null==t?null:n(t,e,0)?t:r.ancestorsNearest(t.parent,e-1,n)},ancestorsFurthest:function(t,e,n){if(null==t)return null;var o=r.ancestorsFurthest(t.parent,e-1,n);return null!=o?o:n(t,e,0)?t:null},_implements:function(t){return"IDBObject"==t||"TheoMessageSubscriber"==t||"TheoMessagePublisher"==t}},props:{init_3144:function(t,e,n,o){var a,s,u=this;if(this.parent_=o,this.page_=o.page,i.super_init(this,v.PostDCXObject,v.PostDCXObject.prototype.init_3181,e,n,t),null==i.as(this.get(r.PROPERTY_STYLE),f.FormaStyle)&&this.set(r.PROPERTY_STYLE,f.FormaStyle.createDefault()),(a=i.as(this.get(r.PROPERTY_STYLE),f.FormaStyle))&&(a.owner=this,a.colorLibrary=i.opt(this.page_,(function(t){return t.colorLibrary}))),s=this.animation)for(var l=i.iter(s.keyFrames);!l.done;l.next()){var c=l.value;i.opt(c.style,(function(t){return t.colorLibrary=i.opt(u.page_,(function(t){return t.colorLibrary}))}))}this.decodeController()},init_7dbd:function(t,e,n,o){var a,s,u=this;if(this.page_=o,i.super_init(this,v.PostDCXObject,v.PostDCXObject.prototype.init_3181,e,n,t),null==i.as(this.get(r.PROPERTY_STYLE),f.FormaStyle)&&this.set(r.PROPERTY_STYLE,f.FormaStyle.createDefault()),(a=i.as(this.get(r.PROPERTY_STYLE),f.FormaStyle))&&(a.owner=this,a.colorLibrary=this.page_.colorLibrary),s=this.animation)for(var l=i.iter(s.keyFrames);!l.done;l.next()){var c=l.value;i.opt(c.style,(function(t){return t.colorLibrary=u.page_.colorLibrary}))}this.decodeController()},init_812f:function(t,e){for(var n,o=t.database,a={path:function(){return F.GUIDUtils.makeGUID()},kind:function(){return r.KIND},"controller-kind":function(){return""},placement:function(){return C.Matrix2D.Identity},"controller-metadata":function(){return h.ControllerMetadata.init_d41d()},style:function(){return f.FormaStyle.createDefault()}},s=i.clone(e),u=i.iter(a);!u.done;u.next()){var l=u.key,c=u.value;null==e[l]&&(s[l]=c())}this.page_=t,i.super_init(this,v.PostDCXObject,v.PostDCXObject.prototype.init_5079,o,{},s,""),(n=i.as(this.get(r.PROPERTY_STYLE),f.FormaStyle))&&(n.owner=this,n.colorLibrary=this.page_.colorLibrary),this.initializeDefaultState(),this.decodeController()},init_d1c9:function(t,e){var n;this.parent_=null,this.page_=null,i.super_init(this,v.PostDCXObject,v.PostDCXObject.prototype.init_866e,e,t),null==i.as(this.get(r.PROPERTY_STYLE),f.FormaStyle)&&this.set(r.PROPERTY_STYLE,f.FormaStyle.createDefault()),(n=i.as(this.get(r.PROPERTY_STYLE),f.FormaStyle))&&(n.owner=this)},initializeDefaultState:function(){var t;(t=i.as(this.get(r.PROPERTY_STYLE),f.FormaStyle))&&(this.cachedStyle_=t,this.cachedStyle_.colorLibrary=this.page.colorLibrary,this.subscribeToStyle(this.cachedStyle_))},willChangeState:function(t){var e=this;v.PostDCXObject.prototype.willChangeState.call(this,t),P.LegacyCoreAssert.isTrue(null==this.stateChangeEvents,"About to change states when a pending state change still has queued events",void 0,"Forma.willChangeState","Forma.swift",178),this.stateChangeEvents={},i.keys(t).forEach((function(t){var n;(n=e.updateEventForProperty(t))&&(e.stateChangeEvents[t]=n)}));for(var n=i.iter(this.stateChangeEvents);!n.done;n.next()){var r=n.value;this.beginUpdate(r)}i.opt(this.controller,(function(n){return n.formaWillChangeState(e,t)}))},didChangeState:function(t){var e=this;v.PostDCXObject.prototype.didChangeState.call(this,t),P.LegacyCoreAssert.isTrue(null!=this.stateChangeEvents,"Changed states without prior will-change notification",void 0,"Forma.didChangeState","Forma.swift",197);for(var n=i.iter(this.stateChangeEvents);!n.done;n.next()){var r=n.value;this.endUpdate(r)}this.stateChangeEvents=null,i.opt(this.controller,(function(n){return n.formaDidChangeState(e,t)}))},willCommitState:function(){var t=this;v.PostDCXObject.prototype.willCommitState.call(this),i.opt(this.controller,(function(e){return e.formaWillCommitState(t)}))},didCommitState:function(){var t=this;v.PostDCXObject.prototype.didCommitState.call(this),i.opt(this.controller,(function(e){return e.formaDidCommitState(t)}))},updateEventForProperty:function(t){var e=null;return t==r.PROPERTY_PLACEMENT?e=new p.FormaTransformChangedEvent(this):t==r.PROPERTY_STYLE&&(e=new p.FormaStyleChangedEvent(this)),e},initializeToDefaults:function(){},decodeController:function(){var t=this;if(0!=this.controllerKind.length){var e=i.opt(i.opt(this.page.document,(function(t){return t.controller})),(function(t){return t.controllerFactory}));null!=e?(this.controller=e.createController(this.controllerKind,this),null!=this.controller?null==this.controllerMetadata&&(i.opt(T.Host.logging,(function(t){return t.warning("Forma: No controller metadata found?")})),this.set(r.PROPERTY_CONTROLLER_METADATA,h.ControllerMetadata.init_d41d()),i.opt(this.controller,(function(e){return e.controllerMetadata=t.controllerMetadata}))):i.opt(T.Host.logging,(function(e){return e.warning("Forma: Factory did not create a controller for "+t.controllerKind+"!")}))):i.opt(T.Host.logging,(function(e){return e.warning("Forma: No constructor for controller kind "+t.controllerKind+"!")}))}},postDecode:function(){this.style.colorLibrary=i.opt(this.page_,(function(t){return t.colorLibrary})),i.opt(this.styleSubscription_,(function(t){return t.unsubscribe()})),this.subscribeToStyle(this.style),i.opt(this.controller,(function(t){return t.postDecode()}))},destroy:function(){this.style.dispose(),i.opt(this.styleSubscription_,(function(t){return t.unsubscribe()})),this.styleSubscription_=null},controllerKind:{get:function(){var t;return(t=i.as(this.get(r.PROPERTY_CONTROLLER_KIND),"String"))||null!=t?t:""}},controllerMetadata:{get:function(){return i.as(this.get(r.PROPERTY_CONTROLLER_METADATA),h.ControllerMetadata)}},className:{get:function(){return r.SCHEMA_CLASS_NAME}},controller:{get:function(){return this.controller_},set:function(t){var e;null==t&&i.opt(T.Host.logging,(function(t){return t.warning("setting a nil controller")})),this.controller_=t,null!=this.controller_&&(this.set(r.PROPERTY_CONTROLLER_KIND,i.opt(this.controller_,(function(t){return t.kind}))),(e=this.controllerMetadata)&&(this.controller_.controllerMetadata=e))}},animation:{get:function(){return i.as(this.get(r.PROPERTY_ANIMATION),c.FormaAnimation)},set:function(t){var e,n,o=this,a=new p.FormaAnimationChangedEvent(this);if(this.beginUpdate(a),e=i.as(this.get(r.PROPERTY_ANIMATION),c.FormaAnimation))for(var s=i.iter(e.keyFrames);!s.done;s.next()){var u=s.value;i.opt(u.style,(function(t){return t.clearColorLibrarySub()}))}if(this.set(r.PROPERTY_ANIMATION,t),n=t)for(var l=i.iter(n.keyFrames);!l.done;l.next())u=l.value,i.opt(u.style,(function(t){return t.colorLibrary=i.opt(o.page_,(function(t){return t.colorLibrary}))}));this.endUpdate(a)}},formaID:{get:function(){return this.path}},contentID:{get:function(){return null!=this.controller?this.controller.contentID:null}},originalID_:{get:function(){return i.as(this.get(r.PROPERTY_ORIGINAL_ID),"String")},set:function(t){this.set(r.PROPERTY_ORIGINAL_ID,t)}},originalID:{get:function(){var t;return(t=this.originalID_)||null!=t?t:this.formaID}},source:{get:function(){var t;return(t=i.opt(i.opt(this.controller,(function(t){return t.userGroupRoot})),(function(t){return t.source})))||null!=t?t:i.as(this.get(r.PROPERTY_SOURCE),"String")},set:function(t){P.LegacyCoreAssert.isTrue(m.FormaSourceUtils.isValid(t),"invalid forma source",void 0,"Forma","Forma.swift",342),this.set(r.PROPERTY_SOURCE,t)}},kind:{get:function(){return this.get(r.PROPERTY_KIND)}},isEqual:function(t){var e;return!!(e=i.as(t,r))&&this.formaID==e.formaID},parent:{get:function(){return this.parent_}},removeFromParent:function(){null!=this.parent_&&this.parent_.removeChild(this)},setParent:function(t,e){void 0===e&&(e=!1);var n=this,r=this.parent_;null!=this.parent_&&null==t&&i.opt(this.styleSubscription_,(function(t){return t.unsubscribe()})),this.parent_=t,null==r&&null!=t&&(this.styleSubscription_=i.opt(this.style_,(function(t){return t.subscribe(n,f.FormaStyleChangedMessage.TYPE)})))},subscribeToStyle:function(t){var e=this;null!=this.parent_?this.styleSubscription_=i.opt(t,(function(t){return t.subscribe(e,f.FormaStyleChangedMessage.TYPE)})):this.styleSubscription_=null},root:{get:function(){return null==this.parent_?i.as(this,_.GroupForma):this.parent_.root}},isDescendent:function(t){for(var e=this.parent;null!=e;){if(e==t)return!0;e=i.opt(e,(function(t){return t.parent}))}return!1},visit:function(t,e){switch(t){case 4:return r.ancestorsNearest(this,0,e);case 5:return r.ancestorsFurthest(this,0,e);case 6:return null;default:if(e(this,0,0))return this}return null},visitPlaced:function(t,e){var n=[];return this.visit(o.FormaTraversal.PreOrder,(function(r,o,a){return 0==o?n=[t]:(n=n.slice(0,o)).push(r.placement.concat(i.last(n))),e(r,i.last(n),o,a)}))},visitAll:function(t,e){this.visit(t,(function(t,n,r){return e(t),!1}))},visitAsArray:function(t){var e=[];return this.visitAll(t,(function(t){e.push(t)})),e},visitChildren:function(t){return this.visit(o.FormaTraversal.JustChildren,(function(e,n,r){return t(e,r)}))},filterByKind:function(t,e){void 0===e&&(e=o.FormaTraversal.PreOrder);var n=[];return this.visitAll(e,(function(e){e.kind==t&&n.push(e)})),n},filterByControllerKind:function(t,e){void 0===e&&(e=o.FormaTraversal.PreOrder);var n=[];return this.visitAll(e,(function(e){i.opt(e.controller,(function(e){return e.kind==t}))&&n.push(e)})),n},filterWithCallback:function(t,e){void 0===e&&(e=o.FormaTraversal.PreOrder);var n=[];return this.visitAll(e,(function(e){t(e)&&n.push(e)})),n},successor:function(){return null==this.parent_?null:null!=(t=this.parent_.indexOfChild(this))?this.parent_.childAt(t+1):null;var t},predecessor:function(){return null==this.parent_?null:null!=(t=this.parent_.indexOfChild(this))?this.parent_.childAt(t-1):null;var t},formaByID:function(t){return this.visit(o.FormaTraversal.PreOrder,(function(e,n,r){return e.formaID==t}))},formaByContentID:function(t){return this.visit(o.FormaTraversal.PreOrder,(function(e,n,r){var o;return!(!(o=i.as(e,S.VideoForma))||o.videoContentID!=t)||e.contentID==t}))},allowUserMove:{get:function(){return i.as(this.get(r.PROPERTY_MOVEABLE),"Bool")},set:function(t){this.set(r.PROPERTY_MOVEABLE,t)}},page:{get:function(){return this.page_},set:function(t){this.page_=t}},bounds:{get:function(){return this.boundsInCoordSpace(C.Matrix2D.Identity)},set:function(t){P.LegacyCoreAssert.fail("Forma does not support setting it's bounds",void 0,"Forma","Forma.swift",574)}},boundsInCoordSpace:function(t){return null},frame:{get:function(){return this.boundsInCoordSpace(this.placement)}},finalFrame:{get:function(){return this.boundsInCoordSpace(this.totalPlacement)}},placement:{get:function(){var t;return(t=i.as(this.get(r.PROPERTY_PLACEMENT),C.Matrix2D))||null!=t?t:C.Matrix2D.Identity},set:function(t){if(!this.placement.equal(t)){P.LegacyCoreAssert.isTrue(t.finite&&0!=t.determinant,"Placement is not finite",void 0,"Forma","Forma.swift",596);var e=new p.FormaTransformChangedEvent(this);this.beginUpdate(e),this.set(r.PROPERTY_PLACEMENT,t),this.endUpdate(e)}}},totalPlacement:{get:function(){var t=C.Matrix2D.Identity;return this.visitAll(o.FormaTraversal.FurthestAncestor,(function(e){t=e.placement.concat(t)})),t}},placementFromAncestor:function(t){for(var e=C.Matrix2D.Identity,n=i.iter(this.visitAsArray(o.FormaTraversal.NearestAncestor));!n.done;n.next()){var r=n.value;if(i.eq(o._equality_Forma_Forma,r,t))break;e=e.precat(r.placement)}return e},move:function(t){this.placement=this.placement.concat(t)},moveOriginToPoint:function(t){var e;(e=this.frame)?this.move(C.Matrix2D.translation(e.evalXY(0,0).multiply(-1)).translate(t)):i.opt(T.Host.logging,(function(t){return t.warning("moveOriginToPoint not possible because could not obtain frame")}))},moveCenterToPoint:function(t){var e;(e=this.frame)?this.move(C.Matrix2D.translation(e.evalXY(.5,.5).multiply(-1)).translate(t)):i.opt(T.Host.logging,(function(t){return t.warning("moveCenterToPoint not possible because could not obtain frame")}))},movePinToPoint:function(t,e){var n;(n=this.frame)?this.move(C.Matrix2D.translation(n.eval(t).multiply(-1)).translate(e)):i.opt(T.Host.logging,(function(t){return t.warning("moveCenterToPoint not possible because could not obtain frame")}))},rotation:function(){return 180*this.rotationInRadians()/Math.PI},rotationInRadians:function(){var t=this.placement.transformValues;return Math.atan2(t.rotSine,t.rotCosine)},containsPoint:function(t,e){if(void 0===e&&(e=0),null!=this.controller_)return this.controller.containsPoint(t,e);var n=this.bounds;return null!=n&&(0!=e&&(n=n.outsetXY(e,e)),n.containsPoint(t))},style_:{get:function(){return null==this.cachedStyle_&&(this.cachedStyle_=i.as(this.get(r.PROPERTY_STYLE),f.FormaStyle)),this.cachedStyle_},set:function(t){null!=t&&this.internalSetStyle(t,!0,!0)}},style:{get:function(){return this.style_}},canApplyStyle:function(t){return null!=t},internalSetStyle:function(t,e,n){var o;if(void 0===e&&(e=!1),void 0===n&&(n=!0),o=t){var a=new p.FormaStyleChangedEvent(this);this.beginUpdate(a),i.opt(i.as(this.get(r.PROPERTY_STYLE),f.FormaStyle),(function(t){return t.dispose()})),this.cachedStyle_=null,i.opt(this.styleSubscription_,(function(t){return t.unsubscribe()})),this.set(r.PROPERTY_STYLE,o),this.cachedStyle_=o,this.cachedStyle_.colorLibrary=this.page_.colorLibrary,e&&(P.LegacyCoreAssert.isTrue(null==this.cachedStyle_.owner,"Setting a forma style that is already owned.",void 0,"Forma.internalSetStyle","Forma.swift",740),this.cachedStyle_.owner=this),this.subscribeToStyle(this.cachedStyle_),n&&i.opt(this.controller,(function(t){return t.styleChanged()})),this.endUpdate(a)}},applyStyle:function(t){null!=t&&t!==this.style_&&(this.style_=t.clone()),i.opt(this.controller,(function(t){return t.styleChanged()}))},protectedSetStyle:function(t){this.style_=t},onMessage:function(t){var e;(e=i.as(t,f.FormaStyleChangedMessage))&&(e.isBefore?(P.LegacyCoreAssert.isTrue(null==this.styleUpdateEvent_,"nested FormaStyleChangedMessage not allowed right now",void 0,"Forma.onMessage","Forma.swift",791),this.styleUpdateEvent_=new p.FormaStyleChangedEvent(this),this.beginUpdate(this.styleUpdateEvent_)):(i.opt(this.controller,(function(t){return t.styleChanged()})),this.endUpdate(this.styleUpdateEvent_),this.styleUpdateEvent_=null),e.isAfter&&i.opt(this.controller,(function(t){return t.styleChanged()})))},matchColors:function(t){var e,n;null!=(e=t.style.colors.colorID(s.ColorRole.FieldPrimary))&&this.style.colors.setColorId(s.ColorRole.FieldPrimary,e),null!=(n=t.style.colors.colorID(s.ColorRole.FieldSecondary))&&this.style.colors.setColorId(s.ColorRole.FieldSecondary,n)},match:function(t){var e;this.placement=t.placement,this.style.kind==t.style.kind?this.style.kind==E.GridStyle.KIND?this.style.match(t.style):(e=t.style.cloneToDatabase(this.database))?this.protectedSetStyle(e):P.LegacyCoreAssert.fail("Forma.match: could not clone style",void 0,"Forma.match","Forma.swift",835):this.matchColors(t),this.allowUserMove=t.allowUserMove,null!=this.controller&&null!=t.controller&&this.controller.match(t.controller)},siblingForma:function(){var t,e=[];if(t=this.parent)for(var n=i.clone(t.visitAsArray(o.FormaTraversal.JustChildren)),r=i.iter(n);!r.done;r.next()){var a=r.value;i.eq(o._equality_Forma_Forma,a,this)||e.push(a)}return e},postMatch:function(t){null!=this.controller&&null!=t.controller&&this.controller.postMatch(t.controller)},getGraph:function(t){var e;return(e=this.page_)?e.pgm.getGraphForForma(this,t):(P.LegacyCoreAssert.fail("Forma.getGraph: unexpectedly couldn't get a graph representation",void 0,"Forma.getGraph","Forma.swift",876),null)},isText:function(){return!1},isImage:function(){return!1},isShape:function(){return!1},isVideo:function(){return!1},isSticker:function(){return!1},isGraphic:function(){return this.isImage()||this.isShape()},isTypeLockup:function(){return null!=this.controller&&i.opt(this.controller,(function(t){return t.kind==R.TypeLockupController.KIND}))},isLogo:function(){return this.hasIntent(r.INTENT_LOGO)},isGridCell:function(){var t;return!!(t=i.as(i.opt(this.parent,(function(t){return t.controller})),g.GridController))&&t.isGridCell(this)},isBackgroundImage:function(){var t;return!!(t=i.as(this.controller,d.FrameController))&&!t.floating&&!t.userGroupMember},hasIntent:function(t){var e;return null!=(e=this.intent)&&e==t},intent:{get:function(){return i.as(this.get(r.PROPERTY_INTENT),"String")},set:function(t){this.set(r.PROPERTY_INTENT,t)}},isModel:{get:function(){return this.isModel_},set:function(t){this.isModel_=t}},tags_:{get:function(){var t,e={};if(t=i.opt(this.getProperty(r.PROPERTY_TAGS),(function(t){return t.dictionaryValue})))for(var n=i.iter(t);!n.done;n.next()){var o,a=n.key;null!=(o=n.value.stringValue)&&(e[a]=o)}return e},set:function(t){for(var e={},n=i.iter(t);!n.done;n.next()){var r=n.key,o=n.value;e[r]=u.DBProperty.stringProperty(u.DBNamePath.init_b14a(a.ContentNode.PROPERTY_TAGS).append(r),o)}this.setProperty(a.ContentNode.PROPERTY_TAGS,u.DBProperty.dictProperty(u.DBNamePath.init_b14a(a.ContentNode.PROPERTY_TAGS),e))}},tags:{get:function(){for(var t=[],e=i.iter(this.tags_);!e.done;e.next()){var n=e.key;t.push(n)}return t}},hasTag:function(t){return null!=this.tags_[t]},clearTags:function(){this.tags_={}},getTag:function(t){return this.tags_[t]},setTag:function(t,e){void 0===e&&(e="");var n=i.clone(this.tags_);n[t]=e,this.tags_=i.clone(n)},removeTag:function(t){i.removeKey(this.tags_,t)},asString:{get:function(){var t,e,n,r,o=(t=i.opt(this.contentID,(function(t){return t.substr(0,8)})))||null!=t?t:"nil",a=this.formaID.substr(0,8),s=(e=i.opt(this.controller,(function(t){return t.kind})))||null!=e?e:"";s==R.TypeLockupController.KIND&&"nil"==o&&this.contentID;var u=(n=i.opt(this.style.colors.library,(function(t){return t.asString})))||null!=n?n:"<none>",l=(r=i.opt(this.finalFrame,(function(t){return t.asString})))||null!=r?r:"(nil finalFrame)";return this.kind==y.RootForma.KIND?this.kind+": "+s+" "+a+" colorLibrary:("+u+") "+o+" "+this.style.opacity+" "+(null!=this.animation?"A":"NA")+" "+l:this.kind+": "+s+" "+a+" "+o+" "+this.style.opacity+" "+(null!=this.animation?"A":"NA")+" "+l}},print:function(){var t="";return this.visit(o.FormaTraversal.PreOrder,(function(e,n,r){for(var o="",a=i.iter(i.range(0,n,!0));!a.done;a.next())o+="    ";return null!=e.controller&&(t+=o+e.asString+"\n"),!1})),t},beginUpdate:function(t){this.isModel||i.opt(this.page_,(function(e){return e.beginUpdate(t)}))},endUpdate:function(t){this.isModel||i.opt(this.page_,(function(e){return e.endUpdate(t)}))},forkToDatabase:function(t,e,n,r){var o,i=v.PostDCXObject.prototype.forkToDatabase.call(this,t,e,n,r);return(o=i)&&(o.setProperty(v.PostDCXObject.PROPERTY_PATH,u.DBProperty.stringProperty(u.DBNamePath.init_b14a(v.PostDCXObject.PROPERTY_PATH),F.GUIDUtils.makeGUID())),null!=o.getProperty(l.DBSchema.PROPERTY_ID)&&o.setProperty(l.DBSchema.PROPERTY_ID,u.DBProperty.stringProperty(u.DBNamePath.init_b14a(l.DBSchema.PROPERTY_ID),t))),i}}}),r),o._equality_Forma_Forma=function(t,e){return t.isEqual(e)}},G1DZ:function(t,e,n){var r,o,i=e,a=n("oAGj");i.FormaSourceNamespace=a.defineEnum("FormaSourceNamespace",{DesignIngredient:"di:",DesignVariation:"dv:"}),i.FormaSourceUtils=(r=function(){},o={},a.defineClass({name:"FormaSourceUtils",ctor:r,statics:{allNamespaces:{get:function(){return void 0===o.allNamespaces&&(o.allNamespaces=[i.FormaSourceNamespace.DesignIngredient,i.FormaSourceNamespace.DesignVariation]),o.allNamespaces}},isValid:function(t){if(null==t)return!0;for(var e=a.iter(r.allNamespaces);!e.done;e.next()){var n=e.value;if(r.checkMatch(t,n))return!0}return!1},isDesignIngredient:function(t){return r.checkMatch(t,i.FormaSourceNamespace.DesignIngredient)},isDesignVariation:function(t){return r.checkMatch(t,i.FormaSourceNamespace.DesignVariation)},stripNamespace:function(t){for(var e=a.iter(r.allNamespaces);!e.done;e.next()){var n=e.value;if(t.startsWith(n))return t.substr(a.toString(n).length)}return t},checkMatch:function(t,e){var n;return!(!(n=a.opt(t,(function(t){return t.startsWith(e)})))&&null==n)&&n}}}),r)},K0Rh:function(t,e,n){var r,o=e,i=n("oAGj"),a=n("FNB+"),s=n("fWxZ"),u=n("QbzR"),l=n("P83h"),c=n("pnSN"),h=n("lmwz"),d=n("fNpk"),m=n("uxH+"),f=n("2ALn"),p=n("Zifs"),g=n("sIWg");o.RootForma=(r=function(){},i.defineClass({name:"RootForma",ctor:r,superName:"GroupForma",statics:{KIND:{get:function(){return"Root"}},PROPERTY_FILLCOLOR_DEPRECATED:"fill-color",PROPERTY_ROOT_STYLE_DEPRECATED:"root-style",SCHEMA_CLASS_NAME:{get:function(){return"RootForma"}},factory:{get:function(){return function(t,e,n,o){if(null!=e){var a=i.as(i.opt(i.opt(o,(function(t){return t.backLink})),(function(t){return t.dereference()})),s.FormaPage);return d.LegacyCoreAssert.isTrue(null!=a,"RootForma needs a parent page",void 0,"RootForma","RootForma.swift",25),r.init_7dbd(t,e,n,a)}return r.init_d1c9(t,n)}}},_implements:function(t){return"IDBObject"==t||"TheoMessageSubscriber"==t||"TheoMessagePublisher"==t}},props:{init_7dbd:function(t,e,n,r){i.super_init(this,c.GroupForma,c.GroupForma.prototype.init_7dbd,t,e,n,r)},init_812f:function(t,e){for(var n={kind:function(){return r.KIND},style:function(){return f.RootStyle.createDefault()}},o=i.clone(e),a=i.iter(n);!a.done;a.next()){var s=a.key,u=a.value;null==e[s]&&(o[s]=u())}i.super_init(this,c.GroupForma,c.GroupForma.prototype.init_812f,t,o)},init_7186:function(t){var e={kind:r.KIND,style:f.RootStyle.createDefault()};this.init_812f(t,e)},init_d1c9:function(t,e){i.super_init(this,c.GroupForma,c.GroupForma.prototype.init_d1c9,t,e)},initializeDefaultState:function(){null!=this.rootStyleDeprecated_&&this.protectedSetStyle(this.rootStyleDeprecated_),null!=this.fillColorDeprecated_&&(this.style.colors.fieldPrimary=this.fillColorDeprecated_),c.GroupForma.prototype.initializeDefaultState.call(this)},initializeToDefaults:function(){var t;(t=i.opt(this.page.document,(function(t){return t.controller})))&&(this.controller=t.controllerFactory.createController(m.RootController.KIND,this)),this.bounds=g.TheoRect.fromSize(this.page.pageSize),c.GroupForma.prototype.initializeToDefaults.call(this)},page:{get:function(){return this.page_},set:function(t){var e=this,n=this.page_;this.page_=t,null==n&&(this.styleSubscription_=i.opt(this.style_,(function(t){return t.subscribe(e,u.FormaStyleChangedMessage.TYPE)})))}},subscribeToStyle:function(t){var e=this;null!=this.page_?this.styleSubscription_=i.opt(t,(function(t){return t.subscribe(e,u.FormaStyleChangedMessage.TYPE)})):this.styleSubscription_=null},postDecode:function(){var t,e=this;c.GroupForma.prototype.postDecode.call(this),i.opt(this.controller,(function(t){return t.kind!=m.RootController.KIND}))&&(this.controller=i.opt(i.opt(this.page.document,(function(t){return t.controller})),(function(t){return t.controllerFactory.createController(m.RootController.KIND,e)}))),(t=i.as(this.controller,m.RootController))&&t.createGridControllerIfNone(),null==this.animation&&this.visit(a.FormaTraversal.PreOrder,(function(t,n,o){return!(t instanceof r||!i.opt(t.animation,(function(t){return null!=t.animationStyle}))||(e.page.animationLibrary.setStillAnimation(e,t.animation.animationStyle),0))})),h.ImageFacade.exitCropMode(this)},className:{get:function(){return r.SCHEMA_CLASS_NAME}},bounds:{get:function(){return null!=this.setBounds?this.setBounds:g.TheoRect.fromSize(this.page.pageSize)},set:function(t){d.LegacyCoreAssert.isTrue(null!=t,"Can't set a nil root bounds",void 0,"RootForma","RootForma.swift",137),d.LegacyCoreAssert.isTrue(g.TheoRect.fromSize(this.page.pageSize).equal(t),"Root bounds doesn't match the FormaPage pageSize.",void 0,"RootForma","RootForma.swift",138),c.GroupForma._setters.bounds.call(this,t)}},placement:{get:function(){return c.GroupForma._getters.placement.call(this)},set:function(t){d.LegacyCoreAssert.isTrue(t.isIdentity,"RootForma: Someone's trying to set the root forma placement to something other than identity!",void 0,"RootForma","RootForma.swift",146),c.GroupForma._setters.placement.call(this,t)}},contentID:{get:function(){return"root"}},isImage:function(){return!1},isGraphic:function(){return!1},isText:function(){return!1},isShape:function(){return!1},isLogo:function(){return!1},hackGenerateArtificialUpdateEvent:function(){var t=new l.FormaInsertedChildrenEvent(this,[],0);this.beginUpdate(t),this.endUpdate(t)},boundsInCoordSpace:function(t){return this.bounds.transform(t)},visible:{get:function(){var t;if(t=this.finalFrame){var e=!1,n=g.TheoRect.Zero;return this.visitAll(a.FormaTraversal.PreOrder,(function(t){var o;t instanceof r||((o=t.finalFrame)&&(n=n.unionWith(o)),t.isImage()&&(e=!0))})),!e||!n.contains(t)}return!1}},rootStyleDeprecated_:{get:function(){return i.as(this.get(r.PROPERTY_ROOT_STYLE_DEPRECATED),u.FormaStyle)}},fillColorDeprecated_:{get:function(){return i.as(this.get(r.PROPERTY_FILLCOLOR_DEPRECATED),p.SolidColor)}}}}),r)},LcYy:function(t,e,n){var r,o,i=e,a=n("oAGj"),s=n("iCxV"),u=n("fNpk"),l=n("Quhx"),c=n("9YN4");i.DocumentHistory=(r=function(){},o={},a.defineClass({name:"DocumentHistory",ctor:r,superName:"PostDCXObject",statics:{SCHEMA_CLASS_NAME:"DocumentHistory",factory:{get:function(){return void 0===o.factory&&(o.factory=function(t,e,n,o){var i=a.as(a.opt(a.opt(o,(function(t){return t.backLink})),(function(t){return t.dereference()})),c.TheoDocument);return u.LegacyCoreAssert.isTrue(null!=i,"DocumentHistory needs a parent document",void 0,"DocumentHistory","DocumentHistory.swift",15),r.init_7e49(t,n,i)}),o.factory},set:function(t){o.factory=t}},PROPERTY_ENTRIES:"entries",PATH:"document-history",MAX_HISTORY_SIZE:100,_implements:function(t){return"IDBObject"==t||"TheoMessagePublisher"==t}},props:{init_7e49:function(t,e,n){this.parent_=n,a.super_init(this,l.PostDCXObject,l.PostDCXObject.prototype.init_3181,n.database,e,t)},init_d0e4:function(t){this.parent_=t,a.super_init(this,l.PostDCXObject,l.PostDCXObject.prototype.init_11e0,t.database),this.set(l.PostDCXObject.PROPERTY_PATH,r.PATH),this.postEntry("initialized")},className:{get:function(){return r.SCHEMA_CLASS_NAME}},parent:{get:function(){return this.parent_}},entries:{get:function(){var t;return(t=a.as(this.get(r.PROPERTY_ENTRIES),["Array","String"]))||null!=t?t:[]}},postEntry:function(t){var e,n,o,i=this.database.beginTransaction("updateHistory",null),u=a.clone(this.entries);u.length>=r.MAX_HISTORY_SIZE&&u.shift();var l="when:'"+((e=a.opt(s.Host.logging,(function(t){return t.timeStamp()})))||null!=e?e:"?")+"';platform:'"+((n=a.opt(s.Host.logging,(function(t){return t.platformID()})))||null!=n?n:"?")+" ("+((o=a.opt(s.Host.logging,(function(t){return t.additionalPlatformInfo()})))||null!=o?o:"?")+")';format#:"+a.toString(c.TheoDocument.CURRENT_VERSION)+";operation:'"+t+"'";u.push(l),this.set(r.PROPERTY_ENTRIES,u),i.mergeWithPrevious()},entryCount:{get:function(){return this.entries.length}},entryAt:function(t){return t<0||t>=this.entries.length?(a.opt(s.Host.logging,(function(t){return t.warning("entryAt: Invalid index requested, returning empty string")})),""):this.entries[t]},forEachEntry:function(t){for(var e=a.iter(this.entries);!e.done;e.next())t(e.value)},clear:function(){this.set(r.PROPERTY_ENTRIES,[])}}}),r)},NxMp:function(t,e,n){var r,o=e,i=n("oAGj"),a=n("gXiO"),s=n("cmoc"),u=n("pnSN"),l=n("iCxV"),c=n("fdtz"),h=n("K0Rh"),d=n("djAF"),m=n("kSRw"),f=n("enh0"),p=n("WWR6"),g=n("zjod");o.FormaFactory=i.defineProtocol("FormaFactory",{createForma:"(FormaPage, String) -> Forma"}),o.DefaultFormaFactory=(r=function(){this.constructors_={},this.constructors_[h.RootForma.KIND]=function(t,e){return h.RootForma.init_7186(t)},this.constructors_[f.TextForma.KIND]=function(t,e){return f.TextForma.init_7186(t)},this.constructors_[c.ImageForma.KIND]=function(t,e){return c.ImageForma.init_7186(t)},this.constructors_[p.VectorForma.KIND]=function(t,e){return p.VectorForma.init_7186(t)},this.constructors_[u.GroupForma.KIND]=function(t,e){return u.GroupForma.init_7fcf(t,e)},this.constructors_[m.SmartGroupForma.KIND]=function(t,e){return u.GroupForma.init_7fcf(t,u.GroupForma.KIND)},this.constructors_[s.FrameForma.KIND]=function(t,e){return s.FrameForma.init_7186(t)},this.constructors_[d.ShapeForma.KIND]=function(t,e){return d.ShapeForma.init_7186(t)},this.constructors_[g.VideoForma.KIND]=function(t,e){return g.VideoForma.init_7186(t)},a.CoreObject.call(this)},i.defineClass({name:"DefaultFormaFactory",ctor:r,superName:"CoreObject",statics:{_implements:function(t){return"FormaFactory"==t}},props:{createForma:function(t,e){var n=this.constructors_[e];return null==n?(i.opt(l.Host.logging,(function(t){return t.warning("createForma: No constructor for kind "+e+" available.")})),null):n(t,e)}}}),r)},OdB2:function(t,e,n){var r,o,i,a,s,u,l,c,h=e,d=n("oAGj"),m=n("90dd");h.FormaPageView=d.defineProtocol("FormaPageView",{beginViewUpdate:"(FormaUpdateEvent) -> AnyObject",endViewUpdate:"(AnyObject) -> Void",getViewportTransform:"() -> Matrix2D",beginUserResize:"() -> Void",endUserResize:"() -> Void"}),h.FormaBeginUpdateMessage=(r=function t(e,n){this.event=n,m.TheoMessage.call(this,t.TYPE,e)},d.defineClass({name:"FormaBeginUpdateMessage",ctor:r,superName:"TheoMessage",statics:{TYPE:{get:function(){return"FormaBeginUpdateMessage"}}}}),r),h.FormaEndUpdateMessage=(o=function t(e,n){this.event=n,m.TheoMessage.call(this,t.TYPE,e)},d.defineClass({name:"FormaEndUpdateMessage",ctor:o,superName:"TheoMessage",statics:{TYPE:{get:function(){return"FormaEndUpdateMessage"}}}}),o),h.PageSizeUpdateMessage=(i=function t(e,n){this.newSize=n,m.TheoMessage.call(this,t.TYPE,e)},d.defineClass({name:"PageSizeUpdateMessage",ctor:i,superName:"TheoMessage",statics:{TYPE:{get:function(){return"PageSizeUpdateMessage"}}}}),i),h.BeginFormaDragMessage=(a=function t(e){m.TheoMessage.call(this,t.TYPE,e)},d.defineClass({name:"BeginFormaDragMessage",ctor:a,superName:"TheoMessage",statics:{TYPE:{get:function(){return"BeginFormaDragMessage"}}}}),a),h.FormaDragMessage=(s=function t(e){m.TheoMessage.call(this,t.TYPE,e)},d.defineClass({name:"FormaDragMessage",ctor:s,superName:"TheoMessage",statics:{TYPE:{get:function(){return"FormaDragMessage"}}}}),s),h.EndFormaDragMessage=(u=function t(e){m.TheoMessage.call(this,t.TYPE,e)},d.defineClass({name:"EndFormaDragMessage",ctor:u,superName:"TheoMessage",statics:{TYPE:{get:function(){return"EndFormaDragMessage"}}}}),u),h.BeginFormaResizeMessage=(l=function t(e){m.TheoMessage.call(this,t.TYPE,e)},d.defineClass({name:"BeginFormaResizeMessage",ctor:l,superName:"TheoMessage",statics:{TYPE:{get:function(){return"BeginFormaResizeMessage"}}}}),l),h.EndFormaResizeMessage=(c=function t(e){m.TheoMessage.call(this,t.TYPE,e)},d.defineClass({name:"EndFormaResizeMessage",ctor:c,superName:"TheoMessage",statics:{TYPE:{get:function(){return"EndFormaResizeMessage"}}}}),c)},P83h:function(t,e,n){var r,o,i,a,s,u,l,c,h,d,m,f,p,g,_,E,F,T,P,C,v,y,R,S,I,A,O,D,N,b,L,x,Y=e,M=n("oAGj");Y.FormaUpdateEvent=(r=function(t,e){this.duration=0,this.type=t,this.forma=e},M.defineClass({name:"FormaUpdateEvent",ctor:r,superName:"CoreObject"}),r),Y.TextPlacementEvent=(o=function t(e){Y.FormaUpdateEvent.call(this,t.TYPE,e)},M.defineClass({name:"TextPlacementEvent",ctor:o,superName:"FormaUpdateEvent",statics:{TYPE:{get:function(){return"TextPlacementEvent"}}}}),o),Y.FormaTransformChangedEvent=(i=function t(e){Y.FormaUpdateEvent.call(this,t.TYPE,e)},M.defineClass({name:"FormaTransformChangedEvent",ctor:i,superName:"FormaUpdateEvent",statics:{TYPE:{get:function(){return"FormaTransformChangedEvent"}}}}),i),Y.FormaCreatedEvent=(a=function t(e){Y.FormaUpdateEvent.call(this,t.TYPE,e)},M.defineClass({name:"FormaCreatedEvent",ctor:a,superName:"FormaUpdateEvent",statics:{TYPE:{get:function(){return"FormaCreatedEvent"}}}}),a),Y.FormaNullChangedEvent=(s=function t(e){Y.FormaUpdateEvent.call(this,t.TYPE,e)},M.defineClass({name:"FormaNullChangedEvent",ctor:s,superName:"FormaUpdateEvent",statics:{TYPE:{get:function(){return"FormaNullChangedEvent"}}}}),s),Y.FormaAnimationTransactionEvent=(u=function t(e){Y.FormaUpdateEvent.call(this,t.TYPE,e)},M.defineClass({name:"FormaAnimationTransactionEvent",ctor:u,superName:"FormaUpdateEvent",statics:{TYPE:{get:function(){return"FormaAnimationTransactionEvent"}}}}),u),Y.FormaHierarchyChangedEvent=(l=function t(e){Y.FormaUpdateEvent.call(this,t.TYPE,e)},M.defineClass({name:"FormaHierarchyChangedEvent",ctor:l,superName:"FormaUpdateEvent",statics:{TYPE:{get:function(){return"FormaHierarchyChangedEvent"}}}}),l),Y.FormaChildrenEvent=(c=function(t,e,n,r){this._children=n,this.index=r,Y.FormaUpdateEvent.call(this,Y.FormaInsertedChildrenEvent.TYPE,e)},M.defineClass({name:"FormaChildrenEvent",ctor:c,superName:"FormaUpdateEvent",props:{children:{get:function(){return this._children.concat()}},forEachChild:function(t){this._children.forEach(t)}}}),c),Y.FormaInsertedChildrenEvent=(h=function t(e,n,r){Y.FormaChildrenEvent.call(this,t.TYPE,e,n,r)},M.defineClass({name:"FormaInsertedChildrenEvent",ctor:h,superName:"FormaChildrenEvent",statics:{TYPE:{get:function(){return"FormaInsertedChildrenEvent"}}}}),h),Y.FormaInsertedAuxiliariesEvent=(d=function t(e,n,r){this.auxiliaries=n,this.index=r,Y.FormaUpdateEvent.call(this,t.TYPE,e)},M.defineClass({name:"FormaInsertedAuxiliariesEvent",ctor:d,superName:"FormaUpdateEvent",statics:{TYPE:{get:function(){return"FormaInsertedAuxiliariesEvent"}}}}),d),Y.FormaRemovedChildrenEvent=(m=function t(e,n,r){Y.FormaChildrenEvent.call(this,t.TYPE,e,n,r)},M.defineClass({name:"FormaRemovedChildrenEvent",ctor:m,superName:"FormaChildrenEvent",statics:{TYPE:{get:function(){return"FormaRemovedChildrenEvent"}}}}),m),Y.FormaRemovedAuxiliariesEvent=(f=function t(e,n,r){this.auxiliaries=n,this.index=r,Y.FormaUpdateEvent.call(this,t.TYPE,e)},M.defineClass({name:"FormaRemovedAuxiliariesEvent",ctor:f,superName:"FormaUpdateEvent",statics:{TYPE:{get:function(){return"FormaRemovedAuxiliariesEvent"}}}}),f),Y.FormaGeometryChangedEvent=(p=function t(e){Y.FormaUpdateEvent.call(this,t.TYPE,e)},M.defineClass({name:"FormaGeometryChangedEvent",ctor:p,superName:"FormaUpdateEvent",statics:{TYPE:{get:function(){return"FormaGeometryChangedEvent"}}}}),p),Y.FormaBoundsInvalidatedEvent=(g=function t(e){Y.FormaUpdateEvent.call(this,t.TYPE,e)},M.defineClass({name:"FormaBoundsInvalidatedEvent",ctor:g,superName:"FormaUpdateEvent",statics:{TYPE:{get:function(){return"FormaBoundsInvalidatedEvent"}}}}),g),Y.FormaPathChangedEvent=(_=function t(e){Y.FormaUpdateEvent.call(this,t.TYPE,e)},M.defineClass({name:"FormaPathChangedEvent",ctor:_,superName:"FormaUpdateEvent",statics:{TYPE:{get:function(){return"FormaPathChangedEvent"}}}}),_),Y.FormaColorChangedEvent=(E=function t(e){Y.FormaUpdateEvent.call(this,t.TYPE,e)},M.defineClass({name:"FormaColorChangedEvent",ctor:E,superName:"FormaUpdateEvent",statics:{TYPE:{get:function(){return"FormaColorChangedEvent"}}}}),E),Y.FormaStrokeChangedEvent=(F=function t(e){Y.FormaUpdateEvent.call(this,t.TYPE,e)},M.defineClass({name:"FormaStrokeChangedEvent",ctor:F,superName:"FormaUpdateEvent",statics:{TYPE:{get:function(){return"FormaStrokeChangedEvent"}}}}),F),Y.FormaFillRuleChangedEvent=(T=function t(e){Y.FormaUpdateEvent.call(this,t.TYPE,e)},M.defineClass({name:"FormaFillRuleChangedEvent",ctor:T,superName:"FormaUpdateEvent",statics:{TYPE:{get:function(){return"FormaFillRuleChangedEvent"}}}}),T),Y.FormaContentChangedEvent=(P=function t(e){Y.FormaUpdateEvent.call(this,t.TYPE,e)},M.defineClass({name:"FormaContentChangedEvent",ctor:P,superName:"FormaUpdateEvent",statics:{TYPE:{get:function(){return"FormaContentChangedEvent"}}}}),P),Y.FormaCutoutChangedEvent=(C=function t(e){Y.FormaUpdateEvent.call(this,t.TYPE,e)},M.defineClass({name:"FormaCutoutChangedEvent",ctor:C,superName:"FormaUpdateEvent",statics:{TYPE:{get:function(){return"FormaCutoutChangedEvent"}}}}),C),Y.FormaStyleChangedEvent=(v=function t(e){Y.FormaUpdateEvent.call(this,t.TYPE,e)},M.defineClass({name:"FormaStyleChangedEvent",ctor:v,superName:"FormaUpdateEvent",statics:{TYPE:{get:function(){return"FormaStyleChangedEvent"}}}}),v),Y.AnimationStyleChangedEvent=(y=function t(e){Y.FormaUpdateEvent.call(this,t.TYPE,e)},M.defineClass({name:"AnimationStyleChangedEvent",ctor:y,superName:"FormaUpdateEvent",statics:{TYPE:{get:function(){return"AnimationStyleChangedEvent"}}}}),y),Y.AnimationTimeChangedEvent=(R=function t(e,n){this.time=n,Y.FormaUpdateEvent.call(this,t.TYPE,e)},M.defineClass({name:"AnimationTimeChangedEvent",ctor:R,superName:"FormaUpdateEvent",statics:{TYPE:{get:function(){return"AnimationTimeChangedEvent"}}}}),R),Y.AnimationStateChangedEvent=(S=function t(e,n){this.state=n,Y.FormaUpdateEvent.call(this,t.TYPE,e)},M.defineClass({name:"AnimationStateChangedEvent",ctor:S,superName:"FormaUpdateEvent",statics:{TYPE:{get:function(){return"AnimationStateChangedEvent"}}}}),S),Y.FormaAnimationChangedEvent=(I=function t(e){Y.FormaUpdateEvent.call(this,t.TYPE,e)},M.defineClass({name:"FormaAnimationChangedEvent",ctor:I,superName:"FormaUpdateEvent",statics:{TYPE:{get:function(){return"FormaAnimationChangedEvent"}}}}),I),Y.FormaAlignmentChangedEvent=(A=function t(e,n,r){this.activeSnaplines=M.clone(n),this.nearbySnaplines=M.clone(r),Y.FormaUpdateEvent.call(this,t.TYPE,e)},M.defineClass({name:"FormaAlignmentChangedEvent",ctor:A,superName:"FormaUpdateEvent",statics:{TYPE:{get:function(){return"FormaAlignmentChangedEvent"}}}}),A),Y.FormaApplyMaskEvent=(O=function t(e){Y.FormaUpdateEvent.call(this,t.TYPE,e)},M.defineClass({name:"FormaApplyMaskEvent",ctor:O,superName:"FormaUpdateEvent",statics:{TYPE:{get:function(){return"FormaApplyMaskEvent"}}}}),O),Y.FormaVideoStateChangedEvent=(D=function t(e){Y.FormaUpdateEvent.call(this,t.TYPE,e)},M.defineClass({name:"FormaVideoStateChangedEvent",ctor:D,superName:"FormaUpdateEvent",statics:{TYPE:{get:function(){return"FormaVideoStateChangedEvent"}}}}),D),Y.FormaVideoTimeChangedEvent=(N=function t(e){Y.FormaUpdateEvent.call(this,t.TYPE,e)},M.defineClass({name:"FormaVideoTimeChangedEvent",ctor:N,superName:"FormaUpdateEvent",statics:{TYPE:{get:function(){return"FormaVideoTimeChangedEvent"}}}}),N),Y.FormaGroupEvent=(b=function t(e){Y.FormaUpdateEvent.call(this,t.TYPE,e)},M.defineClass({name:"FormaGroupEvent",ctor:b,superName:"FormaUpdateEvent",statics:{TYPE:{get:function(){return"FormaGroupEvent"}}}}),b),Y.FormaUngroupEvent=(L=function t(e){Y.FormaUpdateEvent.call(this,t.TYPE,e)},M.defineClass({name:"FormaUngroupEvent",ctor:L,superName:"FormaUpdateEvent",statics:{TYPE:{get:function(){return"FormaUngroupEvent"}}}}),L),Y.FormaForceRerenderPseudoChangeEvent=(x=function t(e){Y.FormaUpdateEvent.call(this,t.TYPE,e)},M.defineClass({name:"FormaForceRerenderPseudoChangeEvent",ctor:x,superName:"FormaUpdateEvent",statics:{TYPE:{get:function(){return"FormaForceRerenderPseudoChangeEvent"}}}}),x)},WWR6:function(t,e,n){var r,o=e,i=n("oAGj"),a=n("FNB+"),s=n("fWxZ"),u=n("P83h"),l=n("pnSN"),c=n("fNpk"),h=n("sIWg"),d=n("1NAc"),m=n("LGJg");o.VectorForma=(r=function(){this.cachedBounds_=null},i.defineClass({name:"VectorForma",ctor:r,superName:"Forma",statics:{KIND:{get:function(){return"Vector"}},PROPERTY_COLOR:"color",PROPERTY_CONTENTID:"content-id",PROPERTY_SIZE:"size",SCHEMA_CLASS_NAME:{get:function(){return"VectorForma"}},factory:{get:function(){return function(t,e,n,o){if(null!=e){var a=i.as(i.opt(i.opt(o,(function(t){return t.backLink})),(function(t){return t.dereference()})),l.GroupForma),u=i.as(i.opt(i.opt(o,(function(t){return t.backLink})),(function(t){return t.dereference()})),s.FormaPage);return c.LegacyCoreAssert.isTrue(null!=a||null!=u,"VectorForma needs a parent group or page",void 0,"VectorForma","VectorForma.swift",23),null!=a?r.init_3144(t,e,n,a):r.init_7dbd(t,e,n,u)}return r.init_d1c9(t,n)}}},_implements:function(t){return"IDBObject"==t||"TheoMessageSubscriber"==t||"TheoMessagePublisher"==t}},props:{init_3144:function(t,e,n,r){i.super_init(this,a.Forma,a.Forma.prototype.init_3144,t,e,n,r)},init_7dbd:function(t,e,n,r){i.super_init(this,a.Forma,a.Forma.prototype.init_7dbd,t,e,n,r)},init_812f:function(t,e){for(var n={kind:function(){return r.KIND}},o=i.clone(e),s=i.iter(n);!s.done;s.next()){var u=s.key,l=s.value;null==e[u]&&(o[u]=l())}i.super_init(this,a.Forma,a.Forma.prototype.init_812f,t,o)},init_7186:function(t){var e={kind:r.KIND};this.init_812f(t,e)},init_d1c9:function(t,e){i.super_init(this,a.Forma,a.Forma.prototype.init_d1c9,t,e)},className:{get:function(){return r.SCHEMA_CLASS_NAME}},updateEventForProperty:function(t){return t==r.PROPERTY_CONTENTID?new u.FormaContentChangedEvent(this):a.Forma.prototype.updateEventForProperty.call(this,t)},contentNode:{get:function(){var t=this;return null==this.contentID?null:i.as(i.opt(this.page.document,(function(e){return e.content.nodeByID(t.contentID)})),m.VectorContentNode)},set:function(t){this.contentID=null==t?null:t.id}},color:{get:function(){return this.get(r.PROPERTY_COLOR)},set:function(t){this.set(r.PROPERTY_COLOR,t)}},size:{get:function(){return i.as(this.get(r.PROPERTY_SIZE),d.TheoSize)},set:function(t){this.set(r.PROPERTY_SIZE,t)}},contentID:{get:function(){var t;return(t=i.as(this.get(r.PROPERTY_CONTENTID),"String"))||null!=t?t:""},set:function(t){var e=new u.FormaContentChangedEvent(this);this.beginUpdate(e),this.set(r.PROPERTY_CONTENTID,t),this.cachedBounds_=null,this.endUpdate(e)}},boundsInCoordSpace:function(t){if(null==this.cachedBounds_){var e=this.contentNode;null!=e&&(this.cachedBounds_=h.TheoRect.fromSize(e.size))}return i.opt(this.cachedBounds_,(function(e){return e.transform(t)}))},isGraphic:function(){return!0}}}),r)},cmoc:function(t,e,n){var r,o=e,i=n("oAGj"),a=n("CWW7"),s=n("Bpjk"),u=n("FNB+"),l=n("6ZWm"),c=n("fWxZ"),h=n("JEzR"),d=n("P83h"),m=n("pnSN"),f=n("4mVB"),p=n("fdtz"),g=n("lmwz"),_=n("fNpk"),E=n("djAF");o.FrameForma=(r=function(){},i.defineClass({name:"FrameForma",ctor:r,superName:"GroupForma",statics:{KIND:{get:function(){return"Frame"}},PROPERTY_CLIPMODE:"clipmode",PROPERTY_CROP_RATIO_ID:"cropRatioId",SCHEMA_CLASS_NAME:{get:function(){return"FrameForma"}},factory:{get:function(){return function(t,e,n,o){if(null!=e){var a=i.as(i.opt(i.opt(o,(function(t){return t.backLink})),(function(t){return t.dereference()})),m.GroupForma),s=i.as(i.opt(i.opt(o,(function(t){return t.backLink})),(function(t){return t.dereference()})),c.FormaPage);return _.LegacyCoreAssert.isTrue(null!=a||null!=s,"FrameForma needs a parent group or page",void 0,"FrameForma","FrameForma.swift",23),null!=a?r.init_3144(t,e,n,a):r.init_7dbd(t,e,n,s)}return r.init_d1c9(t,n)}}},_implements:function(t){return"IDBObject"==t||"TheoMessageSubscriber"==t||"TheoMessagePublisher"==t}},props:{init_3144:function(t,e,n,r){i.super_init(this,m.GroupForma,m.GroupForma.prototype.init_3144,t,e,n,r)},init_7dbd:function(t,e,n,r){i.super_init(this,m.GroupForma,m.GroupForma.prototype.init_7dbd,t,e,n,r)},init_812f:function(t,e){for(var n={kind:function(){return r.KIND},style:function(){return h.FrameStyle.createDefault()},clipmode:function(){return!0},cropRatioId:function(){return s.CropRatioPresetLibrary.FREEFORM_ID}},o=i.clone(e),a=i.iter(n);!a.done;a.next()){var u=a.key,l=a.value;null==e[u]&&(o[u]=l())}i.super_init(this,m.GroupForma,m.GroupForma.prototype.init_812f,t,o)},init_d1c9:function(t,e){i.super_init(this,m.GroupForma,m.GroupForma.prototype.init_d1c9,t,e)},init_7186:function(t){var e={kind:r.KIND,clipmode:!0,cropRatioId:s.CropRatioPresetLibrary.FREEFORM_ID};this.init_812f(t,e)},decodeController:function(){var t;(t=i.opt(this.page.document,(function(t){return t.controller})))&&(this.controller=t.controllerFactory.createController(l.FrameController.KIND,this)),m.GroupForma.prototype.decodeController.call(this)},className:{get:function(){return r.SCHEMA_CLASS_NAME}},updateEventForProperty:function(t){switch(t){case"style":var e;return(e=g.ImageFacade.getImageFormaForForma(this))?new d.FormaCutoutChangedEvent(e):null;default:return m.GroupForma.prototype.updateEventForProperty.call(this,t)}},bounds:{get:function(){return m.GroupForma._getters.bounds.call(this)},set:function(t){var e,n,r,o=this.bounds;m.GroupForma._setters.bounds.call(this,t),(e=i.as(this.controller,l.FrameController))&&(n=o)&&(r=t)&&e.setChildrenCropping(e.getCurrentCropType(n,r),n)}},cropRatioId:{get:function(){var t;return(t=i.as(this.get(r.PROPERTY_CROP_RATIO_ID),"String"))||null!=t?t:s.CropRatioPresetLibrary.FREEFORM_ID},set:function(t){this.set(r.PROPERTY_CROP_RATIO_ID,t)}},clipMode:{get:function(){return this.get(r.PROPERTY_CLIPMODE)},set:function(t){this.set(r.PROPERTY_CLIPMODE,t)}},hasAlpha:function(){var t,e=!(!(t=i.opt(i.as(this.controller,l.FrameController),(function(t){return t.hasCutout})))&&null==t)&&t&&null==this.style.colors.fieldPrimary;return this.visitAll(u.FormaTraversal.JustChildren,(function(t){var n=i.as(t,p.ImageForma);null!=n&&n.hasAlpha()&&(e=!0)})),e},image:{get:function(){return g.ImageFacade.getImageFormaForForma(this)}},matchColors:function(t){i.opt(i.as(this.controller,l.FrameController),(function(e){return 1==e.hasCutout&&i.opt(i.as(t.controller,l.FrameController),(function(t){return 1==t.hasCutout}))}))&&m.GroupForma.prototype.matchColors.call(this,t)},match:function(t){var e,n=this;if(m.GroupForma.prototype.match.call(this,t),e=i.as(t,r)){var o,s,u,c,h,d,_;if(this.isGridCell()&&!t.isGridCell()&&(o=i.as(i.opt(this.parent,(function(t){return t.style})),f.GridStyle))&&o.formaMapping[this.formaID]&&o.removeMappingToForma(this),this.intent=t.intent,(s=g.ImageFacade.getMaskForForma(e))?g.ImageFacade.applyMaskToForma(this,s,null,!0):(u=g.ImageFacade.getMaskFormaForForma(this))&&(u instanceof E.ShapeForma||u instanceof p.ImageForma)&&g.ImageFacade.removeMaskForForma(this),(c=g.ImageFacade.getCutoutMaskFormaForForma(e))&&(h=c.contentNode)&&(d=this.page.document)){var F,T=new a.AddFormaParams(void 0,void 0,void 0,void 0,a.AddFormaParentingHint.doNotAddFormaForContentToTree);(F=t.page==this.page?h:h.copyTo(d))&&a.CreationFacade.addImageForContentNode(this.page,F,T).then((function(e){var r;return(r=i.as(e,p.ImageForma))&&(g.ImageFacade.setCutoutForForma(n,r),g.ImageFacade.setCutoutModeForForma(n,g.ImageFacade.getCutoutModeForForma(t)),r.match(c)),null}))}else(_=i.as(this.controller,l.FrameController))&&g.ImageFacade.getCutoutMaskFormaForForma(this)&&_.hasCutout&&g.ImageFacade.removeCutoutForForma(this);this.cropRatioId=e.cropRatioId}}}}),r)},djAF:function(t,e,n){var r,o=e,i=n("oAGj"),a=n("ascj"),s=n("FNB+"),u=n("fWxZ"),l=n("P83h"),c=n("pnSN"),h=n("iCxV"),d=n("fNpk"),m=n("tGKA"),f=n("35Q0"),p=n("u2iI"),g=n("byfQ"),_=n("8t9B"),E=n("hgLm"),F=n("sIWg"),T=n("1NAc"),P=n("LGJg");o.ShapeForma=(r=function(){this.cachedMaskImage_=null},i.defineClass({name:"ShapeForma",ctor:r,superName:"Forma",statics:{KIND:{get:function(){return"Shape"}},PROPERTY_ARTWORK:"artwork",PROPERTY_CONTENTID:"content-id",PROPERTY_SHAPELIBRARYID:"shape-id",PROPERTY_SIZE:"size",PROPERTY_SLICE_BOX:"slice-box",PROPERTY_PRESCALE:"prescale",PROPERTY_SHAPE_STYLE_DEPRECATED:"style",PROPERTY_CONTENT_REGION:"content-region",PROPERTY_TEXT_BOX:"text-box",SCHEMA_CLASS_NAME:{get:function(){return"ShapeForma"}},factory:{get:function(){return function(t,e,n,o){if(null!=e){var a=i.as(i.opt(i.opt(o,(function(t){return t.backLink})),(function(t){return t.dereference()})),c.GroupForma),s=i.as(i.opt(i.opt(o,(function(t){return t.backLink})),(function(t){return t.dereference()})),u.FormaPage);return d.LegacyCoreAssert.isTrue(null!=a||null!=s,"ShapeForma needs a parent group or page",void 0,"ShapeForma","ShapeForma.swift",31),null!=a?r.init_3144(t,e,n,a):r.init_7dbd(t,e,n,s)}return r.init_d1c9(t,n)}}},_implements:function(t){return"IDBObject"==t||"TheoMessageSubscriber"==t||"TheoMessagePublisher"==t}},props:{init_3144:function(t,e,n,o){var a;i.super_init(this,s.Forma,s.Forma.prototype.init_3144,t,e,n,o),null!=this.shapeLibraryID&&(f.ShapeLibrary.applyToShapeForma(this,this.shapeLibraryID),(a=this.getProperty(r.PROPERTY_ARTWORK))&&(a.shouldWrite=!1,this.setProperty(r.PROPERTY_ARTWORK,a)))},init_7dbd:function(t,e,n,o){var a;i.super_init(this,s.Forma,s.Forma.prototype.init_7dbd,t,e,n,o),null!=this.shapeLibraryID&&(f.ShapeLibrary.applyToShapeForma(this,this.shapeLibraryID),(a=this.getProperty(r.PROPERTY_ARTWORK))&&(a.shouldWrite=!1,this.setProperty(r.PROPERTY_ARTWORK,a)))},init_812f:function(t,e){for(var n={kind:function(){return r.KIND},style:function(){return p.ShapeStyle.createDefault()},size:function(){return new T.TheoSize(1,1)}},o=i.clone(e),a=i.iter(n);!a.done;a.next()){var u=a.key,l=a.value;null==e[u]&&(o[u]=l())}i.super_init(this,s.Forma,s.Forma.prototype.init_812f,t,o)},init_d1c9:function(t,e){var n;i.super_init(this,s.Forma,s.Forma.prototype.init_d1c9,t,e),null!=this.shapeLibraryID&&(f.ShapeLibrary.applyToShapeForma(this,this.shapeLibraryID),(n=this.getProperty(r.PROPERTY_ARTWORK))&&(n.shouldWrite=!1,this.setProperty(r.PROPERTY_ARTWORK,n)))},init_7186:function(t){var e={kind:r.KIND,style:p.ShapeStyle.createDefault(),size:new T.TheoSize(1,1)};this.init_812f(t,e)},postDecode:function(){s.Forma.prototype.postDecode.call(this),this.isGridCell()&&null==this.getProperty(s.Forma.PROPERTY_INTENT)&&this.set(s.Forma.PROPERTY_INTENT,s.Forma.INTENT_GRID_CELL)},className:{get:function(){return r.SCHEMA_CLASS_NAME}},updateEventForProperty:function(t){return t==r.PROPERTY_ARTWORK?new l.FormaContentChangedEvent(this):t==r.PROPERTY_PRESCALE?new l.FormaGeometryChangedEvent(this):t==r.PROPERTY_SLICE_BOX||t==r.PROPERTY_CONTENT_REGION?new l.FormaContentChangedEvent(this):t==r.PROPERTY_SIZE?new l.FormaGeometryChangedEvent(this):t==r.PROPERTY_CONTENTID||t==r.PROPERTY_SHAPELIBRARYID?new l.FormaContentChangedEvent(this):s.Forma.prototype.updateEventForProperty.call(this,t)},didChangeState:function(t){null==t[r.PROPERTY_ARTWORK]&&null==t[r.PROPERTY_PRESCALE]&&null==t[r.PROPERTY_SLICE_BOX]&&null==t[r.PROPERTY_SIZE]||(this.artworkSized_=null),s.Forma.prototype.didChangeState.call(this,t)},match:function(t){var e,n,o;if(s.Forma.prototype.match.call(this,t),e=i.as(t,r)){var u=new l.FormaGeometryChangedEvent(this);this.beginUpdate(u),this.artwork_=e.canonicalArtwork.clone(),this.sliceBox=e.sliceBox,this.contentRegion=e.contentRegion,this.size=e.size,this.endUpdate(u)}(n=i.as(t.controller,_.TypeLockupController))&&null!=(o=i.opt(n.lockupStyle,(function(t){return t.textBacked})))&&o&&this.style.colors.setColorId(a.ColorRole.FieldPrimary,t.style.colors.colorID(a.ColorRole.FieldSecondary))},artwork_:{get:function(){var t,e=new E.TheoRectanglePath(F.TheoRect.fromSize(this.size||new T.TheoSize(1,1)));return(t=i.as(this.get(r.PROPERTY_ARTWORK),g.TheoArtworkNode))||null!=t?t:g.TheoArtworkShape.init_9312(null,[e])},set:function(t){this.set(r.PROPERTY_ARTWORK,t)}},canonicalArtwork:{get:function(){return this.artwork_},set:function(t){var e=new l.FormaContentChangedEvent(this);this.beginUpdate(e),this.artwork_=t,this.artworkSized_=null,this.endUpdate(e)}},preScale:{get:function(){return i.as(this.get(r.PROPERTY_PRESCALE),"Double")},set:function(t){if(t!=this.preScale){var e=new l.FormaGeometryChangedEvent(this);this.beginUpdate(e),this.set(r.PROPERTY_PRESCALE,t),this.artworkSized_=null,this.endUpdate(e)}}},sizedArtwork:{get:function(){var t,e;return null==this.artworkSized_&&((t=this.artwork_.bounds)?(e=null!=this.preScale&&isFinite(this.preScale)?this.preScale:Math.min(this.size.width/t.width,this.size.height/t.height),this.artworkSized_=this.artwork_.applySlicing(t,F.TheoRect.fromSize(this.size),this.sliceBox,e,!0)):(i.opt(h.Host.logging,(function(t){return t.warning("No bounds obtained from artwork")})),this.artworkSized_=this.artwork_.clone())),this.artworkSized_}},sliceBox:{get:function(){return i.as(this.get(r.PROPERTY_SLICE_BOX),F.TheoRect)},set:function(t){var e=new l.FormaContentChangedEvent(this);this.beginUpdate(e),this.set(r.PROPERTY_SLICE_BOX,t),this.artworkSized_=null,this.endUpdate(e)}},contentRegion:{get:function(){return i.as(this.get(r.PROPERTY_CONTENT_REGION),F.TheoRect)},set:function(t){var e=new l.FormaContentChangedEvent(this);this.beginUpdate(e),this.set(r.PROPERTY_CONTENT_REGION,t),this.endUpdate(e)}},size:{get:function(){return i.as(this.get(r.PROPERTY_SIZE),T.TheoSize)},set:function(t){if(this.size!=t){var e=new l.FormaGeometryChangedEvent(this);this.beginUpdate(e),this.set(r.PROPERTY_SIZE,t),this.artworkSized_=null,this.endUpdate(e)}}},bounds:{get:function(){return this.boundsInCoordSpace(m.Matrix2D.Identity)},set:function(t){var e;if(e=t){if(this.size.equal(e.size))return;this.size=e.size}else d.LegacyCoreAssert.fail("shouldnt be setting nil bounds for a shape",void 0,"ShapeForma","ShapeForma.swift",285)}},boundsInCoordSpace:function(t){return i.opt(this.calcBounds(),(function(e){return e.transform(t)}))},calcBounds:function(){var t;return(t=this.size)?F.TheoRect.fromSize(t):null},contentID:{get:function(){return i.as(this.get(r.PROPERTY_CONTENTID),"String")},set:function(t){if(t!=this.contentID){var e=new l.FormaContentChangedEvent(this);this.beginUpdate(e),this.set(r.PROPERTY_CONTENTID,t),this.endUpdate(e)}}},contentNode:{get:function(){var t=this;return null==this.contentID?null:i.opt(this.page.document,(function(e){return e.content.nodeByID(t.contentID)}))},set:function(t){this.contentID=null==t?null:t.id}},shapeLibraryID:{get:function(){return i.as(this.get(r.PROPERTY_SHAPELIBRARYID),"String")},set:function(t){if(t!=this.shapeLibraryID){var e,n=new l.FormaContentChangedEvent(this);this.beginUpdate(n),this.set(r.PROPERTY_SHAPELIBRARYID,t),(e=this.getProperty(r.PROPERTY_ARTWORK))&&(e.shouldWrite=!1,this.setProperty(r.PROPERTY_ARTWORK,e)),this.endUpdate(n)}}},isGraphic:function(){return!0},isShape:function(){return!0},maskImage:{get:function(){if(null==this.cachedMaskImage_){var t=this.persisted?this.database.beginTransaction("cache_mask",null):null;h.Host.imageAnalysis.setShapeFormaTransparencyMask(this,25),i.opt(t,(function(t){return t.rollback()}))}return this.cachedMaskImage_},set:function(t){this.cachedMaskImage_=t}},getAverageAlpha:function(t){if(this.isGridCell())return 1;var e,n,r=t.transform(this.totalPlacement.inverse);if(this.contentNode instanceof P.VectorContentNode&&(e=this.maskImage)&&(n=this.bounds)){var o,a=i.toDouble(e.cols)/i.toDouble(n.width),s=i.toDouble(e.rows)/i.toDouble(n.height),u=r.multiplyXY(a,s).rounded();if(o=u.intersectionWith(new F.TheoRect(0,0,e.size.width,e.size.height)))return e.sumRegion(o)/u.area}return 1}}}),r)},enh0:function(t,e,n){var r,o=e,i=n("oAGj"),a=n("SpAV"),s=n("ascj"),u=n("FNB+"),l=n("QgZx"),c=n("fWxZ"),h=n("P83h"),d=n("pnSN"),m=n("53P9"),f=n("iCxV"),p=n("fNpk"),g=n("cEEQ"),_=n("c+uM"),E=n("Zifs"),F=n("a9ow"),T=n("9YN4"),P=n("8t9B"),C=n("3UhB"),v=n("x4Gy"),y=n("oKlP"),R=n("uUew"),S=n("sIWg"),I=n("LCGV");o.TextForma=(r=function(){this.renderRuns=new v.RenderRuns,this.graphemeCount_=-1,this.cachedText_=null,this.cachedFont_=null,this.cachedSize_=null,this.cachedColor_=null,this.cachedStrokeColor_=null,this.cachedStrokeWidth_=null,this.cachedTextLook_=null,this.cachedTracking_=null},i.defineClass({name:"TextForma",ctor:r,superName:"Forma",statics:{KIND:{get:function(){return"Text"}},PROPERTY_SIZE:"size",PROPERTY_TEXT:"text",PROPERTY_TEXT_STYLE:"text-style",PROPERTY_FILLCOLOR_DEPRECATED:"fill-color",PROPERTY_RANGEINLOCKUP:"range-in-lockup",PROPERTY_ROWINDEX:"row-index",SCHEMA_CLASS_NAME:{get:function(){return"TextForma"}},factory:{get:function(){return function(t,e,n,o){if(null!=e){var a=i.as(i.opt(i.opt(o,(function(t){return t.backLink})),(function(t){return t.dereference()})),d.GroupForma),s=i.as(i.opt(i.opt(o,(function(t){return t.backLink})),(function(t){return t.dereference()})),c.FormaPage);return p.LegacyCoreAssert.isTrue(null!=a||null!=s,"TextForma needs a parent group or page",void 0,"TextForma","TextForma.swift",26),null!=a?r.init_3144(t,e,n,a):r.init_7dbd(t,e,n,s)}return r.init_d1c9(t,n)}}},STROKEWIDTH_ZERO:0,TRACKING_ZERO:0,_implements:function(t){return"IDBObject"==t||"TheoMessageSubscriber"==t||"TheoMessagePublisher"==t}},props:{init_3144:function(t,e,n,r){i.super_init(this,u.Forma,u.Forma.prototype.init_3144,t,e,n,r)},init_7dbd:function(t,e,n,r){i.super_init(this,u.Forma,u.Forma.prototype.init_7dbd,t,e,n,r)},init_812f:function(t,e){for(var n={kind:function(){return r.KIND},style:function(){return I.TextStyle.createDefault()},text:function(){return v.TextModel.init_d41d()}},o=i.clone(e),a=i.iter(n);!a.done;a.next()){var s=a.key,l=a.value;null==e[s]&&(o[s]=l())}i.super_init(this,u.Forma,u.Forma.prototype.init_812f,t,o)},init_7186:function(t){var e={kind:r.KIND,style:I.TextStyle.createDefault(),text:v.TextModel.init_d41d()};this.init_812f(t,e)},init_d1c9:function(t,e){i.super_init(this,u.Forma,u.Forma.prototype.init_d1c9,t,e)},className:{get:function(){return r.SCHEMA_CLASS_NAME}},didChangeState:function(t){i.count(t)>0&&(this.cachedBounds_=null,this.cachedSize_=null),i.keys(t).includes(r.PROPERTY_TEXT)&&(this.cachedText_=null,this.graphemeCount_=-1,this.cachedFont_=null,this.cachedSize_=null,this.cachedColor_=null,this.cachedStrokeColor_=null,this.cachedStrokeWidth_=null,this.cachedTextLook_=null,this.cachedTracking_=null),u.Forma.prototype.didChangeState.call(this,t)},clearCache:function(){u.Forma.prototype.clearCache.call(this),this.renderRuns.clear()},updateEventForProperty:function(t){return t==r.PROPERTY_TEXT?new h.FormaGeometryChangedEvent(this):u.Forma.prototype.updateEventForProperty.call(this,t)},postDecode:function(){var t,e,n,r,o;if(u.Forma.prototype.postDecode.call(this),(e=i.opt(this.model_.getProperty(v.TextModel.PROPERTY_FONT_NAME),(function(t){return t.arrayValue})))&&(n=i.opt(i.first(e),(function(t){return t.dictionaryValue})))&&(r=i.opt(n[F.TextAttribute.PROPERTY_VALUE],(function(t){return t.dictionaryValue})))&&null!=(o=i.opt(r[l.FontDescriptor.PROPERTY_POSTSCRIPT_NAME],(function(t){return t.stringValue})))){var a=this.fontDescriptor;a.postScriptName==o&&a.availability==l.FontAvailability.LOADED||i.opt(this.page.document,(function(t){return t.recordMissingFont(o)}))}var c,h,d=(t=i.opt(this.page.document,(function(t){return t.versionDecoded.vers})))||null!=t?t:0;if(d<T.TheoDocumentVersion.Grouping){var m=this.fontColor;i.eq(E._equality_SolidColor_SolidColor,m,this.style.colors.fieldPrimary)||this.style.colors.setColor(s.ColorRole.FieldPrimary,m)}d<=T.TheoDocumentVersion.FourColorsAndOpacities&&(c=this.lockupStyle)&&(h=c.colors.fieldPrimary)&&!i.eq(E._equality_SolidColor_SolidColor,this.style.colors.fieldPrimary,h)&&(m=this.fontColor,this.textLook==_.LockupTextLook.FillAndOutline2?this.style.colors.setColor(s.ColorRole.FieldSecondary,m):_.LockupStyle.isShadowLook(this.textLook)&&this.style.colors.setColor(s.ColorRole.Shadow,m))},model_:{get:function(){return this.get(r.PROPERTY_TEXT)},set:function(t){this.set(r.PROPERTY_TEXT,t)}},textStyle:{get:function(){return i.as(this.get(r.PROPERTY_TEXT_STYLE),I.TextStyle)},set:function(t){this.set(r.PROPERTY_TEXT_STYLE,t)}},rangeInLockup_:{get:function(){var t;return(t=i.as(this.get(r.PROPERTY_RANGEINLOCKUP),R.TextRange))||null!=t?t:new R.TextRange(0,0)},set:function(t){this.set(r.PROPERTY_RANGEINLOCKUP,t)}},rowIndex_:{get:function(){var t;return(t=i.as(this.get(r.PROPERTY_ROWINDEX),"Int"))||null!=t?t:0},set:function(t){this.set(r.PROPERTY_ROWINDEX,t)}},graphemeCount:{get:function(){return-1==this.graphemeCount_&&(this.graphemeCount_=m.GraphemeUtils.countGraphemes(this.model_.text)),this.graphemeCount_}},isText:function(){return!0},boundsInCoordSpace:function(t){if(0==this.text.length)return S.TheoRect.Zero;if(null==this.cachedBounds_){var e=this.fontStrokeWidth;this.cachedBounds_=f.Host.textModelUtils.measureBoundsForLayout(this.text,this.fontDescriptor,this.fontSize,this.tracking),e!=r.STROKEWIDTH_ZERO&&(this.cachedBounds_=this.cachedBounds_.insetXY(-e/2,-e/2))}return this.cachedBounds_.transform(t)},baselineBoundsInCoordSpace:function(t){return 0==this.text.length?S.TheoRect.Zero:f.Host.textModelUtils.measureBaselineBounds(this.text,this.fontDescriptor,this.fontSize,this.tracking).transform(t)},setTextProperties:function(t,e,n,r,o,u,l,c,d,m,f){var p=new h.FormaGeometryChangedEvent(this);this.beginUpdate(p);var g=this.model_;null!=this.cachedText_&&t==this.cachedText_||(g.text=t,this.cachedText_=t,this.graphemeCount_=-1),g.setAttr(e,v.TextModel.PROPERTY_FONT_NAME),g.setAttr(n,v.TextModel.PROPERTY_FONT_SIZE),g.setAttr(r,v.TextModel.PROPERTY_FONT_COLOR),g.setAttr(o,v.TextModel.PROPERTY_FONT_STROKE_COLOR),g.setAttr(u,v.TextModel.PROPERTY_FONT_STROKE_WIDTH),g.setAttr(l,v.TextModel.PROPERTY_TEXT_LOOK),g.setAttr(c,v.TextModel.PROPERTY_TRACKING),this.cachedFont_=null,this.cachedSize_=null,this.cachedColor_=null,this.cachedStrokeColor_=null,this.cachedStrokeWidth_=null,this.cachedTextLook_=null,this.cachedTracking_=null,this.cachedBounds_=null,this.rangeInLockup_=d,this.rowIndex_=m;var F=this.fontColor;a.CoreAssertDebugOnly.isTrue(f==s.ColorRole.FieldPrimary||f==s.ColorRole.FieldSecondary||f==s.ColorRole.Shadow,"we currently only use primary, secondary or shadow as roles for textForma items",void 0,"TextForma.setTextProperties","TextForma.swift",263),a.CoreAssertDebugOnly.isTrue(f==s.ColorRole.FieldSecondary&&l==_.LockupTextLook.FillAndOutline2||f!=s.ColorRole.FieldSecondary,"currently colorRole secondary is only used for puffy text",void 0,"TextForma.setTextProperties","TextForma.swift",264),f!=s.ColorRole.FieldSecondary&&null!=this.style.colors.fieldSecondary&&this.style.colors.setColor(s.ColorRole.FieldSecondary,null),f!=s.ColorRole.Shadow&&null!=this.style.colors.shadow&&this.style.colors.setColor(s.ColorRole.Shadow,null),f!=s.ColorRole.FieldPrimary&&this.style.colors.setColor(f,F),i.eq(E._equality_SolidColor_SolidColor,this.style.colors.fieldPrimary,F)||this.style.colors.setColor(s.ColorRole.FieldPrimary,F),this.endUpdate(p)},clearTextFormaText:function(){var t=new h.FormaGeometryChangedEvent(this);this.beginUpdate(t);var e=this.model_;null!=this.cachedText_&&this.text==this.cachedText_||(e.text="",this.cachedText_="",this.graphemeCount_=-1),this.endUpdate(t)},text:{get:function(){var t;return null!=(t=this.cachedText_)?t:(this.cachedText_=this.model_.text,this.cachedText_)}},fontDescriptor:{get:function(){var t;return(t=this.cachedFont_)?t:(this.cachedFont_=i.opt(this.model_.fontName,(function(t){return t.value}))||i.opt(i.opt(this.lockupStyle,(function(t){return t.font})),(function(t){return t.fontData})),p.LegacyCoreAssert.isTrue(null!=this.cachedFont_,"Why isn't there a font set?",void 0,"TextForma","TextForma.swift",313),this.cachedFont_||v.TextModel.defaultFontName.value)}},fontSize:{get:function(){var t,e;return null!=(e=this.cachedSize_)?e:(this.cachedSize_=i.opt(this.model_.fontSize,(function(t){return t.value})),p.LegacyCoreAssert.isTrue(null!=this.cachedSize_,"Why isn't there a size set in the model?",void 0,"TextForma","TextForma.swift",323),(t=this.cachedSize_)||null!=t?t:v.TextModel.defaultFontSize.value)}},fontColor:{get:function(){var t;return(t=this.cachedColor_)?t:(this.cachedColor_=i.opt(this.model_.fontColor,(function(t){return t.value}))||i.opt(this.lockupStyle,(function(t){return t.colors.fieldPrimary})),p.LegacyCoreAssert.isTrue(null!=this.cachedColor_,"Why isn't there a color set?",void 0,"TextForma","TextForma.swift",333),this.cachedColor_||v.TextModel.defaultFontColor.value)}},fontStrokeColor:{get:function(){var t;return(t=this.cachedStrokeColor_)?t:(this.cachedStrokeColor_=i.opt(this.model_.fontStrokeColor,(function(t){return t.value}))||i.opt(this.lockupStyle,(function(t){return t.colors.fieldSecondary})),p.LegacyCoreAssert.isTrue(null!=this.cachedStrokeColor_,"Why isn't there a color set?",void 0,"TextForma","TextForma.swift",343),this.cachedStrokeColor_||v.TextModel.defaultFontStrokeColor.value)}},textLook:{get:function(){var t,e,n;return null!=(e=this.cachedTextLook_)?e:(null!=(n=i.opt(this.model_.textLook,(function(t){return t.value})))&&(this.cachedTextLook_=_.LockupTextLook.toCaseValue(n)),this.cachedTextLook_=(t=this.cachedTextLook_)||null!=t?t:_.LockupTextLook.Fill,this.cachedTextLook_)}},fontStrokeWidth:{get:function(){var t,e;return null!=(e=this.cachedStrokeWidth_)?e:(this.cachedStrokeWidth_=(t=i.opt(this.model_.fontStrokeWidth,(function(t){return t.value})))||null!=t?t:r.STROKEWIDTH_ZERO,this.cachedStrokeWidth_)}},tracking:{get:function(){var t,e;return null!=(e=this.cachedTracking_)?e:(this.cachedTracking_=(t=i.opt(this.model_.tracking,(function(t){return t.value})))||null!=t?t:r.TRACKING_ZERO,this.cachedTracking_)}},rangeInLockup:{get:function(){return this.rangeInLockup_}},lockupForma:{get:function(){var t=function(t){return t.visit(u.FormaTraversal.NearestAncestor,(function(t,e,n){var r;return!!(r=t.controller)&&r instanceof P.TypeLockupController}))};return p.LegacyCoreAssert.isTrue(t(this)==i.opt(i.opt(this.parent,(function(t){return t.parent})),(function(t){return t.parent})),"Unexpected number of nodes between text forma and lockup forma",void 0,"TextForma","TextForma.swift",391),i.as(t(this),d.GroupForma)}},lockupStyle:{get:function(){return i.as(i.opt(this.lockupForma,(function(t){return t.style})),_.LockupStyle)}},isRangeStart:function(){var t,e=this.text.includes("");if(t=i.as(i.opt(this.lockupForma,(function(t){return t.controller})),P.TypeLockupController))for(var n=i.iter(t.getCharacterStyleRanges());!n.done;n.next()){var r=n.value;if(e){if(r.end==this.rangeInLockup.end)return!0}else if(r.start==this.rangeInLockup.start)return!0}return!1},isRangeEnd:function(){var t,e=this.text.includes("");if(t=i.as(i.opt(this.lockupForma,(function(t){return t.controller})),P.TypeLockupController))for(var n=i.iter(t.getCharacterStyleRanges());!n.done;n.next()){var r=n.value;if(e){if(r.start==this.rangeInLockup.start)return!0}else if(r.end==this.rangeInLockup.end)return!0}return!1},rowIndex:{get:function(){return this.rowIndex_}},getBoundsCenter:function(){var t;if(t=i.opt(this.bounds,(function(t){return t.center}))){if(!f.Host.textModelUtils.usePGMRenderer())return t;var e,n;if(null!=(e=i.opt(i.as(i.opt(this.lockupForma,(function(t){return t.controller})),P.TypeLockupController),(function(t){return t.text})))&&(n=i.opt(i.opt(this.lockupStyle,(function(t){return t.font})),(function(t){return t.fontData})))){var r=g.getTypographicBoundingRatiosOfString(e,n,!1),o=r.heightRatio*this.fontSize/2+n.capRatio*this.fontSize-r.textVerticalOffsetRatio*this.fontSize;return new y.TheoPoint(t.x,o)}return t}return y.TheoPoint.ZERO},isDecorationTextForma:function(){return this.style.colors.count>1},isWhiteSpace:function(){return C.TypeLockupUtils.isWhiteSpace(this.model_.text)}}}),r)},fWxZ:function(t,e,n){var r,o,i=e,a=n("oAGj"),s=n("6NRR"),u=n("KSe6"),l=n("CWW7"),c=n("9WSY"),h=n("yhkb"),d=n("quOg"),m=n("lqhW"),f=n("FNB+"),p=n("NxMp"),g=n("cmoc"),_=n("ylxa"),E=n("ML5t"),F=n("OdB2"),T=n("P83h"),P=n("pnSN"),C=n("iCxV"),v=n("U010"),y=n("fdtz"),R=n("b/QB"),S=n("fNpk"),I=n("Quhx"),A=n("NbJN"),O=n("K0Rh"),D=n("9YN4"),N=n("enh0"),b=n("8t9B"),L=n("sIWg"),x=n("1NAc");i.FormaPage=(r=function(){this.formaFactory_=new p.DefaultFormaFactory,this.pgmSource_=null,this.colorLibrary_=null},o={},a.defineClass({name:"FormaPage",ctor:r,superName:"PostDCXObject",statics:{SCHEMA_CLASS_NAME:"FormaPage",factory:{get:function(){return void 0===o.factory&&(o.factory=function(t,e,n,o){var i=a.as(a.opt(a.opt(o,(function(t){return t.backLink})),(function(t){return t.dereference()})),D.TheoDocument);return S.LegacyCoreAssert.isTrue(null!=i,"FormaPage needs a parent document",void 0,"FormaPage","FormaPage.swift",15),r.init_3144(t,e,n,i)}),o.factory},set:function(t){o.factory=t}},PROPERTY_KIND:"kind",PROPERTY_PAGE_SIZE:"size",PROPERTY_TEMPLATE_ID:"template-id",PROPERTY_COLOR_LIBRARY:"color-library",PROPERTY_SIZE_ID:"size-id",PROPERTY_ORIGINAL_SIZE_ID:"original-size-id",PROPERTY_CUSTOM_SIZE_FORMAT:"custom-size-format",PROPERTY_CUSTOM_SIZE_PPI:"custom-size-ppi",PROPERTY_EXPORT_DATA:"export-data",PROPERTY_CHILDREN:"children",DEFAULT_SIZE_ID:"Instagram",DEFAULT_ORIGINAL_SIZE_ID:"Unknown",DEFAULT_CUSTOM_SIZE_FORMAT:{get:function(){return void 0===o.DEFAULT_CUSTOM_SIZE_FORMAT&&(o.DEFAULT_CUSTOM_SIZE_FORMAT=_.PageExportFormat.PIXELS),o.DEFAULT_CUSTOM_SIZE_FORMAT}},DEFAULT_CUSTOM_SIZE_PPI:300,DEFAULT_PAGE_SIZE:{get:function(){return void 0===o.DEFAULT_PAGE_SIZE&&(o.DEFAULT_PAGE_SIZE=new x.TheoSize(1200,1200)),o.DEFAULT_PAGE_SIZE}},DCXTYPE:{get:function(){return"application/vnd.adobe.theo.forma+dcx"}},PATH:{get:function(){return"forma-document"}},_implements:function(t){return"IDBObject"==t||"TheoMessagePublisher"==t}},props:{init_3144:function(t,e,n,r){this.document_=r,this.imageFilterLibrary_=new R.ImageFilterLibrary,this.imageCutoutLibrary_=new v.ImageCutoutLibrary,this.animationLibrary_=new u.AnimationLibrary,this.refineCutoutController_=new A.RefineCutoutController,a.super_init(this,I.PostDCXObject,I.PostDCXObject.prototype.init_3181,e,n,t),this.colorLibraryController_=new h.ColorLibraryController(this.colorLibrary,r),this.animationController_=new s.AnimationController(r)},init_d0e4:function(t){this.document_=t,this.imageFilterLibrary_=new R.ImageFilterLibrary,this.imageCutoutLibrary_=new v.ImageCutoutLibrary,this.animationLibrary_=new u.AnimationLibrary,this.refineCutoutController_=new A.RefineCutoutController,a.super_init(this,I.PostDCXObject,I.PostDCXObject.prototype.init_11e0,t.database),this.set(I.PostDCXObject.PROPERTY_PATH,r.PATH),this.set(I.PostDCXObject.PROPERTY_TYPE,r.DCXTYPE),this.set(r.PROPERTY_PAGE_SIZE,r.DEFAULT_PAGE_SIZE),this.set(r.PROPERTY_SIZE_ID,r.DEFAULT_SIZE_ID),this.set(r.PROPERTY_COLOR_LIBRARY,c.ColorLibrary.init_d41d()),this.colorLibraryController_=new h.ColorLibraryController(this.colorLibrary,t),this.animationController_=new s.AnimationController(t),this.root_=a.as(this.createForma(O.RootForma.KIND),P.GroupForma)},cleanupEmptyTextLockups:function(){var t=[];this.root_.visitAll(f.FormaTraversal.PreOrder,(function(e){var n;(n=a.as(e.controller,b.TypeLockupController))&&a.isEmpty(n.text)&&t.push(e)})),l.CreationFacade.deleteFormae(t,(function(){}))},postDecode:function(){var t=this;null==this.colorLibrary.color(a.as(this.colorLibraryController.getThemeColorKeys()[0],"String"))&&a.opt(this.colorLibraryController_,(function(e){return e.applyLegacyColorThemeFromDocument(t.document_)})),a.opt(this.colorLibraryController_,(function(t){return t.ensureDerivedColorsAreSet()})),this.cleanupEmptyTextLockups(),this.root_.visitAll(f.FormaTraversal.PostOrderWithAuxiliaries,(function(t){return t.postDecode()}))},className:{get:function(){return r.SCHEMA_CLASS_NAME}},document:{get:function(){return this.document_}},view:{get:function(){return this.view_},set:function(t){this.view_=t}},pgm:{get:function(){return this.pgmSource_=this.pgmSource_||new E.FormaPagePGMSource(this),this.pgmSource_}},setPageSizeFromDesignSize:function(t){var e=Math.max(this.pageSize_.width,this.pageSize_.height),n=t.aspectRatio>1?Math.round(e/t.aspectRatio):e,r=Math.round(t.aspectRatio*n);this.sizeID=t.id,this.customSizeFormat=t.exportData.format,this.customSizePPI=t.exportData.PPI,this.templateID=null,this.setPageSize(new x.TheoSize(r,n),t.exportData)},setPageSize:function(t,e){if(void 0===e&&(e=null),null!=e&&Math.abs((e.dimensions.aspectRatio-t.aspectRatio)/Math.max(e.dimensions.aspectRatio,t.aspectRatio))>.02)S.LegacyCoreAssert.fail("Incompatible dimensions",void 0,"FormaPage.setPageSize","FormaPage.swift",166);else{var n=!1;if(t.equal(this.pageSize_)||(n=!0,this.pageSize_=t,this.root.bounds=L.TheoRect.fromSize(t),this.publish(new F.PageSizeUpdateMessage(this,t))),n||t.equal(r.DEFAULT_PAGE_SIZE)){var o=a.opt(a.opt(this.document,(function(t){return t.controller})),(function(t){return t.designController.view}));a.opt(o,(function(t){return t.pageSizeChanged()}))}this.exportData_=e}},getExportDataWithLimitTo:function(t){return this.getExportData(t,null)},getPageExportData:function(){return this.getExportData(null,null)},getExportData:function(t,e){var n=null;if(null!=this.exportData_)n=this.exportData_;else{var r=m.DesignSizeLibrary.getById(this.sizeID);null!=r&&(n=r.exportData)}var o=this.pageSize_.aspectRatio,i=null!=e?e:m.DesignSizeLibrary.MAX_EDGE;null==n&&(n=o<1?new _.FormaPageExportData(new x.TheoSize(Math.round(i*o),i),_.PageExportFormat.PIXELS):new _.FormaPageExportData(new x.TheoSize(i,Math.round(i/o)),_.PageExportFormat.PIXELS));var a=Math.max(n.pixelDimensions.width,n.pixelDimensions.height);return null!=t&&a>t&&(i=t,n=o<1?new _.FormaPageExportData(new x.TheoSize(Math.round(i*o),i),_.PageExportFormat.PIXELS):new _.FormaPageExportData(new x.TheoSize(i,Math.round(i/o)),_.PageExportFormat.PIXELS)),n},pageSize_:{get:function(){var t;return(t=a.as(this.get(r.PROPERTY_PAGE_SIZE),x.TheoSize))||null!=t?t:r.DEFAULT_PAGE_SIZE},set:function(t){this.set(r.PROPERTY_PAGE_SIZE,t)}},pageSize:{get:function(){return this.pageSize_}},templateID:{get:function(){return a.as(this.get(r.PROPERTY_TEMPLATE_ID),"String")},set:function(t){this.set(r.PROPERTY_TEMPLATE_ID,t)}},sizeID:{get:function(){var t;return(t=a.as(this.get(r.PROPERTY_SIZE_ID),"String"))||null!=t?t:r.DEFAULT_SIZE_ID},set:function(t){this.set(r.PROPERTY_SIZE_ID,t)}},originalSizeID:{get:function(){var t;return(t=a.as(this.get(r.PROPERTY_ORIGINAL_SIZE_ID),"String"))||null!=t?t:r.DEFAULT_ORIGINAL_SIZE_ID},set:function(t){this.set(r.PROPERTY_ORIGINAL_SIZE_ID,t)}},customSizeFormat:{get:function(){var t,e,n=(t=a.as(this.get(r.PROPERTY_CUSTOM_SIZE_FORMAT),"Int"))||null!=t?t:r.DEFAULT_CUSTOM_SIZE_FORMAT;return(e=_.PageExportFormat.toCaseValue(n))||null!=e?e:r.DEFAULT_CUSTOM_SIZE_FORMAT},set:function(t){this.set(r.PROPERTY_CUSTOM_SIZE_FORMAT,t)}},customSizePPI:{get:function(){var t;return(t=a.as(this.get(r.PROPERTY_CUSTOM_SIZE_PPI),"Double"))||null!=t?t:r.DEFAULT_CUSTOM_SIZE_PPI},set:function(t){this.set(r.PROPERTY_CUSTOM_SIZE_PPI,t)}},colorLibrary:{get:function(){return null==this.colorLibrary_&&(this.colorLibrary_=a.as(this.get(r.PROPERTY_COLOR_LIBRARY),c.ColorLibrary)),this.colorLibrary_}},setColorLibrary:function(t){this.colorLibrary_=t,this.set(r.PROPERTY_COLOR_LIBRARY,t)},colorLibraryController:{get:function(){return this.colorLibraryController_}},exportData_:{get:function(){return a.as(this.get(r.PROPERTY_EXPORT_DATA),_.FormaPageExportData)},set:function(t){this.set(r.PROPERTY_EXPORT_DATA,t)}},exportData:{get:function(){return this.exportData_}},children_:{get:function(){var t;return(t=a.as(this.get(r.PROPERTY_CHILDREN),["Array",f.Forma]))||null!=t?t:[]}},root_:{get:function(){return this.children_.length>0?a.as(this.children_[0],P.GroupForma):null},set:function(t){if(null!=t&&0==this.children_.length){var e=a.clone(a.as(this.get(r.PROPERTY_CHILDREN),["Array",f.Forma]));null!=e&&e.length>0?(e[0]=t,this.set(r.PROPERTY_CHILDREN,e)):this.set(r.PROPERTY_CHILDREN,[a.as(t,f.Forma)])}}},root:{get:function(){return this.root_}},hasRoot:function(){return null!=this.root_},imageFilterLibrary:{get:function(){return this.imageFilterLibrary_}},imageCutoutLibrary:{get:function(){return this.imageCutoutLibrary_}},animationLibrary:{get:function(){return this.animationLibrary_}},layoutLibrary:{get:function(){return this.document.gridLibrary}},animationController:{get:function(){return this.animationController_}},refineCutoutController:{get:function(){return this.refineCutoutController_}},imageColors:{get:function(){var t,e,n=[],r=a.clone(this.root_.filterWithCallback((function(t){return t instanceof y.ImageForma})));return r.length>0&&(t=a.as(r[0],y.ImageForma))&&(e=a.opt(t.contentNode,(function(t){return t.image})))&&a.append(n,e.getImageColors(10)),n}},formaByID:function(t){return this.root_.formaByID(t)},selectableFormaeIntersectingRect:function(t){var e=[];return this.root_.visit(f.FormaTraversal.PreOrder,(function(n,r,o){if(null!=n.controller&&n.controller.canMultiSelect&&!n.isFullCanvas&&L.TheoRect.PointInCommon(t,n.totalPlacement.inverse,n.bounds)){if(n.controller.userGroupChild){for(var i=n;i.controller.userGroupChild;)i=i.parent;return a.containsEq(e,i,f._equality_Forma_Forma)||e.push(i),!1}var s,u;(s=a.as(n.parent,g.FrameForma))?L.TheoRect.PointInCommon(t,s.totalPlacement.inverse,s.bounds)&&e.push(n):(u=a.as(n,N.TextForma))?e.push(u.lockupForma):e.push(n)}return!1})),e},formaAtPoint:function(t,e,n,r){void 0===e&&(e=0),void 0===n&&(n=null),void 0===r&&(r=null);var o,i=this,s=null;return this.root_.visit(f.FormaTraversal.PreOrder,(function(u,l,c){var h;if(h=a.opt(u.totalPlacement.inverse,(function(e){return e.transformPoint(t)}))){var m=Math.sqrt(Math.abs(u.totalPlacement.determinant));S.LegacyCoreAssert.isTrue(0!=m,"framescale is zero",void 0,"FormaPage.formaAtPoint","FormaPage.swift",426);var f=e/m;if(u.containsPoint(h,f)&&!u.isFullCanvas){if(i.document.controller.interactionMode==d.InteractionMode.AutomaticGrid&&null!=u.controller&&u.controller.floating&&!C.Host.platform.isWeb)return!0;if(null!=r&&0==r(u))return!1;if(((o=a.opt(u.controller,(function(t){return t.userGroup})))||null!=o)&&o)return!1;if(null!=n){for(var p=!1,_=a.iter(n);!_.done;_.next()){var E=_.value;if(u.kind==E&&(!u.isShape()||null!=u.controller)){p=!0;break}}if(0==p)return!1}var F,T;if(F=a.as(u.parent,g.FrameForma)){if(T=a.opt(F.totalPlacement.inverse,(function(e){return e.transformPoint(t)}))){var P=Math.sqrt(Math.abs(F.totalPlacement.determinant));S.LegacyCoreAssert.isTrue(0!=P,"framescale is zero",void 0,"FormaPage.formaAtPoint","FormaPage.swift",465);var v=e/P;F.containsPoint(T,v)&&(s=u)}}else s=u}}return!1})),s},formaAtPointInSelection:function(t,e){var n=null;return e.forEachSelected((function(e){return e.visit(f.FormaTraversal.PreOrder,(function(e,r,o){var i;if((i=a.opt(e.totalPlacement.inverse,(function(e){return e.transformPoint(t)})))&&e.containsPoint(i)&&!e.isFullCanvas){if(e instanceof N.TextForma)return n=e,!0;var s,u;(s=a.as(e.parent,g.FrameForma))?(u=a.opt(s.totalPlacement.inverse,(function(e){return e.transformPoint(t)})))&&s.containsPoint(u)&&(n=e):n=e}return!1}))})),n},createForma:function(t){var e=this.formaFactory_.createForma(this,t);if(null==e)return null;var n=new T.FormaCreatedEvent(e);return this.beginUpdate(n),e.initializeToDefaults(),this.endUpdate(n),e},createFormaWithController:function(t,e){var n=this.formaFactory_.createForma(this,t);if(null==n)return null;var r=new T.FormaCreatedEvent(n);return this.beginUpdate(r),n.initializeToDefaults(),n.controller=a.opt(a.opt(this.document_,(function(t){return t.controller})),(function(t){return t.controllerFactory.createController(e,n)})),this.endUpdate(r),n},createModelForma:function(t){var e=this.formaFactory_.createForma(this,t);return null==e?null:(e.isModel=!0,e)},beginUpdate:function(t){null!=this.view_&&(t.token=this.view_.beginViewUpdate(t)),this.publish(new F.FormaBeginUpdateMessage(this,t))},endUpdate:function(t){this.publish(new F.FormaEndUpdateMessage(this,t)),a.opt(this.view_,(function(e){return e.endViewUpdate(t.token)}))}}}),r)},fdtz:function(t,e,n){var r,o,i,a=e,s=n("oAGj"),u=n("ascj"),l=n("FNB+"),c=n("6ZWm"),h=n("cmoc"),d=n("fWxZ"),m=n("P83h"),f=n("pnSN"),p=n("NkBu"),g=n("q5zr"),_=n("lmwz"),E=n("uWOl"),F=n("fNpk"),T=n("tGKA"),P=n("VkKB"),C=n("Zifs"),v=n("sIWg");a.LRUColorCacheEntry=(r=function(t,e){this.key=t,this.value=e},s.defineClass({name:"LRUColorCacheEntry",ctor:r}),r),a.LRUColorCache=(o=function(t){this.cachedItemsByKey_={},this.cachedItemsLRU_=[],void 0===t&&(t=50),this.maxEntries_=t},s.defineClass({name:"LRUColorCache",ctor:o,props:{get:function(t){var e;return(e=this.cachedItemsByKey_[t])?(s.remove(this.cachedItemsLRU_,e),this.cachedItemsLRU_.splice(0,0,e),e.value):null},remove:function(t){var e;(e=this.cachedItemsByKey_[t])&&(s.removeKey(this.cachedItemsByKey_,t),s.remove(this.cachedItemsLRU_,e))},add:function(t,e){(n=this.cachedItemsByKey_[t])&&(s.removeKey(this.cachedItemsByKey_,t),s.remove(this.cachedItemsLRU_,n));var n=new a.LRUColorCacheEntry(t,e);this.cachedItemsByKey_[t]=n,this.cachedItemsLRU_.splice(0,0,n);var r=this.cachedItemsLRU_.length;r>this.maxEntries_&&this.cachedItemsLRU_.splice(this.maxEntries_,r-this.maxEntries_)}}}),o),a.ImageForma=(i=function(){this.cachedBounds_=null,this.cachedContent_=null,this.avgColorCache_=new a.LRUColorCache,this.changeSubscriptions_=[]},s.defineClass({name:"ImageForma",ctor:i,superName:"Forma",statics:{KIND:{get:function(){return"Image"}},PROPERTY_CONTENTID:"content-id",PROPERTY_IMAGE_STYLE_DEPRECATED:"image-style",SCHEMA_CLASS_NAME:{get:function(){return"ImageForma"}},factory:{get:function(){return function(t,e,n,r){if(null!=e){var o=s.as(s.opt(s.opt(r,(function(t){return t.backLink})),(function(t){return t.dereference()})),f.GroupForma),a=s.as(s.opt(s.opt(r,(function(t){return t.backLink})),(function(t){return t.dereference()})),d.FormaPage);return F.LegacyCoreAssert.isTrue(null!=o||null!=a,"ImageForma needs a parent group or page",void 0,"ImageForma","ImageForma.swift",73),null!=o?i.init_3144(t,e,n,o):i.init_7dbd(t,e,n,a)}return i.init_d1c9(t,n)}}},propagateMaskContentChange:function(t){var e,n;if((e=s.opt(t,(function(t){return t.parent})))&&(n=_.ImageFacade.getImageFormaForForma(e))){var r=new m.FormaContentChangedEvent(n);n.beginUpdate(r),n.endUpdate(r)}},_implements:function(t){return"IDBObject"==t||"TheoMessageSubscriber"==t||"TheoMessagePublisher"==t}},props:{deprecatedStyle_:{get:function(){return s.as(this.get(i.PROPERTY_IMAGE_STYLE_DEPRECATED),E.ImageStyle)}},init_3144:function(t,e,n,r){s.super_init(this,l.Forma,l.Forma.prototype.init_3144,t,e,n,r),null!=this.deprecatedStyle_&&this.protectedSetStyle(this.deprecatedStyle_)},init_7dbd:function(t,e,n,r){s.super_init(this,l.Forma,l.Forma.prototype.init_7dbd,t,e,n,r),null!=this.deprecatedStyle_&&this.protectedSetStyle(this.deprecatedStyle_)},init_812f:function(t,e){for(var n={kind:function(){return i.KIND},style:function(){return E.ImageStyle.createDefault()}},r=s.clone(e),o=s.iter(n);!o.done;o.next()){var a=o.key,u=o.value;null==e[a]&&(r[a]=u())}s.super_init(this,l.Forma,l.Forma.prototype.init_812f,t,r)},init_7186:function(t){var e={kind:i.KIND,style:E.ImageStyle.createDefault()};this.init_812f(t,e)},init_d1c9:function(t,e){s.super_init(this,l.Forma,l.Forma.prototype.init_d1c9,t,e),null!=this.deprecatedStyle_&&this.protectedSetStyle(this.deprecatedStyle_)},initializeDefaultState:function(){null!=this.deprecatedStyle_&&this.protectedSetStyle(this.deprecatedStyle_),l.Forma.prototype.initializeDefaultState.call(this)},decodeController:function(){var t;null==this.controller&&(t=s.opt(this.page.document,(function(t){return t.controller})))&&(this.controller=t.controllerFactory.createController(p.ImageController.KIND,this)),l.Forma.prototype.decodeController.call(this)},className:{get:function(){return i.SCHEMA_CLASS_NAME}},updateEventForProperty:function(t){return t==i.PROPERTY_CONTENTID?new m.FormaContentChangedEvent(this):l.Forma.prototype.updateEventForProperty.call(this,t)},postDecode:function(){var t,e,n,r,o;(t=this.contentNode)&&(this.ensureContentNodeListeners(),(e=t.mediaMetadata)&&null!=(n=e.designIntent)&&(n==P.MediaMetadata.DESIGNINTENT_LOGO&&(this.intent=l.Forma.INTENT_LOGO),n==P.MediaMetadata.DESIGNINTENT_PATTERN&&(this.intent=l.Forma.INTENT_PATTERN),n==P.MediaMetadata.DESIGNINTENT_FLOATING_IMAGE&&(this.intent=l.Forma.INTENT_FLOATING_IMAGE))),this.isGridCell()&&null==this.getProperty(l.Forma.PROPERTY_INTENT)&&this.set(l.Forma.PROPERTY_INTENT,l.Forma.INTENT_GRID_CELL),(r=s.opt(this.parent,(function(t){return t.controller})))&&r.kind!=c.FrameController.KIND&&(o=s.as(this.page.createFormaWithController(h.FrameForma.KIND,c.FrameController.KIND),h.FrameForma))&&(s.opt(this.parent,(function(t){return t.appendChild(o)})),o.bounds=this.bounds,o.placement=this.placement,this.placement=T.Matrix2D.Identity,o.appendChild(this,!1),o.allowUserMove=!0),l.Forma.prototype.postDecode.call(this)},contentNode:{get:function(){var t,e;null!=(t=this.contentID)&&((!(e=this.cachedContent_)||e.id!=t)&&(this.cachedContent_=s.as(s.opt(this.page.document,(function(e){return e.content.nodeByID(t)})),g.ImageContentNode)));return this.cachedContent_},set:function(t){this.cachedContent_=t,this.contentID=s.opt(t,(function(t){return t.id}))}},contentUrl:{get:function(){return s.opt(this.contentNode,(function(t){return t.url}))}},mimeType:{get:function(){return s.opt(this.contentNode,(function(t){return t.mimeType}))}},contentID:{get:function(){return s.as(this.get(i.PROPERTY_CONTENTID),"String")},set:function(t){var e=new m.FormaContentChangedEvent(this);this.beginUpdate(e),this.removeListenersFromContentNode(),this.set(i.PROPERTY_CONTENTID,t),this.addListenersToContentNode(),this.cachedBounds_=null,s.opt(this.cachedContent_,(function(e){return e.id!=t}))&&(this.cachedContent_=null),this.avgColorCache_=new a.LRUColorCache,this.endUpdate(e),this.intent==l.Forma.INTENT_CUTOUT_MASK&&i.propagateMaskContentChange(this)}},didChangeState:function(t){l.Forma.prototype.didChangeState.call(this,t),this.intent==l.Forma.INTENT_CUTOUT_MASK&&s.keys(t).includes(i.PROPERTY_CONTENTID)&&i.propagateMaskContentChange(this)},addListenersToContentNode:function(){var t,e=this;this.intent==l.Forma.INTENT_CUTOUT_MASK&&(t=this.contentNode)&&this.changeSubscriptions_.push(t.subscribeWithCallback((function(t){return i.propagateMaskContentChange(e)}),g.ImageContentChangedMessage.TYPE))},removeListenersFromContentNode:function(){for(;0==!this.changeSubscriptions_.length;)s.opt(this.changeSubscriptions_.pop(),(function(t){return t.unsubscribe()}))},ensureContentNodeListeners:function(){this.removeListenersFromContentNode(),this.addListenersToContentNode()},match:function(t){var e,n=this.placement;if(l.Forma.prototype.match.call(this,t),e=s.as(t,i)){if(0==e.style.colors.hasReferencedColorsFromColorLibrary()){var r,o,a=e.page.colorLibraryController.applyLegacyFilterColorsAndReturnKeys(e.style);null!=(r=a.primaryKey)&&e.style.colors.setColorId(u.ColorRole.FieldPrimary,r),null!=(o=a.secondaryKey)&&e.style.colors.setColorId(u.ColorRole.FieldSecondary,o)}this.applyStyle(e.style),t.contentID!=this.contentID&&(this.placement=n)}},boundsInCoordSpace:function(t){var e;return null==this.cachedBounds_&&(e=this.contentNode)&&(this.cachedBounds_=v.TheoRect.fromXYWH(0,0,s.toDouble(e.pixelWidth),s.toDouble(e.pixelHeight))),s.opt(this.cachedBounds_,(function(e){return e.transform(t)}))},invalidateCachedBounds:function(){var t=new m.FormaBoundsInvalidatedEvent(this);this.beginUpdate(t),this.cachedBounds_=null,this.endUpdate(t)},getFocusRegion:function(){var t;return(t=s.opt(this.contentNode,(function(t){return t.focusRegion})))?t.transform(this.placement):null},getAverageEdge:function(t){var e,n=t.transform(this.placement.inverse);return(e=this.contentNode)?e.getAverageEdge(n):0},getFaceIntersections:function(t){var e,n,r=t.transform(this.placement.inverse);if((e=this.contentNode)&&(n=e.image)){var o=s.toDouble(n.getWidth())/s.toDouble(e.pixelWidth),i=s.toDouble(n.getHeight())/s.toDouble(e.pixelHeight);return n.getFaceIntersections(r.multiplyXY(o,i))}return 0},getAverageColor:function(t){var e;if((e=this.avgColorCache_.get(t.asString))&&!s.eq(C._equality_SolidColor_SolidColor,e,C.SolidColor.BLACK))return e;var n,r,o=t.transform(this.placement.inverse);if((n=this.contentNode)&&(r=n.image)){var i,a=s.toDouble(r.getWidth())/s.toDouble(n.pixelWidth),u=s.toDouble(r.getHeight())/s.toDouble(n.pixelHeight);if(i=r.getAverageColor(o.multiplyXY(a,u),s.as(this.style,E.ImageStyle)))return this.avgColorCache_.add(t.asString,i),i}return null},hasAlpha:function(){return null!=this.contentNode&&this.contentNode.hasAlpha},isImage:function(){return!0}}}),i)},kSRw:function(t,e,n){var r,o=e,i=n("oAGj"),a=n("fWxZ"),s=n("pnSN"),u=n("fNpk");o.SmartGroupForma=(r=function(){},i.defineClass({name:"SmartGroupForma",ctor:r,superName:"GroupForma",statics:{KIND:{get:function(){return"smart-group"}},PROPERTY_BOUNDS_DEPRECATED:"bounds",PROPERTY_CLIPMODE:"clipmode",SCHEMA_CLASS_NAME:{get:function(){return"SmartGroupForma"}},factory:{get:function(){return function(t,e,n,o){if(null!=e){var l=i.as(i.opt(i.opt(o,(function(t){return t.backLink})),(function(t){return t.dereference()})),s.GroupForma),c=i.as(i.opt(i.opt(o,(function(t){return t.backLink})),(function(t){return t.dereference()})),a.FormaPage);return u.LegacyCoreAssert.isTrue(null!=l||null!=c,"SmartGroupForma needs a parent group or page",void 0,"SmartGroupForma","SmartGroupForma.swift",28),null!=l?s.GroupForma.init_3144(t,e,n,l):s.GroupForma.init_7dbd(t,e,n,c)}return r.init_d1c9(t,n)}}},_implements:function(t){return"IDBObject"==t||"TheoMessageSubscriber"==t||"TheoMessagePublisher"==t}},props:{init_3144:function(t,e,n,r){i.super_init(this,s.GroupForma,s.GroupForma.prototype.init_3144,t,e,n,r)},init_7dbd:function(t,e,n,r){i.super_init(this,s.GroupForma,s.GroupForma.prototype.init_7dbd,t,e,n,r)},init_812f:function(t,e){for(var n={kind:function(){return r.KIND}},o=i.clone(e),a=i.iter(n);!a.done;a.next()){var u=a.key,l=a.value;null==e[u]&&(o[u]=l())}i.super_init(this,s.GroupForma,s.GroupForma.prototype.init_812f,t,o)},init_7fcf:function(t,e){var n={kind:e};this.init_812f(t,n)},init_d1c9:function(t,e){i.super_init(this,s.GroupForma,s.GroupForma.prototype.init_d1c9,t,e)},className:{get:function(){return r.SCHEMA_CLASS_NAME}}}}),r)},pnSN:function(t,e,n){var r,o=e,i=n("oAGj"),a=n("13MC"),s=n("FNB+"),u=n("fWxZ"),l=n("QbzR"),c=n("P83h"),h=n("9Lk3"),d=n("ZK0l"),m=n("fNpk"),f=n("c+uM"),p=n("tGKA"),g=n("Quhx"),_=n("8t9B"),E=n("sIWg");o.GroupForma=(r=function(){this.cachedChildren_=null,this.cachedAuxiliaries_=null},i.defineClass({name:"GroupForma",ctor:r,superName:"Forma",statics:{KIND:{get:function(){return"group"}},PROPERTY_BOUNDS:"bounds",PROPERTY_CHILDREN:"children",OLD_PROPERTY_CHARSTYLES:"character-styles",OLD_PROPERTY_CHARSTYLERANGES:"charstyle-ranges",SCHEMA_CLASS_NAME:{get:function(){return"GroupForma"}},factory:{get:function(){var t;return function(e,n,o,a){if(null!=n){var s=i.as(i.opt(i.opt(a,(function(t){return t.backLink})),(function(t){return t.dereference()})),g.PostDCXObject),l=i.as(s,r),c=(t=i.as(s,u.FormaPage))||null!=t?t:i.opt(l,(function(t){return t.page}));return m.LegacyCoreAssert.isTrue(null!=c,"GroupForma needs a parent page",void 0,"GroupForma","GroupForma.swift",27),null!=l?r.init_3144(e,n,o,l):r.init_7dbd(e,n,o,c)}return r.init_d1c9(e,o)}}},childrenPostOrder:function(t,e,n){for(var r=null,o=0,a=e.childCount,u=e.auxiliaryCount,l=i.iter(i.range(0,e.childCount,!1));!l.done;l.next()){var c=l.value;if(null!=(r=e.childAt(c).visit(t,(function(t,e,r){return n(t,e+1,(o+=1)-1)}))))return r}if(t==s.FormaTraversal.PostOrderWithAuxiliaries)for(var h=i.iter(i.range(0,e.auxiliaryCount,!1));!h.done;h.next())if(c=h.value,null!=(r=e.auxiliaryAt(c).visit(t,(function(t,e,r){return n(t,e+1,(o+=1)-1)}))))return r;return m.LegacyCoreAssert.isTrue(a<=e.childCount,"this function should not delete any children",void 0,"GroupForma.childrenPostOrder","GroupForma.swift",770),m.LegacyCoreAssert.isTrue(u<=e.auxiliaryCount,"this function should not delete any auxiliaries",void 0,"GroupForma.childrenPostOrder","GroupForma.swift",771),n(e,0,o)?e:r},childrenPreOrder:function(t,e,n){var r=null,o=0;if(n(e,0,o))return e;for(var a=e.childCount,u=e.auxiliaryCount,l=i.iter(i.range(0,e.childCount,!1));!l.done;l.next()){var c=l.value;if(null!=(r=e.childAt(c).visit(t,(function(t,e,r){return n(t,e+1,(o+=1)-1)}))))return r}if(t==s.FormaTraversal.PreOrderWithAuxiliaries)for(var h=i.iter(i.range(0,e.auxiliaryCount,!1));!h.done;h.next())if(c=h.value,null!=(r=e.auxiliaryAt(c).visit(t,(function(t,e,r){return n(t,e+1,(o+=1)-1)}))))return r;return m.LegacyCoreAssert.isTrue(a<=e.childCount,"this function should not delete any children",void 0,"GroupForma.childrenPreOrder","GroupForma.swift",816),m.LegacyCoreAssert.isTrue(u<=e.auxiliaryCount,"this function should not delete any auxiliaries",void 0,"GroupForma.childrenPreOrder","GroupForma.swift",817),r},childrenOnly:function(t,e){for(var n=i.iter(i.range(0,t.childCount,!1));!n.done;n.next()){var r=n.value,o=t.childAt(r);if(e(o,1,r))return o}return null},childrenAndAuxiliaries:function(t,e){var n;return(n=r.childrenOnly(t,e))?n:r.auxiliariesOnly(t,e)},auxiliariesOnly:function(t,e){for(var n=i.iter(i.range(0,t.auxiliaryCount,!1));!n.done;n.next()){var r,o=n.value;if((r=t.auxiliaryAt(o))&&e(r,1,o))return r}return null},_implements:function(t){return"IDBObject"==t||"TheoMessageSubscriber"==t||"TheoMessagePublisher"==t}},props:{init_3144:function(t,e,n,r){i.super_init(this,s.Forma,s.Forma.prototype.init_3144,t,e,n,r)},init_7dbd:function(t,e,n,r){i.super_init(this,s.Forma,s.Forma.prototype.init_7dbd,t,e,n,r)},init_812f:function(t,e){for(var n={kind:function(){return r.KIND},children:function(){return[]}},o=i.clone(e),a=i.iter(n);!a.done;a.next()){var u=a.key,l=a.value;null==e[u]&&(o[u]=l())}i.super_init(this,s.Forma,s.Forma.prototype.init_812f,t,o)},init_7fcf:function(t,e){var n={kind:e};this.init_812f(t,n)},init_d1c9:function(t,e){i.super_init(this,s.Forma,s.Forma.prototype.init_d1c9,t,e)},destroy:function(){s.Forma.prototype.destroy.call(this);for(var t=i.iter(this.children_);!t.done;t.next())t.value.destroy();for(var e=i.iter(this.auxiliaries_);!e.done;e.next())e.value.destroy()},className:{get:function(){return r.SCHEMA_CLASS_NAME}},updateEventForProperty:function(t){return t==r.PROPERTY_BOUNDS?new c.FormaGeometryChangedEvent(this):t==r.PROPERTY_CHILDREN?new c.FormaHierarchyChangedEvent(this):s.Forma.prototype.updateEventForProperty.call(this,t)},postDecode:function(){var t;s.Forma.prototype.postDecode.call(this),this.populateChildrenAndAux(),this.controller instanceof _.TypeLockupController&&(t=i.as(this.style,f.LockupStyle))&&(t.wheelUsed=!1),this.controller instanceof h.GridController&&(this.validateOnSet=!0)},setProperty:function(t,e){s.Forma.prototype.setProperty.call(this,t,e),m.LegacyCoreAssert.isTrue(null!=this.getProperty(s.Forma.PROPERTY_KIND),"Group forma missing kind; base state inaccessible",{id:this.id},"GroupForma.setProperty","GroupForma.swift",119),m.LegacyCoreAssert.isTrue(null!=this.getProperty(g.PostDCXObject.PROPERTY_PATH),"Group forma missing path; base state inaccessible",{id:this.id},"GroupForma.setProperty","GroupForma.swift",120)},charStylesArray_:{get:function(){var t,e=null;if(t=i.opt(this.getProperty(r.OLD_PROPERTY_CHARSTYLES),(function(t){return t.dictionaryValue}))){e={};for(var n=i.iter(t);!n.done;n.next()){var o,a=n.key,s=n.value;(o=i.as(l.FormaStyle.codec.decode(s,this),f.LockupStyle))&&(e[a]=o)}}return e}},charStylesRangesArray:{get:function(){var t,e=null;if(t=i.opt(this.getProperty(r.OLD_PROPERTY_CHARSTYLERANGES),(function(t){return t.dictionaryValue}))){e={};for(var n=i.iter(t);!n.done;n.next()){var o=n.key,a=n.value,s=i.clone(a.arrayValue);if(null!=s){var u=s.map((function(t){return t.intValue}),this).filter((function(t){return null!=t}),this).map((function(t){return t}),this);e[o]=i.clone(u)}}}return e}},bounds_:{get:function(){return i.as(this.get(r.PROPERTY_BOUNDS),E.TheoRect)},set:function(t){this.set(r.PROPERTY_BOUNDS,t)}},children_:{get:function(){return this.populateChildrenAndAux(),this.cachedChildren_}},populateChildrenAndAux:function(){var t,e=null==this.cachedChildren_,n=null==this.cachedAuxiliaries_;if((e||n)&&(this.cachedChildren_=this.cachedChildren_||[],this.cachedAuxiliaries_=this.cachedAuxiliaries_||[],t=i.as(this.get(r.PROPERTY_CHILDREN),["Array",s.Forma])))for(var o=i.iter(t);!o.done;o.next()){var a=o.value,u=a.hasTag(s.Forma.TAG_IS_AUXILIARY);e&&!u?i.opt(this.cachedChildren_,(function(t){return t.push(a)})):n&&u&&i.opt(this.cachedAuxiliaries_,(function(t){return t.push(a)}))}},auxiliaries_:{get:function(){return this.populateChildrenAndAux(),this.cachedAuxiliaries_}},flushChildren:function(){if(null!=this.cachedChildren_||null!=this.cachedAuxiliaries_){m.LegacyCoreAssert.isTrue(i.is(this.state,a.IDBObjectMutableState),"flushChildren - group state not mutable!",void 0,"GroupForma.flushChildren","GroupForma.swift",200);var t,e,n=[];if((t=this.cachedChildren_)&&(n=t.concat()),e=this.cachedAuxiliaries_)for(var o=i.iter(e);!o.done;o.next()){var s=o.value;n.push(s)}this.set(r.PROPERTY_CHILDREN,n)}},clearCache:function(){this.flushChildren(),s.Forma.prototype.clearCache.call(this),this.cachedChildren_=null,this.cachedAuxiliaries_=null},childrenAsArray:{get:function(){return this.children_.concat()}},willCommitState:function(){this.flushChildren(),s.Forma.prototype.willCommitState.call(this)},willChangeState:function(t){var e=this;s.Forma.prototype.willChangeState.call(this,t),i.keys(t).includes(r.PROPERTY_CHILDREN)&&(i.opt(this.cachedChildren_,(function(t){return t.forEach((function(t){t.parent===e&&t.setParent(null)}))})),this.cachedChildren_=null,i.opt(this.cachedAuxiliaries_,(function(t){return t.forEach((function(t){t.parent===e&&t.setParent(null)}))})),this.cachedAuxiliaries_=null)},didChangeState:function(t){var e,n=this;i.keys(t).includes(r.PROPERTY_CHILDREN)&&(m.LegacyCoreAssert.isTrue(null==this.cachedChildren_,"Re-get of children happened while trying to change states",void 0,"GroupForma.didChangeState","GroupForma.swift",259),m.LegacyCoreAssert.isTrue(null==this.cachedAuxiliaries_,"Re-get of auxiliaries happened while trying to change states",void 0,"GroupForma.didChangeState","GroupForma.swift",260),this.cachedChildren_=null,this.cachedAuxiliaries_=null,(e=i.as(this.get(r.PROPERTY_CHILDREN),["Array",s.Forma]))&&e.forEach((function(t){return t.setParent(n,null==t.parent||t.parent!=n)}))),s.Forma.prototype.didChangeState.call(this,t)},setParent:function(t,e){if(void 0===e&&(e=!1),s.Forma.prototype.setParent.call(this,t,!1),e)for(var n=i.iter(this.childrenAsArray);!n.done;n.next())n.value.setParent(this,!0)},state:{get:function(){return s.Forma._getters.state.call(this)},set:function(t){i.is(s.Forma._getters.state.call(this),a.IDBObjectMutableState)&&this.flushChildren(),s.Forma._setters.state.call(this,t)}},bounds:{get:function(){return null!=this.bounds_?this.bounds_:this.childrenBoundsInCoordSpace(p.Matrix2D.Identity)},set:function(t){var e=this;if(!(null!=t&&null!=this.bounds_&&t.equal(this.bounds_)||null==t&&null==this.bounds_)){var n=new c.FormaGeometryChangedEvent(this);this.beginUpdate(n),i.opt(i.as(this.controller,d.GroupController),(function(t){return t.beginUpdateGroup(e.bounds_)})),this.bounds_=t,i.opt(i.as(this.controller,d.GroupController),(function(t){return t.updateGroup()})),i.opt(i.as(this.controller,d.GroupController),(function(t){return t.endUpdateGroup()})),this.endUpdate(n)}}},setBounds:{get:function(){return this.bounds_}},contentID:{get:function(){if(null!=(r=s.Forma._getters.contentID.call(this)))return r;var t=[];if(this.visit(s.FormaTraversal.JustChildren,(function(e,n,r){var o;return null!=(o=e.contentID)&&t.push(o),!1})),0==t.length)return null;i.sortInPlace(t);for(var e="",n=i.iter(t);!n.done;n.next()){var r;e+=r=n.value}return e}},match:function(t){if(s.Forma.prototype.match.call(this,t),!this.bounds.equal(t.bounds))if(null!=this.controller&&this.controller.maintainAspectRatio){var e=t.bounds.fitAspectRatioWithin(this.bounds.aspectRatio);this.bounds=E.TheoRect.fromXYWH(t.bounds.minX,t.bounds.minY,e.width,e.height)}else this.bounds=t.bounds},visit:function(t,e){switch(t){case 1:case 7:return r.childrenPreOrder(t,this,e);case 2:case 8:return r.childrenPostOrder(t,this,e);case 6:return r.childrenOnly(this,e);case 9:return r.auxiliariesOnly(this,e);case 10:return r.childrenAndAuxiliaries(this,e);default:return s.Forma.prototype.visit.call(this,t,e)}},insertChildrenInternal:function(t,e,n){if(e<0||e>this.children_.length)m.LegacyCoreAssert.fail("insertChildrenInternal: invalid index",{index:e},"GroupForma.insertChildrenInternal","GroupForma.swift",400);else{for(var r=i.iter(t);!r.done;r.next())if((u=r.value).page.uuid!=this.page.uuid)return void m.LegacyCoreAssert.fail("insertChildrenAt: attempting to insert children from a different page",void 0,"GroupForma.insertChildrenInternal","GroupForma.swift",407);var o=new c.FormaInsertedChildrenEvent(this,t,e);this.beginUpdate(o),this.makeMutable();for(var a=e,s=i.iter(t);!s.done;s.next()){var u,l=(u=s.value).totalPlacement,h=a;if(null!=u.parent&&(u.parent!=this?u.parent.removeChild(u):(a>0&&a==this.children_.length&&(h-=1),i.remove(this.children_,u))),u.setParent(this),this.children_.splice(h,0,u),a+=1,n){var d=u.totalPlacement;d.equal(l)||u.move(p.Matrix2D.concat2(d.inverse,l))}}this.endUpdate(o)}},insertChildrenAt:function(t,e,n){void 0===n&&(n=!1),this.insertChildrenInternal(t,e,n)},appendChild:function(t,e){void 0===e&&(e=!1);var n=[];n.push(t),this.insertChildrenInternal(n,this.children_.length,e)},appendChildren:function(t,e){void 0===e&&(e=!1),this.insertChildrenAt(t,this.children_.length,e)},insertBefore:function(t,e,n){void 0===n&&(n=!1),null==e?this.insertChildAt(t,this.children_.length,n):e.parent!==this?(m.LegacyCoreAssert.fail("insertBefore: refForma must be a child of this forma; appending",void 0,"GroupForma.insertBefore","GroupForma.swift",467),this.insertChildAt(t,this.children_.length,n)):this.insertChildAt(t,i.indexOfEq(this.children_,e,s._equality_Forma_Forma),n)},insertChildAt:function(t,e,n){void 0===n&&(n=!1);var r=[];r.push(t),this.insertChildrenAt(r,e,n)},removeChildrenAt:function(t,e){if(t<0||e<0||t+e>this.children_.length)m.LegacyCoreAssert.fail("removeChildrenAt: Invalid index or count",{index:t,count:e},"GroupForma.removeChildrenAt","GroupForma.swift",482);else if(0==e);else{var n=this.children_.slice(t,t+e),r=new c.FormaRemovedChildrenEvent(this,n,t);this.beginUpdate(r),this.makeMutable();for(var o=i.iter(n);!o.done;o.next())o.value.setParent(null);this.children_.splice(t,e),this.endUpdate(r)}},removeChild:function(t){var e;null!=(e=i.indexOfEq(this.children_,t,s._equality_Forma_Forma))?this.removeChildAt(e):m.LegacyCoreAssert.fail("Child is not part of this group",void 0,"GroupForma.removeChild","GroupForma.swift",505)},removeChildAt:function(t){this.removeChildrenAt(t,1)},removeAllChildren:function(){this.removeChildrenAt(0,this.children_.length)},indexOfChild:function(t){return i.indexOfEq(this.children_,t,s._equality_Forma_Forma)},indexOfTop:function(t){for(var e=-1,n=i.iter(i.range(0,this.childCount,!1).reversed());!n.done;n.next()){var r=n.value;if(t(this.childAt(r))){e=r;break}}return e},findDescendant:function(t){for(var e=i.iter(this.children_);!e.done;e.next()){var n,o,a=e.value;if(t(a))return a;if((n=i.as(a,r))&&(o=n.findDescendant(t)))return o}return null},findChild:function(t){return this.children_.find(t,this)},childAt:function(t){return m.LegacyCoreAssert.isTrue(t>=0&&t<this.children_.length,"requested for child at out of range index",void 0,"GroupForma.childAt","GroupForma.swift",553),t>=0&&t<this.children_.length?this.children_[t]:null},childCount:{get:function(){return this.children_.length}},boundsInCoordSpace:function(t){return null!=this.bounds_?this.bounds_.transform(t):this.childrenBoundsInCoordSpace(t)},childrenFinalFrame:{get:function(){return this.childrenBoundsInCoordSpace(this.totalPlacement)}},childrenFrame:{get:function(){return this.childrenBoundsInCoordSpace(this.placement)}},childrenBoundsInCoordSpace:function(t){var e=null;return this.children_.forEach((function(n){var o;if(o=i.as(n,r))e=E.TheoRect.unionOf(e,o.childrenBoundsInCoordSpace(n.placement.concat(t)));else if(!n.isFullCanvas){var a=n.boundsInCoordSpace(n.placement.concat(t));e=E.TheoRect.unionOf(e,a)}})),e},auxiliaryCount:{get:function(){return this.auxiliaries_.length}},auxiliaryAt:function(t){return m.LegacyCoreAssert.isTrue(t>=0&&t<this.auxiliaries_.length,"requested for auxiliary at out of range index",void 0,"GroupForma.auxiliaryAt","GroupForma.swift",604),t>=0&&t<this.auxiliaries_.length?this.auxiliaries_[t]:null},indexOfAuxiliary:function(t){return i.indexOfEq(this.auxiliaries_,t,s._equality_Forma_Forma)},findAuxiliary:function(t){return this.auxiliaries_.find(t,this)},appendAuxiliary:function(t){var e=[];e.push(t),this.insertAuxiliaryInternal(e,this.auxiliaries_.length)},removeAuxiliary:function(t){var e;null!=(e=i.indexOfEq(this.auxiliaries_,t,s._equality_Forma_Forma))?this.removeAuxiliaryAt(e):m.LegacyCoreAssert.fail("Auxiliary is not part of this group",void 0,"GroupForma.removeAuxiliary","GroupForma.swift",632)},removeAuxiliaryAt:function(t){this.removeAuxiliariesAt(t,1)},removeAuxiliariesAt:function(t,e){if(t<0||e<0||t+e>this.auxiliaries_.length)m.LegacyCoreAssert.fail("removeAuxiliariesAt: Invalid index or count",{index:t,count:e},"GroupForma.removeAuxiliariesAt","GroupForma.swift",642);else if(e>0){var n=this.auxiliaries_.slice(t,t+e),r=new c.FormaRemovedAuxiliariesEvent(this,n,t);this.beginUpdate(r),this.makeMutable();for(var o=i.iter(n);!o.done;o.next())o.value.setParent(null);this.auxiliaries_.splice(t,e),this.endUpdate(r)}},insertAuxiliaryInternal:function(t,e){if(e<0||e>this.auxiliaries_.length)m.LegacyCoreAssert.fail("insertAuxiliaryInternal: invalid index",{index:e},"GroupForma.insertAuxiliaryInternal","GroupForma.swift",661);else{for(var n=i.iter(t);!n.done;n.next()){if((u=n.value).page.uuid!=this.page.uuid)return void m.LegacyCoreAssert.fail("insertAuxiliaryInternal: attempting to insert formae from a different page",void 0,"GroupForma.insertAuxiliaryInternal","GroupForma.swift",668);u.setTag(s.Forma.TAG_IS_AUXILIARY)}var r=new c.FormaInsertedAuxiliariesEvent(this,t,e);this.beginUpdate(r),this.makeMutable();for(var o=e,a=i.iter(t);!a.done;a.next()){var u,l;(l=(u=a.value).parent)&&(l!=this?l.removeAuxiliary(u):i.remove(this.auxiliaries_,u)),o>this.auxiliaries_.length&&(o=this.auxiliaries_.length),u.setParent(this),this.auxiliaries_.splice(o,0,u),o+=1}this.endUpdate(r)}},isImage:function(){return this.children_.length>0&&null==this.children_.find((function(t){return!t.isImage()}),this)},isGraphic:function(){return this.children_.length>0&&null==this.children_.find((function(t){return!t.isGraphic()}),this)},isText:function(){return this.children_.length>0&&null==this.children_.find((function(t){return!t.isText()}),this)},isShape:function(){return this.children_.length>0&&null==this.children_.find((function(t){return!t.isShape()}),this)},isVideo:function(){return this.children_.length>0&&null==this.children_.find((function(t){return!t.isVideo()}),this)},isLogo:function(){return this.children_.length>0&&null==this.children_.find((function(t){return!t.isLogo()}),this)},isSticker:function(){return this.children_.length>0&&null==this.children_.find((function(t){return!t.isSticker()}),this)}}}),r)},ylxa:function(t,e,n){var r,o,i=e,a=n("oAGj"),s=n("fWxZ"),u=n("fNpk"),l=n("1NAc");i.PageExportFormat=a.defineEnum("PageExportFormat",{PIXELS:0,MILLIMETERS:1,INCHES:2}),i.describePageExportFormat=function(t){switch(t){case 0:return"pixels";case 1:return"millimeters";case 2:return"inches"}},i.FormaPageExportData=(r=function(t,e,n){void 0===n&&(n=null),this.dimensions_=t,this.format_=e,this.ppi_=n,null!=n||e!=i.PageExportFormat.MILLIMETERS&&e!=i.PageExportFormat.INCHES||u.LegacyCoreAssert.fail("Must specify ppi for mm or inches",void 0,"FormaPageExportData.init","FormaPageExportData.swift",49)},o={},a.defineClass({name:"FormaPageExportData",ctor:r,superName:"CoreObject",statics:{PROPERTY_DIMENSIONS:"dimensions",PROPERTY_FORMAT:"format",PROPERTY_PPI:"ppi",MM_TO_INCHES:{get:function(){return void 0===o.MM_TO_INCHES&&(o.MM_TO_INCHES=1/25.4),o.MM_TO_INCHES}},POINTS_PER_INCH:72,DEFAULT_PPI:300,exportPixels:function(t){return new r(t,i.PageExportFormat.PIXELS,null)},exportInches:function(t,e){return new r(t,i.PageExportFormat.INCHES,e)},exportMillimeters:function(t,e){return new r(t,i.PageExportFormat.MILLIMETERS,e)},decodeJson:function(t){var e;if(null==t)return null;var n=a.as(t,["Dictionary","String","Any"]);if(null==n)return u.LegacyCoreAssert.fail("FormaPageExportData.decodeJSON : object passed isn't a dictionary",void 0,"FormaPageExportData.decodeJson","FormaPageExportData.swift",128),null;var o,s,c,h=null,d=i.PageExportFormat.PIXELS,m=l.TheoSize.Zero;return(o=l.TheoSize.decodeJson(a.as(n[r.PROPERTY_DIMENSIONS],"AnyObject")))&&(m=o),null!=(s=a.as(n[r.PROPERTY_FORMAT],"Int"))?d=(e=i.PageExportFormat.toCaseValue(s))||null!=e?e:i.PageExportFormat.PIXELS:u.LegacyCoreAssert.fail("Must have format encoded",void 0,"FormaPageExportData.decodeJson","FormaPageExportData.swift",144),null!=(c=a.as(n[r.PROPERTY_PPI],"Double"))&&(h=c),new r(m,d,h)}},props:{dimensions:{get:function(){return this.dimensions_}},format:{get:function(){return this.format_}},PPI:{get:function(){return null==this.ppi?s.FormaPage.DEFAULT_CUSTOM_SIZE_PPI:this.ppi_}},ppi:{get:function(){return this.ppi_}},pixelDimensions:{get:function(){return this.format_==i.PageExportFormat.MILLIMETERS?this.dimensions_.multiply(r.MM_TO_INCHES*this.ppi_):this.format_==i.PageExportFormat.INCHES?this.dimensions_.multiply(this.ppi_):(u.LegacyCoreAssert.isTrue(this.format_==i.PageExportFormat.PIXELS,"unexpected page export format",{format:this.format_},"FormaPageExportData","FormaPageExportData.swift",87),this.dimensions_)}},pointDimensions:{get:function(){return this.format_==i.PageExportFormat.MILLIMETERS?this.dimensions_.multiply(r.MM_TO_INCHES*r.POINTS_PER_INCH):this.format_==i.PageExportFormat.INCHES?this.dimensions_.multiply(r.POINTS_PER_INCH):(u.LegacyCoreAssert.isTrue(this.format_==i.PageExportFormat.PIXELS,"unexpected page export format",{format:this.format_},"FormaPageExportData","FormaPageExportData.swift",104),this.dimensions_)}},encodeJson:function(){var t={};return t[r.PROPERTY_DIMENSIONS]=this.dimensions_.encodeJson(),t[r.PROPERTY_FORMAT]=this.format_,null!=this.ppi_&&(t[r.PROPERTY_PPI]=this.ppi_),t}}}),r)},zjod:function(t,e,n){var r,o=e,i=n("oAGj"),a=n("fWxZ"),s=n("P83h"),u=n("pnSN"),l=n("Qlvz"),c=n("fdtz"),h=n("uWOl"),d=n("fNpk"),m=n("9YN4"),f=n("RkYL"),p=n("fGVU"),g=n("sW6f"),_=n("QTen");o.VideoPlayerStatus=i.defineEnum("VideoPlayerStatus",{stopped:0,playing:1}),o.VideoMode=i.defineEnum("VideoMode",{stillImage:0,playback:1,publish:2,trim:3}),o.VideoForma=(r=function(){this.cachedVideoContent_=null,this.currentTime_=f.TheoTime.Zero,this.playerStatus_=o.VideoPlayerStatus.stopped,this.mode_=o.VideoMode.stillImage},i.defineClass({name:"VideoForma",ctor:r,superName:"ImageForma",statics:{KIND:{get:function(){return"Video"}},PROPERTY_VIDEO_CONTENTID:"video-content-id",SCHEMA_CLASS_NAME:{get:function(){return"VideoForma"}},factory:{get:function(){return function(t,e,n,o){if(null!=e){var s=i.as(i.opt(i.opt(o,(function(t){return t.backLink})),(function(t){return t.dereference()})),u.GroupForma),l=i.as(i.opt(i.opt(o,(function(t){return t.backLink})),(function(t){return t.dereference()})),a.FormaPage);return d.LegacyCoreAssert.isTrue(null!=s||null!=l,"VideoForma needs a parent group or page",void 0,"VideoForma","VideoForma.swift",45),null!=s?r.init_3144(t,e,n,s):r.init_7dbd(t,e,n,l)}return r.init_d1c9(t,n)}}},_implements:function(t){return"IDBObject"==t||"TheoMessageSubscriber"==t||"TheoMessagePublisher"==t}},props:{init_3144:function(t,e,n,r){i.super_init(this,c.ImageForma,c.ImageForma.prototype.init_3144,t,e,n,r)},init_7dbd:function(t,e,n,r){i.super_init(this,c.ImageForma,c.ImageForma.prototype.init_7dbd,t,e,n,r)},init_812f:function(t,e){for(var n={kind:function(){return r.KIND},style:function(){return _.VideoStyle.createDefault()}},o=i.clone(e),a=i.iter(n);!a.done;a.next()){var s=a.key,u=a.value;null==e[s]&&(o[s]=u())}i.super_init(this,c.ImageForma,c.ImageForma.prototype.init_812f,t,o)},init_7186:function(t){var e={kind:r.KIND,style:_.VideoStyle.createDefault()};this.init_812f(t,e)},init_d1c9:function(t,e){i.super_init(this,c.ImageForma,c.ImageForma.prototype.init_d1c9,t,e)},getFrameForTime:function(t){var e;if(e=this.videoContentNode){if(0==e.times.length)return 0;var n=i.opt(this.animation,(function(t){return t.startTime}))||e.times[0],r=e.times[e.times.length-1],o=i.opt(this.animation,(function(t){return t.endTime}))||r;if(t.seconds>o.seconds)return e.times.length-1;if(t.seconds-n.seconds<=0)return 0;var a=t.subtract(n),s=new f.TheoTime(i.toInt(a.seconds*i.toDouble(r.timescale))%r.value,r.timescale);if(s.value<e.times[0].value)return 0;for(var u=i.iter(i.range(0,e.times.length-1,!1));!u.done;u.next()){var l=u.value;if(s.value>=e.times[l].value&&s.value<e.times[l+1].value)return l+1}return e.times.length-1}return 0},decodeController:function(){var t;null==this.controller&&(t=i.opt(this.page.document,(function(t){return t.controller})))&&(this.controller=t.controllerFactory.createController(p.VideoController.KIND,this)),c.ImageForma.prototype.decodeController.call(this)},className:{get:function(){return r.SCHEMA_CLASS_NAME}},updateEventForProperty:function(t){return t==r.PROPERTY_VIDEO_CONTENTID?new s.FormaContentChangedEvent(this):c.ImageForma.prototype.updateEventForProperty.call(this,t)},isVideo:function(){return!0},isSticker:function(){var t,e;return!!((t=this.videoContentNode)&&(e=i.opt(this.parent,(function(t){return t.controller})))&&t.isGIF&&e.moveable)},videoContentNode:{get:function(){var t,e;null!=(t=this.videoContentID)&&((!(e=this.cachedVideoContent_)||e.id!=t)&&(this.cachedVideoContent_=i.as(i.opt(this.page.document,(function(e){return e.content.nodeByID(t)})),g.VideoContentNode)));return this.cachedVideoContent_},set:function(t){var e=new s.FormaContentChangedEvent(this);this.beginUpdate(e),this.cachedVideoContent_=t,this.set(r.PROPERTY_VIDEO_CONTENTID,i.opt(t,(function(t){return t.id}))),this.endUpdate(e)}},videoContentID:{get:function(){return i.as(this.get(r.PROPERTY_VIDEO_CONTENTID),"String")}},currentTime:{get:function(){return this.currentTime_},set:function(t){if(t!=this.currentTime_){var e=new s.FormaVideoTimeChangedEvent(this);this.beginUpdate(e),this.currentTime_=t,this.endUpdate(e)}}},videoPlayerStatus:{get:function(){return this.playerStatus_},set:function(t){if(t!=this.playerStatus_){var e=new s.FormaVideoStateChangedEvent(this);this.beginUpdate(e),this.playerStatus_=t,this.endUpdate(e)}}},mode:{get:function(){return this.mode_},set:function(t){if(t!=this.mode_){var e=new s.FormaVideoStateChangedEvent(this);this.beginUpdate(e),this.mode_=t,this.endUpdate(e)}}},setVideoPlayerStatusAndMode:function(t,e,n){if(n||t!=this.playerStatus_||e!=this.mode_){var r=new s.FormaVideoStateChangedEvent(this);this.beginUpdate(r),this.mode_=e,this.playerStatus_=t,this.endUpdate(r)}},forceStateChange:function(){var t=new s.FormaVideoStateChangedEvent(this);this.beginUpdate(t),this.endUpdate(t)},postDecode:function(){var t,e,n=this;if(c.ImageForma.prototype.postDecode.call(this),e=i.as(this.style,h.ImageStyle)){if(!(this.style instanceof _.VideoStyle)){var r=(t=i.opt(this.page.document,(function(t){return t.versionDecoded.vers})))||null!=t?t:0;d.LegacyCoreAssert.isTrue(r<m.TheoDocumentVersion.VideoSupport,"Why is there no VideoStyle for VideoForma",{version:i.toString(r)},"VideoForma.postDecode","VideoForma.swift",277);var o,a,s=_.VideoStyle.createDefault();(o=this.videoContentNode)&&(s.duration=o.duration),(a=s.mergeWithImageStyle(e))&&this.protectedSetStyle(a),i.opt(this.videoContentNode,(function(t){return null==t.mediaMetadata&&i.opt(n.contentNode,(function(t){return null!=t.mediaMetadata}))}))&&i.opt(this.videoContentNode,(function(t){return t.mediaMetadata=i.opt(n.contentNode,(function(t){return t.mediaMetadata}))}))}e.filter=null,e.adjustments=l.ImageAdjustments.createDefault(),e.name=h.ImageStyle.DEFAULT_NAME}},canApplyStyle:function(t){return c.ImageForma.prototype.canApplyStyle.call(this,t)&&t instanceof _.VideoStyle},applyStyle:function(t){var e,n,r;(e=i.as(t,h.ImageStyle))&&(n=i.as(this.style,_.VideoStyle))&&(r=n.mergeWithImageStyle(e))&&(r.filter=null,r.adjustments=l.ImageAdjustments.createDefault(),r.name=h.ImageStyle.DEFAULT_NAME,this.internalSetStyle(r))},resetToStartTime:function(){var t;if(t=i.as(this.style,_.VideoStyle)){var e=t.startTime;if(e!=this.currentTime_){var n=new s.FormaVideoStateChangedEvent(this);this.beginUpdate(n),this.currentTime_=e,this.endUpdate(n)}}}}}),r)}}]);
//# sourceMappingURL=vendors_npm_spark_989c2140-577a4ca6.js.map