(window.webpackJsonp=window.webpackJsonp||[]).push([["search-controller"],{1053:function(e,t,s){var r,i;r=[s(7),s(2),s(6),s(1)],void 0===(i=function(e,t,s,r){"use strict";return new(s.Model.extend({isClipboardSupported:function(){return document.queryCommandSupported("copy")},copyFieldToClipboard:function(e){var t;e.select();try{document.execCommand("copy")||(t="execCommand returned false")}catch(s){t="caught-error: "+s.message,window.marvel.logger.debug("Clipboard copy error:"+s.message,s)}if(t)throw new Error("Could not copy string to clipboard: "+t)},copyStringToClipboard:function(t){var s=e("<input>");s.css({position:"absolute",transform:"translateX(-5000px)"}),e("body").append(s),s.val(t);try{this.copyFieldToClipboard(s)}finally{s.remove()}}}))}.apply(t,r))||(e.exports=i)},1384:function(e,t,s){e.exports=function(){var e=[],t=[],s={},r={},i={};function a(e){return"string"==typeof e?new RegExp("^"+e+"$","i"):e}function l(e,t){return e===t?t:e===e.toUpperCase()?t.toUpperCase():e[0]===e[0].toUpperCase()?t.charAt(0).toUpperCase()+t.substr(1).toLowerCase():t.toLowerCase()}function o(e,t){return e.replace(/\$(\d{1,2})/g,(function(e,s){return t[s]||""}))}function n(e,t){return e.replace(t[0],(function(s,r){var i=o(t[1],arguments);return l(""===s?e[r-1]:s,i)}))}function h(e,t,r){if(!e.length||s.hasOwnProperty(e))return t;for(var i=r.length;i--;){var a=r[i];if(a[0].test(t))return n(t,a)}return t}function c(e,t,s){return function(r){var i=r.toLowerCase();return t.hasOwnProperty(i)?l(r,i):e.hasOwnProperty(i)?l(r,e[i]):h(i,r,s)}}function d(e,t,s,r){return function(r){var i=r.toLowerCase();return!!t.hasOwnProperty(i)||!e.hasOwnProperty(i)&&h(i,i,s)===i}}function u(e,t,s){return(s?t+" ":"")+(1===t?u.singular(e):u.plural(e))}return u.plural=c(i,r,e),u.isPlural=d(i,r,e),u.singular=c(r,i,t),u.isSingular=d(r,i,t),u.addPluralRule=function(t,s){e.push([a(t),s])},u.addSingularRule=function(e,s){t.push([a(e),s])},u.addUncountableRule=function(e){"string"!=typeof e?(u.addPluralRule(e,"$0"),u.addSingularRule(e,"$0")):s[e.toLowerCase()]=!0},u.addIrregularRule=function(e,t){t=t.toLowerCase(),e=e.toLowerCase(),i[e]=t,r[t]=e},[["I","we"],["me","us"],["he","they"],["she","they"],["them","them"],["myself","ourselves"],["yourself","yourselves"],["itself","themselves"],["herself","themselves"],["himself","themselves"],["themself","themselves"],["is","are"],["was","were"],["has","have"],["this","these"],["that","those"],["echo","echoes"],["dingo","dingoes"],["volcano","volcanoes"],["tornado","tornadoes"],["torpedo","torpedoes"],["genus","genera"],["viscus","viscera"],["stigma","stigmata"],["stoma","stomata"],["dogma","dogmata"],["lemma","lemmata"],["schema","schemata"],["anathema","anathemata"],["ox","oxen"],["axe","axes"],["die","dice"],["yes","yeses"],["foot","feet"],["eave","eaves"],["goose","geese"],["tooth","teeth"],["quiz","quizzes"],["human","humans"],["proof","proofs"],["carve","carves"],["valve","valves"],["looey","looies"],["thief","thieves"],["groove","grooves"],["pickaxe","pickaxes"],["whiskey","whiskies"]].forEach((function(e){return u.addIrregularRule(e[0],e[1])})),[[/s?$/i,"s"],[/[^\u0000-\u007F]$/i,"$0"],[/([^aeiou]ese)$/i,"$1"],[/(ax|test)is$/i,"$1es"],[/(alias|[^aou]us|tlas|gas|ris)$/i,"$1es"],[/(e[mn]u)s?$/i,"$1s"],[/([^l]ias|[aeiou]las|[emjzr]as|[iu]am)$/i,"$1"],[/(alumn|syllab|octop|vir|radi|nucle|fung|cact|stimul|termin|bacill|foc|uter|loc|strat)(?:us|i)$/i,"$1i"],[/(alumn|alg|vertebr)(?:a|ae)$/i,"$1ae"],[/(seraph|cherub)(?:im)?$/i,"$1im"],[/(her|at|gr)o$/i,"$1oes"],[/(agend|addend|millenni|dat|extrem|bacteri|desiderat|strat|candelabr|errat|ov|symposi|curricul|automat|quor)(?:a|um)$/i,"$1a"],[/(apheli|hyperbat|periheli|asyndet|noumen|phenomen|criteri|organ|prolegomen|hedr|automat)(?:a|on)$/i,"$1a"],[/sis$/i,"ses"],[/(?:(kni|wi|li)fe|(ar|l|ea|eo|oa|hoo)f)$/i,"$1$2ves"],[/([^aeiouy]|qu)y$/i,"$1ies"],[/([^ch][ieo][ln])ey$/i,"$1ies"],[/(x|ch|ss|sh|zz)$/i,"$1es"],[/(matr|cod|mur|sil|vert|ind|append)(?:ix|ex)$/i,"$1ices"],[/(m|l)(?:ice|ouse)$/i,"$1ice"],[/(pe)(?:rson|ople)$/i,"$1ople"],[/(child)(?:ren)?$/i,"$1ren"],[/eaux$/i,"$0"],[/m[ae]n$/i,"men"],["thou","you"]].forEach((function(e){return u.addPluralRule(e[0],e[1])})),[[/s$/i,""],[/(ss)$/i,"$1"],[/(wi|kni|(?:after|half|high|low|mid|non|night|[^\w]|^)li)ves$/i,"$1fe"],[/(ar|(?:wo|[ae])l|[eo][ao])ves$/i,"$1f"],[/ies$/i,"y"],[/\b([pl]|zomb|(?:neck|cross)?t|coll|faer|food|gen|goon|group|lass|talk|goal|cut)ies$/i,"$1ie"],[/\b(mon|smil)ies$/i,"$1ey"],[/(m|l)ice$/i,"$1ouse"],[/(seraph|cherub)im$/i,"$1"],[/(x|ch|ss|sh|zz|tto|go|cho|alias|[^aou]us|tlas|gas|(?:her|at|gr)o|ris)(?:es)?$/i,"$1"],[/(analy|ba|diagno|parenthe|progno|synop|the|empha|cri)(?:sis|ses)$/i,"$1sis"],[/(movie|twelve|abuse|e[mn]u)s$/i,"$1"],[/(test)(?:is|es)$/i,"$1is"],[/(alumn|syllab|octop|vir|radi|nucle|fung|cact|stimul|termin|bacill|foc|uter|loc|strat)(?:us|i)$/i,"$1us"],[/(agend|addend|millenni|dat|extrem|bacteri|desiderat|strat|candelabr|errat|ov|symposi|curricul|quor)a$/i,"$1um"],[/(apheli|hyperbat|periheli|asyndet|noumen|phenomen|criteri|organ|prolegomen|hedr|automat)a$/i,"$1on"],[/(alumn|alg|vertebr)ae$/i,"$1a"],[/(cod|mur|sil|vert|ind)ices$/i,"$1ex"],[/(matr|append)ices$/i,"$1ix"],[/(pe)(rson|ople)$/i,"$1rson"],[/(child)ren$/i,"$1"],[/(eau)x?$/i,"$1"],[/men$/i,"man"]].forEach((function(e){return u.addSingularRule(e[0],e[1])})),["adulthood","advice","agenda","aid","alcohol","ammo","anime","athletics","audio","bison","blood","bream","buffalo","butter","carp","cash","chassis","chess","clothing","cod","commerce","cooperation","corps","debris","diabetes","digestion","elk","energy","equipment","excretion","expertise","flounder","fun","gallows","garbage","graffiti","headquarters","health","herpes","highjinks","homework","housework","information","jeans","justice","kudos","labour","literature","machinery","mackerel","mail","media","mews","moose","music","manga","news","pike","plankton","pliers","pollution","premises","rain","research","rice","salmon","scissors","series","sewage","shambles","shrimp","species","staff","swine","tennis","traffic","transporation","trout","tuna","wealth","welfare","whiting","wildebeest","wildlife","you",/[^aeiou]ese$/i,/deer$/i,/fish$/i,/measles$/i,/o[iu]s$/i,/pox$/i,/sheep$/i].forEach(u.addUncountableRule),u}()},1748:function(e,t){e.exports='{{#inVbSearchHeader}}\n<div class="vb-search-header-background"></div>\n<div class="search-header-logo-and-back">\n    {{^inMainSearchHeader}}\n    <a class="mrvl-logo-link" href="/{{localePathPrefix}}"><p class="mrvl-logo" data-auto="brand-logo">{{header-title}}<span class="mrvl-logo-preload"></span></p></a>\n    {{/inMainSearchHeader}}\n    <button class="npw-visual-browse-header-back-arrow{{#backArrowText}} has-text{{/backArrowText}}" title="{{backArrowText}}" data-auto="npwfu-close-btn">{{backArrowText}}</button>\n</div>\n<div class="vb-search-header-short-v-filler"></div>\n{{#showFavoritesInHeader}}\n<div class="npw-visual-browser-header-favorites" data-id="favorites">{{npw-vg-search-results-header-button-favorites}}</div>\n{{/showFavoritesInHeader}}\n<div class="npw-visual-browse-header-create-new-dropdown">\n</div>\n<div class="npw-visual-browse-header-create-new-dropdown-v-spacer"></div>\n{{#formatFilters}}\n{{#filtersInHeader}}\n<div class="vb-search-header-filters-background {{#filtersInHeaderCss}}{{.}}{{/filtersInHeaderCss}}">\n<div class="vb-search-header-formats">\n{{#format}}\n{{^hide}}\n{{^sep}}\n<div class="vb-search-header-formats-format{{#selected}} selected{{/selected}}" data-id="{{id}}" data-app="{{#app}}{{.}}{{/app}}">{{label}}</div>\n{{/sep}}\n{{#sep}}\n<div class="vb-search-header-formats-format-sep">|</div>\n{{/sep}}\n{{/hide}}\n{{/format}}\n</div>\n</div>\n{{/filtersInHeader}}\n{{/formatFilters}}\n{{/inVbSearchHeader}}\n<div class="search-results-grid-view-holder hide {{#searchViewInContainer}} search-view-in-container search-view-common{{/searchViewInContainer}}" data-auto="search-results-grid-holder"></div>\n<div class="search-view hide{{^inMainSearchHeader}}{{#inVbSearchHeader}} in-vb-search-header{{/inVbSearchHeader}}{{/inMainSearchHeader}}{{#inMainSearchHeader}} in-main-search-header{{/inMainSearchHeader}}{{#searchViewInContainer}} search-view-in-container{{/searchViewInContainer}}{{#searchViewInHeader}} search-view-in-header{{/searchViewInHeader}}{{#searchViewBarOnly}} search-view-bar-only{{/searchViewBarOnly}}{{#searchParentHeightControl}} search-view-parent-height-control{{/searchParentHeightControl}}">\n    <div class="search-overlay hide" data-auto="search-view-search-overlay"></div>\n    <div class="search-top-container">\n        {{^searchViewNoBackground}}\n        <div class="search-bg-underlay{{#showUnderlay}} showing{{/showUnderlay}}"></div>\n        {{/searchViewNoBackground}}\n        <div class="search-bar{{#searchViewBarHasButton}} show-search-button{{/searchViewBarHasButton}}">\n\n        {{^inVbSearchHeader}}\n            <div class="search-input-library-dropdown">\n                <select name="search-input-library-select" class="search-input-library-select">\n                    <option value="featured">Featured</option>\n                    <option value="private">Your Libraries</option>\n                    <option value="shared">Shared with you</option>\n                    <option value="public">Public Libraries</option>\n                </select>\n            </div>\n        {{/inVbSearchHeader}}\n            <div class="search-libraries-breadcrumb hide">\n                <div class="search-libraries-breadcrumb-library-type"></div>\n                <div class="search-libraries-breadcrumb-caret-icon"></div>\n                <div class="search-libraries-breadcrumb-library"></div>\n            </div>\n            <div class="search-input-holder">\n                <div class="search-button" type="text" data-auto="search-view-search-input-search-button"></div>\n                <button class="search-input-escape-focus hide"></button>\n                <input class="search-input" placeholder="{{placeholder}}{{^placeholder}}{{npw-search-field-placeholder}}{{/placeholder}}" id="search-view-search-input" type="text" data-auto="search-view-search-input" autocomplete="off">\n                <button class="search-clear disabled" type="text" data-auto="search-view-search-input-search-button"></button>\n            </div>\n            <div class="search-input-tooltip-holder off">\n                <div class="search-input-tooltip"></div>\n            </div>\n            <div class="search-input-disabled hide" type="text"></div>\n            <div class="search-results hide" data-auto="search-view-results-menu"></div>\n            <div class="search-results-libraries hide"></div>\n            <div class="search-results-no-libraries hide">\n                <div class="no-libraries-image"></div>\n                <div class="no-libraries-title-text">{{imagepicker-ccl-no-libraries-title}}</div>\n                <p class="no-libraries-body-text">{{imagepicker-ccl-no-libraries-body}}</p>\n                <div class="libraries-learn-more"><a href="https://www.adobe.com/creativecloud/libraries.html" target="_blank">{{imagepicker-ccl-no-libraries-learn-more}}</a></div>\n            </div>\n        </div>\n        <div class="more-to-come shared"></div>\n        <div class="search-results-library-empty hide" data-auto="search-view-results-library-empty">\n            <div class="empty-library-templates-image"></div>\n            <div class="empty-library-templates-title-text"></div>\n            <div class="empty-library-templates-body-text"></div>\n            <div class="empty-library-templates-learn-more"></div>\n        </div>\n    </div>\n</div>\n'},2260:function(e,t,s){var r,i;r=[s(7),s(2),s(6),s(1),s(141),s(95),s(3526),s(3527),s(2708),s(47),s(0),s(25),s(14),s(1416),s(3529),s(3535),s(386),s(207),s(836)],void 0===(i=function(e,t,s,r,i,a,l,o,n,h,c,d,u,g,m,p,f,v,w){"use strict";var b={DROPDOWN_FEAT_TEMPLATES:"dropdown_feat_templates",DROPDOWN_LIBRARIES:"dropdown_libraries",BREADCRUMB:"breadcrumb"},_=b.DROPDOWN_FEAT_TEMPLATES,y={borderSpace:20,minHeight:80,maxHeight:300,targetNumRows:2.5,rowVSpace:32,maxWidth:1600,rowHMargin:32},x={project:10,learn:10,template:5},S=(c.cpTemplateSearchRemixFeedTag,c.cpTemplateSearchRemixPaidTag,c.cpTemplateSearchMappedTagRemixPaid),k=S.split("-")[1],T=c.cpTemplateSearchGiphyTag,C=c.cpTemplateSearchMaxStringLength,R=[i.DOM_VK_LEFT,i.DOM_VK_RIGHT,i.DOM_VK_UP,i.DOM_VK_DOWN];return s.View.extend({events:{"click .search-button":this._handleSearchBtnClick,"click .search-input":this._handleSearchInputBoxClick,"click .search-term-link":this._handleSearchResultClick,"click .search-results":this._handleSearchResultClick},initialize:function(e){e=t.assign({},e||{}),this.currentSelectedLibraryType=void 0,this.currentSelectedLibraryTypeLabel=void 0,t.bindAll(this,t.functionsIn(this)),this._debouncedGetSearch=t.debounce(this._getSearchResults.bind(this),500),this._debouncedContainerResized=t.debounce(this._containerResized.bind(this),500),this._initializeOptions(e),this._initSearchSuggestAndTotalTemplates(e),this._options.doNotRenderOnInit||(this.render(),this._options.autoSearch&&this._options.autoSearch.needsToBeTriggered?this.triggerAutoSearch(this._options.autoSearch):this._options.searchData&&this.restoreSearchAfterReRender(this._options.searchData))},_initializeOptions:function(e){this._options=e,this._setSearchRequestsController(this._options.SearchRequestsController),this._gridDims=t.assign({},y,e.gridDims||{}),this._options.popularSearchStrings&&this._initPopularSearchesFromStrings(this._options.popularSearchStrings),this._options.debugTagging?this._debugSettings={debugCssStr:"debug-tagging",cpAssetPathTemplate:this._options.debugTaggingAssetPathTemplate}:this._debugSettings=null,this.preferredNumSuggestedResults=t.isUndefined(this._options.preferredNumSuggestedResults)?5:this._options.preferredNumSuggestedResults||0,this.maxTotalResultLinesToDisplay=t.isUndefined(this._options.maxTotalResultLinesToDisplay)?this._options.maxTotalResultLinesToDisplay||0:10,this.maxItemsToDisplayInGroup=8,this.maxKeywordFiltersToDisplay=8,this.maxKeywordFilters=50,this.maxNumSelectedTags=this._options.maxNumSelectedTags||6,this._setSearchForCurrentRoutePath({initializing:!0})},_setSearchRequestsController:function(e){this.SearchRequestsController=e,this._boundSearchCallbacks||(this._boundSearchCallbacks=!0,this._setSearchingForResults=this._setSearchingForResults.bind(this),this.renderCpSearchResults=this.renderCpSearchResults.bind(this)),this.SearchRequestsController.setCallbacks({setSearchingForResults:this._setSearchingForResults,renderCpSearchResults:this.renderCpSearchResults})},doInitialRender:function(e){e&&(this._options.el=e,this.setElement(e)),this.render(),this._nextInitialRenderIsUpdate?(this.searchResultsGridView&&this._reapplyGridViewInitOptions(),this._nextInitialRenderIsUpdate=!1,this._options.autoSearch&&this._options.autoSearch.needsToBeTriggered&&this.triggerAutoSearch(this._options.autoSearch)):this._options.autoSearch&&this._options.autoSearch.needsToBeTriggered?this.triggerAutoSearch(this._options.autoSearch):this._options.searchData&&this.restoreSearchAfterReRender(this._options.searchData)},updateOptions:function(s){if(s.SearchRequestsController&&s.SearchRequestsController!==this.SearchRequestsController&&this._setSearchRequestsController(s.SearchRequestsController),s.reset){var r=t.assign({},s);delete r.reset,this._initializeOptions(r)}else t.assign(this._options,s);this._eventsBoundEl$&&(t.each(this._eventsBoundEl$.children(),(function(t){e(t).remove()})),this._eventsBoundEl$=null),this._options.doNotRenderOnInit?(this._nextInitialRenderIsUpdate=!0,this.searchResultsGridView&&(this._reapplyGridViewInitOptionsOnNextResults=!0)):(this.setElement(s.el),this.render(),this.searchResultsGridView&&this._reapplyGridViewInitOptions(),this._options.autoSearch&&this._options.autoSearch.needsToBeTriggered?this.triggerAutoSearch(this._options.autoSearch):this._options.searchData&&this.restoreSearchAfterReRender(this._options.searchData))},_initSearchSuggestAndTotalTemplates:function(e){var t={MAX_TEMPLATE_SEARCH_STRING_LENGTH:c.cpTemplateSearchMaxStringLength,MAX_TEMPLATE_SEARCH_TERMS:c.cpTemplateSearchMaxSearchTerms,REMIX_PAID_MAP_TAG:c.cpTemplateSearchMappedTagRemixPaid,GIPHY_TAG:c.cpTemplateSearchGiphyTag,searchServiceSuggestOptions:e.searchServiceSuggestOptions,SearchRequestsController:e.SearchRequestsController,optionsForAllQuery:this._getSuggestQueryOptions()};this._searchSuggest=new p(t),this._totalTemplates={marvel:0},this._searchSuggest.getTotalTemplatesCount().then(function(e){this._totalTemplates.marvel=e,e<1e3&&!this._options.usingStageContent&&window.marvel.logger.warn("[SearchView] user has less than 1000 total templates:"+e),this._calcPlaceholderText(),this._setPlaceholderAttr()}.bind(this))},_getAllAsCatSearch:function(e){var t={label:"All",labelG11n:u.getString("npw-vb-search-box-cat-all"),commandType:"searchAll"};return this._updateLineDataWithApp(t,e,!0),t},_getAllPremiumAsCatSearch:function(e){var t={label:k,labelG11n:u.getString("npw-vb-search-box-cat-all-premium"),commandType:"searchAllPremium"};return this._updateLineDataWithApp(t,e,!0),t},_getAllAnimatedAsCatSearch:function(e){var t={label:k,labelG11n:u.getString("npw-vb-search-box-cat-all-animated"),commandType:"searchAllAnimated"};return this._updateLineDataWithApp(t,e,!0),t},_initPopularSearchesFromStrings:function(e){var s=e.length-1;this.popularSearches=[],this.popularCategories=[];var r=e.categories,i=e.popularSearchStringsUseEnglish;e=e.searchStrings,t.each(e,function(e,r){var a=[],l=[];t.each(e.tags,(function(e){a.push(e),l.push(e.substring(e.indexOf("-")+1))}));var o=l.join(" "),n=u.getString("npw-vb-search-box-popular-translation-"+l.join("-")),h=n||o,c={tags:a.join(":"),label:h,srcLabel:o,searchStr:i&&o||h};e.app&&this._updateLineDataWithApp(c,e.app),r===s&&(c.last=!0),this.popularSearches.push(c)}.bind(this)),t.each(r,function(e,t){var r=e.split("-")[1],i={tags:e,keywords:r,labelG11n:u.getString("npw-vb-search-box-category-"+r)||r,label:r};t===s&&(i.last=!0),this.popularCategories.push(i)}.bind(this))},_trackEvent:function(e,t){d.trackEvent(e,t||{},this._getAnalyticsPage())},_getAnalyticsPage:function(){var e=(this._options.context||"npw")+":search";return this._showingCpResults&&(e+="ResultsGrid"),e},_handleSearchBtnClick:function(e){this._handleKeyUp(e)},hideResultsForHomeRender:function(){this._showingCpResults&&this._hideCpSearchResults()},_setShowingResults:function(){this.$el.addClass("showing-results-grid"),this._options.inMainSearchHeader&&e(document.body).addClass("showing-search-header-results-grid"),this._showingCpResults=!0},_hideCpSearchResults:function(){this.clearLibrariesResults(),this._$searchLibraryEmpty.addClass("hide"),this._showingCpResults=!1,this.$el.removeClass("showing-results-grid"),this._options.inMainSearchHeader&&e(document.body).removeClass("showing-search-header-results-grid"),this._options.showFormatFilters&&this._searchFilters.formatFilters.hideInResults&&this._searchFilters.formatFilters.holder$.removeClass("hide-formats"),this.searchResultsGridView&&this.searchResultsGridView.hide(),this.hideTextForFieldIfNeeded()},_isASearchPage:function(){return"template"===this._currentRoutePathInfo.type?this._showingCpResults:window.location.pathname.includes("/sp/"+this._currentRoutePathInfo.type+"-search")},_handleSearchLibraryChange:function(s){if(this._setLibraryEmptyState(),"featured"===s.currentTarget.value)return this.setCurrentView(b.DROPDOWN_TEMPLATES),this._librarySearchEnabled=!1,this.clearLibrariesResults(),this.hideEmptyLibrariesView(),this._$searchInputHolder.removeClass("hide"),this._$searchInputDisabled.removeClass("hide"),this._$searchResultsHolder.removeClass("library-results"),void this.triggerAutoSearch(this._options.autoSearch);this._librarySearchEnabled=!0,this._theLibrarySelected=t.find(this._libraries,(function(t){return t.id==e(s.currentTarget).data("id")})),this._$searchInputHolder.addClass("hide"),this._$searchInputDisabled.addClass("hide"),this._$searchResultsHolder.addClass("library-results"),this._hideCpSearchResults(),this._theLibrarySelected?(this.hideLibrarySearchResults(),this.renderBreadcrumb(),this.displaySpinner(),v.default.loadElements(this._theLibrarySelected,"application/vnd.adobe.element.template+dcx").then(function(e){this.hideSpinner(),this.renderLibrarySearchResults(e)}.bind(this)).catch(function(e){this.hideSpinner(),window.marvel.logger.error("[SearchView] failed to fetch selected CC Library elements.",{selectedLibraryId:s.currentTarget.value,error:e})}.bind(this)).done()):(window.marvel.logger.error("[SearchView] failed to find selected CC Library.",{selectedLibraryId:s.currentTarget.value}),window.marvel.events.trigger("show-app-toast-message",{message:u.getString("searchview-error-library-dropdown"),variant:"error",timeout:1e4,closable:!0})),v.default.lastSelectedLibraryUrn=this._theLibrarySelected&&this._theLibrarySelected.urn},_handleSearchLibraryTypeChange:function(e){if(this._setLibraryEmptyState(),"featured"===e.currentTarget.value)return this.setCurrentView(b.DROPDOWN_FEAT_TEMPLATES),this._librarySearchEnabled=!1,this.hideEmptyLibrariesView(),this.clearLibrariesResults(),this._$searchInputHolder.removeClass("hide"),this._$searchInputDisabled.removeClass("hide"),this._$searchResultsHolder.removeClass("library-results"),void this.triggerAutoSearch(this._options.autoSearch);this.setCurrentView(b.DROPDOWN_LIBRARIES),this._librarySearchEnabled=!0,this._theLibraryTypeSelected=e.currentTarget.value,this._$searchInputHolder.addClass("hide"),this._$searchInputDisabled.addClass("hide"),this._$searchResultsHolder.addClass("library-results"),this._hideCpSearchResults(),this._theLibraryTypeSelected&&this.loadLibraries(this._theLibraryTypeSelected)},_setLibraryEmptyState:function(){var e=u.getString("searchview-empty-library-body"),t=u.getString("searchview-empty-library-title"),s=u.getString("searchview-empty-library-learn-more"),r=c.cclMarketingURL;this.$el.find(".empty-library-templates-title-text").text(t),this.$el.find(".empty-library-templates-body-text").text(e),this.$el.find(".empty-library-templates-learn-more").html('<a href="'+r+'" target="_blank">'+s+"</a></div>")},hideTextForFieldIfNeeded:function(){this._options.showPlaceholderIfNotShowingResultsGrid&&!this._isASearchPage()&&(this._restoreTextOnClick={text:this._$searchInput.val()},this._$searchInput.val(""),this._calcPlaceholderText(),this._setPlaceholderAttr({unfocused:!0}))},reshowForFieldOnly:function(){this._$searchInput.val(this._restoreTextOnClick.text),this._restoreTextOnClick=null},returningToHome:function(){this._showingCpResults&&(this._hideCpSearchResults(),this.setBackText())},_handleBrowseHeaderBackArrow:function(s){e(s.target).blur();var r={showingCpResults:!(!this._showingCpResults||!this.searchResultsGridView),currentSearch:t.clone(this.SearchRequestsController.getCurrentSearch()),filters:this._searchFilters.current,searchFieldStr:this._getTrimmedInputText(),searchView:this};this.searchResultsGridView&&this.searchResultsGridView._showingDetail?this.searchResultsGridView.closeDetail():this._options.navBackClickHandler?this._options.navBackClickHandler(s,r).then(function(){r.showingCpResults&&(this._hideCpSearchResults(),this.setBackText(null,{hidingResults:!0}))}.bind(this)):this._showingCpResults&&(this._hideCpSearchResults(),this.setBackText(null,{hidingResults:!0}))},_getCleanedSearchInput:function(e){if((e=("string"==typeof e?e:this._$searchInput.val()).replace(/\+/g," ").replace(/  +/g," ").trim()).length&&e.length>C){var t=e.substring(0,C);if(" "!==e[C]){var s=t.lastIndexOf(" ");-1!==s&&(t=t.substring(0,s))}e=t}return e},_handleReturnPressedForArrows:function(e){e.stopImmediatePropagation(),e.preventDefault();var t=this._getSelectedLine();if(this._waitingForInputParseReturn=null,this._doesInputFieldMatchBoxResults())this._handleSearchResultClick(null,t.line$,{selType:t.selType,fromArrowReturn:!0});else if(!t.line$||"returnField"===t.selType){if("returnField"===t.selType)return void this._handleSearchResultClick(null,t.line$,{selType:t.selType,fromArrowReturn:!0});this._waitingForInputParseReturn={text:this._getCleanedSearchInput().toLowerCase()}}},_getSelectedLine:function(){var t=this._arrowPresses.selectedLine$,s=t&&"lineReturn";return t||(s="returnField",t=e('<div class="empty-line search-result-line-can-arrow-nav"/>')),{selType:s,line$:t}},_handleArrowKeyPressed:function(e){if(this._arrowPresses.enabled){e.stopImmediatePropagation(),e.preventDefault();var t=e.keyCode===i.DOM_VK_UP;if(!this._arrowPresses.pressesSinceReset){var s=this._$searchInput.val();s!==this._arrowPresses.searchStr&&(this._arrowPresses.searchStr=s)}this._arrowPresses.pressesSinceReset++,this._incSelectedLine(t?-1:1)}},_getFirstGoodLine:function(){var t=this._$searchResults.find(".search-result-result-line");return t.length&&e(t[0])},_incSelectedLine:function(t){if(!this._arrowPresses.numLines)return!1;var s=this._arrowPresses.lineIndex+t;if(s>=this._arrowPresses.numLines?s=this._arrowPresses.fieldIndex:s<this._arrowPresses.fieldIndex&&(s=this._arrowPresses.numLines-1),s!=this._arrowPresses.lineIndex)if(this._arrowPresses.selectedLine$&&this._arrowPresses.selectedLine$.removeClass("arrow-selected"),this._arrowPresses.lineIndex=s,s>=0){if(window.marvel.logger.debug(s),this._arrowPresses.selectedLine$=e(this._arrowPresses.lines$[s]),this._arrowPresses.selectedLine$.addClass("arrow-selected"),this._arrowPresses.selectedLine$.hasClass("search-add-text-tag")){if(!this._arrowPresses.selectedLine$.hasClass("show-more-tags-btn")){this._arrowPresses.hasCachedAddText||(this._arrowPresses.hasCachedAddText=!0,this._arrowPresses.cachedAddText=this._arrowPresses.searchStr);var r=this._arrowPresses.selectedLine$.data("text");this._setSearchInput(this._arrowPresses.cachedAddText+" "+r)}}else if(!this._arrowPresses.selectedLine$.hasClass("search-result-result-line-all")){var i=this._arrowPresses.selectedLine$.data("label");if(!i)i=this._arrowPresses.selectedLine$.data("keywords").split(":").join(" ");this._setSearchInput(i)}}else this._arrowPresses.selectedLine$=null,this._setSearchInput(this._arrowPresses.searchStr),s===this._arrowPresses.tagsIndex&&(this._arrowPresses.clearTags$.hasClass("enabled")?this._arrowPresses.clearTags$.focus():this._arrowPresses.selectedTags$[0].focus())},_handleKeyDown:function(t){var s;if(this._debouncedGetSearch.cancel(),this._cancelCurrentGetSearchResults(),e(t.target).hasClass("search-clear")){if(t.keyCode===i.DOM_VK_RETURN)return t.stopImmediatePropagation(),t.preventDefault(),void t.stopPropagation();t.keyCode===i.DOM_VK_TAB&&(s=!t.shiftKey)}else t.keyCode===i.DOM_VK_UP||t.keyCode===i.DOM_VK_DOWN?(t.preventDefault(),this._handleArrowKeyPressed(t)):t.keyCode===i.DOM_VK_TAB&&(s=t.shiftKey||this._$searchClear.hasClass("disabled"));s&&(this._applyInputTextForFocus(),this._blurFieldAndHideResults())},_recalculateSearchButtonActive:function(e){var t=!0;return(t=""!==(e=this._getCleanedSearchInput(e)))?this._$searchButton.addClass("active"):this._$searchButton.removeClass("active"),t},_triggerNonTemplateSearch:function(e){if(this._currentRoutePathInfo.currentData.queryPath){e=e&&t.trim(e)||"";var s=a.format({pathname:this._currentRoutePathInfo.currentData.queryPath,query:t.assign({q:e},this._currentRoutePathInfo.currentData.extraQueryValues)});return this._setSearchInput(e),this._blurFieldAndHideResults(),window.marvel.navigate(s,{trigger:!0}),!0}return!1},_escapeKeyUp:function(e,t){this._trackEvent("NPWSearchPressedEscKey",{searchTerm:t}),this._applyInputTextForFocus(),this._blurFieldAndHideResults({applyEscapeFocus:!0}),this.hideTextForFieldIfNeeded()},_handleKeyupInResults:function(e){e.keyCode===i.DOM_VK_ESCAPE&&this._escapeKeyUp(e,this._getTrimmedInputText())},_handleKeyUp:function(t){var s=this._getTrimmedInputText();if(s.length?this._$searchClear.removeClass("disabled"):this._$searchClear.addClass("disabled"),t.keyCode===i.DOM_VK_ESCAPE)this._escapeKeyUp(t,s);else if(e(t.currentTarget).hasClass("search-button"))this._$searchResults.hasClass("hide")?(this._waitingForInputParseReturn={text:this._getCleanedSearchInput().toLowerCase()},this._handleInputFocusOrClearX({fromContext:"fromSearchBtn"})):(this._trackEvent("NPWSearchClickedSearchBtn",{searchTerm:s}),s.length&&this._arrowPresses.enabled&&this._handleReturnPressedForArrows(t));else if(e(t.currentTarget).hasClass("search-clear"))t.keyCode===i.DOM_VK_RETURN&&this._handleClearSearchClick(t);else if(t.keyCode===i.DOM_VK_RETURN){if(this._arrowPresses.lastTagKeydownEventTime&&t.timeStamp-this._arrowPresses.lastTagKeydownEventTime<500)return void(this._arrowPresses.lastTagKeydownEventTime=0);if(this._triggerNonTemplateSearch(s))return;this._arrowPresses.enabled&&this._handleReturnPressedForArrows(t)}else if(-1===R.indexOf(t.keyCode)){if(this._recalculateSearchButtonActive(s),this._currentRoutePathInfo.currentData.queryPath)return;this._debouncedGetSearch(t,null,{ifDifferentThanLast:!0,keyWasSpace:t.keyCode===i.DOM_VK_SPACE}),this._arrowPresses.enabled&&(this._arrowPresses.hasCachedAddText=!1)}},_getLinesFromServerData:function(e){if(!e.mustacheData)if(e.splitLinesData){var s=e.splitLinesData.textLines.concat(e.splitLinesData.suggestionLines||[]);t.each(s,function(e){var s,r=[];r=e.keysArray,s=t.map(e.tagsData,(function(e){return e.tag||e})),e.keywords=r.join(":"),e.tags=s.length&&s.join(":")||"",(this._options.debugTagging||this._options.showNumbersInLines)&&(e.showAnyCounts=!0)}.bind(this)),e.mustacheData={textLines:e.splitLinesData.textLines,suggestionLines:e.splitLinesData.suggestionLines,tagLinesGroups:e.tagLinesGroups,selectedTags:e.selectedTags&&t.cloneDeep(e.selectedTags)}}else e.mustacheData={lines:[]};return e.mustacheData},_updateLineDataWithApp:function(e,t,s){if(this._options.searchHistoryAppSpecific){"object"==typeof t&&(t=t.typeName);var r=g.getFormatInfo(t);r?(e.app=r.type,e.appLabel=r.formatLabel):s||window.marvel.logger.debug("bad app id for search line:"+t,e)}},_searchHistoryForBox:function(e){var t=x[e||"template"],s={searches:[]};if(this._searchHistory&&this._searchHistory.searches.length){t=Math.min(t,this._searchHistory.searches.length);for(var r=0;r<t;r++){var i=this._searchHistory.searches[r],a={label:i.s};i.app&&this._updateLineDataWithApp(a,i.app),s.searches.push(a)}}return s.numSearches=s.searches.length,s.historyLabel=this._getHistoryLabel(),s.numSearches||(s.historySubLabel=this._getHistoryLabel({none:!0})),s},_doesInputFieldMatchBoxResults:function(){return void 0!==this._lastDisplayedSearchBoxInput&&(!!this._arrowPresses.pressesSinceReset||this._getTrimmedInputText().toLowerCase()===this._lastDisplayedSearchBoxInput.toLowerCase())},_lastDisplayedSearchBoxInput:void 0,_getHistoryLabel:function(e){var t="npw-vb-search-box-section-history";return e&&e.none&&(t="npw-vb-search-box-section-history-none"),u.formatMessage(t,{type:this._currentRoutePathInfo.type})},_makeResultBoxForNonTemplates:function(e,t){var s=this._currentRoutePathInfo.type;t=t||{};var r={historySearches:this._searchHistoryForBox(s),fromNoResults:!0,isLearn:!0,scrollInnerHeight:this._maxResultsInnerHeightStr};this._$searchResults.html(u.mustacheRender(l,r,{lineLabels:o})),this._showSearchResults(e),"fromClearX"!==t.fromContext?this._focusInputIgnoreEvent():(this._cacheInputTextForFocus(),this._restoreTextOnClick=null)},_makeResultBoxFromNoSearchResults:function(e,s){this._$searchResults.empty();var r=this._searchHistoryForBox(),i=this.popularSearches&&this.popularSearches.length&&{searches:this.popularSearches},a=this.popularCategories;if(a){var n=[this._getAllAsCatSearch(this._searchFilters.current.format.app||"")];this._options.allowPremiumTemplates&&n.push(this._getAllPremiumAsCatSearch(this._searchFilters.current.format.app||"")),this._options.animationEnabled&&n.push(this._getAllAnimatedAsCatSearch(this._searchFilters.current.format.app||"")),a=n.concat(a)}var h=this._lastShownResultBoxSettings&&this._lastShownResultBoxSettings.templateOptions&&this._lastShownResultBoxSettings.templateOptions.selectedTags;h&&!h.items&&(h=null);var c={showPopular:i,showCategorySearches:!!a,categorySearches:a,historySearches:r.numSearches&&r,selectedTags:this._searchSuggest.getSelectedTagsForNoResults(s,h),fromNoResults:!0,scrollInnerHeight:this._maxResultsInnerHeightStr};this._extendDebugSettingsToTemplateSettings(c),this._$searchResults.html(u.mustacheRender(l,c,{lineLabels:o})),this._lastShownResultBoxSettings=t.assign({},this._lastShownResultBoxSettings,{searchInput:e,templateOptions:c,options:this._lastShownResultBoxSettings&&this._lastShownResultBoxSettings.options||{}}),this._showSearchResults(e),this._focusInputIgnoreEvent()},_focusInputIgnoreEvent:function(){this._ignoreNextFocus=!0,this._$searchInput.focus()},_makeResultBoxFromSearchData:function(e,s){s=s||{};var r,i=this._getCleanedSearchInput(e).toLowerCase().split(" "),a=1===i.length&&""===i[0],n=!s.doNotShow;this._lastDisplayedSearchBoxInput=e,s.resultsFromServer?r=this._getLinesFromServerData(s.resultsFromServer):a?r={lines:[]}:(window.marvel.logger.debug("called _makeResultBoxFromSearchData with bad options",{options:s,searchInput:e}),r={lines:[]}),this._$searchResults.empty();var h=0;r.lines?h=r.lines.length:(r.suggestionLines&&(h+=r.suggestionLines.length),r.textLines&&(h+=r.textLines.length));var c=this._searchHistoryForBox(),d=!h&&this.popularSearches&&this.popularSearches.length&&{searches:this.popularSearches},g=!h&&this.popularCategories;if(g){var m=[this._getAllAsCatSearch(this._searchFilters.current.format.app||"")];this._options.allowPremiumTemplates&&m.push(this._getAllPremiumAsCatSearch(this._searchFilters.current.format.app||"")),this._options.animationEnabled&&m.push(this._getAllAnimatedAsCatSearch(this._searchFilters.current.format.app||"")),g=m.concat(g)}n&&0===h&&e&&this._trackEvent("NPWSearchTermsYieldedZeroResults",{searchTerm:e});var p={tagLinesGroups:r.tagLinesGroups,selectedTags:r.selectedTags,numResults:h,showPopular:d,showCategorySearches:!!g,categorySearches:g,historySearches:c.numSearches&&c,fromNoResults:!1,scrollInnerHeight:this._maxResultsInnerHeightStr};if(r.textLines||r.suggestionLines?(p.textLines=r.textLines,p.hasTextLines=p.textLines&&p.textLines.length,p.suggestionLines=r.suggestionLines,p.hasSuggestionLines=p.suggestionLines&&p.suggestionLines.length,p.hasTextOrSuggestionLines=p.hasTextLines||p.hasSuggestionLines):p.tagLines=r.lines&&r.lines.length&&r.lines,this._extendDebugSettingsToTemplateSettings(p),this._$searchResults.html(u.mustacheRender(l,p,{lineLabels:o})),n){var f=s.fromContext;f||(window.marvel.logger.warn("unknown context in _makeResultBoxFromSearchData",{searchInput:e,options:s}),f="unknownContext");var v="fromFocus"===f&&this._$searchResults.hasClass("hide");this._showSearchResults(e),v&&this._scrollResults(0)}if(this._lastShownResultBoxSettings={searchInput:e,options:t.cloneDeep(s),templateOptions:p},this._waitingForInputParseReturn){if(this._waitingForInputParseReturn.text===this._lastDisplayedSearchBoxInput){var w=this._getFirstGoodLine();w&&this._handleSearchResultClick(null,w,{selType:"returnFieldDelayed"})}this._waitingForInputParseReturn=null}},_extendDebugSettingsToTemplateSettings:function(e){this._debugSettings&&(e.debugCssStr=this._debugSettings.debugCssStr)},_searchStringFromResultLine:function(e,t){if("noResultLineCategory"===t)return"";var s=e.data("search-str");return s||(e.hasClass("search-results-tag-button")?this._$searchInput.val():(e.data("keywords")||"").split(":").join(" "))},_setSearchInput:function(e){e=e||"",this._$searchInput.val(e),e.length?this._$searchClear.removeClass("disabled"):this._$searchClear.addClass("disabled"),this._recalculateSearchButtonActive(e)},_tagsAboveResultsEnabled:function(){return this._gridDims&&!this._gridDims.hideTagsAboveResults},_handleSearchResultClickClear:function(t){t.stopImmediatePropagation(),t.preventDefault(),this._handleClearFiltersClick(e(t.target))},_handleSearchResultClick:function(s,r,i){if(i=i||{},s&&(s.stopImmediatePropagation(),r=r||e(s.currentTarget)),r.hasClass("search-add-text-tag"))this.searchAddTextTagClicked(r,i);else{var a=i.fromTag,l=i.selType||"lineClick";if(this._inputTextOnFocus=void 0,i.fromUnfocusedClearX||r.hasClass("search-result-line-can-arrow-nav")||a){var o,n=this._getTrimmedInputText(),c=r.data("tags"),d=r.data("keywords"),g=r.data("app"),m=i.commandType||r.data("command-type"),p=("searchAll"===m||"searchAllPremium"===m||"searchAllAnimated"===m)&&m,f=r.data("use-case")||r.data("src-label")||r.data("label")||r.text();g&&(o=h.getAppByType(g)),!o&&this._searchFilters.current.format.app&&(o=h.getAppByType(this._searchFilters.current.format.app));var v,w,b,_=!0,y=!1;i.fromUnfocusedClearX?v="clearSearch":r.hasClass("search-result-result-line")?v="resultLine":r.hasClass("search-result-search-suggest-line")?(n=n||r.jquery&&r.text(),v="resultLine",y=!0):r.hasClass("search-result-search-suggest-line-user-text")?(v="resultSuggestLine",w=!0):r.hasClass("search-result-search-suggest-line-history")?v="noResultLineHistory":r.hasClass("search-result-search-suggest-line-popular-category")?(v="noResultLineCategory",w=!0,b=c&&c.length&&c.split(":")):r.hasClass("search-result-search-suggest-line-popular-search")?v="noResultLinePopularTerm":r.hasClass("search-results-tag-button")?v=r.hasClass("search-results-selected-tag")?"resultSelectedTag":"resultSuggestedTag":r.hasClass("empty-line")&&(_=!0,y=!0,v="userStr"),_&&!this._options.allowFieldDefault&&0===l.indexOf("returnField")&&r.find(".search-result-result-line-span-hint").length&&(_=!1);var x=y?n:!p&&this._searchStringFromResultLine(r,v)||"",S={searchTerm:((y?n:this._arrowPresses.searchStr)||"").trim(),contextualData2:"searchStr:"+x,contextualData4:"suggestedTerms:"+f,type:v,trigger:l};if(o&&(S.sparkFormat=o.typeName),_||this._trackEvent("NPWVisualBrowseTemplateFieldReturnIgnored",S),_){this._debouncedGetSearch.cancel(),S.type=v,p||""!==x||b||(p="searchAll");var k={findAllType:p,commandType:m,searchString:x,addHistory:!m,app:o};if(!this._triggerNonTemplateSearch(k.searchString)){if(!w){var T=this._getLastResultsFromServer(),C=!this._$searchResults.hasClass("hide")&&T&&T.srcTagFilters;C?k.tagFilters=C:this._currentSelectedTags&&this._currentSelectedTags.length&&(k.tagFilters=this._currentSelectedTags)}if(!p&&!a){this._options.keysForTags&&c&&!b&&(d?c=null:(d=t.map(c.split(":"),(function(e){return c.split("-")[1]})).join(":"),c=null));var R="returnFieldDelayed"!==l;if(b)k.tagFilters=t.map(b,(function(e){var t=e.split("-").slice(1).join("-");return{assets:[],id:e,tag:e,key:t,keyword:t,tags:[e],selected:!0,label:u.getString("npw-vb-search-box-category-"+t),needsLabel:!0}})),c=null;else if(c){if(k.tags=c.split(":"),R){var F=t.map(k.tags,(function(e){return e.substring(e.indexOf("-")+1)}));this._getSearchResults(null,F.join(" "),{doNotShow:!0})}}else if(d)k.keywords=d.split(":"),R&&this._getSearchResults(null,k.keywords.join(" "),{doNotShow:!0});else if(y)k.keywords=x.split(" ");else{var I=r.data("label");if(!I)return void window.marvel.logger.debug("no data in search line:"+r.text(),r);k.keywords=I.split(" ")}}var A;this._setSearchInput(k.searchString),"header"===this._options.context&&(A=this._options.SearchController.getHeaderBackInfo()),this.setBackText(A),k.analyticsData=S,k.backInfo=A,this._options.asHeader||this._options.editorApp?this.SearchRequestsController.isSearchDifferent(k)||!this.searchResultsGridView?this._getTemplateResults(k):0===this._numResultsLastSearch?this._makeResultBoxFromNoSearchResults(k.searchString,k.tagFilters):(this._blurFieldAndHideResults({applyEscapeFocus:!0}),this._setShowingResults(),this._reapplyGridViewInitOptionsOnNextResults&&(this._reapplyGridViewInitOptionsOnNextResults=!1,this._reapplyGridViewInitOptions()),this.searchResultsGridView.render({isReRender:!0})):this._getTemplateResults(k)}}}}},_cancelCurrentGetSearchResults:function(){this._currentGetSearchResultsCancellableObj&&(this._currentGetSearchResultsCancellableObj.cancel=!0,this._currentGetSearchResultsCancellableObj=null)},searchAddTextTagClicked:function(e,s){if(e.hasClass("show-more-tags-btn")){var r;this._$searchResults.find(".search-add-text-tag.if-showing-all").addClass("show-more-tags-tags search-result-line-can-arrow-nav"),e.addClass("hide").removeClass("search-result-line-can-arrow-nav"),s.fromArrowReturn&&(r=this._arrowPresses.lineIndex);var i=this._arrowPresses.hasCachedAddText?this._arrowPresses.cachedAddText:this._arrowPresses.searchStr;return this._resetArrowNav(!0,i),void(s.fromArrowReturn&&(this._arrowPresses.lineIndex=r-1,this._incSelectedLine(1)))}var a=e.data("text"),l=this._$searchInput.val(),o="";(e.addClass("hide").removeClass("search-result-line-can-arrow-nav"),s.fromArrowReturn)?o=l:o=-1===l.toLowerCase().split(" ").indexOf(a.toLowerCase())?l.trim()+" "+a:l.trim();this._resetArrowNav(!0,o),this._$searchInput.val(o),this._focusInputIgnoreEvent(),s=t.assign({},s,{newText:o,inputText:l})},_handleClearFiltersClick:function(e){var s=this._lastShownResultBoxSettings.options.resultsFromServer.srcTagFilters;s||(s=[],this._lastShownResultBoxSettings.options.resultsFromServer.srcTagFilters=s),s.splice(0);var r=this._lastShownResultBoxSettings.options.resultsFromServer.mustacheData.selectedTags;t.each(r.items,(function(e){e.selected=!1})),r.numMaxTagsSelected=0,r.atMaxTags=!1,this._$searchResults.find(".search-result-group-line-tags-tags").removeClass("at-max-tags"),e.closest(".search-result-group-line").find(".search-result-group-line-tag").removeClass("selected"),this._setClearAllFiltersButtonEnabled(!1),this._focusInputIgnoreEvent()},_setClearAllFiltersButtonEnabled:function(e){this._$clearAllFiltersButton=this._$searchResults.find(".search-box-filters-clear-all"),e?(this._$clearAllFiltersButton.addClass("enabled"),this._$clearAllFiltersButton.prop("disabled","")):(this._$clearAllFiltersButton.removeClass("enabled"),this._$clearAllFiltersButton.prop("disabled",!0))},_getLastResultsFromServer:function(){return this._lastShownResultBoxSettings&&this._lastShownResultBoxSettings.options&&this._lastShownResultBoxSettings.options.resultsFromServer},_setAtMaxSelectedTagsForSelect:function(e,t){e.maxNumSelectedTags&&(t.selected?e.numMaxTagsSelected++:e.numMaxTagsSelected--,e.atMaxTags=e.numMaxTagsSelected>=e.maxNumSelectedTags,e.atMaxTags?this._$searchResults.find(".search-result-group-line-tags-tags").addClass("at-max-tags"):this._$searchResults.find(".search-result-group-line-tags-tags").removeClass("at-max-tags"))},searchResultSelectedTagClicked:function(e){var s,r=this._getLastResultsFromServer();if(r){(s=r.srcTagFilters)||(s=[],r.srcTagFilters=s);var i=e.data("src-key")+"",a=r.mustacheData.selectedTags,l=t.find(a.items,(function(e){return e.srcKey===i}));if(l){var o=l.customFilterType||l.aggTag&&l.aggTag.customFilterType,n=-1,h=t.find(s,(function(e,t){if(e.srcKey===i)return n=t,!0}));l.selected?(l.selected=!1,e.removeClass("selected"),-1!==n&&s.splice(n,1)):!a.atMaxTags||o?(l.selected=!0,e.addClass("selected"),h||s.push(l.aggTag)):l=null,l&&!o&&this._setAtMaxSelectedTagsForSelect(a,l)}}else window.marvel.logger.warn("[SearchView] null lastResultsFromServer in searchResultSelectedTagClicked",this._lastShownResultBoxSettings),s=[];this._setClearAllFiltersButtonEnabled(s.length>0),this._focusInputIgnoreEvent()},_getSuggestQueryOptions:function(e){var s=t.assign({},{prefix:"",tagFilters:null,spaceAggsRecalc:!1},e||{});return s.keysForTags=this._options.keysForTags,this._options.searchPageAndVideoAsRelated?s.app="post":s.app=this._searchFilters.current.format.app,s.preferredNumSuggestedResults=this.preferredNumSuggestedResults,s.maxTotalResultLinesToDisplay=this.maxTotalResultLinesToDisplay,s.maxItemsToDisplayInGroup=this.maxItemsToDisplayInGroup,s.maxKeywordFiltersToDisplay=this.maxKeywordFiltersToDisplay,s.maxKeywordFilters=this.maxKeywordFilters,s.maxNumSelectedTags=this.maxNumSelectedTags,s.showOnlySelectedKeywordFilters=!this._tagsAboveResultsEnabled(),s.lastSearchResults=this._lastRenderedResults&&this._lastRenderedResults.results,s.debug=!!this._debugSettings,this._options.allowPremiumTemplates&&(s[S]="allow"),this._options.allowGiphyTemplates&&(s[T]="allow"),s},_getSearchResults:function(e,s,r){var i={},a=!this._$searchResults.hasClass("hide")&&this._lastShownResultBoxSettings;this._currentGetSearchResultsCancellableObj&&(this._currentGetSearchResultsCancellableObj.cancel=!0),this._currentGetSearchResultsCancellableObj=i,r=r||{};var l=s;l||(l=this._$searchInput.val()),this._debouncedGetSearch.cancel();var o=r.keyWasSpace&&this._searchSuggest.suggestAggsOnSpace();if(o&&this._lastShownResultBoxSettings&&this._lastShownResultBoxSettings.options&&this._lastShownResultBoxSettings.options.keyWasSpace&&(o=!1),l=this._getCleanedSearchInput(l),r.ifDifferentThanLast){var n=this._lastShownResultBoxSettings&&this._lastShownResultBoxSettings.searchInput||"";if(l===n&&!o)return;delete r.ifDifferentThanLast}var h,c=r.fromContext;h=r.tagFilters?r.tagFilters:a&&a.options&&a.options.resultsFromServer?a.options.resultsFromServer.srcTagFilters:this._currentSelectedTags,e&&(c="fromKeyUp");var d=this._getSuggestQueryOptions({prefix:l,tagFilters:h,spaceAggsRecalc:o});this._searchSuggest.getCpPrefixData(d,i).then(function(e){this._currentGetSearchResultsCancellableObj===i&&(this._currentGetSearchResultsCancellableObj=null,i.cancel||e.cancelled||this._makeResultBoxFromSearchData(l,t.assign({resultsFromServer:e,fromContext:c},r)))}.bind(this),(function(e){window.marvel.logger.warn("[SearchView] getCpPrefixData rejected:",e)}))},_handleSearchInputBoxClick:function(){this._trackEvent("NPWSearchBoxClicked",{}),this._setPlaceholderAttr({clear:!0})},setViewHeight:function(e){this._$searchView.css("height",e)},_handleInputFocusOrClearX:function(e){this._setPlaceholderAttr({remove:!0});var s,r,i=this._getTrimmedInputText(),a=this._lastShownResultBoxSettings&&i===this._lastShownResultBoxSettings.searchInput,l=!this._$searchResults.hasClass("hide");if(a&&this._showingCpResults){var o;this._currentSelectedTags&&this._currentSelectedTags.length&&(s=this._currentSelectedTags),r=this._lastShownResultBoxSettings&&this._lastShownResultBoxSettings.templateOptions&&this._lastShownResultBoxSettings.templateOptions.selectedTags&&this._lastShownResultBoxSettings.templateOptions.selectedTags.items;var n=0;r&&(o=t.reduce(r,(function(e,t){return t.selected&&(e[t.id]=!0,n++),e}),{})),a=s&&s.length?n===s.length&&!t.find(s,(function(e){return!o[e.id]})):!n}this._currentRoutePathInfo.currentData.queryPath?this._makeResultBoxForNonTemplates(i,e):a&&l?(this._lastShownResultBoxSettings.options.doNotShow&&(this._lastShownResultBoxSettings.options.doNotShow=!1),this._makeResultBoxFromSearchData(this._lastShownResultBoxSettings.searchInput,t.assign({},this._lastShownResultBoxSettings.options,e))):this._getSearchResults(null,null,{fromContext:e.fromContext||"fromFocus"})},_arrowPresses:{enabled:!1},_resetArrowNav:function(e,t){var s=this._$searchResults.find(".search-results-selected-tag").filter(":visible");this._arrowPresses.selectedTags$=s.length&&s,this._arrowPresses.selectedTags$?(this._arrowPresses.clearTags$=this._$searchResults.find(".search-box-filters-clear-all"),this._arrowPresses.showMoreTags$=this._$searchResults.find(".show-more-tags-btn").filter(":visible"),this._arrowPresses.showMoreTags$.length||(this._arrowPresses.showMoreTags$=null)):(this._arrowPresses.clearTags$=null,this._arrowPresses.showMoreTags$=null),this._arrowPresses.lines$=this._$searchResults.find(".search-result-line-can-arrow-nav"),this._arrowPresses.numLines=this._arrowPresses.lines$.length,this._arrowPresses.lines$.removeClass("arrow-selected"),this._arrowPresses.selectedLine$=null,this._arrowPresses.fieldIndex=this._arrowPresses.selectedTags$?-2:-1,this._arrowPresses.tagsIndex=this._arrowPresses.selectedTags$?-1:-100,this._arrowPresses.lineIndex=this._arrowPresses.fieldIndex,this._arrowPresses.enabled=!!e,this._arrowPresses.searchStr=t,this._arrowPresses.pressesSinceReset=0,this._arrowPresses.hasCachedAddText=!1,this._arrowPresses.cachedAddText=""},_showSearchResults:function(e){this._$searchResults.removeClass("hide"),this._$searchView.addClass("searching"),this._$searchOverlay.addClass("overlay-showing").removeClass("hide"),this._resetArrowNav(!0,e),""===e&&this._setPlaceholderAttr()},_scrollResults:function(e){e=e||0,this._$searchResults.find(".search-results-ul-scroller").scrollTop(e)},_hideSearchResults:function(){this._$searchResults.addClass("hide"),this._$searchOverlay.addClass("hide").removeClass("overlay-showing"),this._$searchView.removeClass("searching")},_setSearchingForResults:function(e,s){if(s=s||{},e){var r;if("searchAll"===s.commandType||this._$searchInput.width()>300){var i,a={appId:s.app&&g.getAppType(s.app)||""};if("searchAll"===s.commandType)i="npw-search-field-progress-all";else this._getTrimmedInputText()?(i="npw-search-field-progress",a.searchString=this._getTrimmedInputText()):i="npw-search-field-progress-all";r=u.formatMessage(i,a)}else r=this._getTrimmedInputText();this._$searchInput.addClass("hide"),this._$searchInputDisabled.removeClass("hide"),this._$searchInputDisabled.text(r),this._$searchResults.addClass("hide"),this._$searchView.removeClass("searching"),this._$searchButton.addClass("searching"),s.noProgressOverlay||(s.opaqueProgressOverlay&&this._$searchOverlay.addClass("overlay-opaque"),this._$searchOverlay.removeClass("hide").addClass("overlay-showing"))}else this._$searchInput.removeClass("hide"),this._$searchInputDisabled.addClass("hide"),this._$searchButton.removeClass("searching"),this._$searchOverlay.removeClass("overlay-showing"),this._$searchOverlay.removeClass("overlay-opaque"),s.showImmediately?this._$searchOverlay.addClass("hide"):t.delay(function(){this._$searchOverlay.addClass("hide")}.bind(this),300),this._calcPlaceholderText(),this._setPlaceholderAttr({unfocused:!0})},moveFocusToBeforeSearchField:function(){this._$searchEscapeFocus.removeClass("hide"),this._$searchEscapeFocus.focus(),this._$searchEscapeFocus.addClass("hide"),this._$searchEscapeFocus.blur()},_blurFieldAndHideResults:function(e){this._hideSearchResults(),e&&e.applyEscapeFocus?this.moveFocusToBeforeSearchField():this._$searchInput.blur()},_cacheInputTextForFocus:function(){this._$searchOverlay.hasClass("overlay-showing")||(this._inputTextOnFocus=this._$searchInput.val())},_applyInputTextForFocus:function(){t.isUndefined(this._inputTextOnFocus)||(this._setSearchInput(this._inputTextOnFocus),this._inputTextOnFocus=void 0)},_clearSearchAndFilters:function(){this._setSearchInput(""),this._currentSelectedTags=[],this._handleSearchResultClick(null,e("<div/>"),{fromUnfocusedClearX:!0,commandType:"findAll"})},_handleClearSearchClick:function(e){this._$searchOverlay.hasClass("overlay-showing")?(this._cacheInputTextForFocus(),this._setSearchInput(""),this._handleInputFocusOrClearX({fromContext:"fromClearX"}),this._focusInputIgnoreEvent()):this._clearSearchAndFilters()},_clearSearchResults:function(e){(e=e||{}).hideOverlay&&this._$searchOverlay.addClass("hide").removeClass("overlay-showing"),this._setPlaceholderAttr({unfocused:!e.showResultsForEmpty}),e.showResultsForEmpty?this._makeResultBoxFromSearchData("",{fromContext:e.fromContext}):(this._$searchResults.addClass("hide"),this._$searchView.removeClass("searching"))},_setPlaceholderAttr:function(e){var t=this.placeholderText||"";if((e=e||{}).clear)t="";else if(e.remove)return void this._$searchInput.removeAttr("placeholder");e.unfocused&&(t=this.unfocusedPlaceholderText),this._$tooltipHolder.addClass("off"),t=this._currentRoutePathInfo.currentData.placeholder||t;var s=this._currentRoutePathInfo.currentData.tooltip;s&&g.shouldShowSearchTooltip(s.type).then(function(e){e&&setTimeout(function(){this._$tooltipHolder.find(".search-input-tooltip").text(s.label),this._$tooltipHolder.removeClass("off"),g.searchTooltipShown(s.type)}.bind(this),3e3)}.bind(this)),this._$searchInput.attr("placeholder",t),this._$searchInput.attr("data-placeholder",t)},_calcPlaceholderText:function(){var e="npw-search-field-placeholder-templates-home";if(this._$searchInput){var t=this._$searchInput.width();t&&t<=300&&(e="npw-search-field-placeholder-templates-short")}if("npw-search-field-placeholder-templates-home"===e){var s=this._totalTemplates.marvel,r=1*Math.floor(s/1e3);this.placeholderText=r?u.formatMessage(e,{appId:"marvel",numThousands:r}):s?u.formatMessage("npw-search-field-placeholder-templates",{appId:"marvel"}):""}else this.placeholderText=u.formatMessage(e,{appId:"marvel"});this.unfocusedPlaceholderText=this.placeholderText},render:function(){if(this._options.template){var e=this._options.templateOptions||{};if(this._options.showFormatFilters){var s=[{id:"all",app:"marvel",label:u.formatMessage("npw-vb-format-marvel",{count:2})}];if(t.each(g.getOrderedApps(),function(e){s.push({id:e.id,app:e.type,label:e.formatLabel})}.bind(this)),this._options.favoritesEnabled){var r=!!this._options.showFavoritesInHeader;r||s.push({sep:!0}),s.push({id:"favorites",label:u.formatMessage("npw-vb-format-capitalized-plural",{appId:"favorite"}),hide:!!r})}t.each(s,function(e){e.id===this._options.defaultFilters.format.id&&(e.selected=!0,this._searchFilters.current.format=e)}.bind(this)),e.formatFilters={format:s,filtersInHeader:this._options.filtersInHeader,filtersInHeaderCss:this._options.filtersInHeaderCss},this._searchFilters.formatFilters={settings:s,hideInResults:this._options.searchPageAndVideoAsRelated}}e.localePathPrefix=u.localePathPrefix,this._extendDebugSettingsToTemplateSettings(e);var i=u.mustacheRender(this._options.template,e);this.$el.html(i.toString())}return this._$searchView=this.$el.find(".search-view").removeClass("hide"),this._$searchInput=this.$el.find(".search-input"),this._$searchInputDisabled=this.$el.find(".search-input-disabled"),this._$searchOverlay=this.$el.find(".search-overlay"),this._$searchUnderlay=this.$el.find(".search-bg-underlay"),this._$searchResults=this.$el.find(".search-results"),this._$searchResultsHolder=this.$el.find(".search-results-grid-view-holder"),this._$searchBar=this.$el.find(".search-bar"),this._$searchClear=this.$el.find(".search-clear"),this._$searchButton=this.$el.find(".search-button"),this._$searchEscapeFocus=this.$el.find(".search-input-escape-focus"),this._$backArrow=this.$el.find(".npw-visual-browse-header-back-arrow"),this._$mrvlLogo=this.$el.find(".mrvl-logo-link"),this._$searchInputHolder=this.$el.find(".search-input-holder"),this._$searchLibraryDropdown=this.$el.find(".search-input-library-dropdown"),this._$searchLibrarySelect=this.$el.find(".search-input-library-select"),this._$searchLibraryEmpty=this.$el.find(".search-results-library-empty"),this._$tooltipHolder=this.$el.find(".search-input-tooltip-holder"),this._bindEvents(),this.dropdown$=this._options.dropdownSelectorStr&&this.$el.find(this._options.dropdownSelectorStr),this._options.asHeader&&(this.headerBackground$=this.$el.find(".vb-search-header-background ")),this.$el.removeClass("hide"),this._calcPlaceholderText(),this._setPlaceholderAttr(),this._initialRenderSearchFieldText&&(this._setSearchInput(this._initialRenderSearchFieldText),this._initialRenderSearchFieldText=void 0),this.dropdown$&&this.dropdown$[0]&&this._createDropdownAfterRender(this.dropdown$),this._$searchLibrarySelect&&this._$searchLibrarySelect.length&&this._populateLibrariesDropdownAfterRender(this._$searchLibrarySelect),this._options.containerDims&&this._sizeResultsMaxHeightForContainer(),this},_bindEvents:function(){this._eventsBoundEl$&&this._eventsBoundEl$!==this.$el&&(t.each(this._eventsBoundEl$.children(),(function(t){e(t).remove()})),this._eventsBoundEl$=null),this._eventsBoundEl$||(this._eventsBoundEl$=this.$el,this._$searchInput.keyup(this._handleKeyUp),this._$searchInput.keydown(this._handleKeyDown),this._$searchClear.keyup(this._handleKeyUp),this._$searchClear.keydown(this._handleKeyDown),this._$searchInput.focus(function(){this._$tooltipHolder.addClass("off"),this._restoreTextOnClick&&this.reshowForFieldOnly(),this._ignoreNextFocus?this._ignoreNextFocus=!1:(this._cacheInputTextForFocus(),this._handleInputFocusOrClearX({fromContext:"fromFocus"}))}.bind(this)),this._$searchOverlay.click(function(){this._$searchResults.is(":focus")||(this._applyInputTextForFocus(),this._clearSearchResults({hideOverlay:!0}),this.hideTextForFieldIfNeeded())}.bind(this)),this._options.handleSearchUnderlayClicked&&this._$searchUnderlay.click(function(){this._options.handleSearchUnderlayClicked()}.bind(this)),this._$searchLibrarySelect.on("change",this._handleSearchLibraryTypeChange),this._$searchResults.on("click","li",this._handleSearchResultClick),this._$searchResults.on("click",".search-box-filters-clear-all",this._handleSearchResultClickClear),this._$searchResults.on("click",".search-result-group-line-tag",this._handleTagClickInSearchGroup),this._$searchResults.on("keydown",".search-result-group-line-tag, .search-box-filters-clear-all",this._handleKeydownInTagSearchGroup),this._$searchResults.on("keyup",this._handleKeyupInResults),this._$searchClear.on("click",this._handleClearSearchClick.bind(this)),this._$searchButton.on("click",this._handleSearchBtnClick.bind(this)),this._$backArrow.on("click",this._handleBrowseHeaderBackArrow.bind(this)),this._$mrvlLogo.length&&this._$mrvlLogo.on("click",this._handleBrowseHeaderBackArrow.bind(this)),this._options.showFormatFilters&&(this._searchFilters.formatFilters.holder$=this.$el.find(".vb-search-header-filters-background"),this._searchFilters.formatFilters.divs$=this.$el.find(".vb-search-header-formats-format"),this._searchFilters.formatFilters.divs$.on("click",this._handleFormatFilterClick),this._options.autoSearch&&this._options.autoSearch.needsToBeTriggered&&this._searchFilters.formatFilters.hideInResults&&this._searchFilters.formatFilters.holder$.addClass("hide-formats")),this._options.showFavoritesInHeader&&(this._$favoritesBtn=this.$el.find(".npw-visual-browser-header-favorites"),this._$favoritesBtn.on("click",this._handleFavoritesBtnClick.bind(this)))),window.marvel.events.on("sp-route-change-for-search",function(e){this._setSearchForCurrentRoutePath(e)}.bind(this)),window.marvel.events.on("add-search-history",function(e){this._handleAddSearchHistory(e)}.bind(this))},_handleAddSearchHistory:function(e){this.SearchRequestsController.addSearchHistoryForResults(e)},_currentRoutePathInfo:{typesData:{}},_getTrimmedInputText:function(){return this._$searchInput?this._$searchInput.val().trim():""},_setupExtraQueryValues:function(e){var s=window.location.pathname,r={};if("template"!==e.type&&s.includes("/sp/"+e.type+"-search")){var i=a.parse(window.location.href,!0);i.query&&(delete i.query.q,t.isEmpty(i.query)||(r=i.query))}"learn"===e.type&&(r.trigger="search"),e.currentData.extraQueryValues=r},_setSearchForCurrentRoutePath:function(e){e=e||{};var s,r=window.location.pathname,i="template",a=e&&e.searchStr||"";if(r.includes("/sp/project-search")||r.includes("/sp/shared")||r.includes("/sp/recents")||r.includes("/sp/projects")||r.includes("/sp/folders")?i="project":r.includes("/sp/learn")&&(i="learn"),this._currentRoutePathInfo.type===i)return e.initializing?this._initialRenderSearchFieldText=a:this._setSearchInput(a),void this._setupExtraQueryValues(this._currentRoutePathInfo);if(this._currentRoutePathInfo.currentData&&(this._currentRoutePathInfo.currentData.restoreText=this._restoreTextOnClick&&t.cloneDeep(this._restoreTextOnClick),!this._currentRoutePathInfo.currentData.restoreText)){var l=this._getTrimmedInputText();l&&(this._currentRoutePathInfo.currentData.restoreText={text:l})}(s=this._currentRoutePathInfo.typesData[i])||(s={type:i},"template"!==i&&(s.placeholder=u.getString(i+"-search-searchbar-placeholder"),s.tooltip={type:i,label:u.getString("npw-search-input-tooltip-"+i)},s.queryPath=i+"-search"),this._currentRoutePathInfo.typesData[i]=s),this._restoreTextOnClick=s.restoreText&&t.cloneDeep(s.restoreText),this._options.enableSearchHistory&&(this._searchHistory=this.SearchRequestsController.getMySearchHistory(this,i)),this._currentRoutePathInfo.type=i,this._currentRoutePathInfo.currentData=s,this._setupExtraQueryValues(this._currentRoutePathInfo),e.initializing?this._initialRenderSearchFieldText=a:(this._setPlaceholderAttr(),this._setSearchInput(a))},_createMenuItemClick:function(){},_onCreateProjectMenuOpen:function(){},_onCreateProjectMenuClose:function(){},_navigateToBrandingFromCreateProjectMenu:function(){this._options.SearchController.navigateToBrandingFromCreateProjectMenu(this)},_createDropdownAfterRender:function(e){if(this._options.searchReact){var t=this._options.searchReact;if(this.wrappedCreateMenuModel=this.wrappedCreateMenuModel||new s.Model,this.wrappedCreateMenuModel.set({userProps:this._options.userProps,context:this._options.context+":createProjectMenu",iconOnlyTrigger:this._options.userProps.createMenuIconOnlyTrigger,onButtonClick:this._createMenuItemClick,onOpen:this._onCreateProjectMenuOpen,onClose:this._onCreateProjectMenuClose,hideViewAll:!0,el:e,dataAuto:"search-create-project-menu",isInSearch:!0,handleNavigateToBranding:this._navigateToBrandingFromCreateProjectMenu.bind(this),handleHomeCreateFromScratch:function(e,t){e&&this._options.SearchController.handleHomeCreateFromScratchInSearch(this,e,t)}.bind(this)}),!this.wrappedReactCreateProjectsMenuCls){var r=t.reactWrapper.wrapComponentSpectrum(t.CreateProjectMenu,this.wrappedCreateMenuModel);this.wrappedReactCreateProjectsMenuCls=r.extend({cachename:"reactsearchcreatefromscratch",remove:function(){r.prototype.remove.call(this)}})}this.wrappedReactCreateFromScratch?this.wrappedReactCreateFromScratch.setElement(e):(this.wrappedReactCreateFromScratch=this._renderReactView(this.wrappedReactCreateProjectsMenuCls,e,this.wrappedCreateMenuModel),this.wrappedReactCreateFromScratch.listenToModelChange()),this.wrappedReactCreateFromScratch.render()}},viewCache:{},_renderReactView:function(e,t,r){var i,a=!1,l=!0;try{e.prototype.cachename&&this.viewCache[e.prototype.cachename]?i=this.viewCache[e.prototype.cachename]:a=!0,a&&((i=Object.create(e.prototype)).el=t,e.apply(i,Array.prototype.slice.call(arguments,1)),e.prototype.cachename&&(this.viewCache[e.prototype.cachename]=i)),r&&l&&(i.model=r),l&&i.render(s.history.fragment,{})}catch(o){window.marvel.logger.warn("render exception ["+o+"], View = "+e.prototype.cachename,o)}return i},_populateLibrariesDropdownAfterRender:function(t){var s=["searchview-featured-library-label","searchview-personal-library-label","searchview-shared-library-label","searchview-private-library-label"];t.find("option").each((function(t){e(this).text(u.getString(s[t]))})),t.on("change",(function(){d.trackEvent("libraries:templateDropDownPressed",{contextualData1:"location:editor"},"editor")}))},loadLibraries:function(e){var s;this.hideEmptyLibrariesView(),this.displaySpinner();var r=this.$el.find(".search-results-libraries");r.empty(),r.removeClass("hide"),"private"===e?(s="private",this.currentSelectedLibraryTypeLabel=u.getString("searchview-personal-library-label")):"shared"===e?(s="incoming",this.currentSelectedLibraryTypeLabel=u.getString("searchview-shared-library-label")):"public"===e&&(s="public",this.currentSelectedLibraryTypeLabel=u.getString("searchview-public-library-label")),this.currentSelectedLibraryType=s,v.default.loadLibraries(s,"name",!0).then(function(e){this.hideSpinner(),0===e.libraries.length?this.displayEmptyLibrariesView():(this._libraries=e.libraries,this.renderLibraries(e.libraries,s,!0),e.allLoaded||"public"===s||t.delay(function(e){this._appendToLibraries(s)}.bind(this),250))}.bind(this)).done()},_appendToLibraries:function(e){if(this.currentSelectedLibraryType===e){var t=this._libraries.length;v.default.loadMoreLibraries(e,"name",t,!0).then(function(t){this._libraries=this._libraries.concat(t.libraries),this.currentSelectedLibraryType===e&&t.libraries.length>0&&this.renderLibraries(t.libraries,e,!1),!1===t.allLoaded&&this._appendToLibraries(e)}.bind(this)).done()}},displaySpinner:function(){e(".more-to-come").addClass("showing")},hideSpinner:function(){e(".more-to-come").removeClass("showing")},renderBreadcrumb:function(){this.setCurrentView(b.BREADCRUMB),e(".search-libraries-breadcrumb").removeClass("hide");var t=this.$el.find(".search-libraries-breadcrumb-library-type");t.text(this.currentSelectedLibraryTypeLabel),t.click(this.onLibraryTypeClick),this.$el.find(".search-libraries-breadcrumb-library").text(this._theLibrarySelected.name)},onLibraryTypeClick:function(e){this.$el.find(".search-results-grid-view-holder").addClass("hide"),this._$searchLibraryEmpty.addClass("hide"),this.setCurrentView(b.DROPDOWN_LIBRARIES),this._hideCpSearchResults(),this.hideBreadcrumb(),this.displayLibrarySearchResults()},hideBreadcrumb:function(){e(".search-libraries-breadcrumb").addClass("hide")},hideLibrarySearchResults:function(){var e=this.$el.find(".search-results-libraries"),t=this.$el.find(".search-input-library-dropdown");e.addClass("hide"),t.addClass("hide")},displayLibrarySearchResults:function(){var e=this.$el.find(".search-results-libraries"),t=this.$el.find(".search-input-library-dropdown");e.removeClass("hide"),t.removeClass("hide")},setCurrentView:function(e){_=e,this.hideSpinner(),this._hideSearchResults()},hidingVisualBrowse:function(){this._options.asHeader&&this.$el.addClass("hide")},_getSearchOptionsFromUseCase:function(e){var s,r=e.searchTags||[],i=e.searchStr||e.matchedSearchStr||"",a={assetId:e.assetId,assetIdApp:e.app};return i.length&&!r.length&&(r=i.split(" ")),r.length||(a.findAllType="searchAll"),a.findAllType?s="":-1!==r[0].indexOf("-")?(a.tags=r,a.keywords=t.map(r,(function(e,t){return e.split("-")[1]})),s=a.keywords.join(" ")):(a.keywords=r,s=r.join(" ")),{options:a,fieldSearchStr:s}},getSearchQueryFromUseCase:function(e){var t=this._getSearchOptionsFromUseCase(e),s={assetId:e.alias||e.id};return t.options.findAllType?s.all=!0:s.keys=t.options.keywords.join(" "),s},doSearchFromUseCaseInfo:function(e,s){var r=this._getSearchOptionsFromUseCase(e.useCase);this._setSearchInput(r.fieldSearchStr),r.options.findAllType||this._getSearchResults(null,r.fieldSearchStr,{doNotShow:!0}),this._options.searchPageAndVideoAsRelated?"page"!==e.useCase.app&&"video"!==e.useCase.app||(r.options.assetId=null):this._setFormatFilter(e.useCase.app),r.options.analyticsData=t.assign({useCase:e.useCase.id,sparkFormat:e.useCase.app,searchTerm:r.fieldSearchStr,trigger:"seeMore"},s||{}),this._getTemplateResults(r.options)},_getTagNamesAnalyticValForAsset:function(e){return this._options.SearchController.getTagNamesAnalyticValForAsset(e)},_sendTemplatePressedAnalytics:function(e){this._options.SearchController.sendTemplatePressedAnalyticsFromSearchResult(this,e)},_finishSearchAfterError:function(e){this._setSearchingForResults(!1,{showImmediately:!0}),this._numResultsLastSearch=0,this._makeResultBoxFromNoSearchResults(e.searchString,e.tagFilters),e.resultsDefer&&e.resultsDefer.resolve()},_getTemplateResults:function(e){var t=e.app||this._searchFilters.current.format.app;t&&this._options.searchPageAndVideoAsRelated&&(t=null),e.app=t,e.isUserSearch=!0,this.SearchRequestsController.getTemplateResults(e).then(function(t){var s=this._options.asHeader;t.err?this._finishSearchAfterError(e):(t.assets.length||!this._showingCpResults?this.renderCpSearchResults(t,{jumpToDetailAssetId:e.jumpToDetailAssetId,backInfo:e.backInfo}):s=!0,s&&this._setSearchingForResults(!1,{showImmediately:!0}),t.assets.length?(this._numResultsLastSearch=t.assets.length,this._blurFieldAndHideResults({applyEscapeFocus:!0})):(this._numResultsLastSearch=0,this._makeResultBoxFromNoSearchResults(e.searchString,e.tagFilters)),e.resultsDefer&&e.resultsDefer.resolve())}.bind(this)).done()},createFromSearchResultsThumb:function(e,t){var s=this.SearchRequestsController.getCurrentSearch(),r=s.searchStr||"";if(t&&t.analytics&&(t.analytics.searchTerm=r,t.analytics.tagFilters=s.options.tagFilters),this._sendTemplatePressedAnalytics({createOptions:t,asset:e}),t.analyticsPage=t.analyticsPage||this._getAnalyticsPage(),t.analyticsFullTagNames=this._getTagNamesAnalyticValForAsset(e),t.searchStr=r,e.library){var i=h.getAppByType("post").getStorageImpl().currentDoc,a=e.library.isSharedWithUser()?"shared":"personal",l=this._options.editorLaunchOperation,o=void 0===i.getChildWithMap("content");w.default.show({fromEditor:"remix"===l,template:e,projectIsEdited:i.hasChanged()&&!o,currentProject:i,analyticsContext:{createLocation:"editorTemplateBrowse"}}),d.trackEvent("libraries:templatePreviewPressed",{contextualdata15:"cclType:"+a,contextualData10:"createFromLocation:editorTemplateBrowse"})}else{var n,c;if(!t.editorQuery)n=0===this._options.context.indexOf("editor:")?"editor-template":"search-template",e.isRecommended?e.isFakeRecommend?(c="fakeRecommended",n+="-fake-recommend"):(c="recommended",n+="-recommend"):c="searchResults",t.editorQuery={createLocation:n,section:c};!this._options.defaultCreateAction&&this._options.handleCreateFromSearchResultsThumbClick?this._options.handleCreateFromSearchResultsThumbClick(e,t):this._handleDefaultCreateFromSearchResults(e,t)}},_handleDefaultCreateFromSearchResults:function(e,t){this._showDefaultCreateConfirm(e,t)},_showDefaultCreateConfirm:function(e,t,s){var r=[],i=r,a=this._getPreviewLocation(t.previewLocation);r.push({id:"create",text:"search-results-confirm-cta-create",primary:!0,textIfAssetRequiresUpgrade:"search-results-confirm-cta-create-upgrade"}),this.showDetailConfirmForCurrentClickedThumb({asset:e,premiumTemplateBadge:t.premiumTemplateBadge,ctasForPremium:i,gridlessOptions:s,previewNavType:"side",title:void 0,subtitle:void 0,ctas:r,stringsAreIds:!0,cssClass:"vertical-default",isVertical:!0,previewLocation:a,analytics:{templatePreviewClosed:{callback:function(e,t){var s;s=t.cancelled?"cancel":t.asset.premium&&t.showUpgradeForPremium?"createNeedUpgrade":"create",e.contextualData5="action:"+s}}}}).then(function(e){e.closeDefer.resolve(),e.cta&&(t.detailRenditionInfo=e.detailRenditionInfo,s&&(t.searchQueryForReopen=s.searchInfoForReopen.query,t.searchQueryForReopen.assetId=e.asset.id),this.defaultCreateFromSearchResultsThumbClick(e.asset,t))}.bind(this))},_triggeringRemix:function(e){this._options.SearchController.vbTriggeringRemixFromSearchThumb(e,this)},getTotalTemplates:function(){return this._totalTemplates.marvel},defaultCreateFromSearchResultsThumbClick:function(e,t){if(e.isPremiumTemplate&&this._options.showUpgradeForPremium){var s=this._totalTemplates.marvel;this._options.SearchController.showPremiumUpgradeModalForPremiumTemplate(e,t,s)}else this._options.SearchController.remixFromSearchThumb(e,this,t),"header"===this._options.context&&this._hideCpSearchResults()},getCurrentSearchAnalytics:function(){return this.SearchRequestsController.getCurrentSearchAnalytics()},_ensureGridView:function(){this.searchResultsGridView||(this.searchResultsGridView=new m({el:this._options.resultsHolder$||this.$el.find(".search-results-grid-view-holder"),parentRerendersOnResize:this._options.parentRerendersOnResize,SearchController:this._options.SearchController}))},showCreateConfirmWithoutGrid:function(e){var t=e.gridOptions;this._ensureGridView();var s="npw"===this._options.context?"search":this._options.context,r={analytics:e.analytics||{},previewLocation:e.previewLocation};t||(t=this._getGridOptions()),r.analytics.context=r.analytics.context||s,this._showDefaultCreateConfirm(e.asset,r,{gridOptions:t,searchInfoForReopen:e.searchInfoForReopen,assets:e.resultAssets,searchAnalytics:e.searchAnalytics})},_getPreviewLocation:function(e){var t=e;return t||("header"===(t=this._options.context)||"npw"===t?t="search":"editor:post"===t&&(t="editorPost")),t},showDetailConfirmForCurrentClickedThumb:function(e){"npw"===this._options.context||this._options.context;return e.analytics||(e.analytics={}),e.previewLocation=this._getPreviewLocation(e.previewLocation),e.premiumTemplateBadge=this._options.premiumTemplateBadge,!this._options.userProps.isPremiumUser&&this._options.userProps.allowPremiumTemplates?e.premiumRequiresUpgrade=!0:e.ctasForPremium=null,this.searchResultsGridView.showDetailConfirmForCurrentClickedThumb(e)},getDataForReopenRedraw:function(e){var t={isResize:!!(e=e||{}).isResize,lastRenderedResults:this._lastRenderedResults,showingCpResults:this._showingCpResults,dataToRestore:this._getDataForRestoringAfterRedraw()};return t.showingCpResults&&(t.cpResultsRedrawData=this.searchResultsGridView.getDataForRedraw()),t},loadMoreFromResultsClicked:function(e){this._librarySearchEnabled?this.loadMoreFromResultsLibrary(e):this.loadMoreFromResultsSearch(e)},loadMoreFromResultsLibrary:function(e){v.default.loadMoreElements(this._theLibrarySelected,"application/vnd.adobe.element.template+dcx").then(function(t){this.renderLibrarySearchResults(t,e,this._lastRenderedResults)}.bind(this)).done()},loadMoreFromResultsSearch:function(e){var t={searchTerm:this.SearchRequestsController.getCurrentSearch().searchStr,type:e.isClick?"click":"scroll",loadAssets:e.pagination.lastShowing,numAssets:e.pagination.total,contextualData16:"tagSelected:"+(e.selectedTags||"NULL")},s=this.SearchRequestsController.getCurrentSearch();this._trackEvent("NPWVisualBrowseSearchLoadMoreInTemplateResults",t),s.targetTotal+=40,this.SearchRequestsController.repeatSearch({loadNext:!0,targetTotal:s.targetTotal,noProgressOverlay:!0,splitQuery:s.splitQuery,totalPulled:s.totalPulled,extraResults:s.extraResults,aggregations:s.aggregations})},assetDetailShownInResults:function(e){this._sendTemplatePressedAnalytics({detailOptions:e})},_searchFilters:{current:{format:{}}},_setFormatFilter:function(s,r){if("object"==typeof s&&(s=s.typeName),this._searchFilters.formatFilters&&this._searchFilters.formatFilters.divs$){if(r)s=r.data("app");else{var i=t.find(this._searchFilters.formatFilters.divs$,(function(t){return e(t).data("app")===s}));r=e(i)}this._searchFilters.formatFilters.divs$.removeClass("selected"),r.addClass("selected")}return this._searchFilters.current.format=this._getFilterFormatFromApp(s),this._calcPlaceholderText(),this._setPlaceholderAttr(),r},_getFilterFormatFromApp:function(e){return t.find(this._searchFilters.formatFilters.settings,function(t){return t.app==e}.bind(this))},_handleFavoritesBtnClick:function(e){this._handleFormatFilterClick(e)},_handleFormatFilterClick:function(s){var r=e(s.currentTarget),i=this._searchFilters.current.format.app,a={format:{app:r.data("app"),id:r.data("id")}};this._setFormatFilter(a.format.app,r),"favorites"===a.format.id&&(this._searchFilters.current.format.app=i),this._options.handleFilterSelectedInSearch({filter:a,showingCpResults:this._showingCpResults,currentSearch:t.cloneDeep(this.SearchRequestsController.getCurrentSearch())}).startSearchTimer&&this._filterClickWantsRepeat()},triggerAutoSearch:function(e){var s=function(e){var t=e.searchOptions&&e.searchOptions.fallbackSearch&&e.searchOptions.fallbackSearch.triggered,s=t?t.fieldSearchStr:e.fieldSearchStr,r=t?t.isFindAll:e.searchOptions.isFindAll;this._setSearchInput(s),r||this._getSearchResults(null,s,{doNotShow:!0}),e.appInfo&&(this._options.searchPageAndVideoAsRelated||this._setFormatFilter(e.searchQuery.app))}.bind(this);this.SearchRequestsController.triggerAutoSearch(e,s).then(function(s){if(_===b.DROPDOWN_FEAT_TEMPLATES){var r="";e.fallbackSearch&&e.fallbackSearch.triggered&&(r=e.fallbackSearch.triggered.fieldSearchStr,this._setSearchInput(e.fallbackSearch.triggered.fieldSearchStr)),s.err?(t.assign({},e,{searchString:r}),this._finishSearchAfterError(e)):this.renderCpSearchResults(s,{hideProgressWhenRendered:!0,jumpToDetailAssetId:e.jumpToDetailAssetId,backInfo:e.backInfo})}}.bind(this))},restoreSearchAfterReRender:function(e){e=e||{},t.assign(this,e.dataToRestore||{});var s,r=this.SearchRequestsController.restoreSearchAfterReRender(e);r&&(s=t.isUndefined(e.searchFieldStr)?r.userStr||r.searchStr:e.searchFieldStr,this._setSearchInput(s),e.showingCpResults&&(e.lastRenderedResults.options.hideProgressWhenRendered=!0,this.renderCpSearchResults(null,null,e.lastRenderedResults)))},_tagClickWantsRepeat:function(e){this._showingCpResults&&(this.searchResultsGridView.searchTriggered(),this._getTemplateResults(e))},_filterClickWantsRepeat:function(){this._showingCpResults&&(window.marvel.logger.debug("calling _filterClickWantsRepeat while showing results"),this.searchResultsGridView.searchTriggered(),this.SearchRequestsController.repeatSearch({targetTotal:80,forceApp:{app:this._searchFilters.current.format.app}}))},_handleKeydownInTagSearchGroup:function(t){if(-1!==R.concat([i.DOM_VK_RETURN,i.DOM_VK_TAB]).indexOf(t.keyCode))if(t.stopImmediatePropagation(),t.preventDefault(),t.keyCode===i.DOM_VK_RETURN)this._arrowPresses.lastTagKeydownEventTime=t.timeStamp,e(t.currentTarget).hasClass("search-box-filters-clear-all")?this._handleSearchResultClickClear(t):this._handleTagClickInSearchGroup(t,{focusTagIfMore:!0});else if(t.keyCode===i.DOM_VK_UP)this._focusInputIgnoreEvent(),this._incSelectedLine(-1);else if(t.keyCode===i.DOM_VK_DOWN)this._focusInputIgnoreEvent(),this._incSelectedLine(1);else{var s=e(document.activeElement),r=!1;t.keyCode===i.DOM_VK_RIGHT||t.keyCode===i.DOM_VK_TAB&&!t.shiftKey?s.hasClass("search-box-filters-clear-all")||s.hasClass("show-more-tags-btn")?this._arrowPresses.selectedTags$[0].focus():s[0].nextElementSibling&&e(s[0].nextElementSibling).is(":visible")?s[0].nextElementSibling.focus():this._arrowPresses.showMoreTags$?this._arrowPresses.showMoreTags$.focus():this._arrowPresses.clearTags$&&this._arrowPresses.clearTags$.hasClass("enabled")?this._arrowPresses.clearTags$.focus():this._arrowPresses.selectedTags$[0].focus():s.hasClass("search-box-filters-clear-all")?this._arrowPresses.showMoreTags$?this._arrowPresses.showMoreTags$.focus():r=!0:s.hasClass("show-more-tags-btn")?r=!0:s[0].previousElementSibling?s[0].previousElementSibling.focus():s.hasClass("search-results-selected-tag")&&(this._arrowPresses.clearTags$.hasClass("enabled")?this._arrowPresses.clearTags$.focus():this._arrowPresses.showMoreTags$?this._arrowPresses.showMoreTags$.focus():r=!0),r&&this._arrowPresses.selectedTags$[this._arrowPresses.selectedTags$.length-1].focus()}},_handleTagClickInSearchGroup:function(t,s){var r=e(t.currentTarget),i=r.hasClass("show-more-tags-btn");if(t.stopImmediatePropagation(),t.preventDefault(),i){var a;if(s&&s.focusTagIfMore){var l=this._arrowPresses.selectedTags$[this._arrowPresses.selectedTags$.length-1];a=l.nextElementSibling||l}r.parents(".search-result-group-line").addClass("show-more-tags-tags"),this._arrowPresses.selectedTags$=this._$searchResults.find(".search-results-selected-tag"),this._arrowPresses.showMoreTags$=null,a?a.focus():this._focusInputIgnoreEvent()}else if(r.hasClass("search-results-selected-tag"))this.searchResultSelectedTagClicked(r);else{var o,n=this._getSelectedLine(),c=this._options.keysForTags,d=r.data("id"),u=h.getAppByType(this._searchFilters.current.format.app),g=n.line$&&n.line$.data(c?"keywords":"tags")||"",m=g&&g.split(":")||[],p=!0;if(c){var f=m.indexOf(d);-1===f?m.push(d):(m.splice(f,1),p=!1),o=m.join(" ")}else{var v=r.data("groupId")+"-"+d,w=m.indexOf(v);-1===w?m.push(v):(m.splice(w,1),p=!1),o=this.SearchRequestsController.keysStrFromTagsArray(m)}var b={searchString:o,addHistory:!0,app:u};c?b.keys=m:b.tags=m,this._getSearchResults(null,b.searchString,{doNotShow:!0}),this._setSearchInput(b.searchString),this._handleSearchResultClick(null,r,{tagId:d,fromTag:!0,selType:p?"tagAddInSearchBox":"tagRemoveInSearchBox"})}},tagClickedInResults:function(e,s){var r=this.SearchRequestsController.getCurrentSearch();r&&r.searchStr;s=s||{};var i=this._$searchInput.val(),a=!1,l=!0,o=!t.isUndefined(s.changeSelectionValue),n=t.isUndefined(s.changeSelectionValue)?!e.selected:s.changeSelectionValue;if(this.searchResultsGridView&&this.searchResultsGridView._showingDetail&&(this.searchResultsGridView.tagClickedSinceChangingToGridDetail||(this.searchResultsGridView.tagClickedSinceChangingToGridDetail=!0)),n)e.selected=!0,this._currentSelectedTags.push(e);else{var h=-1;t.find(this._currentSelectedTags,(function(t,s){if(t.id===e.id)return h=s,!0})),e.selected=!1,-1!==h?this._currentSelectedTags.splice(h,1):l=!1}(l||o)&&(i=r.searchStr,a=!0,this._tagClickWantsRepeat({userStr:i,searchStr:i,searchString:i,tagFilters:this._currentSelectedTags,analyticsData:{trigger:e.selected?"tagClickAdd":"tagClickRemove",contextualData17:"tagId:"+(e.srcKey||e.id)}})),a&&this._setSearchInput(i)},setFavoriteForAsset:function(e,t){return this._options.VisualBrowseUseCasesController.applyFavoriteStateToSearchResultAsset(e,t,this.SearchRequestsController.getCurrentSearch()).then(function(e){return e}.bind(this))},redisplayCachedSearchResults:function(e){this._setCurrentSelectedTagsFromResults(e.results),this._setSearchInput(this.SearchRequestsController.getCurrentSearch().searchStr),this._setFormatFilter(e.currentFilter.format.app),this.renderCpSearchResults(e.results,e.originalOptions)},_getDataForRestoringAfterRedraw:function(){return this.SearchRequestsController.getDataForRestoringAfterRedraw()},setBackText:function(e,t){var s,r,i;if(t=t||{},e)s=this._options.SearchController.getBackArrowText(e.backType),r=e.backPath,i=e.backType;else if("npw"!==this._options.context)i="home",s=this._options.SearchController.getBackArrowText(i);else{var a=!t.hidingResults;if(e=this._options.SearchController.getBackInfoFromNPWCurrentPath(null,a))i=e.backId,s=e.text,r=e.backPath;else{var l=this.SearchRequestsController.getTriggeredAutoSearchOptions();i=l&&l.backType?l.backType:this._showingCpResults?"visualBrowse":"projects",s=this._options.SearchController.getBackArrowText(i)}}this._$backArrow.text(s),this._$backArrow.attr("title",s),this._$backArrow.addClass("has-text"),this._$backArrow.data("back-id",i),this._$backArrow.data("back-path",r||"")},_setCurrentSelectedTagsFromResults:function(e){this._currentSelectedTags=e.tagFilters||[],e.tagsData.currentSelectedTags=this._currentSelectedTags},handleInputFocusFromGrid:function(){this._$searchInput.focus()},_getGridOptions:function(e,s,r){var i=this._options.autoShowRecommended;i&&this._options.autoShowRecommendedOnlyOnFindAll&&!r&&(i=!1);var a=i&&this._options.recommendNumberOfSearchResults,l=t.assign({},{analytics:{context:this._options.context},gridDims:this._gridDims,showLoadMoreButton:this._options.showLoadMoreButton,tagClickHandler:this.tagClickedInResults.bind(this),loadMoreClickHandler:this.loadMoreFromResultsClicked.bind(this),assetDetailShownCallback:this.assetDetailShownInResults.bind(this),createFromThumbClickHandler:this.createFromSearchResultsThumb.bind(this),favoritesEnabled:this._options.favoritesEnabled,setFavorite:this.setFavoriteForAsset.bind(this),detailViewEnabled:this._options.detailViewEnabled||e&&e.enableDetailView,allowPremiumTemplates:this._options.allowPremiumTemplates,showUpgradeForPremium:this._options.showUpgradeForPremium,allowGiphyTemplates:this._options.allowGiphyTemplates,animationEnabled:this._options.animationEnabled,autoPlayDetailAnimation:this._options.autoPlayDetailAnimation,premiumTemplateBadge:this._options.premiumTemplateBadge,preloadAllResultMp4s:this._options.preloadAllResultMp4s,backArrowTextForDetail:this._options.detailViewEnabled&&this._options.SearchController.getBackArrowText("searchResults"),hideAssetUntilLoaded:this._options.hideAssetUntilLoaded,isReRender:s,maxResultsBeforeAutoLoadFromScroll:80,assetLoadFailed:this.SearchRequestsController.assetLoadFailed,autoShowRecommended:i,recommendNumberOfSearchResults:a,getRecommendedResults:this.SearchRequestsController.getRecommendedResults,uiStrings:this._options.uiStrings,containerDims:this._options.containerDims,preDetailViewCallback:this._options.preDetailViewCallback&&this.preDetailViewCallback.bind(this),maxNumSelectedTags:this._options.maxNumSelectedTags||6,maxNumTagsInResults:this._options.maxNumTagsInGridResults||8,getTagNamesAnalyticValForAsset:this._getTagNamesAnalyticValForAsset.bind(this),handleInputFocusFromGrid:this.handleInputFocusFromGrid},e||{},this._options.resultsOptions||{});return l.debugSettings=this._debugSettings,l},renderCpSearchResults:function(e,s,r){var i=!1;r?(i=!0,e=r.results,s=r.options,this._lastRenderedResults=r):this._lastRenderedResults={results:t.cloneDeep(e),options:t.cloneDeep(s)},this._setCurrentSelectedTagsFromResults(e),this._setShowingResults(),this._options.showFormatFilters&&this._searchFilters.formatFilters.hideInResults&&this._searchFilters.formatFilters.holder$.addClass("hide-formats"),this.setBackText(s.backInfo);var a=""===e.searchStr&&0===e.tagFilters.length;s=this._getGridOptions(s,i,a),this.searchResultsGridView?this._reapplyGridViewInitOptionsOnNextResults&&(this._reapplyGridViewInitOptionsOnNextResults=!1,this._reapplyGridViewInitOptions()):this._ensureGridView(),this.searchResultsGridView.renderResults(e,s),s.hideProgressWhenRendered&&this._setSearchingForResults(!1,{showImmediately:i}),this.moveFocusToBeforeSearchField()},renderLibrarySearchResults:function(e,s,r){if(_===b.BREADCRUMB){var i={},a=[],l=0;t.forEach(e.elements,(function(e){i[e.id]=e,e.rendition={aspectRatio:1400233,href:e.thumbnail,maxHeight:857,maxWidth:1200},e.templatedImgHref=e.getPrimaryImageRepresentationHref(),e.width=200,e.height=200,e.widthInGrid=100,e.heightInGrid=100,a.push(e)})),r&&r.results&&(r.results.assets&&(l=(l=Math.floor(r.results.assets.length/2))<10?0:l,a=r.results.assets.concat(e.elements)),r.results.assetsById&&(i=t.assign(r.results.assetsById,i))),0===a.length?this._$searchLibraryEmpty.removeClass("hide"):(this._$searchLibraryEmpty.addClass("hide"),this.renderCpSearchResults({assets:a,assetsById:i,tagsData:{currentSelectedTags:null,tagsInOrder:[]},total:e.totalCount,hasMore:!e.allLoaded},{jumpToDetailAssetId:null,backInfo:null}),setTimeout(function(){this.searchResultsGridView.scrollToGridRow(l)}.bind(this),10),a.length<20&&setTimeout(function(){this.searchResultsGridView.loadMoreIfNotLoadingAndMore()}.bind(this),10))}},clearLibrariesResults:function(){this.$el.find(".search-results-libraries").addClass("hide")},hideEmptyLibrariesView:function(){this.$el.find(".search-results-no-libraries").addClass("hide")},displayEmptyLibrariesView:function(){this.$el.find(".search-results-no-libraries").removeClass("hide")},renderLibraries:function(e,t,s){var r=this.$el.find(".search-results-libraries");if(!r.hasClass("hide")&&this.currentSelectedLibraryType===t){s&&r.empty();var i=this;e.forEach((function(e,t){var s=i.getLibraryItem(e,t);r.append(s)})),window.setTimeout((function(){r.addClass("showing")}),100)}},getLibraryItem:function(t,s){var r,i=e("<div class='search-results-library-item'></div>"),a=e("<p class='label'><span>"+t.name+"</span></p>");return i.on("click",this._handleSearchLibraryChange),i.data("index",s),i.data("item",t),i.attr("data-id",t.id),t.isTeam()?r=e("<p class='right-team-icon'></p>"):t.isPublic()?r=e("<p class='right-public-icon'></p>"):t.isSharedWithUser()&&(r=e("<p class='right-shared-icon'></p>")),i.append(a),r&&i.append(r),i},_reapplyGridViewInitOptions:function(){this.searchResultsGridView.applyNewInitOptions({el:this._options.resultsHolder$||this.$el.find(".search-results-grid-view-holder"),parentRerendersOnResize:this._options.parentRerendersOnResize})},searchViewShown:function(e){(e=e||{}).gridDims&&t.assign(this._gridDims,e.gridDims),e.containerDims&&(this._options.containerDims=t.assign(this._options.containerDims||{},e.containerDims)),this._showingCpResults&&this.searchResultsGridView.searchViewShown(e),this._sizeResultsMaxHeightForContainer(),this._calcPlaceholderText(),this._setPlaceholderAttr()},containerResized:function(e){e.isWindowResize?this._debouncedContainerResized(e):this._containerResized(e)},_maxResultsInnerHeightStr:"",_sizeResultsMaxHeightForContainer:function(){var e=this._$searchInput.offset().top-this.$el.offset().top+this._$searchInput.height(),t=this._options.containerDims.height-(e+48);this._maxResultsInnerHeightStr=t-24+"px",this._$searchResults.css("max-height",t)},_containerResized:function(e){this._options.containerDims=t.assign(this._options.containerDims||{},e.containerDims),e.gridDims&&t.assign(this._gridDims,e.gridDims),t.isUndefined(e.showUnderlay)||(e.showUnderlay?this._$searchUnderlay.addClass("showing"):this._$searchUnderlay.removeClass("showing")),this._showingCpResults&&this.searchResultsGridView.containerResized({containerDims:e.containerDims,gridDims:this._gridDims}),this._sizeResultsMaxHeightForContainer(),this._calcPlaceholderText(),this._setPlaceholderAttr()},remove:function(){return this._options.doNotEmpty||(this.$el.empty(),this.$el.addClass("hide")),this.searchResultsGridView&&(this.searchResultsGridView.remove(),this.searchResultsGridView=null),this._searchSuggest&&this._searchSuggest.remove(),this},preDetailViewCallback:function(e){var s=this._options.preDetailViewCallback(e);return t.isEqual(s.containerDims,this._options.containerDims)?{resized:!1}:(this._options.containerDims=t.assign(this._options.containerDims||{},s.containerDims),s.gridDims&&t.assign(this._gridDims,s.gridDims),{resized:!0,containerDims:this._options.containerDims,gridDims:this._gridDims})},getLocStringForEditor:function(e){return u.getString(e)}})}.apply(t,r))||(e.exports=i)},2261:function(e,t,s){var r,i;r=[s(7),s(2),s(1),s(6),s(14),s(25),s(23),s(11),s(0),s(47),s(95),s(402),s(1384)],void 0===(i=function(e,t,s,r,i,a,l,o,n,h,c,d,u){"use strict";var g,m=n.cpTemplateSearchRemixFeedTag,p=n.cpTemplateSearchRemixPaidTag,f=n.cpTemplateSearchMappedTagRemixPaid,v=f.split("-")[1],w=n.cpTemplateSearchGiphyTag,b=w.split("-")[1],_={thumbClick:"useCaseSearch",seeMore:"useCaseSearch"},y=r.Model.extend({initialize:function(e){g=(e=e||{}).logger||window.marvel.logger,this.setCallbacks(e.callbacks),this._options=e||{},this._initializeLists(),this.dataId=this._options.dataId,window._searchViewTemplateSearchBadAssets||(window._searchViewTemplateSearchBadAssets={count:0,ids:{}}),this._badAssets=window._searchViewTemplateSearchBadAssets,this._boundFunctions||(this._boundFunctions=!0,this.assetLoadFailed=this.assetLoadFailed.bind(this),this.getRecommendedResults=this.getRecommendedResults.bind(this)),this._sparkContentSearchAllFields=!l.hasFeature("npw-vb-search-spark-content-search-tags-only"),this._processOneSparkContentAsset=this._processOneSparkContentAsset.bind(this),this._options.enableSearchHistory&&this._initSearchHistory("template"),this._initSizeFilterMaps(this._options.sizeFilterInfo)},getSearchLocale:function(){return this._options.searchLocale},updateOptions:function(e){},_normalizeAspectRatio:function(e){return Math.floor(1e6*e)},_aspectRatioSearchString:function(e,t){return this._aspectRatioSearchStringMinMax(e,e,t)},_aspectRatioSearchStringMinMax:function(e,t,s){return"rendition.aspectRatio:["+(e-(s=s||0))+" TO "+(t+s)+"]"},_initSizeFilterMaps:function(e){if(e&&!e.unsupported){var s=e.sizeFilterMapsJSON.maps,r={},i=this._normalizeAspectRatio(e.sizeFilterMapsJSON.sizeRangeForEquality),a=i;this._sizeFilterMaps={sizesByLowerCaseId:r},this._sizeFilterMaps.sizes=t.reduce(e.pickerInfo.sizes,function(e,t){var i=s[t.id],l={id:t.id,aspectRatio:this._normalizeAspectRatio(t.aspectRatio),_baseWidth:t.width,_baseHeight:t.height};return r[l.id.toLowerCase()]=l,i&&(l.filters=i.filters,l.str=i.str,l.sizeQueryString=this._aspectRatioSearchString(l.aspectRatio,a)),e[l.id]=l,e}.bind(this),{});var l=[],o=t.reduce(this._sizeFilterMaps.sizes,(function(e,t){var s=t.aspectRatio+"",r=e[s];return r||(r={aspectRatio:t.aspectRatio,sizes:[],sizeQueryString:t.sizeQueryString},e[s]=r,l.push(r)),r.sizes.push(t),t.aspectGroup=r,e}),{});this._sizeFilterMaps.aspectGroups=o,l.sort((function(e,t){return e.aspectRatio-t.aspectRatio})),t.each(l,(function(e,t){e.index=t}));var n=l.length;t.each(l,(function(e,t){var s,r,a=[];if(t)for(r=t-1;r>=0&&(s=l[r],e.aspectRatio-s.aspectRatio<=i);r--)a.push(s);if(t<n-2)for(r=t+1;r<n&&(s=l[r]).aspectRatio-e.aspectRatio<=i;r++)a.push(s);e.related=a})),t.each(l,function(e){if(e.related&&e.related.length){var s={min:e.aspectRatio,max:e.aspectRatio};t.reduce(e.related,(function(e,t){return t.aspectRatio<e.min?e.min=t.aspectRatio:t.aspectRatio>e.max&&(e.max=t.aspectRatio),e}),s),e.relatedSizeQueryString=this._aspectRatioSearchStringMinMax(s.min,s.max,a)}else e.relatedSizeQueryString=e.sizeQueryString}.bind(this))}else this._sizeFilterMaps=null},_initializeLists:function(){this._fieldToTagMapsNoLoc=t.clone(this._fieldToTagMaps),delete this._fieldToTagMapsNoLoc.locales,this._nonLangTagFieldIds=t.keys(this._fieldToTagMapsNoLoc),this._nonLangTagToFieldMap=t.reduce(this._fieldToTagMapsNoLoc,(function(e,t,s){return e[t]=s,e}),{});var e=t.keys(this._fieldToTagMaps);this._allFieldsToSelect=e.concat(this._nonTagFieldsToSelect),this._initCustomFlags()},setCallbacks:function(e){this.callbacks=t.assign(this.callbacks||{},e||{}),t.each(this.requiredCallbackNames,(function(t){e[t]||(e[t]=function(){g.debugger("send "+t+" in in setCallbacks")})}))},assetLoadFailed:function(e){this._badAssets.ids[e.id]||(this._badAssets.count++,this._badAssets.ids[e.id]=!0)},_combineResultAssets:function(e){var s=t.reduce(e,(function(e,t){return e[t.id]=t,t.matched=!1,e}),{}),r=this._assets.assetsArray;return t.each(r,(function(e,t){var i=s[e.id];i&&(i.matched=!0,r[t]=i)})),t.each(e,function(e){e.matched||r.push(e)}.bind(this)),r},_setupOneAssetRenditionFromResult:function(e,t){e.width=e.width||e.w,e.height=e.height||e.h},_assets:{assetsById:{},assetsArray:[]},_allowedTagPrefixes:["explore","spcase","spterm","spstyle","spcolor","spsize","spingred","spinfluencer","spcollect","sploc","spmap","cpat"],_addAllTagsToAsset:function(e){e.allTags||(e.tags?(e.allTags=t.map(e.tags,(function(e){var t=e.split("-"),s=t.slice(1);return{label:s.join(" "),keyword:s.join("-"),prefix:t[0],id:e}})),e.allTags.sort((function(e,t){return e.label>=t.label?1:-1}))):e.allTags=[])},_assignTagsDataToResults:function(e,s,r){var i=e.tagsData,a=s.options.tagFilters;a||(a=[]),(i=this._tagsDataFromSparkContentResults(e,a,s.options)).tagsInOrder=i.tagFilters.concat(i.tagsInOrder);var l=[],o=t.reduce(e.assets,function(s,r){var i=t.isUndefined(r.isPremiumTemplate)?-1!==r.tags.indexOf(f):r.isPremiumTemplate,a=-1!==r.tags.indexOf(w),o=r.animated;if(i){if(!this._options.allowPremiumTemplates)return g.debug("asset in result with premium when not allowed:"+r.id,r),s;r.isPremiumTemplate=!0}if(a){if(!this._options.allowGiphyTemplates)return g.debug("asset in result with giphy when not allowed:"+r.id,r),s;r.isGiphyTemplate=!0}if(r.sploc?-1===r.sploc.indexOf("sploc-")&&(r.sploc="sploc-"+r.sploc):r.sploc="sploc-en",this._setupOneAssetRenditionFromResult(r,e),"post"===r.app&&t.isUndefined(r.remixable)&&(r.remixable=!0),!r.templatedImgHref)return g.debug("asset with no rendition:"+r.id,r),s;if(o&&this._options.animationEnabled){var n=r.templatedImgHref.split("rendition")[0],h=r.templatedImgHref.split("/version/")[1].split("/")[0];r.animationHref=n+"dcx/"+r.id+"/content/videoRendition.mp4/version/"+h}return this._addAllTagsToAsset(r),r.tagsForData=r.tags.join(":"),r._orderedIndex=l.length,l.push(r),s[r.id]=r,s}.bind(this),{});t.assign(e,{tagsData:i,tagFilters:i.tagFilters,assetsById:o,assets:l})},_getTokensArrayFromQueryStr:function(e,s){var r="+";-1!==e.indexOf("%20")?r="%20":-1!==e.indexOf(" ")&&(r=" ");var i=e.split(r);return s&&(i=t.map(i,this._cleanUserStringAllowColon)),i},_getValidPctFilterStringFromValue:function(e,t){var s="";if("string"==typeof e)if(e=e.toLowerCase(),-1!==["hide","only","allow"].indexOf(e))s=e;else if(t){var r=e.split("pct:");if(2===r.length)if(1===(r=r[1].split(":")).length){var i=1*r[0];0===i?s="hide":i>0&&i<=100&&(s="pct:"+i)}else if(2===r.length){var a=1*r[0],l=1*r[1];l>0&&a>0&&l<=10&&a<=10&&(s="pct:"+a+":"+l)}}return s},getTriggeredAutoSearchOptions:function(){return this._triggeredAutoSearchOptions},_getQueryBoolean:function(e,s){return t.isUndefined(e)?s:!0===e||"true"===e},_initCustomFlags:function(){var e;this._options.allowPremiumTemplates&&((e=this._initCustomFlag(v,2,"npw-vb-search-box-cat-all-premium")).assetProps={isPremiumTemplate:!0},e.filterTag.isPremium=!0),this._options.animationEnabled&&((e=this._initCustomFlag("animated",3,"npw-vb-search-box-cat-all-animated")).filterTag.isAnimated=!0)},_initCustomFlag:function(e,t,s){var r=i.getString(s),a=r.toLowerCase(),l={label:r,labelLc:a};this._customFlags[e]=l,this._customLabels[e]=l.label,this._customLabelsLc[e]=a,this._customKeyFromLabelLc[a]=e;var o="spmap-"+e,n={id:a,label:r,key:e,keyword:e,srcKey:e,tag:o,tags:[o],filterStr:e+":true",customFilterType:e,suggestSortPriority:t};return l.filterTag=n,l},_customFlags:{},_customLabels:{},_customLabelsLc:{},_customKeyFromLabelLc:{},_getCustomTag:function(e,s){var r=this._customFlags[e];return r?t.assign({},r.filterTag,s||{}):(g.debug("[SearchRequestsController] bad tagType in _getCustomTag: "+e),{})},getValidatedSizeFilterId:function(e){var t;if(this._sizeFilterMaps){var s=this._sizeFilterMaps.sizesByLowerCaseId[e.toLowerCase()];s&&(t=s.id)}return t},getValidatedSizeFilterMap:function(e){return this._sizeFilterMaps&&this._sizeFilterMaps.sizesByLowerCaseId[e.toLowerCase()]||null},triggerAutoSearch:function(e,r){var i=e.trigger||e.searchQuery&&e.searchQuery.trigger||this._triggeredAutoSearchCallbackOptions&&this._triggeredAutoSearchCallbackOptions.searchQuery.trigger||"autoSearch";if(e.needsToBeTriggered=!1,e.useController)return r&&r(this._triggeredAutoSearchCallbackOptions),e.searchPromise?e.searchPromise.then((function(e){return e})):s.resolve(this._lastProcessedData);var a,l=[],o=[],n=e.searchQuery,h=n.app&&this._options.VisualBrowseAndSearchAppsController.getFormatInfo(n.app),c={assetId:n.assetId};if(this._triggeredAutoSearchOptions=e,n.limit){var d=1*n.limit;isNaN(d)||(d>100&&(d=100),c.limit=d),this._getQueryBoolean(n.forceLowerLimit,!1)&&(c.forceLowerLimit=!0)}if(n.filters&&(o=this._getTokensArrayFromQueryStr(n.filters,!0)),"true"===n.all)c.isFindAll=!0;else{t.isUndefined(n.tag)?t.isUndefined(n.key)?t.isUndefined(n.keys)?t.isUndefined(n.tags)||(o=this._getTokensArrayFromQueryStr(n.tags)):l=this._getTokensArrayFromQueryStr(n.keys):l=t.isArray(n.key)?n.key:[n.key]:t.isArray(n.tag)?n.tag:[n.tag];var u={};l=t.reduce(l,function(e,t){return t=this.cleanUserString(t.split("-").join(" ")),u[t]||(u[t]=!0,e.push(t)),e}.bind(this),[])}if(n.sizeFilter)if(this._sizeFilterMaps){var m=this._sizeFilterMaps.sizesByLowerCaseId[n.sizeFilter.toLowerCase()];if(m){var f=m.str||"";c.sizeFilterMap=m,t.each(m.filters,(function(e){-1===o.indexOf(e)&&o.push(e)})),f&&(l=t.uniq(l.concat(f.split(" "))))}}else g.debug("requesting sizeFilter but unsupported:"+n.sizeFilter,e);var w,b=n[p]||n.premium;if(b){var _=this._getValidPctFilterStringFromValue(b,!0);if(""!==_&&(c.premiumFilter=_,o.length)){var y=o.indexOf(v);-1!==y&&o.splice(y,1)}}(o.length&&l.length&&(l=t.filter(l,(function(e){return-1===o.indexOf(e)}))),l.length?c.keywords=l:c.isFindAll=!0,o.length&&(c.tagFilters=t.map(o,function(e){var t=e.split(":"),s=t[0],r=t.length>1?t[1]:void 0;if(s===v)return this._getCustomTag(v,{value:r});c.verifyTagFilters=!0;var i=s.split("-");if(i.length>1){var a=this._nonLangTagToFieldMap[i[0]];if(a)return{fields:[a],tag:s,tags:[s],id:s,keyword:i.slice(1).join("-"),value:r,needsLabel:!0,label:i.slice(1).join(" ")}}return{keyword:s,id:s,value:r}}.bind(this))),a=c.isFindAll?"":c.keywords.join(" "),c.analyticsData={searchTerm:a,trigger:i},h&&(this._options.searchPageAndVideoAsRelated&&("page"!==h.type&&"video"!==h.type||(c.assetId=null)),c.analyticsData.sparkFormat=h.type),t.isUndefined(n.fallbackThresh))||(w="default"===n.fallbackThresh?this._options.defaultFallbackThresh:1*n.fallbackThresh,!isNaN(w)&&w>=0&&(c.fallbackSearch={minResults:w}));return this._triggeredAutoSearchCallbackOptions={searchOptions:c,fieldSearchStr:a,appInfo:h,searchQuery:n},r&&r(this._triggeredAutoSearchCallbackOptions),this.getTemplateResults(c)},repeatSearch:function(e){var s=t.isUndefined(e.searchStr)?this._currentSearch.searchStr:e.searchStr,r=t.isUndefined(e.userStr)?this._currentSearch.userStr:e.userStr,i=e.forceApp?e.forceApp.app:this._currentSearch.app,a=e.options||this._currentSearch.options;e.deferForRender||this.callbacks.setSearchingForResults(!0,e),this._getSparkContentSearchResults(i,s,r,a,e).then(function(t){e.deferForRender?e.deferForRender.resolve(t):this.callbacks.renderCpSearchResults(t,{repeatOptions:e,hideProgressWhenRendered:!0})}.bind(this),(function(t){g.error("repeat search returned error",t),e.deferForRender&&e.deferForRender.reject(t)}))},getCurrentSearch:function(){return this._currentSearch},getSearchDataForRestore:function(e){return e},getCurrentSearchAnalytics:function(){return this._lastGetTemplateResultsAnalytics||{}},getLastTemplateResultsAnalyticsTriggerCategory:function(){this._lastGetTemplateResultsAnalytics||g.debug("no _lastGetTemplateResultsAnalytics in getLastTemplateResultsAnalyticsTriggerCategory");var e=this._lastGetTemplateResultsAnalytics.trigger;return _[e]||"templateSearch"},getDataForRestoringAfterRedraw:function(){return{_currentSearch:this._currentSearch,_tagsData:this._tagsData,_nextCursorHref:this._nextCursorHref,_remainingIds:this._remainingIds,_assets:this._assets,_lastGetTemplateResultsOptions:this._lastGetTemplateResultsOptions,_lastGetTemplateResultsAnalytics:this._lastGetTemplateResultsAnalytics}},restoreSearchAfterReRender:function(e){return e=e||{},t.assign(this,e.dataToRestore||{}),e.currentSearch||this._currentSearch},getTemplateResultsForOpeningEditor:function(e,s){var r={searchQuery:t.clone(s)};return r.searchQuery.app=e.typeName||e,this.triggerAutoSearch(r)},keysStrFromTagsArray:function(e,s){return t.map(e,(function(e){return e.split("-").slice(1).join(" ")})).join(t.isUndefined(s)?" ":s)},_getSearchTermForAnalytics:function(e,s){return t.isUndefined(e)&&(e=s||""),""===e?"searchTerm:none":e},_trackEvent:function(e,t){a.trackEvent(e,t||{},this._getAnalyticsPage())},_getAnalyticsPage:function(){var e=(this._options.context||"npw")+":search";return this._showingCpResults&&(e+="ResultsGrid"),e},_areTagsListsDifferent:function(e,s){if(!e||!e.length)return!(!s||!s.length);if(!s||!s.length||s.length!==e.length)return!0;var r=t.reduce(e,(function(e,t){return e[t.keyword]=!0,e}),{});return!!t.find(s,(function(e){return!r[e.keyword]}))},isSearchDifferent:function(e){var t=!0;return this._lastGetTemplateResultsOptions&&((t=this._lastGetTemplateResultsOptions.searchString!==e.searchString)||(t=e.findAllType!==this._lastGetTemplateResultsOptions.findAllType||this._areTagsListsDifferent(e.tagFilters,this._lastGetTemplateResultsOptions.tagFilters))),t},_getRealRecommendedResults:function(e){return this.getTemplateResults({isRecommendedSearch:!0,recommendAlgorithm:"TEMPLATE_RECOMMEND_V1",forceLowerLimit:!0,limit:30,analyticsData:{trigger:"recommendedSearch",searchTerm:"",sparkFormat:"post"}})},getRecommendedResults:function(e){return this._recommendedSearchDefer||(this._recommendedSearchDefer=s.defer(),this._getRealRecommendedResults(e).then(function(s){var r,i=s.assets,a=s.assetsById;r=e.isEdu?[{fields:["topics"],id:"spterm-k12",keyword:"k12",label:"k12",needsLabel:!0,tag:"spterm-k12",tags:["spterm-k12"]}]:[{fields:["categories"],id:"explore-feed",keyword:"feed",label:"feed",needsLabel:!0,tag:"explore-feed",tags:["explore-feed"]}],this.getTemplateResults({isRecommendedSearch:!0,limit:50,analyticsData:{trigger:"recommendedSearchFallback",searchTerm:"",sparkFormat:"post"},verifyTagFilters:!0,tagFilters:r}).then(function(e){e.assets.forEach((function(e){a[e.id]||(e.isFakeRecommend=!0,i.push(e),a[e.id]=e)})),t.each(i,(function(e){e.isRecommended=!0})),this._recommendedSearchDefer.resolve({recommendedAssets:i,recommendedAssetsById:a})}.bind(this))}.bind(this)).catch((function(e){window.marvel.logger.error("error retrieving recommended results",e)}))),this._recommendedSearchDefer.promise},getTemplateResults:function(e){var r=s.defer();this._lastGetTemplateResultsOptions=t.cloneDeep(e);var i,l,o=e.app,n="",h=!1;this._options.searchPageAndVideoAsRelated?o="post":o&&this._options.searchPageAndVideoAsRelated&&(o=null),e.user?(i=e.searchStr||"",n=e.userStr||i,l=e.user):e.findAllType?(i="",h=this._options.keysForTags):e.tags?(i=e.tags.join(" "),n=this.keysStrFromTagsArray(e.tags)):this._options.keysForTags?(h=!0,i=e.searchString||e.keywords&&e.keywords.join(" ")||""):i=n=e.keywords&&e.keywords.join(" ")||"",e.isRecommendedSearch||this.callbacks.setSearchingForResults(!0,e);var c,d={pageName:a.getPageName(),contextualData1:"keyword:"+(e.analyticsData.searchTerm||""),contextualData3:"type:templates",contextualData6:"isUserSearch:"+!!e.isUserSearch,trigger:e.analyticsData.trigger};(d.tagId?d.contextualData13="method:tag":d.contextualData13="method:search",e.tagFilters&&e.tagFilters.length)?c="["+t.map(e.tagFilters,(function(e){return e.keyword})).join(",")+"]":c="none";d.contextualData2="filters:"+c;var u,g={field:"tags",keysOnly:h,assetId:e.assetId||e.jumpToDetailAssetId,sizeFilterMap:e.sizeFilterMap,user:l,tagFilters:e.tagFilters,contentSearch:!!e.contentSearch,flags:{},strFilters:[],verifyTagFilters:e.verifyTagFilters,recommendAlgorithm:e.recommendAlgorithm};if(e.limit&&(g.limit=e.limit,e.forceLowerLimit&&(g.forceLowerLimit=!0)),g.assetId&&e.assetIdApp&&(g.assetIdApp=e.assetIdApp),this._options.allowGiphyTemplates&&(g[w]="allow"),this._options.animationEnabled){var m;if("searchAllAnimated"===e.findAllType)m=!0;else if(i){u=i.toLowerCase().split(" ");var p=this._customLabelsLc.animated;(m=-1!==u.indexOf(p))&&g.strFilters.push(p)}if(m)g.tagFilters&&t.find(g.tagFilters,(function(e){return e.isAnimated}))||("searchAllAnimated"===e.findAllType?(g.tagFilters||(g.tagFilters=[]),g.tagFilters.push(this._getCustomTag("animated"))):g.flags.animated=!0)}if(this._options.allowPremiumTemplates){var b,_,y=e.premiumFilter;if(i)-1!==(u=i.toLowerCase().split(" ")).indexOf(this._customLabelsLc[v])?(b=!0,g.strFilters.push(this._customLabelsLc[v])):b=-1!==u.indexOf(v)||-1!==u.indexOf(f);else if("searchAllPremium"===e.findAllType)_=this._getCustomTag(v),g.tagFilters?t.find(g.tagFilters,(function(e){return e.isPremium}))||g.tagFilters.push(_):g.tagFilters=[_];else if(g.tagFilters){var x=t.find(g.tagFilters,(function(e){return e.isPremium}));x&&(y="false"===x.value||!1===x.value?"hide":"only")}_||(y||(y="searchAllPremium"===e.findAllType?"only":this._options.premiumFilter),b&&"hide"!==y&&"only"!==y&&(y="pct:100",g.flags[v]="true"),g[f]=y)}else g[f]="hide";return this._getSparkContentSearchResults(o,i,n,g).then(function(i){var a,l;if(e.fallbackSearch&&i.total<=e.fallbackSearch.minResults){var n=e.fallbackSearch.fieldSearchStr||"";g.tagFilters=e.fallbackSearch.tagFilters||[],l=!0,e.fallbackSearch.triggered={fieldSearchStr:n,isFindAll:""===n},a=this._getSparkContentSearchResults(o,n,n,g)}else a=s(i);a.then(function(s){var i;if(i=location.pathname.endsWith("/sp/")||location.pathname.endsWith("/sp")?"home":location.pathname.endsWith("/sp/search")?"templateSearch":"editor",!e.disableAnalytics){var a={contextualData4:"location:"+i,contextualData5:"resultsCount:"+s.total};this._lastGetTemplateResultsAnalytics=t.assign({},d,a),this._trackEvent("search:keywordEntered",this._lastGetTemplateResultsAnalytics),e.addHistory&&!l&&this._addSearchHistoryAfterResults(s,e),s.searchAnalytics={searchStr:this._lastGetTemplateResultsAnalytics.contextualData2,tagFilters:this._lastGetTemplateResultsAnalytics.contextualData14,searchTerm:this._lastGetTemplateResultsAnalytics.searchTerm}}r.resolve(s)}.bind(this))}.bind(this),(function(e){r.resolve({err:e||"unknown err"})})).done(),r.promise},_defaultSearchHistory:{searches:{}},_recalcSortedSearchHistory:function(){var e=t.map(this._searchHistory.savedHistory.searches,(function(e){return e}));e.sort((function(e,t){return t.d-e.d})),e.length>20&&e.splice(20),this._searchHistory.searches=e},getMySearchHistory:function(e,t){return this._initSearchHistory(t),this._searchHistory},_searchHistories:{},_initSearchHistory:function(e){var s,r=this._searchHistories[e];if(r)return this._historyEnabled=!0,void(this._searchHistory=r);try{var i=o.getProfile();i&&i.userId&&(s="vb-tmpl-search-history-json_"+(new d).update(i.userId).digest("hex"),"template"!==e&&(s+="_"+e))}catch(n){g.warn("error initting search history",n)}if(s){var a;this._historyEnabled=!0;try{var l=window.localStorage.getItem(s);l&&(a=JSON.parse(l))}catch(n){}a?a.searches=t.reduce(a.searches,(function(e,t,s){return(s=s.toLowerCase())&&(e[s]=t,(t.t||t.k)&&(delete t.t,delete t.k)),e}),{}):a=t.cloneDeep(this._defaultSearchHistory),this._searchHistory={savedHistory:a,searches:[],type:e,storageKey:s},this._searchHistories[e]=this._searchHistory,this._recalcSortedSearchHistory()}},addSearchHistoryForResults:function(e){var t=this._searchHistory&&this._searchHistory.type;t===e.type?this._addSearchHistoryAfterResults({total:e.total||0},e):g.debug("history type mismatch: requested: "+e.type+", current:"+(t||"uninitialized"))},_addSearchHistoryAfterResults:function(e,t){if(this._historyEnabled&&e.total&&t.searchString&&this._searchHistory){var s,r=t.searchString.toLowerCase(),i=this._searchHistory.savedHistory.searches[r],a={d:Date.now(),r:1,s:t.searchString};if(t.app&&(a.app="object"==typeof t.app?t.app.typeName:t.app),i&&(a.r=i.r+1),this._searchHistory.savedHistory.searches[a.s]=a,this._recalcSortedSearchHistory(),this._searchHistory.storageKey){try{s=JSON.stringify(this._searchHistory.savedHistory)}catch(l){g.error("error parsing json in addSearchHistory",{err:l,searchOptions:t})}if(s)try{window.localStorage.setItem(this._searchHistory.storageKey,s)}catch(l){g.warn("error saving to localStorage in addSearchHistory",l)}}}},getHeroTemplateFromResults:function(e,s){if(!e||!e.assets||!e.assets.length)return null;if(this._options.allowPremiumTemplates&&"ifEntitled"===s.premium&&l.hasFeature("is-paid-user")){var r=t.find(e.assets,(function(e){return e.isPremiumTemplate}));return r||e.assets[0]}return t.find(e.assets,(function(e){return!e.isPremiumTemplate}))},_constantSearchType:"application/vnd.adobe.theo.document+dcx",_constantSearchTypeFilterString:'type:"application/vnd.adobe.theo.document+dcx"',_nonTagFieldsToSelect:["created","description","id","urn","premium","remixCount","rendition","_score","animated","title"],_fieldToTagMaps:{categories:"explore",colors:"spcolor",collections:"spcollect",influencers:"spinfluencer",ingredients:"spingred",locales:"sploc",styles:"spstyle",tasks:"spcase",topics:"spterm"},_aggsFieldsToRequest:["categories","colors","collections","influencers","ingredients","styles","tasks","topics"],getFieldToMapKey:function(e){return this._fieldToTagMaps[e]||"unk"},_labelFromTagKey:function(e){return e.split("-").join(" ")},_tagsDataFromSparkContentResults:function(e,s,r){var i,a={},l=0,o=(r=r||{}).verifyTagFilters&&{};s&&(i=t.reduce(s,(function(e,t,s){return t.selected=!0,t.isFilter=!0,t.needsLabel?(a[t.id]={tag:t,index:s},l++):e[t.id]={index:s,tag:t},o&&(o[t.keyword]=t,t.needsValidation=!0),e}),{}));var n,h=[],c={},d=(e.options.keysOnly,t.reduce(this._customFlags,(function(e,t,s){return e[s]={flagData:t,assets:[]},e}),{}));if(e.aggregations){var u={};if(!e.aggregations.processed){var g=e.aggregations;g.length||(g=[g]),t.each(g,function(e){t.each(e,function(e,s){if(e.buckets&&e.buckets.length){var r=this._fieldToTagMapsNoLoc[s];r?t.each(e.buckets,function(e){var t=e.key.split(" ").join("-");if(t){var s=e.label||this._labelFromTagKey(t),n=s.toLowerCase(),h=this._customKeyFromLabelLc[n],c=u[n];if(h)if(c)u[n].numAssets+=e.docCount;else{var d=this._getCustomTag(h,{numAssets:e.docCount,aggregateType:"only"});u[n]=d}else{var g=r+"-"+t;if(c)c.numAssets+=e.docCount,-1===c.fields.indexOf(r)&&c.fields.push(r),-1===c.tags.indexOf(g)&&c.tags.push(g),c.label!==s&&s!==n&&c.label.toLowerCase()===c.label&&(c.label=s);else{var m={numAssets:e.docCount,id:n,label:s,key:t,srcKey:t,keyword:t,fields:[r],tags:[g],tag:g,aggregateType:"only",assets:[]};u[n]=m}if(l&&a[g]){var p=a[g];p.tag.id=s,p.tag.needsLabel=!1,i[p.tag.id]=p,--l&&delete a[g]}}o&&o[t]&&(o[t].tagMatch=u[s])}}.bind(this)):window.marvel.logger.debug("unknown aggId in _tagsDataFromSparkContentResults")}}.bind(this))}.bind(this)),e.aggregations={aggTags:u,processed:!0}}n=t.cloneDeep(e.aggregations.aggTags),c=n}return t.each(e.assets,function(e){e.originalTags=e.tags,e.tags=[],t.each(d,(function(s,r){e[r]&&(s.assets.push(e),s.flagData.assetProps&&t.assign(e,s.flagData.assetProps))})),t.each(this._fieldToTagMaps,function(s,r){t.each(e[r],function(t){if(""!==t){t=t.split(" ").join("-");var i=s+"-"+t;"locales"!==r?e.tags.push(i):e.sploc=i}}.bind(this))}.bind(this))}.bind(this)),t.each(c,function(e,s){h.push(e),e.selected=!1,e.aggregateType?"inResult"===e.aggregateType&&(e.numAssets=Math.max(e.assets.length,e.numAssets)):e.numAssets=e.assets.length,e.fields=t.uniq(e.fields),this._calcTagSuggestPriority(e)}.bind(this)),i&&(h=t.filter(h,(function(e){var t=i[e.id];return t?(s[t.index]=e,e.selected=!0,e.isFilter=!0):e.isFilter=!1,e.isSearchTerm=!1,!e.isFilter})),o&&(s=t.reduce(s,(function(e,t){var s=o[t.keyword];return s&&s.tagMatch&&e.push(s.tagMatch),e}),[]))),h.sort(this.sortTagsInOrder),t.each(d,function(t,r){if(t.assets.length||!(""!==e.searchStr||s&&s.length)){var a=t.flagData.labelLc,l=c[a];if(!l){var o=i[a];o?l=o.tag:(l=this._getCustomTag(r),h.unshift(l)),c[a]=l}l.assets=t.assets,l.numAssets=t.assets.length}}.bind(this)),t.assign(e.tagsData,{tags:c,tagsInOrder:h,tagFilters:s}),e.tagsData},_processQueryPostResults:function(e){var s=0,r=0,i=[];return t.each(e,function(e){var t=e.srcPart;if(e.err)window.marvel.logger.error("Error with split query: "+t.sendOptions.q,e.err),t.data=this._getEmptyResultsObj();else if(t.doingNumFromFirst){t.doingNumFromFirst=!1;var a=t.data._embedded.results;t.data=e.value;var l={};t.data._embedded.results=a.concat(t.data._embedded.results).filter((function(e){if(!l[e.id])return l[e.id]=!0,!0})),t.data._embedded.count=t.data._embedded.results.length}else t.data=e.value,t.data._embedded.aggregations&&i.push(t.data._embedded.aggregations);t.total=t.data._embedded.total,s+=t.total,t.nextIndex=0,t.totalPulled+=t.data._embedded.count,t.numRemaining=t.total-t.totalPulled,t.nextHref=t.data._links&&t.data._links.next&&t.data._links.next.href,t.nextHref&&(t.nextBody=t.data._links.next.body),t.nextHref?t.numRemaining||(t.numRemaining=1):t.numRemaining=0,r+=t.numRemaining}.bind(this)),{total:s,numRemaining:r,aggregations:i.length&&i}},_setupSplitQueries:function(e,s,r,i,a){var l=s&&s[0],o=[],n=function(e,s){var a=s&&i.limit||1,n=t.cloneDeep(i),h={sendOptions:n,totalPulled:0},c={};if(e&&n.filters&&(n.filters=n.filters.replace(l,e)),r){var d=t.cloneDeep(n);n.filters?n.filters+=" AND premium:false":n.filters="premium:false",d.filters?d.filters+=" AND premium:true":d.filters="premium:true",h.interleave=r.free;var u=[h];u.push({sendOptions:d,interleave:r.premium,totalPulled:0}),t.each(u,function(e){o.push({sendOptions:this._getSparkContentQueryTotalSendOptions(e.sendOptions,a),srcPart:e})}.bind(this)),c.parts=u}else c.single=h,o.push({sendOptions:this._getSparkContentQueryTotalSendOptions(h.sendOptions,a),srcPart:h});return c}.bind(this),h=[];s?t.each(s,(function(e,t){h.push(n(e,!t))})):h.push(n(null,!0));var c={queries:h};return c.currentQuery=c.queries[0],a&&o.push({sendOptions:this._getAssetIdQueryData(a),srcPart:{assetId:a}}),this._sendSparkContentQueryPostArray(o).then(function(s){if(a){var r=s.pop(),l=r&&r.value._embedded.results[0];l&&(c.assetIdResult=this._processOneSparkContentAsset(l))}var o=this._processQueryPostResults(s);c.initialTotal=o.total,c.numRemaining=o.numRemaining,c.aggregations=o.aggregations,c.queries=t.filter(c.queries,function(e){return e===c.currentQuery||(e.single?!!e.single.total&&(e.single.numFromFirst=e.single.data._embedded.results.length,e.single.numRemaining+=e.single.numFromFirst,void(c.numRemaining+=e.single.numFromFirst)):(e.parts=t.filter(e.parts,(function(e){return!!e.total&&(e.numFromFirst=e.data._embedded.results.length,e.numRemaining+=e.numFromFirst,c.numRemaining+=e.numFromFirst,!0)})),!!e.parts.length&&(1===e.parts.length&&(e.single=e.parts[0],e.parts=null),!0)))}.bind(this)),e.splitQuery=c,e.targetTotal=i.limit}.bind(this))},_doNextSplitQuery:function(e,r,i){var a=i.splitQuery,l=r.targetTotal-this._assets.assetsArray.length;if(!a.currentQuery)return s.reject({errorMessage:"no more records for split query"});if(!a.currentQuery.single){var o=t.filter(a.currentQuery.parts,(function(e){return e.numRemaining>0&&e.nextHref}));a.currentQuery.parts=o,1===o.length&&(a.currentQuery.single=o[0])}var n=[];return a.currentQuery.single?n.push({sendOptions:this._getSplitCursorQuerySendOptions(a.currentQuery.single,l),srcPart:a.currentQuery.single}):t.each(a.currentQuery.parts,function(e){n.push({sendOptions:this._getSplitCursorQuerySendOptions(e,l),srcPart:e})}.bind(this)),this._sendSparkContentQueryPostArray(n).then(function(t){return this._processQueryPostResults(t),this._processSplitQuery(e,r,i)}.bind(this))},cleanUserString:function(e){return e.replace(/[.,\/#!$%\^&\*;:{}\]\[=\_"`~()\\]/g," ").replace(/ +/g," ").trim()},_cleanUserStringAllowColon:function(e){return e.replace(/[.,\/#!$%\^&\*;{}\]\[=\_"`~()\\]/g," ").replace(/ +/g," ").trim()},_getSingularIfPlural:function(e){if(u.isPlural(e)){var t=u.singular(e);if(t!==e)return t}return""},_requestFieldIdFromFieldId:function(e){return this._nonLangTagToFieldMap[e]||e},_getFiltersFromTagFilters:function(e){var s={customFilters:[]};return s.filters=t.reduce(e,function(e,r){if(r.customFilterType)s.customFilters.push(r);else{var i='"'+r.keyword.split("-").join(" ")+'"';if(r.fields)if(r.fields.length>1){var a=t.map(r.fields,function(e){return this._requestFieldIdFromFieldId(e)+":"+i}.bind(this));i="("+a.join(" OR ")+")"}else i=this._requestFieldIdFromFieldId(r.fields[0])+":"+i;e.push(i)}return e}.bind(this),[]),s},_getSparkContentSearchResults:function(e,s,r,i,a){if((a=a||{isFirstQuery:!0,totalPulled:0}).extraResults)return this._preSparkContentSearchTemplateResults(i,this._currentSearch,a);var o;"string"==typeof e&&(e=h.getAppByType(e)),i.user&&window.marvel.logger.debug("asking for user in _getSparkContentSearchResults:"+i.user),s&&(s=this.cleanUserString(s)),i.limit&&a.isFirstQuery?(o=i.limit)<1?o=1:o>100?o=100:i.forceLowerLimit||(o=Math.max(o,40)):o=a.isFirstQuery?80:a.targetTotal;var n,d,u,g,p={searchStr:s,userStr:r,app:e,options:i,splitQuery:a.splitQuery,totalPulled:a.totalPulled,targetTotal:o};if(this._currentSearch=p,a.splitQuery)return this._doNextSplitQuery(i,p,a);if(a.loadNext){var v=p.targetTotal-this._assets.assetsArray.length;v<40&&(v=40);var _=c.parse(this._nextCursorHref,!0);_.protocol="https",_.host=this._options.searchHost,_.query.limit=v,_.search="",n=c.format(_)}else{var y=!this._sparkContentSearchAllFields,x=i[f],S=[],k=i.strFilters&&i.strFilters.slice()||[],T=!t.isEmpty(i.flags)&&i.flags;if(i.tagFilters&&i.tagFilters.length){var C,R={},F=t.reduce(i.tagFilters,function(e,s){if(s.customFilterType)R[s.customFilterType]=s,s.isPremium&&(C=s),e.push(s.filterStr);else if(s.tags){var r=t.reduce(s.tags,function(e,t){var s=t.split("-"),r=this._nonLangTagToFieldMap[s[0]],i=e[r];return i||(i=[],e[r]=i),i.push(s.slice(1).join("-")),e}.bind(this),{}),a=t.reduce(r,(function(e,t,s){var r=s+":";return 1===t.length?r+='"'+t[0]+'"':r+='("'+t.join('" OR "')+'")',e.push(r),e}),[]);1===a.length?e.push(a[0]):e.push("("+a.join(" OR ")+")")}else{i.verifyTagFilters||window.marvel.logger.debug("no tags for tag filter",s);var l='"'+s.keyword.split("-").join(" ")+'"';if(s.fields)if(s.fields.length>1){var o=t.map(s.fields,(function(e){return e+":"+l}));l="("+o.join(" OR ")+")"}else l=s.fields[0]+":"+l;e.push(l)}return e}.bind(this),[]);T&&t.each(T,function(e,t){R.hasOwnProperty(t)||(S.push(t+":"+e),k.push(this._customLabelsLc[t]))}.bind(this)),F.length&&(S=S.concat(F)),C&&"hide"!==x&&"pct:0"!==x&&(x="only")}else T&&t.each(T,function(e,t){S.push(t+":"+e),k.push(this._customLabelsLc[t])}.bind(this));if(i.sizeFilterMap){var I=i.sizeFilterMap.aspectGroup?i.sizeFilterMap.aspectGroup.sizeQueryString:i.sizeFilterMap.sizeQueryString;I&&S.push(I)}if(k.length&&s.length){k=t.uniq(k);var A=t.filter(s.split(" "),(function(e){return""!==e&&-1===k.indexOf(e.toLowerCase())}));s=A.join(" ")}-1!==(u={q:s||"",limit:p.targetTotal,select:this._allFieldsToSelect.join(",")}).q.indexOf(m)&&(u.q=u.q.split(m).join("")),y&&(u.searchIn=this._nonLangTagFieldIds.join(",")),u.aggs=this._aggsFieldsToRequest.join(","),u.aggsLimit=10;var D,P=""!==s&&["-_score"]||[];if(l.hasFeature("npw-vb-search-scs-sort-score-by-remix-count-over-created")||P.push("-created"),P.push("-remixCount"),x&&"hide"!==x&&"pct:0"!==x){if("pct:100"===x||"only"===x)D="premium:true";else if(0===x.indexOf("pct:"))if(l.hasFeature("npw-vb-search-scs-no-split-query-for-premium-freq"))u.premiumFreq=2;else{var L=1,$=1,O=x.split(":");if(2===O.length){var M=1*O[1];isNaN(M)||M>0&&M<100&&50!==M&&(M<50?L=Math.min(Math.round(100/M)-1,10):$=Math.min(Math.round(100/(100-M))-1,10))}else 3===O.length&&($=Math.round(1*O[1]),L=Math.round(1*O[2]),isNaN($)||($>10?$=10:$<1&&($=1)),isNaN(L)||(L>10?L=10:L<1&&(L=1)));g={free:L,premium:$}}}else D="premium:false";D&&!i.flags.premium&&S.push(D),"allow"!==i[w]&&S.push("NOT ingredients:"+b);var E=this.getSearchLocale(),V=E.split("-")[0],z=V+"*",B=!1;if(u.qLoc=E,"en"!==V&&!l.hasFeature("npw-vb-search-scs-no-en-fallback")&&((u.premiumFreq||g)&&l.hasFeature("npw-vb-search-scs-split-query-for-premium-locales")&&(B=!0),!B)){z="("+z+" OR en*)";var H="locales";V>"en"&&(H="-"+H),P.unshift(H)}z&&(B&&(d=["locales:"+z,"locales:en*"]),S.push("locales:"+z)),this._constantSearchTypeFilterString&&S.push(this._constantSearchTypeFilterString),S.length&&(u.filters=S.join(" AND ")),u.orderBy=P.join(","),u.q||(u.q="*");var N=this._options.searchPathPrefix;i.recommendAlgorithm&&(N+="/recommend",u.algorithm=i.recommendAlgorithm),n=c.format({protocol:"https",host:this._options.searchHost,pathname:N,query:u})}return d||g?this._setupSplitQueries(a,d,g,u,i.assetId).then(function(){return this._processSplitQuery(i,p,a)}.bind(this)):(i.assetId&&!a.loadNext&&(this._fixSendOptionsJsonForPost(u),n={sendOptions:u,assetId:i.assetId}),this._doSparkContentQuery(n,i,p,a))},_getEmptyResultsObj:function(e){return{_embedded:{count:0,results:[],total:0},_links:{self:{href:e}}}},_setProcessedAssetAsFirstAsset:function(e,s){if(0!==e._orderedIndex){var r=-1;if(t.isUndefined(e._orderedIndex)||s.assetsArray[e._orderedIndex]===e&&(r=e._orderedIndex),-1===r){var i=-1;e._orderedIndex=0,t.each(s.assetsArray,(function(t,s){t!==e?t._orderedIndex=s+1:i=s})),-1!==i&&s.assetsArray.splice(i,1),s.assetsArray.unshift(e)}else s.assetsArray.splice(r,1),s.assetsArray.unshift(e),t.each(s.assetsArray,(function(e,t){e._orderedIndex=t}))}},_addAssetAsFirstAsset:function(e,t){t.assetsById[e.id]=e,this._setProcessedAssetAsFirstAsset(e,t),this._addAllTagsToAsset(e)},_addMappedAssetToAssetsObj:function(e,t){t=t||this._assets;var s=this._options.VisualBrowseUseCasesController.getAssetFromData({asset:{id:e,app:"post"}});return s&&s.app&&this._addAssetAsFirstAsset(s,t),s},_cleanupSplitQueriesAfterProcess:function(e){var s=0;e.queries=t.filter(e.queries,(function(e){if(e.single)e.numRemaining=e.single.numRemaining;else{e.numRemaining=0;var r=t.filter(e.parts,(function(t){return e.numRemaining+=t.numRemaining,t.nextHref}));e.numRemaining&&(1===r.length?e.single=r[0]:e.parts=r)}return s+=e.numRemaining,e.numRemaining})),e.currentQuery=e.queries[0],e.hasMoreQueries=e.queries.length>1,e.numRemaining=s},_processSplitQuery:function(e,t,r){t.splitQuery=r.splitQuery;var i=s.defer();return this._preSparkContentSearchTemplateResults(null,t,r).then(function(s){if(this._assets={assetsArray:s.assets,assetsById:s.assetsById},e.assetId){var a=s.assetsById[e.assetId];if(a)0!==a._orderedIndex&&this._setProcessedAssetAsFirstAsset(a,this._assets);else if(t.splitQuery&&t.splitQuery.assetIdResult)this._addAssetAsFirstAsset(t.splitQuery.assetIdResult,this._assets);else{var l=this._addMappedAssetToAssetsObj(e.assetId,this._assets);l&&(this._assets.assetsById[l.id]=l)}}this._tagsData=s.tagsData,this._cleanupSplitQueriesAfterProcess(t.splitQuery),s.hasMore=!!t.splitQuery.currentQuery,s.total=this._assets.assetsArray.length+t.splitQuery.numRemaining,t.extraResults&&(s.total+=t.extraResults.assets.length),this._assets.assetsArray.length>=t.targetTotal?i.resolve(s):t.splitQuery.numRemaining?this._doNextSplitQuery(e,t,r).then((function(e){i.resolve(e)})):i.resolve(s)}.bind(this)),i.promise},_getAssetIdQueryData:function(e){return{limit:1,filters:'id:"'+e+'"'}},_moveAssetToBeginningOfArray:function(e,s){return t.find(s,(function(t,r){if(t.id===e){var i=s.splice(r,1);return s.unshift(i[0]),!0}}))},_doSparkContentQuery:function(e,t,r,i){var a,l=s.defer();if(e.assetId){var o={main:e.sendOptions,asset:this._getAssetIdQueryData(e.assetId)};a=this._sendSparkContentQueryPost(null,o).then(function(e){var t;try{if(t=e._embedded.asset._embedded.results[0])this._moveAssetToBeginningOfArray(t.id,e._embedded.main._embedded.results)||(e._embedded.main._embedded.results.unshift(t),e._embedded.main._embedded.total++)}catch(s){}return e._embedded.main}.bind(this))}else a=this._sendSparkContentQuery(e);return a.then(function(e){var s=this._nextCursorHref,a=(i.totalPulled||0)+e._embedded.count;this._nextCursorHref=e._links&&e._links.next&&e._links.next.href,e.hasMore=!!this._nextCursorHref,e.totalPulled=a,r.totalPulled=a,e.numRemaining=e._embedded.total-e.totalPulled,this._preSparkContentSearchTemplateResults(e,r,i).then(function(o){if(this._assets={assetsArray:e.assets,assetsById:e.assetsById},t.assetId&&!e.assetsById[t.assetId]&&this._addMappedAssetToAssetsObj(t.assetId,this._assets),this._tagsData=e.tagsData,i&&i.numRepeats&&i.numRepeats>3)s===this._nextCursorHref&&s&&(this._nextCursorHref=null,o.hasMore=!1,window.marvel.logger.error("[SearcRequestController] cursor not updating:"+s)),l.resolve(o);else if(this._assets.assetsArray.length>=r.targetTotal)l.resolve(o);else if(this._nextCursorHref){var n=i&&i.numRepeats||0;this.repeatSearch({loadNext:!0,numRepeats:n+1,deferForRender:l,targetTotal:r.targetTotal,totalPulled:a})}else l.resolve(o)}.bind(this))}.bind(this),function(e){l.reject(e)}.bind(this)).done(),l.promise},_sentUrls:[],_sendSparkContentQuery:function(t){var r=s.defer();return this._sentUrls.push(t),window.marvel.logger.debug("sendSparkContentQuery:"+t),e.ajax({type:"GET",url:t,headers:{"X-Api-Key":n.sparkContentSearchApiKey,Accept:"application/hal+json"},success:function(e,t,s){r.resolve(e)}.bind(this),error:function(e,t,s){window.marvel.logger.error("[SearcRequestController] Errored out while attempting to get query count from content service: ["+e.status+"]",e.responseJSON||e.responseText),r.reject(e)}.bind(this)},null,!0),r.promise},_sendSparkContentQueryPostArray:function(e){var r={},i=0,a=[],l=!1,o=t.reduce(e,(function(e,t,s){var a=t.sendOptions;return a.algorithm&&(l=!0,-1!==a.filters.indexOf("premium:false")?a.premium=!1:a.premium=!0),a.fulfilledData?r["r"+s]=a.fulfilledData:(e["r"+s]=a,i++),e}),{});return i?this._sendSparkContentQueryPost(null,o,l).then(function(s){var i=s._links&&s._links.next&&s._links.next.body;return t.each(e,(function(e,t){var l="r"+t,o=r[l];if(!o){var n=(o=s._embedded[l]).nextBody||i&&i[l];n&&(o._links.next.body=n)}a.push({value:o,srcPart:e.srcPart})})),a}.bind(this),(function(e){return s.reject(e)})):(t.each(e,(function(e,t){a.push({value:r["r"+t],srcPart:e.srcPart})})),s.resolve(a))},_sendSparkContentQueryPostArraySimple:function(e){var r=[];if(!e.length)return s.resolve(r);var i=t.reduce(e,(function(e,t,s){return e["r"+s]=t,e}),{});return this._sendSparkContentQueryPost(null,i).then(function(s){var i=s._links&&s._links.next&&s._links.next.body;return t.each(e,(function(e,t){var a="r"+t,l=s._embedded[a];if(l){var o=l.nextBody||i&&i[a];o&&(l._links.next.body=o)}r.push(l)})),r}.bind(this),(function(e){return s.reject(e)}))},_sendSparkContentQueryPost:function(t,r,i){if(!t){var a=this._options.searchPathPrefix;i&&(a+="/recommend"),t=c.format({protocol:"https",host:this._options.searchHost,pathname:a})}var l=s.defer();return i?o.getAccessToken().then((function(s){e.ajax({method:"POST",data:JSON.stringify(r),url:t,dataType:"json",contentType:"application/json",headers:{"X-Api-Key":n.sparkContentSearchApiKey,Accept:"application/hal+json",Authorization:"Bearer "+s},success:function(e,t,s){l.resolve(e)}.bind(this),error:function(e,t,s){window.marvel.logger.error("[SearcRequestController] Errored out querying content service: ["+e.status+"]",{response:e.responseJSON||e.responseText||e.statusText,requestData:r}),l.reject(e)}.bind(this)},null,!0)})):e.ajax({method:"POST",data:JSON.stringify(r),url:t,dataType:"json",contentType:"application/json",headers:{"X-Api-Key":n.sparkContentSearchApiKey,Accept:"application/hal+json"},success:function(e,t,s){l.resolve(e)}.bind(this),error:function(e,t,s){window.marvel.logger.error("[SearcRequestController] Errored out querying content service: ["+e.status+"]",{response:e.responseJSON||e.responseText||e.statusText,requestData:r}),l.reject(e)}.bind(this)},null,!0),l.promise},_sendBatchQuery:function(e){return this._sendSparkContentQuery(e,"POST")},doAggregatesFromFragmentsQuery:function(e,s){var r,i=(s=s||{}).locale||this.getSearchLocale(),a=[],l=i,o={qLoc:i,limit:0,aggs:this._aggsFieldsToRequest,aggsLimit:s.aggsLimit||5};s.tagFilters&&(r=this._getFiltersFromTagFilters(s.tagFilters))&&r.filters&&r.filters.length&&(a=a.concat(r.filters)),s.langOnly?l.length>2&&(l=l.substring(0,2)+"*"):l=l.toLowerCase(),s.includeEnglishIfNonEnglish&&"en-us"!==i.toLowerCase()&&(s.langOnly?l+=" OR en*":l+=" OR en-us",l="("+l+")"),a.push("locales:"+l),this._options.allowPremiumTemplates||a.push("premium:false"),this._constantSearchTypeFilterString&&a.push(this._constantSearchTypeFilterString),o.filters=a.join(" AND ");var n=s.calcAggsForAllFragments?e:e.slice(0,1),h=t.map(n,(function(e){return t.assign({q:e||"*"},o)}));return this._sendSparkContentQueryPostArraySimple(h).then(function(r){var i=t.map(n,function(e,t){var i=r[t]._embedded;return{str:e,totalResults:i.total,tagsInOrder:this._tagsInOrderFromOneAggsSet(i.aggregations,!t&&s.prepends)}}.bind(this));return!s.calcAggsForAllFragments&&e.length>1&&(i=this.appendFragStringEmptyAggsToArray(i,e,1)),i}.bind(this))},appendFragStringEmptyAggsToArray:function(e,s,r){var i=e.slice(0);return t.map(s.slice(r),(function(e){i.push({str:e,totalResults:-1})})),0===r&&(i[0].tagsInOrder=[]),i},_calcTagSuggestPriority:function(e){t.isUndefined(e.suggestSortPriority)&&(1===e.fields.length&&"explore"===e.fields[0]?e.suggestSortPriority=-1:e.suggestSortPriority=1)},sortTagsInOrder:function(e,t){return e.suggestSortPriority!==t.suggestSortPriority?e.suggestSortPriority>t.suggestSortPriority?-1:1:t.numAssets-e.numAssets},_tagsInOrderFromOneAggsSet:function(e,s){var r={},i=[],a={};if(t.each(e,function(e,s){if(e.buckets&&e.buckets.length){var l=this._fieldToTagMapsNoLoc[s];l?t.each(e.buckets,function(e){var t=e.key.split(" ").join("-");if(t){var s=e.label||this._labelFromTagKey(t),o=r[s],n=l+"-"+t;if(o)o.numAssets+=e.docCount,-1===o.fields.indexOf(l)&&o.fields.push(l),-1===o.tags.indexOf(n)&&o.tags.push(n);else{var h={numAssets:e.docCount,id:s,label:s,key:t,keyword:t,srcKey:t,fields:[],tag:n,tags:[n]};r[h.id]=h,i.push(h),a[h.id]&&window.marvel.logger.debug("duped aggTag:"+h.id),a[h.id]=h,h.fields.push(l)}}}.bind(this)):window.marvel.logger.debug("unknown aggId in _tagsInOrderFromOneAggsSet")}}.bind(this)),i.forEach(this._calcTagSuggestPriority),i.sort(this.sortTagsInOrder),s&&s.length){var l=t.map(s,function(e){return this._getCustomTag(e)}.bind(this));l.reverse(),i=l.concat(i)}return i},_getSplitCursorQuerySendOptions:function(e,t){if(e.numFromFirst){if(!e.nextBody||e.numFromFirst>=t)return e.numFromFirst=0,{fulfilledData:e.data};t-=e.numFromFirst}return e.forceLowerLimit?t=Math.max(0,t):t<40&&(t=40),e.numFromFirst?(e.numPulled-=e.numFromFirst,e.numFromFirst=0,e.doingNumFromFirst=!0,this._extendSplitCursorQuerySendOptions(e.nextBody,t)):this._extendSplitCursorQuerySendOptions(e.nextBody,t)},_getSparkContentQueryTotal:function(e,s){(e=t.cloneDeep(e)).limit=s||1;var r=c.format({protocol:"https",host:this._options.searchHost,pathname:this._options.searchPathPrefix,query:e});return this._sendSparkContentQuery(r)},_fixSendOptionsJsonForPost:function(e){t.each(["orderBy","aggs","select"],(function(t){e[t]&&(e[t]=e[t].split(","))}))},_getSparkContentQueryTotalSendOptions:function(e,s){return e=t.cloneDeep(e),this._fixSendOptionsJsonForPost(e),e.limit=s||1,e},_extendSplitCursorQuerySendOptions:function(e,s){return(e=t.cloneDeep(e)).limit=s||1,e},_processOneSparkContentAsset:function(e){if(this._badAssets.count&&this._badAssets.ids[e.id])return null;e.tags=[],t.each(this._fieldToTagMaps,(function(s,r){t.each(e[r],(function(t){t&&e.tags.push(s+"-"+t)}))}));var s=this._constantSearchType||"";return e.app=this._options.VisualBrowseAndSearchAppsController.getAppType(e.type||s),e.templatedImgHref=e.rendition.href,e.width=e.rendition.maxWidth,e.height=e.rendition.maxHeight,e},_interleaveParts:function(e){for(var t=[],s=e;s.length>1;){for(var r=[],i=0;i<s.length;i++){var a=s[i];a.nextIndex<a.assets.length&&(1===a.interleave?(t.push(a.assets[a.nextIndex]),a.nextIndex++):(t=t.concat(a.assets.slice(a.nextIndex,a.nextIndex+a.interleave)),a.nextIndex+=a.interleave),a.nextIndex<a.assets.length&&r.push(a))}s=r}if(s.length){var l=s[0];t=t.concat(l.assets.slice(l.nextIndex)),l.nextIndex=l.assets.length}return t},_preSparkContentSearchTemplateResults:function(e,r,i){var a,l=(i=i||{}).extraResults;if(i.isFirstQuery?a=i.splitQuery?i.splitQuery.aggregations:e._embedded&&e._embedded.aggregations:(a=i.aggregations,this._badAssets.count&&(this._assets.assetsArray=t.filter(this._assets.assetsArray,function(e){return!this._badAssets.ids[e.id]&&e}.bind(this)))),l){e=l.resultsData;var o,n=i.targetTotal-this._assets.assetsArray.length;n>l.assets.length?(o=l.assets,i.extraResults=null,r.extraResults=null):(o=l.assets.splice(0,n),0===l.assets.length&&(i.extraResults=null,r.extraResults=null)),this._assets.assetsArray=this._assets.assetsArray.concat(o),e.assets=this._assets.assetsArray}else{if(i.splitQuery&&i.splitQuery.currentQuery?(i.splitQuery.currentQuery.single?(e=i.splitQuery.currentQuery.single.data).assets=t.filter(e._embedded.results,this._processOneSparkContentAsset):(e=i.splitQuery.currentQuery.parts[0].data,t.each(i.splitQuery.currentQuery.parts,function(e){e.assets=t.filter(e.data._embedded.results,this._processOneSparkContentAsset)}.bind(this)),e.assets=this._interleaveParts(i.splitQuery.currentQuery.parts)),e.hasMore=i.splitQuery.numRemaining>0):e.assets=t.filter(e._embedded.results,this._processOneSparkContentAsset),t.extend(e,r),e.tagsData={},i.isFirstQuery)e.tagsData.keysForTags=this._options.keysForTags,e.total=e._embedded.total,i.isFirstQuery=!1;else{var h=e._embedded.total-e._embedded.count;e.assets=this._combineResultAssets(e.assets),e.total=e.assets.length+h,e.tagsData=this._tagsData}e.assets.length>i.targetTotal?r.extraResults={assets:e.assets.splice(i.targetTotal),resultsData:t.clone(e)}:r.extraResults=null}var c=e.assets.length;return i.splitQuery?c+=i.splitQuery.numRemaining:e.numRemaining&&(c+=e.numRemaining),r.extraResults&&(c+=r.extraResults.assets.length),e.total=c,e.aggregations=a,this._assignTagsDataToResults(e,r,i),r.aggregations=e.aggregations,i.aggregations=e.aggregations,this._options.favoritesEnabled?this._options.VisualBrowseUseCasesController.applyFavoritesToSearchResults(e).then((function(e){return e})):s.resolve(e)}});return y.requiredCallbackNames=["setSearchingForResults","renderCpSearchResults"],y}.apply(t,r))||(e.exports=i)},2262:function(e){e.exports=JSON.parse('{"sizeRangeForEquality":0.01,"maps":{"Instagram":{"filters":["instagram"]},"InstagramStory":{"filters":["instagram-story"]},"InstagramPortrait":{"filters":["instagram"]},"InstagramLandscape":{"filters":["instagram"]},"Facebook":{"filters":["facebook"]},"Pinterest":{"filters":["pinterest"]},"YouTubeThumbnail":{"filters":["youtube"],"str":"thumbnail"},"LinkedInBlogPost":{"filters":["linkedin"]},"SnapchatStory":{"filters":[],"str":"snapchat"},"Twitter":{"filters":["twitter"]},"Letter":{"filters":["letter"]},"Poster":{"filters":["poster"]},"Card":{"filters":["card"]},"A5":{},"A4":{},"A3":{},"FacebookProfileCover":{"filters":["facebook"],"str":"profile cover"},"FacebookPageCover":{"filters":["facebook"]},"FacebookEventCover":{"filters":["facebook"],"str":"event cover"},"YouTubeChannelArt":{"filters":["youtube"]},"TwitchBanner":{"filters":["twitch"]},"TwitterHeader":{"filters":["twitter"],"str":"header"},"EtsyCover":{"filters":["etsy"]},"LinkedInProfileCover":{"filters":["linkedin"],"str":"profile"},"EventbriteEventImage":{"filters":["eventbrite"]},"iPhone":{"filters":["iphone"]},"Square":{},"3:2":{},"4:3":{},"16:9":{},"2:3":{},"3:1":{},"2:1":{},"1:2":{},"SparkVideoSlide":{},"SparkVideoSlideSquare":{},"KindleCover":{"filters":["kindle"]},"BlogPost":{"filters":["blog"]}}}')},2593:function(e,t){e.exports="<style>\n    {{#assets}}\n    #{{id}} {\n        {{^hideAssetUntilLoaded}}\n        {{^rendition}}\n        background-image: url('{{{url}}}.{{fileType}}');\n        {{/rendition}}\n        {{#rendition}}\n        background-image: url('{{{.}}}');\n        {{/rendition}}\n        {{/hideAssetUntilLoaded}}\n        {{#hwar}}\n        padding-top: {{.}};\n        {{/hwar}}\n        {{#w}}\n        width: {{.}};\n        {{/w}}\n        {{#h}}\n        height: {{.}};\n        {{/h}}\n    }\n\n    {{/assets}}\n    @media\n        only screen and (-webkit-min-device-pixel-ratio: 1.5),\n        only screen and (min--moz-device-pixel-ratio: 1.5),\n        only screen and (-o-min-device-pixel-ratio: 1.5/1),\n        only screen and (min-device-pixel-ratio: 1.5),\n        only screen and (min-resolution: 192dpi),\n        only screen and (min-resolution: 1.5dppx) {\n\n        {{#assets}}\n        #{{id}} {\n            {{^hideAssetUntilLoaded}}\n            {{^rendition}}\n            background-image: url('{{{url}}}@2x.{{fileType}}');\n            {{/rendition}}\n            {{#rendition2x}}\n            background-image: url('{{{.}}}');\n            {{/rendition2x}}\n            {{/hideAssetUntilLoaded}}\n        }\n        {{/assets}}\n</style>\n"},2708:function(e,t,s){var r=s(3528);"string"==typeof r&&(r=[[e.i,r,""]]);var i={hmr:!0,transform:void 0,insertInto:void 0};s(202)(r,i);r.locals&&(e.exports=r.locals)},3526:function(e,t){e.exports='<div class="search-results-ul-scroller" style="{{#scrollInnerHeight}}max-height:{{scrollInnerHeight}};{{/scrollInnerHeight}}">\n<ul class="search-results-ul show-group-lines">\n{{#selectedTags}}\n<div class="search-result-group-line search-result-group-line-tags search-result-group-line-tags-{{id}}" data-id="{{id}}"><div class="tags-label-and-clear">{{npw-vb-search-box-section-filters}}\n    {{#numSelected}}\n    <button class="search-box-filters-clear-all enabled" title="{{npw-vb-search-box-section-filters-clear-title}}">{{npw-vb-search-box-section-filters-clear}}</button>\n    {{/numSelected}}\n    {{^numSelected}}\n    <button class="search-box-filters-clear-all"  title="{{npw-vb-search-box-section-filters-clear-title}}" disabled>{{npw-vb-search-box-section-filters-clear}}</button>\n    {{/numSelected}}\n    </div>\n<div class="search-result-group-line-tags-tags{{#atMaxTags}} at-max-tags{{/atMaxTags}}">\n{{#items}}\n    <button tabindex="-1" class="search-result-group-line-tag search-results-selected-tag search-results-tag-button search-result-colored-tag search-result-colored-tag-{{prefix}} search-result-group-line-tag-{{prefix}}{{#selected}} selected{{/selected}}{{#ifShowingAll}} if-showing-all{{/ifShowingAll}} search-result-group-line-tag-tag-{{id}}{{#customFilterType}} ignore-at-max-tags{{/customFilterType}} {{debugCssStr}}" title="{{itemTitle}}" data-id="{{id}}" data-src-key="{{srcKey}}">{{label}}</button>\n{{/items}}\n{{#numMoreItems}}\n    <button tabindex="-1" class="search-result-group-line-tag search-results-tag-button search-result-colored-tag search-result-colored-tag-{{prefix}} search-result-group-line-tag-{{prefix}}{{#selected}} selected{{/selected}} search-result-group-line-tag-tag-{{id}} show-more-tags-btn {{debugCssStr}}" data-group-id="{{groupId}}" data-id="{{id}}" >...</button>\n{{/numMoreItems}}\n</div>\n</div>\n<div class="search-result-group-line search-result-group-line-rule"></div>\n{{/selectedTags}}\n{{#numResults}}\n{{#tagLines}}\n    <li class="search-result-result-line search-result-line-can-arrow-nav" data-tags="{{tags}}" data-keywords="{{keywords}}">{{> lineLabels}}</li>\n{{/tagLines}}\n{{#hasTextOrSuggestionLines}}\n<li class="search-result-group-line-tags-label">{{npw-vb-search-box-section-searching-for}}</li>\n{{#hasTextLines}}\n    {{#textLines}}\n    <li class="search-result-result-line search-result-line-can-arrow-nav" data-tags="{{tags}}" data-keywords="{{keywords}}">{{> lineLabels}}</li>\n    {{/textLines}}\n{{/hasTextLines}}\n{{#hasSuggestionLines}}\n    {{#suggestionLines}}\n    <li class="search-result-search-suggest-line no-indent search-result-search-suggest-line-user-text search-result-line-can-arrow-nav" data-tags="{{tags}}" data-keywords="{{keywords}}">{{> lineLabels}}</li>\n    {{/suggestionLines}}\n{{/hasSuggestionLines}}\n{{/hasTextOrSuggestionLines}}\n<div class="search-result-group-line search-result-group-line-rule"></div>\n{{#tagLinesGroups}}\n<li class="search-result-group-line-tags-label">{{npw-vb-search-box-section-related}}</li>\n{{#items}}\n    <li class="search-result-group-line-tag {{#isAddText}} search-add-text-tag{{/isAddText}}{{^ifShowingAll}} search-result-line-can-arrow-nav{{/ifShowingAll}}{{#ifShowingAll}} if-showing-all{{/ifShowingAll}} search-results-tag-button search-result-colored-tag search-result-colored-tag-{{prefix}} search-result-group-line-tag-{{prefix}}{{#selected}} selected{{/selected}} search-result-group-line-tag-tag-{{id}} {{debugCssStr}}" title="{{itemTitle}}" data-group-id="{{groupId}}" data-text="{{label}}" data-id="{{id}}" data-src-key="{{srcKey}}">&mldr; {{label}}</li>\n{{/items}}\n{{#numMoreItems}}\n    <li class="search-result-group-line-tag search-results-tag-button search-result-line-can-arrow-nav search-result-colored-tag search-result-colored-tag-{{prefix}} search-result-group-line-tag-{{prefix}} search-result-group-line-tag-tag-{{id}} show-more-tags-btn{{#isAddText}} search-add-text-tag{{/isAddText}} {{debugCssStr}}" data-group-id="{{groupId}}" data-id="{{id}}" data-src-key="{{srcKey}}">{{npw-vb-search-results-related-more}}</li>\n{{/numMoreItems}}\n{{/tagLinesGroups}}\n{{/numResults}}\n{{^numResults}}\n{{#fromNoResults}}\n{{^isLearn}}\n{{^selectedTags.numSelected}}\n<div class="search-result-group-line search-result-no-results-line">{{npw-vb-search-box-section-sorry}}</div>\n{{/selectedTags.numSelected}}\n{{#selectedTags.numSelected}}\n<div class="search-result-group-line search-result-no-results-line">{{npw-vb-search-box-section-sorry-filters}}</div>\n{{/selectedTags.numSelected}}\n{{/isLearn}}\n{{/fromNoResults}}\n{{#historySearches}}\n<div class="search-result-group-line">{{historyLabel}}</div>\n{{#historySubLabel}}\n<li class="search-result-search-suggest-line search-result-search-suggest-line-history">{{historySubLabel}}</li>\n{{/historySubLabel}}\n{{#searches}}\n<li class="search-result-search-suggest-line search-result-search-suggest-line-history search-result-line-can-arrow-nav" data-app="{{app}}" data-label="{{label}}" data-keywords="{{keywords}}" data-tags="{{tags}}">{{label}}{{#appLabel}}<span class="search-result-line-app-label search-result-line-app-label-{{app}}">&nbsp;({{.}})</span>{{/appLabel}}</li>\n{{/searches}}\n{{/historySearches}}\n{{#popularSearches}}\n<li class="search-result-search-suggest-line search-result-search-suggest-line-popular-use-cases" data-term="{{term}}">{{term}}</li>\n{{/popularSearches}}\n{{/numResults}}\n{{#showPopular}}\n<div class="search-result-group-line">{{npw-vb-search-box-section-popular}}</div>\n{{#searches}}\n<li class="search-result-search-suggest-line search-result-search-suggest-line-popular-search search-result-line-can-arrow-nav{{#commandType}} is-command{{/commandType}}" data-app="{{app}}" data-command-type="{{commandType}}" data-label="{{label}}" data-src-label="{{srcLabel}}" data-search-str="{{searchStr}}" data-keywords="{{keywords}}" data-tags="{{tags}}">{{label}}{{#translation}}<span class="search-result-line-popular-translation">&nbsp;({{.}})</span>{{/translation}}{{#appLabel}}<span class="search-result-line-app-label search-result-line-app-label{{app}}">&nbsp;({{.}})</span>{{/appLabel}}</li>\n{{/searches}}\n{{/showPopular}}\n{{#showCategorySearches}}\n<div class="search-result-group-line">{{npw-vb-search-box-section-categories}}</div>\n{{#categorySearches}}\n<li class="search-result-search-suggest-line search-result-search-suggest-line-popular-category search-result-line-can-arrow-nav{{#commandType}} is-command{{/commandType}}" data-app="{{app}}" data-command-type="{{commandType}}" data-label="{{label}}" data-keywords="{{keywords}}" data-tags="{{tags}}">{{labelG11n}}{{#appLabel}}<span class="search-result-line-app-label search-result-line-app-label{{app}}">&nbsp;({{.}})</span>{{/appLabel}}</li>\n{{/categorySearches}}\n{{/showCategorySearches}}\n\n</ul>\n</div>\n'},3527:function(e,t){e.exports='{{#displayArray}}<span class="search-result-line-span-tag search-result-colored-tag-{{prefix}} {{debugCssStr}}" title="{{#debugCssStr}}{{tag}}{{/debugCssStr}}">{{#chunks}}{{#src}}<span class="search-result-result-line-span-src">{{{.}}}</span>{{/src}}{{#hint}}<span class="search-result-result-line-span-hint">{{{.}}}</span>{{/hint}}{{{space}}}{{/chunks}}</span>{{/displayArray}}{{#showAnyCounts}}{{#totalCount}}<span class="search-result-result-line-span-count search-app-color-all"> ({{totalCount}})</span>{{/totalCount}}{{/showAnyCounts}}'},3528:function(e,t,s){(e.exports=s(201)(!1)).push([e.i,'@-webkit-keyframes appear{0%{opacity:0}to{opacity:1}}@keyframes appear{0%{opacity:0}to{opacity:1}}@-webkit-keyframes fadeTo{0%{opacity:0}to{opacity:.1}}@keyframes fadeTo{0%{opacity:0}to{opacity:.1}}.search-app-color-all{color:#3e3f41}.search-results-grid-item-thumb-premium-icon{display:none;background-image:url(/images/icon-premium-template-badge.svg);width:20px;height:27px;background-repeat:no-repeat;background-size:contain;position:absolute;right:4px;top:-4px}.search-results-grid-item-thumb-premium-icon.show-premium-user-badge-shield-dark{width:24px;height:33px;background-image:url(/images/icon-premium-user-premium-badge-shield-dark.svg)}.search-results-grid-item-thumb-premium-icon.show-premium-user-badge-shield-light{width:24px;height:33px;background-image:url(/images/icon-premium-user-premium-badge-shield-light.svg)}.search-results-grid-view-holder{display:block;left:0;position:relative;width:100%;height:calc(100vh - 112px);padding:0 0 10px;z-index:1;background-color:#fff;opacity:1}.search-results-grid-view-holder.search-view-in-container{height:calc(100% - 144px);top:72px;position:absolute;background-color:inherit}.search-results-grid-view-holder.search-view-in-container .search-results-grid-view{margin-top:40px}.search-results-grid-view-holder.search-view-in-container .search-results-grid-item-detail-holder{z-index:1}.search-results-grid-view-holder.search-view-in-container .search-results-grid-item-detail-holder .search-results-grid-item-detail-header{z-index:1;top:-32px;width:100%}.search-results-grid-view-holder.search-view-in-container .search-results-grid-item-detail-holder .search-results-grid-item-detail-header .search-results-grid-item-detail-header-ctas{display:none}.search-results-grid-view-holder.search-view-in-container .search-results-grid-item-detail-holder .search-results-grid-item-detail-header .search-results-grid-item-detail-header-create{left:auto;right:0;top:-57px;-webkit-transform:none;transform:none;right:16px}.search-results-grid-view-holder.search-view-in-container .search-results-grid-item-detail-holder .search-results-grid-item-detail-header .npw-visual-browse-header-back-arrow{top:-40px;position:relative;height:100%;width:50px;background-color:transparent;background-position:0;background-image:url(/images/spectrum-back-arrow-valley.svg);background-repeat:no-repeat;background-size:18px;margin-left:34px;cursor:pointer}.search-results-grid-view-holder.search-view-in-container .search-results-grid-item-detail-holder .search-results-grid-item-detail-header .npw-visual-browse-header-back-arrow:hover{background-image:url(/images/spectrum-back-arrow-midnight.svg)}.search-results-grid-view-holder.search-view-in-container .search-results-grid-item-detail-holder .search-results-grid-item-detail-header .npw-visual-browse-header-back-arrow.has-text{padding-left:30px;line-height:66px;text-transform:uppercase;width:auto;font-weight:700;font-size:12px;color:#808990;transition:color .2s ease-in-out}.search-results-grid-view-holder.search-view-in-container .search-results-grid-item-detail-holder .search-results-grid-item-detail-header .npw-visual-browse-header-back-arrow.has-text:hover{color:#3e3f41}.search-results-grid-view-holder.library-results{margin-top:0;height:calc(100% - 144px)}.search-results-grid-view-holder.library-results .search-results-grid-view{margin-top:0}.search-results-grid-view-holder .search-results-grid-view{position:relative;left:50%;-webkit-transform:translateX(-50%);transform:translateX(-50%);height:100%;width:100%;display:-webkit-flex;display:flex;-webkit-flex-direction:column;flex-direction:column;-webkit-align-items:center;align-items:center}.search-results-grid-view-holder .search-results-grid-view .search-results-tags{width:100%;text-align:center;padding:12px 24px 24px;display:-webkit-flex;display:flex;-webkit-flex-direction:row;flex-direction:row;-webkit-align-items:flex-start;align-items:flex-start;-webkit-justify-content:center;justify-content:center;-webkit-flex-wrap:wrap;flex-wrap:wrap}.search-results-grid-view-holder .search-results-grid-view .search-results-tags.at-max-tags .search-results-tag:not(.selected):not(.search-results-tag-tag-premium){background-color:#f4f5f5;opacity:.5}.search-results-grid-view-holder .search-results-grid-view .search-results-pagination{color:#3e3f41;display:-webkit-flex;display:flex;-webkit-flex-direction:column;flex-direction:column;font-weight:500;text-align:center;-webkit-align-items:center;align-items:center;height:100px;overflow-y:hidden}.search-results-grid-view-holder .search-results-grid-view .search-results-pagination .search-results-pagination-more{margin-top:12px}.search-results-grid-view-holder .search-results-grid-view .search-results-grid-item .search-results-grid-item-thumb-icon{display:none}.search-results-grid-view-holder .search-results-grid-view .search-results-grid-item.search-results-grid-item-page .search-results-grid-item-thumb-icon{width:100%;height:35px;left:0;bottom:0;display:block;background-image:url(/images/npw/visualBrowse/thumb-icon-page-footer35.svg);position:absolute;background-repeat:no-repeat;background-size:contain;background-color:#fff;background-position:50%}.search-results-grid-view-holder .search-results-grid-view .search-results-grid-item.search-results-grid-item-page .search-results-grid-item-thumb-icon.non-expandable{height:25px;background-size:cover}.search-results-grid-view-holder .search-results-grid-view .search-results-grid-item.search-results-grid-item-post .search-results-grid-item-thumb-animation-icon{width:20px;height:20px;left:8px;bottom:8px;display:block;background-image:url(/images/thumb-icon-post-animated.svg);position:absolute;background-repeat:no-repeat;background-size:contain;background-position:50%;transition:opacity .2s ease-in-out;opacity:1}.search-results-grid-view-holder .search-results-grid-view .search-results-grid-item.search-results-grid-item-post .search-results-grid-item-thumb-animation-icon.non-expandable{height:25px;width:25px;background-size:cover}.search-results-grid-view-holder .search-results-grid-view.favorites-enabled .search-results-grid-item-detail-other-results-item .search-results-grid-item-thumb-favorite-icon,.search-results-grid-view-holder .search-results-grid-view.favorites-enabled .search-results-grid-item .search-results-grid-item-thumb-favorite-icon{background-repeat:no-repeat;background-position:0;background-size:contain;background-image:url(/images/npw/visualBrowse/icon-heart-empty.svg);width:24px;height:24px;position:absolute;top:3px;right:3px;opacity:0;display:block;cursor:pointer;transition:opacity .2s ease-in-out;z-index:2}.search-results-grid-view-holder .search-results-grid-view.favorites-enabled .search-results-grid-item-detail-other-results-item .search-results-grid-item-thumb-favorite-icon:hover,.search-results-grid-view-holder .search-results-grid-view.favorites-enabled .search-results-grid-item .search-results-grid-item-thumb-favorite-icon:hover{background-image:url(/images/npw/visualBrowse/icon-heart-empty-no-background-hover.svg)}.search-results-grid-view-holder .search-results-grid-view.favorites-enabled .search-results-grid-item-detail-other-results-item.is-favorite .search-results-grid-item-thumb-favorite-icon,.search-results-grid-view-holder .search-results-grid-view.favorites-enabled .search-results-grid-item.is-favorite .search-results-grid-item-thumb-favorite-icon{background-image:url(/images/npw/visualBrowse/icon-heart-solid-with-border.svg);opacity:1}.search-results-grid-view-holder .search-results-grid-view.favorites-enabled .search-results-grid-item-detail-other-results-item.is-favorite .search-results-grid-item-thumb-favorite-icon:hover,.search-results-grid-view-holder .search-results-grid-view.favorites-enabled .search-results-grid-item.is-favorite .search-results-grid-item-thumb-favorite-icon:hover{background-image:url(/images/npw/visualBrowse/icon-heart-solid-no-border.svg)}.search-results-grid-view-holder .search-results-grid-view.favorites-enabled .search-results-grid-item-detail-other-results-item:not(.is-favorite) .search-results-grid-item-thumb-favorite-icon,.search-results-grid-view-holder .search-results-grid-view.favorites-enabled .search-results-grid-item:not(.is-favorite) .search-results-grid-item-thumb-favorite-icon{opacity:0}.search-results-grid-view-holder .search-results-grid-view.favorites-enabled .search-results-grid-item-detail-other-results-item:not(.is-favorite):hover .search-results-grid-item-thumb-favorite-icon,.search-results-grid-view-holder .search-results-grid-view.favorites-enabled .search-results-grid-item:not(.is-favorite):hover .search-results-grid-item-thumb-favorite-icon{opacity:1}.search-results-grid-view-holder .search-results-grid-view.favorites-enabled .search-results-grid-item-detail-other-results-item.expand:not(.is-favorite) .search-results-grid-item-thumb-favorite-icon,.search-results-grid-view-holder .search-results-grid-view.favorites-enabled .search-results-grid-item.expand:not(.is-favorite) .search-results-grid-item-thumb-favorite-icon{display:block}.search-results-grid-view-holder .search-results-grid-holder{overflow-y:auto;overflow-x:hidden;width:100%;padding:0 12px}.search-results-grid-view-holder .search-results-grid-holder:hover{overflow-y:auto;overflow-x:hidden}.search-results-grid-view-holder .search-results-grid-holder.library-results{margin-top:0}.search-results-grid-view-holder .search-results-grid-item-detail-holder{top:60px;height:calc(100vh - 175px);min-height:240px;width:100%;position:absolute;display:-webkit-flex;display:flex;-webkit-flex-direction:row;flex-direction:row;transition:opacity .2s ease-in-out}.search-results-grid-view-holder .search-results-grid-item-detail-holder.revealing{opacity:0}.search-results-grid-view-holder .search-results-grid-item-detail-holder .share-results-share-button{cursor:pointer;color:#3e3f41;background-color:#fff;margin-top:12px;border-radius:16px;padding:8px;width:100%;text-align:center;opacity:1;font-weight:700;font-size:14px}.search-results-grid-view-holder .search-results-grid-item-detail-holder .share-results-share-button:hover{opacity:.8}.search-results-grid-view-holder .search-results-grid-item-detail-holder .social-overlay-bg{z-index:105;position:fixed;left:0;top:-120px;width:101vw;height:110vh;background-color:rgba(0,0,0,.5)}.search-results-grid-view-holder .search-results-grid-item-detail-holder .social-modal{display:block;padding:0 10%;overflow:hidden}.search-results-grid-view-holder .search-results-grid-item-detail-holder .social-modal.hide{display:none}.search-results-grid-view-holder .search-results-grid-item-detail-holder .social-modal .social-modal-bg{overflow:hidden;background-color:#fff;border-radius:6px;-webkit-transform:translateY(75%);transform:translateY(75%);padding:16px 5px 0;color:#808990;margin:0 auto;max-width:240px}.search-results-grid-view-holder .search-results-grid-item-detail-holder .social-modal .social-modal-bg.field-view{max-width:300px;padding-bottom:24px}.search-results-grid-view-holder .search-results-grid-item-detail-holder .social-modal .social-modal-bg .x-close-btn{position:absolute;right:8px;top:8px;background-image:url(/images/close_active.svg);background-color:transparent;background-repeat:no-repeat;background-size:contain;background-position:50%;width:16px;height:16px;border:none;cursor:pointer;color:transparent}.search-results-grid-view-holder .search-results-grid-item-detail-holder .social-modal .social-modal-bg .x-close-btn:hover{background-image:url(/images/close_hover.svg)}.search-results-grid-view-holder .search-results-grid-item-detail-holder .social-modal .social-modal-bg .social-modal-header{background-color:#e8ebed;border-top-left-radius:6px;border-top-right-radius:6px;padding:6px 16px 5px;margin:-16px -5px 8px;font-size:15x;font-weight:700;height:30px}.search-results-grid-view-holder .search-results-grid-item-detail-holder .social-modal .social-modal-bg .social-modal-field-view.hide{display:none}.search-results-grid-view-holder .search-results-grid-item-detail-holder .social-modal .social-modal-bg .social-modal-field-view .social-modal-field-title{color:#3e3f41;margin-bottom:10px}.search-results-grid-view-holder .search-results-grid-item-detail-holder .social-modal .social-modal-bg .social-modal-field-view .social-modal-field-textarea{width:100%;resize:none;height:38px;border:1px solid #e1e1e1;border-radius:6px;padding:8px;box-sizing:border-box;color:#3e3f41}.search-results-grid-view-holder .search-results-grid-item-detail-holder .social-modal .social-modal-bg .social-modal-field-view .social-modal-field-textarea.embed{height:80px}.search-results-grid-view-holder .search-results-grid-item-detail-holder .social-modal .social-modal-bg .social-modal-field-view .social-modal-field-textarea.textarea-edit-display{text-overflow:clip}.search-results-grid-view-holder .search-results-grid-item-detail-holder .social-modal .social-modal-bg .social-modal-field-view .social-modal-field-textarea:active,.search-results-grid-view-holder .search-results-grid-item-detail-holder .social-modal .social-modal-bg .social-modal-field-view .social-modal-field-textarea:focus{border:1px solid #1473e6;outline:none}.search-results-grid-view-holder .search-results-grid-item-detail-holder .social-modal .social-modal-bg .social-modal-menu.hide{display:none}.search-results-grid-view-holder .search-results-grid-item-detail-holder .social-modal .social-modal-bg .social-modal-menu .social-line{font-weight:700;padding:11px 16px 12px 46px;background-repeat:no-repeat;background-position:13px;background-size:22px;border-radius:6px;cursor:pointer;opacity:.75;line-height:normal;margin-bottom:8px}.search-results-grid-view-holder .search-results-grid-item-detail-holder .social-modal .social-modal-bg .social-modal-menu .social-line:hover{background-color:#dce0e3;color:#3e3f41;opacity:1}.search-results-grid-view-holder .search-results-grid-item-detail-holder .social-modal .social-modal-bg .social-modal-menu .social-line.twitter{background-size:24px;background-image:url(/images/icon-social-twitter.svg)}.search-results-grid-view-holder .search-results-grid-item-detail-holder .social-modal .social-modal-bg .social-modal-menu .social-line.facebook{background-image:url(/images/icon-social-facebook.svg)}.search-results-grid-view-holder .search-results-grid-item-detail-holder .social-modal .social-modal-bg .social-modal-menu .social-line.embed{background-image:url(/images/icon-social-embed-sp.svg)}.search-results-grid-view-holder .search-results-grid-item-detail-holder .social-modal .social-modal-bg .social-modal-menu .social-line.copy{background-image:url(/images/icon-social-copy.svg)}.search-results-grid-view-holder .search-results-grid-item-detail-holder .social-modal .social-modal-bg .social-modal-menu .social-line.copy span{font-size:inherit;font-weight:inherit}.search-results-grid-view-holder .search-results-grid-item-detail-holder .social-modal .social-modal-bg .social-modal-menu .social-line.copy span.copied-span{display:none}.search-results-grid-view-holder .search-results-grid-item-detail-holder .social-modal .social-modal-bg .social-modal-menu .social-line.copy:hover{background-color:#808990;color:#fff}.search-results-grid-view-holder .search-results-grid-item-detail-holder .social-modal .social-modal-bg .social-modal-menu .social-line.copy:hover.copied span.copied-span{display:inline-block}.search-results-grid-view-holder .search-results-grid-item-detail-holder .social-modal .social-modal-bg .social-modal-menu .social-line.copy:hover.copied span.copy-span{display:none}.search-results-grid-view-holder .search-results-grid-item-detail-holder .social-modal .social-modal-bg .social-modal-menu .social-line.message{background-image:url(/images/icon-social-message.svg)}.search-results-grid-view-holder .search-results-grid-item-detail-holder .social-modal .social-modal-bg .social-modal-menu .social-line.email{background-image:url(/images/icon-social-email.svg)}.search-results-grid-view-holder .search-results-grid-item-detail-holder .search-results-grid-item-detail-right{position:relative;width:25%;height:100%;background:#3e3f41;padding:24px 12px;display:none;-webkit-flex-direction:column;flex-direction:column;-webkit-justify-content:space-between;justify-content:space-between}.search-results-grid-view-holder .search-results-grid-item-detail-holder .search-results-grid-item-detail-right .search-results-grid-item-detail-right-ctas .search-results-grid-item-detail-right-cta{font-size:14px;font-weight:700;color:#fff;border-radius:16px;background-color:#1473e6;padding:8px;text-align:center;width:100%;cursor:pointer;opacity:1}.search-results-grid-view-holder .search-results-grid-item-detail-holder .search-results-grid-item-detail-right .search-results-grid-item-detail-right-ctas .search-results-grid-item-detail-right-cta:hover{opacity:.8}.search-results-grid-view-holder .search-results-grid-item-detail-holder .search-results-grid-item-detail-right .search-results-grid-item-detail-right-tags{display:-webkit-flex;display:flex;-webkit-flex-wrap:wrap;flex-wrap:wrap}.search-results-grid-view-holder .search-results-grid-item-detail-holder .search-results-grid-item-detail-right .search-results-grid-item-detail-right-tags .search-results-grid-item-detail-right-tag{padding:4px 8px;font-size:13px;margin:4px 4px 0 0;border-radius:18px}.search-results-grid-view-holder .search-results-grid-item-detail-holder .search-results-grid-item-detail-header{position:fixed;width:100vw;height:66px;top:-113px}.search-results-grid-view-holder .search-results-grid-item-detail-holder .search-results-grid-item-detail-header .search-results-grid-item-detail-header-create{background-color:#1473e6;color:#fff;font-size:15px;font-weight:700;border-radius:20px;width:auto;padding:0 20px;height:40px;line-height:40px;position:fixed;top:-100px;left:50%;-webkit-transform:translateX(-50%);transform:translateX(-50%);cursor:pointer}.search-results-grid-view-holder .search-results-grid-item-detail-holder .search-results-grid-item-detail-header .search-results-grid-item-detail-header-ctas{display:-webkit-flex;display:flex;position:absolute;top:20px;right:32px}.search-results-grid-view-holder .search-results-grid-item-detail-holder .search-results-grid-item-detail-header .search-results-grid-item-detail-header-ctas .search-results-grid-item-detail-header-cta{cursor:pointer;color:#3e3f41;font-size:14px;font-weight:700;height:32px;line-height:30px;border:1px solid #fff;border-radius:20px;padding:0 8px 0 26px;background-position:4px;background-repeat:no-repeat;opacity:1;transition:opacity .1s ease-in-out,background-color .1s ease-in-out}.search-results-grid-view-holder .search-results-grid-item-detail-holder .search-results-grid-item-detail-header .search-results-grid-item-detail-header-ctas .search-results-grid-item-detail-header-cta span{font-weight:inherit;font-size:inherit;color:inherit}.search-results-grid-view-holder .search-results-grid-item-detail-holder .search-results-grid-item-detail-header .search-results-grid-item-detail-header-ctas .search-results-grid-item-detail-header-cta.search-results-grid-item-detail-header-cta-share{background-image:url(/images/spectrum-share-midnight.svg)}.search-results-grid-view-holder .search-results-grid-item-detail-holder .search-results-grid-item-detail-header .search-results-grid-item-detail-header-ctas .search-results-grid-item-detail-header-cta.search-results-grid-item-detail-header-cta-favorite{width:134px;text-align:left;padding-left:30px;background-image:url(/images/npw/visualBrowse/icon-heart-empty-with-background.svg)}.search-results-grid-view-holder .search-results-grid-item-detail-holder .search-results-grid-item-detail-header .search-results-grid-item-detail-header-ctas .search-results-grid-item-detail-header-cta.search-results-grid-item-detail-header-cta-favorite .search-results-grid-item-detail-header-cta-favorite-is-not{display:block}.search-results-grid-view-holder .search-results-grid-item-detail-holder .search-results-grid-item-detail-header .search-results-grid-item-detail-header-ctas .search-results-grid-item-detail-header-cta.search-results-grid-item-detail-header-cta-favorite .search-results-grid-item-detail-header-cta-favorite-is{display:none}.search-results-grid-view-holder .search-results-grid-item-detail-holder .search-results-grid-item-detail-header .search-results-grid-item-detail-header-ctas .search-results-grid-item-detail-header-cta.search-results-grid-item-detail-header-cta-favorite.is-favorite{background-image:url(/images/npw/visualBrowse/icon-heart-solid-no-border.svg)}.search-results-grid-view-holder .search-results-grid-item-detail-holder .search-results-grid-item-detail-header .search-results-grid-item-detail-header-ctas .search-results-grid-item-detail-header-cta.search-results-grid-item-detail-header-cta-favorite.is-favorite .search-results-grid-item-detail-header-cta-favorite-is-not{display:none}.search-results-grid-view-holder .search-results-grid-item-detail-holder .search-results-grid-item-detail-header .search-results-grid-item-detail-header-ctas .search-results-grid-item-detail-header-cta.search-results-grid-item-detail-header-cta-favorite.is-favorite .search-results-grid-item-detail-header-cta-favorite-is{display:block}.search-results-grid-view-holder .search-results-grid-item-detail-holder .search-results-grid-item-detail-header .search-results-grid-item-detail-header-ctas .search-results-grid-item-detail-header-cta:hover{opacity:.8}.search-results-grid-view-holder .search-results-grid-item-detail-holder .search-results-grid-item-detail{background-color:#fff;width:100%;height:100%;position:relative}.search-results-grid-view-holder .search-results-grid-item-detail-holder .search-results-grid-item-detail .search-results-grid-item-detail-other-results-section-scroller-holder{height:25%;background-color:#fff;position:relative}.search-results-grid-view-holder .search-results-grid-item-detail-holder .search-results-grid-item-detail .search-results-grid-item-detail-other-results-section-scroller{width:100%;height:100%;overflow-y:hidden;overflow-x:scroll}.search-results-grid-view-holder .search-results-grid-item-detail-holder .search-results-grid-item-detail .search-results-grid-item-detail-other-results-section-scroller .search-results-grid-item-detail-other-results-section{width:auto;height:100%;display:-webkit-flex;display:flex;-webkit-align-items:flex-start;align-items:flex-start}.search-results-grid-view-holder .search-results-grid-item-detail-holder .search-results-grid-item-detail .search-results-grid-item-detail-other-results-section-scroller .search-results-grid-item-detail-other-results-section .search-results-grid-item-detail-other-results-item{margin:0 4px;height:100%;position:relative}.search-results-grid-view-holder .search-results-grid-item-detail-holder .search-results-grid-item-detail .search-results-grid-item-detail-other-results-section-scroller .search-results-grid-item-detail-other-results-section .search-results-grid-item-detail-other-results-item:first-child{margin-left:0}.search-results-grid-view-holder .search-results-grid-item-detail-holder .search-results-grid-item-detail .search-results-grid-item-detail-other-results-section-scroller .search-results-grid-item-detail-other-results-section .search-results-grid-item-detail-other-results-item:last-child{margin-right:0}.search-results-grid-view-holder .search-results-grid-item-detail-holder .search-results-grid-item-detail .search-results-grid-item-detail-other-results-section-scroller .search-results-grid-item-detail-other-results-section .search-results-grid-item-detail-other-results-item .search-results-grid-item-detail-other-results-item-thumb{height:calc(100% - 5px);background-repeat:no-repeat;background-size:contain;background-position:50%;position:relative;opacity:.5;cursor:pointer}.search-results-grid-view-holder .search-results-grid-item-detail-holder .search-results-grid-item-detail .search-results-grid-item-detail-other-results-section-scroller .search-results-grid-item-detail-other-results-section .search-results-grid-item-detail-other-results-item .search-results-grid-item-detail-other-results-item-thumb .search-results-grid-item-detail-other-results-item-thumb-loader{left:2px;top:2px;width:calc(100% - 4px);height:calc(100% - 4px);position:absolute}.search-results-grid-view-holder .search-results-grid-item-detail-holder .search-results-grid-item-detail .search-results-grid-item-detail-other-results-section-scroller .search-results-grid-item-detail-other-results-section .search-results-grid-item-detail-other-results-item .search-results-grid-item-detail-other-results-item-selection{position:absolute;bottom:0;background-color:transparent;width:100%;height:3px;margin-top:2px}.search-results-grid-view-holder .search-results-grid-item-detail-holder .search-results-grid-item-detail .search-results-grid-item-detail-other-results-section-scroller .search-results-grid-item-detail-other-results-section .search-results-grid-item-detail-other-results-item.selected .search-results-grid-item-detail-other-results-item-selection{display:block;background-color:#1473e6}.search-results-grid-view-holder .search-results-grid-item-detail-holder .search-results-grid-item-detail .search-results-grid-item-detail-other-results-section-scroller .search-results-grid-item-detail-other-results-section .search-results-grid-item-detail-other-results-item.selected .search-results-grid-item-detail-other-results-item-thumb{width:calc(100% - 4px);height:calc(100% - 4px);opacity:1}.search-results-grid-view-holder .search-results-grid-item-detail-holder .search-results-grid-item-detail .search-results-grid-item-detail-image-section{width:100%;height:75%;min-height:160px;display:-webkit-flex;display:flex;background-color:#f4f5f5}.search-results-grid-view-holder .search-results-grid-item-detail-holder .search-results-grid-item-detail .search-results-grid-item-detail-image-section .search-results-grid-item-detail-image-and-tags-holder{position:relative;width:100%;max-width:calc(100% - 100px);height:100%}.search-results-grid-view-holder .search-results-grid-item-detail-holder .search-results-grid-item-detail .search-results-grid-item-detail-image-section .search-results-grid-item-detail-image-and-tags-holder .search-results-grid-item-detail-tags{margin:8px 0 0;height:40px;-webkit-justify-content:left;justify-content:left;overflow-x:auto;overflow-y:hidden;position:relative;left:50%;-webkit-transform:translateX(-50%);transform:translateX(-50%)}.search-results-grid-view-holder .search-results-grid-item-detail-holder .search-results-grid-item-detail .search-results-grid-item-detail-image-section .search-results-grid-item-detail-image-and-tags-holder .search-results-grid-item-detail-image-holder{height:100%;width:auto;position:relative}.search-results-grid-view-holder .search-results-grid-item-detail-holder .search-results-grid-item-detail .search-results-grid-item-detail-image-section .search-results-grid-item-detail-image-and-tags-holder .search-results-grid-item-detail-image-holder .search-results-grid-item-detail-animation,.search-results-grid-view-holder .search-results-grid-item-detail-holder .search-results-grid-item-detail .search-results-grid-item-detail-image-section .search-results-grid-item-detail-image-and-tags-holder .search-results-grid-item-detail-image-holder .search-results-grid-item-detail-image,.search-results-grid-view-holder .search-results-grid-item-detail-holder .search-results-grid-item-detail .search-results-grid-item-detail-image-section .search-results-grid-item-detail-image-and-tags-holder .search-results-grid-item-detail-image-holder .search-results-grid-item-detail-loading{position:absolute;background-repeat:no-repeat;background-size:contain;background-position:50%;width:100%;height:100%}.search-results-grid-view-holder .search-results-grid-item-detail-holder .search-results-grid-item-detail .search-results-grid-item-detail-image-section .search-results-grid-item-detail-image-and-tags-holder .search-results-grid-item-detail-image-holder .search-results-grid-item-detail-animation.search-results-grid-item-detail-image,.search-results-grid-view-holder .search-results-grid-item-detail-holder .search-results-grid-item-detail .search-results-grid-item-detail-image-section .search-results-grid-item-detail-image-and-tags-holder .search-results-grid-item-detail-image-holder .search-results-grid-item-detail-image.search-results-grid-item-detail-image,.search-results-grid-view-holder .search-results-grid-item-detail-holder .search-results-grid-item-detail .search-results-grid-item-detail-image-section .search-results-grid-item-detail-image-and-tags-holder .search-results-grid-item-detail-image-holder .search-results-grid-item-detail-loading.search-results-grid-item-detail-image{z-index:1}.search-results-grid-view-holder .search-results-grid-item-detail-holder .search-results-grid-item-detail .search-results-grid-item-detail-image-section .search-results-grid-item-detail-image-and-tags-holder .search-results-grid-item-detail-image-holder .search-results-grid-item-detail-animation.search-results-grid-item-detail-animation,.search-results-grid-view-holder .search-results-grid-item-detail-holder .search-results-grid-item-detail .search-results-grid-item-detail-image-section .search-results-grid-item-detail-image-and-tags-holder .search-results-grid-item-detail-image-holder .search-results-grid-item-detail-image.search-results-grid-item-detail-animation,.search-results-grid-view-holder .search-results-grid-item-detail-holder .search-results-grid-item-detail .search-results-grid-item-detail-image-section .search-results-grid-item-detail-image-and-tags-holder .search-results-grid-item-detail-image-holder .search-results-grid-item-detail-loading.search-results-grid-item-detail-animation{z-index:2}.search-results-grid-view-holder .search-results-grid-item-detail-holder .search-results-grid-item-detail .search-results-grid-item-detail-image-section .search-results-grid-item-detail-nav{width:50px}.search-results-grid-view-holder .search-results-grid-item-detail-holder .search-results-grid-item-detail .search-results-grid-item-detail-nav{position:relative;top:0;background-repeat:no-repeat;width:75px;height:calc(100% - (3vh + 36px));z-index:1;pointer-events:none;opacity:.5;background-color:transparent}.search-results-grid-view-holder .search-results-grid-item-detail-holder .search-results-grid-item-detail .search-results-grid-item-detail-nav .search-results-grid-item-detail-nav-icon{background-size:24px;background-repeat:no-repeat;height:100%;width:32px;position:absolute;pointer-events:auto;top:0}.search-results-grid-view-holder .search-results-grid-item-detail-holder .search-results-grid-item-detail .search-results-grid-item-detail-nav.search-results-grid-item-detail-nav-left{left:0}.search-results-grid-view-holder .search-results-grid-item-detail-holder .search-results-grid-item-detail .search-results-grid-item-detail-nav.search-results-grid-item-detail-nav-left .search-results-grid-item-detail-nav-icon{right:0;background-position:100%;background-image:url(/images/caret-left.svg)}.search-results-grid-view-holder .search-results-grid-item-detail-holder .search-results-grid-item-detail .search-results-grid-item-detail-nav.search-results-grid-item-detail-nav-left .search-results-grid-item-detail-nav-icon:hover{background-image:url(/images/caret-left-hover.svg)}.search-results-grid-view-holder .search-results-grid-item-detail-holder .search-results-grid-item-detail .search-results-grid-item-detail-nav.search-results-grid-item-detail-nav-right{right:0}.search-results-grid-view-holder .search-results-grid-item-detail-holder .search-results-grid-item-detail .search-results-grid-item-detail-nav.search-results-grid-item-detail-nav-right .search-results-grid-item-detail-nav-icon{left:0;background-position:0;background-image:url(/images/caret-right.svg)}.search-results-grid-view-holder .search-results-grid-item-detail-holder .search-results-grid-item-detail .search-results-grid-item-detail-nav.search-results-grid-item-detail-nav-right .search-results-grid-item-detail-nav-icon:hover{background-image:url(/images/caret-right-hover.svg)}.search-results-grid-view-holder .search-results-grid-item-detail-holder .search-results-grid-item-detail.can-nav .search-results-grid-item-detail-nav{opacity:1}.search-results-grid-view-holder .search-results-grid-item-detail-holder.show-right-rail .search-results-grid-item-detail-right{display:-webkit-flex;display:flex}.search-results-grid-view-holder .search-results-grid-item-detail-holder.show-right-rail .search-results-grid-item-detail{width:75%}.search-results-grid-view-holder .search-results-grid-item-detail-holder.show-right-rail .search-results-grid-item-detail-header{display:none}.search-results-grid-view-holder .search-results-grid-item-detail-holder{z-index:2;top:-47px;height:calc(100% + 47px)}.search-results-grid-view-holder .search-results-grid-item-detail-holder .search-results-grid-item-detail-image-section{width:100%;height:calc(82vh - 66px);padding-top:5vh}.search-results-grid-view-holder .search-results-grid-item-detail-holder .search-results-grid-item-detail-image-section .search-results-grid-item-detail-image-and-tags-holder{display:-webkit-flex;display:flex;-webkit-flex-direction:column;flex-direction:column}.search-results-grid-view-holder .search-results-grid-item-detail-holder .search-results-grid-item-detail-image-section .search-results-grid-item-detail-image-and-tags-holder .search-results-grid-item-detail-tags{display:-webkit-flex;display:flex;-webkit-justify-content:center;justify-content:center;margin:3vh 0}.search-results-grid-view-holder .search-results-grid-item-detail-holder .search-results-grid-item-detail-image-section .search-results-grid-item-detail-image-and-tags-holder .search-results-grid-item-detail-tags .search-results-tag-button{padding:0 10px;margin:0 3px;border:1px solid #c5ccd0;height:28px;line-height:25px;opacity:1;font-weight:500;transition:opacity .1s ease-in-out,background-color .1s ease-in-out}.search-results-grid-view-holder .search-results-grid-item-detail-holder .search-results-grid-item-detail-image-section .search-results-grid-item-detail-image-and-tags-holder .search-results-grid-item-detail-tags .search-results-tag-button:hover{background-color:#f8f8f8}.search-results-grid-view-holder .search-results-grid-item-detail-holder .search-results-grid-item-detail-other-results-section-scroller-holder{height:18vh;padding-top:1.75vh}.search-results-grid-view-holder .search-results-grid{display:-webkit-flex;display:flex;-webkit-flex-direction:column;flex-direction:column;-webkit-align-items:center;align-items:center;padding-bottom:66px;width:100%;left:50%;-webkit-transform:translateX(-50%);transform:translateX(-50%);position:relative}.search-results-grid-view-holder .search-results-grid .search-results-grid-row{display:-webkit-flex;display:flex;-webkit-flex-direction:row;flex-direction:row;-webkit-justify-content:space-between;justify-content:space-between;width:100%;margin-top:20px}.search-results-grid-view-holder .search-results-grid .search-results-grid-row:first-child{margin-top:0}.search-results-grid-view-holder .search-results-grid .search-results-grid-row.partial-row{-webkit-justify-content:flex-start;justify-content:flex-start}.search-results-grid-view-holder .search-results-grid .search-results-grid-row.partial-row-narrow{-webkit-justify-content:space-between;justify-content:space-between}.search-results-grid-view-holder .search-results-grid .search-results-grid-row.partial-row-narrow:after,.search-results-grid-view-holder .search-results-grid .search-results-grid-row.partial-row-narrow:before{content:"";display:block}.search-results-grid-view-holder .search-results-grid .search-results-grid-row.is-carousel-row{overflow-y:hidden;overflow-x:auto}.search-results-grid-view-holder .search-results-grid .search-results-grid-row .search-results-grid-item{position:relative;text-decoration:none;color:#3e3f41;cursor:default}.search-results-grid-view-holder .search-results-grid .search-results-grid-row .search-results-grid-item:hover{color:#000}.search-results-grid-view-holder .search-results-grid .search-results-grid-row .search-results-grid-item:hover:not(.not-loaded) .search-results-grid-item-hover-thang{opacity:1}.search-results-grid-view-holder .search-results-grid .search-results-grid-row .search-results-grid-item:last-child{margin-right:0}.search-results-grid-view-holder .search-results-grid .search-results-grid-row .search-results-grid-item .search-results-grid-item-thumb{background-size:contain;background-repeat:no-repeat;background-position:50%;z-index:1;position:relative;opacity:1;transition:opacity .3s ease-in-out,-webkit-transform .3s ease-in-out;transition:opacity .3s ease-in-out,transform .3s ease-in-out;transition:opacity .3s ease-in-out,transform .3s ease-in-out,-webkit-transform .3s ease-in-out;-webkit-transform:scale(1);transform:scale(1)}.search-results-grid-view-holder .search-results-grid .search-results-grid-row .search-results-grid-item .search-results-grid-item-label{font-size:15px;font-weight:600;color:inherit;text-decoration:none;margin-top:6px}.search-results-grid-view-holder .search-results-grid .search-results-grid-row .search-results-grid-item .search-results-grid-item-label:first-letter{text-transform:uppercase}.search-results-grid-view-holder .search-results-grid .search-results-grid-row .search-results-grid-item .search-results-grid-item-label:not(.debug-tagging){display:none}.search-results-grid-view-holder .search-results-grid .search-results-grid-row .search-results-grid-item .search-results-grid-item-thumb-bg-load{position:absolute;top:1px;left:1px;z-index:-1;background-color:#f4f5f5;width:calc(100% - 2px);height:calc(100% - 2px)}.search-results-grid-view-holder .search-results-grid .search-results-grid-row .search-results-grid-item.not-loaded .search-results-grid-item-thumb{opacity:0;-webkit-transform:scale(.8);transform:scale(.8)}.search-results-grid-view-holder .search-results-grid .search-results-grid-row .search-results-grid-item.had-load-error{display:none}.search-results-grid-view-holder .search-results-grid .recommended-row-footer,.search-results-grid-view-holder .search-results-grid .recommended-row-header{width:100%;color:#1a2226;font-size:18px;font-weight:900;margin-bottom:-5px}.search-results-grid-view-holder .search-results-grid .recommended-row-footer{margin-top:14px}.search-results-grid-view-holder .search-results-grid-item-detail-holder .search-results-grid-item-hover-thang,.search-results-grid-view-holder .search-results-grid-item-detail-other-results-item .search-results-grid-item-hover-thang,.search-results-grid-view-holder .search-results-grid-item .search-results-grid-item-hover-thang{opacity:0;width:100%;height:100%;position:absolute;top:0;left:0;transition:opacity .3s ease-in-out .1s}.search-results-grid-view-holder .search-results-grid-item-detail-holder .search-results-grid-item-hover-thang.is-edge,.search-results-grid-view-holder .search-results-grid-item-detail-holder .search-results-grid-item-hover-thang.is-IE,.search-results-grid-view-holder .search-results-grid-item-detail-other-results-item .search-results-grid-item-hover-thang.is-edge,.search-results-grid-view-holder .search-results-grid-item-detail-other-results-item .search-results-grid-item-hover-thang.is-IE,.search-results-grid-view-holder .search-results-grid-item .search-results-grid-item-hover-thang.is-edge,.search-results-grid-view-holder .search-results-grid-item .search-results-grid-item-hover-thang.is-IE{transition-delay:0s}.search-results-grid-view-holder .search-results-grid-item-detail-holder .search-results-grid-item-hover-thang .search-results-grid-item-hover-thang-background,.search-results-grid-view-holder .search-results-grid-item-detail-other-results-item .search-results-grid-item-hover-thang .search-results-grid-item-hover-thang-background,.search-results-grid-view-holder .search-results-grid-item .search-results-grid-item-hover-thang .search-results-grid-item-hover-thang-background{width:100%;height:100%;background-color:rgba(0,0,0,.7);position:absolute;top:0;left:0}.search-results-grid-view-holder .search-results-grid-item-detail-holder .search-results-grid-item-hover-thang .search-results-grid-main-cta,.search-results-grid-view-holder .search-results-grid-item-detail-other-results-item .search-results-grid-item-hover-thang .search-results-grid-main-cta,.search-results-grid-view-holder .search-results-grid-item .search-results-grid-item-hover-thang .search-results-grid-main-cta{height:30px;width:auto;color:#fff;border:2px solid #fff;font-size:15px;font-weight:700;line-height:25px;position:absolute;top:50%;left:50%;-webkit-transform:translate(-50%,-50%);transform:translate(-50%,-50%);border-radius:15px;padding:0 12px;white-space:nowrap;background-color:rgba(0,0,0,.25);transition:color .2s ease-in-out,background-color .2s ease-in-out;cursor:pointer}.search-results-grid-view-holder .search-results-grid-item-detail-holder .search-results-grid-item-hover-thang .search-results-grid-main-cta:hover,.search-results-grid-view-holder .search-results-grid-item-detail-other-results-item .search-results-grid-item-hover-thang .search-results-grid-main-cta:hover,.search-results-grid-view-holder .search-results-grid-item .search-results-grid-item-hover-thang .search-results-grid-main-cta:hover{background-color:#fff;color:#3e3f41}.search-results-grid-view-holder .search-results-grid-item-detail-holder .search-results-grid-item-hover-thang .search-results-grid-item-hover-ctas,.search-results-grid-view-holder .search-results-grid-item-detail-other-results-item .search-results-grid-item-hover-thang .search-results-grid-item-hover-ctas,.search-results-grid-view-holder .search-results-grid-item .search-results-grid-item-hover-thang .search-results-grid-item-hover-ctas{z-index:1;width:100%;position:absolute;top:0;left:0;display:-webkit-flex;display:flex;-webkit-justify-content:flex-end;justify-content:flex-end;-webkit-flex-wrap:wrap;flex-wrap:wrap;padding:2px 26px 0 4px}.search-results-grid-view-holder .search-results-grid-item-detail-holder .search-results-grid-item-hover-thang .search-results-grid-item-hover-ctas .search-results-grid-item-hover-cta,.search-results-grid-view-holder .search-results-grid-item-detail-other-results-item .search-results-grid-item-hover-thang .search-results-grid-item-hover-ctas .search-results-grid-item-hover-cta,.search-results-grid-view-holder .search-results-grid-item .search-results-grid-item-hover-thang .search-results-grid-item-hover-ctas .search-results-grid-item-hover-cta{border-radius:16px;font-size:12px;font-weight:500;color:#3e3f41;padding:4px 6px;margin:3px;background-repeat:no-repeat;background-size:contain;width:22px;height:22px}.search-results-grid-view-holder .search-results-grid-item-detail-holder .search-results-grid-item-hover-thang .search-results-grid-item-hover-ctas .search-results-grid-item-hover-cta.search-results-grid-item-hover-cta-detail,.search-results-grid-view-holder .search-results-grid-item-detail-other-results-item .search-results-grid-item-hover-thang .search-results-grid-item-hover-ctas .search-results-grid-item-hover-cta.search-results-grid-item-hover-cta-detail,.search-results-grid-view-holder .search-results-grid-item .search-results-grid-item-hover-thang .search-results-grid-item-hover-ctas .search-results-grid-item-hover-cta.search-results-grid-item-hover-cta-detail{background-image:url(/images/spectrum-magnify-white.svg)}.search-results-grid-view-holder .search-results-grid-item-detail-holder .search-results-grid-item-hover-thang .search-results-grid-item-hover-ctas .search-results-grid-item-hover-cta:hover,.search-results-grid-view-holder .search-results-grid-item-detail-other-results-item .search-results-grid-item-hover-thang .search-results-grid-item-hover-ctas .search-results-grid-item-hover-cta:hover,.search-results-grid-view-holder .search-results-grid-item .search-results-grid-item-hover-thang .search-results-grid-item-hover-ctas .search-results-grid-item-hover-cta:hover{opacity:.85}.search-results-grid-view-holder .search-results-grid-item-detail-holder .search-results-grid-item-hover-thang .search-results-grid-item-hover-tags,.search-results-grid-view-holder .search-results-grid-item-detail-other-results-item .search-results-grid-item-hover-thang .search-results-grid-item-hover-tags,.search-results-grid-view-holder .search-results-grid-item .search-results-grid-item-hover-thang .search-results-grid-item-hover-tags{z-index:1;width:100%;position:absolute;bottom:0;left:0;height:auto;display:none;-webkit-flex-direction:row;flex-direction:row;-webkit-flex-wrap:wrap;flex-wrap:wrap;-webkit-justify-content:flex-start;justify-content:flex-start;padding-bottom:4px}.search-results-grid-view-holder .search-results-grid-item-detail-holder .search-results-grid-item-hover-thang .search-results-grid-item-hover-tags.debug-tagging,.search-results-grid-view-holder .search-results-grid-item-detail-other-results-item .search-results-grid-item-hover-thang .search-results-grid-item-hover-tags.debug-tagging,.search-results-grid-view-holder .search-results-grid-item .search-results-grid-item-hover-thang .search-results-grid-item-hover-tags.debug-tagging{display:-webkit-flex;display:flex;max-height:100%;overflow:hidden auto}.search-results-grid-view-holder .search-results-grid-item-detail-holder .search-results-grid-item-hover-thang .search-results-grid-item-hover-tags .search-results-grid-item-hover-id,.search-results-grid-view-holder .search-results-grid-item-detail-holder .search-results-grid-item-hover-thang .search-results-grid-item-hover-tags .search-results-grid-item-hover-score,.search-results-grid-view-holder .search-results-grid-item-detail-holder .search-results-grid-item-hover-thang .search-results-grid-item-hover-tags .search-results-grid-item-hover-size,.search-results-grid-view-holder .search-results-grid-item-detail-holder .search-results-grid-item-hover-thang .search-results-grid-item-hover-tags .search-results-grid-item-hover-tag,.search-results-grid-view-holder .search-results-grid-item-detail-other-results-item .search-results-grid-item-hover-thang .search-results-grid-item-hover-tags .search-results-grid-item-hover-id,.search-results-grid-view-holder .search-results-grid-item-detail-other-results-item .search-results-grid-item-hover-thang .search-results-grid-item-hover-tags .search-results-grid-item-hover-score,.search-results-grid-view-holder .search-results-grid-item-detail-other-results-item .search-results-grid-item-hover-thang .search-results-grid-item-hover-tags .search-results-grid-item-hover-size,.search-results-grid-view-holder .search-results-grid-item-detail-other-results-item .search-results-grid-item-hover-thang .search-results-grid-item-hover-tags .search-results-grid-item-hover-tag,.search-results-grid-view-holder .search-results-grid-item .search-results-grid-item-hover-thang .search-results-grid-item-hover-tags .search-results-grid-item-hover-id,.search-results-grid-view-holder .search-results-grid-item .search-results-grid-item-hover-thang .search-results-grid-item-hover-tags .search-results-grid-item-hover-score,.search-results-grid-view-holder .search-results-grid-item .search-results-grid-item-hover-thang .search-results-grid-item-hover-tags .search-results-grid-item-hover-size,.search-results-grid-view-holder .search-results-grid-item .search-results-grid-item-hover-thang .search-results-grid-item-hover-tags .search-results-grid-item-hover-tag{font-size:10px;border-radius:16px;padding:4px 6px;margin:3px;height:20px;background-color:hsla(0,0%,100%,.8)}.search-results-grid-view-holder .search-results-grid-item-detail-holder .search-results-grid-item-hover-thang .search-results-grid-item-hover-tags .search-results-grid-item-hover-id.search-results-grid-item-hover-score,.search-results-grid-view-holder .search-results-grid-item-detail-holder .search-results-grid-item-hover-thang .search-results-grid-item-hover-tags .search-results-grid-item-hover-score.search-results-grid-item-hover-score,.search-results-grid-view-holder .search-results-grid-item-detail-holder .search-results-grid-item-hover-thang .search-results-grid-item-hover-tags .search-results-grid-item-hover-size.search-results-grid-item-hover-score,.search-results-grid-view-holder .search-results-grid-item-detail-holder .search-results-grid-item-hover-thang .search-results-grid-item-hover-tags .search-results-grid-item-hover-tag.search-results-grid-item-hover-score,.search-results-grid-view-holder .search-results-grid-item-detail-other-results-item .search-results-grid-item-hover-thang .search-results-grid-item-hover-tags .search-results-grid-item-hover-id.search-results-grid-item-hover-score,.search-results-grid-view-holder .search-results-grid-item-detail-other-results-item .search-results-grid-item-hover-thang .search-results-grid-item-hover-tags .search-results-grid-item-hover-score.search-results-grid-item-hover-score,.search-results-grid-view-holder .search-results-grid-item-detail-other-results-item .search-results-grid-item-hover-thang .search-results-grid-item-hover-tags .search-results-grid-item-hover-size.search-results-grid-item-hover-score,.search-results-grid-view-holder .search-results-grid-item-detail-other-results-item .search-results-grid-item-hover-thang .search-results-grid-item-hover-tags .search-results-grid-item-hover-tag.search-results-grid-item-hover-score,.search-results-grid-view-holder .search-results-grid-item .search-results-grid-item-hover-thang .search-results-grid-item-hover-tags .search-results-grid-item-hover-id.search-results-grid-item-hover-score,.search-results-grid-view-holder .search-results-grid-item .search-results-grid-item-hover-thang .search-results-grid-item-hover-tags .search-results-grid-item-hover-score.search-results-grid-item-hover-score,.search-results-grid-view-holder .search-results-grid-item .search-results-grid-item-hover-thang .search-results-grid-item-hover-tags .search-results-grid-item-hover-size.search-results-grid-item-hover-score,.search-results-grid-view-holder .search-results-grid-item .search-results-grid-item-hover-thang .search-results-grid-item-hover-tags .search-results-grid-item-hover-tag.search-results-grid-item-hover-score{background-color:rgba(126,13,13,.8);color:#fff}.search-results-grid-view-holder .search-results-grid-item-detail-holder .search-results-grid-item-hover-thang .search-results-grid-item-hover-tags .search-results-grid-item-hover-id.search-results-grid-item-hover-id,.search-results-grid-view-holder .search-results-grid-item-detail-holder .search-results-grid-item-hover-thang .search-results-grid-item-hover-tags .search-results-grid-item-hover-score.search-results-grid-item-hover-id,.search-results-grid-view-holder .search-results-grid-item-detail-holder .search-results-grid-item-hover-thang .search-results-grid-item-hover-tags .search-results-grid-item-hover-size.search-results-grid-item-hover-id,.search-results-grid-view-holder .search-results-grid-item-detail-holder .search-results-grid-item-hover-thang .search-results-grid-item-hover-tags .search-results-grid-item-hover-tag.search-results-grid-item-hover-id,.search-results-grid-view-holder .search-results-grid-item-detail-other-results-item .search-results-grid-item-hover-thang .search-results-grid-item-hover-tags .search-results-grid-item-hover-id.search-results-grid-item-hover-id,.search-results-grid-view-holder .search-results-grid-item-detail-other-results-item .search-results-grid-item-hover-thang .search-results-grid-item-hover-tags .search-results-grid-item-hover-score.search-results-grid-item-hover-id,.search-results-grid-view-holder .search-results-grid-item-detail-other-results-item .search-results-grid-item-hover-thang .search-results-grid-item-hover-tags .search-results-grid-item-hover-size.search-results-grid-item-hover-id,.search-results-grid-view-holder .search-results-grid-item-detail-other-results-item .search-results-grid-item-hover-thang .search-results-grid-item-hover-tags .search-results-grid-item-hover-tag.search-results-grid-item-hover-id,.search-results-grid-view-holder .search-results-grid-item .search-results-grid-item-hover-thang .search-results-grid-item-hover-tags .search-results-grid-item-hover-id.search-results-grid-item-hover-id,.search-results-grid-view-holder .search-results-grid-item .search-results-grid-item-hover-thang .search-results-grid-item-hover-tags .search-results-grid-item-hover-score.search-results-grid-item-hover-id,.search-results-grid-view-holder .search-results-grid-item .search-results-grid-item-hover-thang .search-results-grid-item-hover-tags .search-results-grid-item-hover-size.search-results-grid-item-hover-id,.search-results-grid-view-holder .search-results-grid-item .search-results-grid-item-hover-thang .search-results-grid-item-hover-tags .search-results-grid-item-hover-tag.search-results-grid-item-hover-id{background-color:rgba(13,13,126,.8);color:#fff}.search-results-grid-view-holder .search-results-grid-item-detail-holder .search-results-grid-item-hover-thang .search-results-grid-item-hover-tags .search-results-grid-item-hover-id.search-results-grid-item-hover-size,.search-results-grid-view-holder .search-results-grid-item-detail-holder .search-results-grid-item-hover-thang .search-results-grid-item-hover-tags .search-results-grid-item-hover-score.search-results-grid-item-hover-size,.search-results-grid-view-holder .search-results-grid-item-detail-holder .search-results-grid-item-hover-thang .search-results-grid-item-hover-tags .search-results-grid-item-hover-size.search-results-grid-item-hover-size,.search-results-grid-view-holder .search-results-grid-item-detail-holder .search-results-grid-item-hover-thang .search-results-grid-item-hover-tags .search-results-grid-item-hover-tag.search-results-grid-item-hover-size,.search-results-grid-view-holder .search-results-grid-item-detail-other-results-item .search-results-grid-item-hover-thang .search-results-grid-item-hover-tags .search-results-grid-item-hover-id.search-results-grid-item-hover-size,.search-results-grid-view-holder .search-results-grid-item-detail-other-results-item .search-results-grid-item-hover-thang .search-results-grid-item-hover-tags .search-results-grid-item-hover-score.search-results-grid-item-hover-size,.search-results-grid-view-holder .search-results-grid-item-detail-other-results-item .search-results-grid-item-hover-thang .search-results-grid-item-hover-tags .search-results-grid-item-hover-size.search-results-grid-item-hover-size,.search-results-grid-view-holder .search-results-grid-item-detail-other-results-item .search-results-grid-item-hover-thang .search-results-grid-item-hover-tags .search-results-grid-item-hover-tag.search-results-grid-item-hover-size,.search-results-grid-view-holder .search-results-grid-item .search-results-grid-item-hover-thang .search-results-grid-item-hover-tags .search-results-grid-item-hover-id.search-results-grid-item-hover-size,.search-results-grid-view-holder .search-results-grid-item .search-results-grid-item-hover-thang .search-results-grid-item-hover-tags .search-results-grid-item-hover-score.search-results-grid-item-hover-size,.search-results-grid-view-holder .search-results-grid-item .search-results-grid-item-hover-thang .search-results-grid-item-hover-tags .search-results-grid-item-hover-size.search-results-grid-item-hover-size,.search-results-grid-view-holder .search-results-grid-item .search-results-grid-item-hover-thang .search-results-grid-item-hover-tags .search-results-grid-item-hover-tag.search-results-grid-item-hover-size{background-color:rgba(13,126,13,.8);color:#fff}.search-results-grid-view-holder .search-results-grid-item-detail-holder.is-premium-template .search-results-grid-item-thumb-premium-icon,.search-results-grid-view-holder .search-results-grid-item-detail-other-results-item.is-premium-template .search-results-grid-item-thumb-premium-icon,.search-results-grid-view-holder .search-results-grid-item.is-premium-template .search-results-grid-item-thumb-premium-icon{display:block}.search-results-grid-view-holder .search-results-grid-item-detail-holder.is-premium-template.search-results-grid-item-detail-other-results-item .search-results-grid-item-thumb-premium-icon,.search-results-grid-view-holder .search-results-grid-item-detail-other-results-item.is-premium-template.search-results-grid-item-detail-other-results-item .search-results-grid-item-thumb-premium-icon,.search-results-grid-view-holder .search-results-grid-item.is-premium-template.search-results-grid-item-detail-other-results-item .search-results-grid-item-thumb-premium-icon{display:block;z-index:1;top:-1px;width:16px;background-position:top}.search-results-grid-view-holder .search-results-grid-item-detail-holder.is-premium-template.search-results-grid-item-detail-holder.search-results-grid-item-detail-image-and-tags-holder .search-results-grid-item-thumb-premium-icon,.search-results-grid-view-holder .search-results-grid-item-detail-other-results-item.is-premium-template.search-results-grid-item-detail-holder.search-results-grid-item-detail-image-and-tags-holder .search-results-grid-item-thumb-premium-icon,.search-results-grid-view-holder .search-results-grid-item.is-premium-template.search-results-grid-item-detail-holder.search-results-grid-item-detail-image-and-tags-holder .search-results-grid-item-thumb-premium-icon{display:block}.search-results-grid-view-holder .search-results-grid-item-detail-holder.is-premium-template .search-results-grid-item-hover-thang,.search-results-grid-view-holder .search-results-grid-item-detail-other-results-item.is-premium-template .search-results-grid-item-hover-thang,.search-results-grid-view-holder .search-results-grid-item.is-premium-template .search-results-grid-item-hover-thang{height:calc(100% + 4px);top:-4px}.search-results-grid-view-holder .search-results-grid-item-detail-holder.search-results-grid-item.implicit-create-cta,.search-results-grid-view-holder .search-results-grid-item-detail-other-results-item.search-results-grid-item.implicit-create-cta,.search-results-grid-view-holder .search-results-grid-item.search-results-grid-item.implicit-create-cta{outline:3px solid transparent;transition:outline .2s ease-in-out .1s;cursor:pointer}.search-results-grid-view-holder .search-results-grid-item-detail-holder.search-results-grid-item.implicit-create-cta.is-edge,.search-results-grid-view-holder .search-results-grid-item-detail-holder.search-results-grid-item.implicit-create-cta.is-IE,.search-results-grid-view-holder .search-results-grid-item-detail-other-results-item.search-results-grid-item.implicit-create-cta.is-edge,.search-results-grid-view-holder .search-results-grid-item-detail-other-results-item.search-results-grid-item.implicit-create-cta.is-IE,.search-results-grid-view-holder .search-results-grid-item.search-results-grid-item.implicit-create-cta.is-edge,.search-results-grid-view-holder .search-results-grid-item.search-results-grid-item.implicit-create-cta.is-IE{transition-delay:0s}.search-results-grid-view-holder .search-results-grid-item-detail-holder.search-results-grid-item.implicit-create-cta .search-results-grid-item-thumb-premium-icon,.search-results-grid-view-holder .search-results-grid-item-detail-other-results-item.search-results-grid-item.implicit-create-cta .search-results-grid-item-thumb-premium-icon,.search-results-grid-view-holder .search-results-grid-item.search-results-grid-item.implicit-create-cta .search-results-grid-item-thumb-premium-icon{z-index:1}.search-results-grid-view-holder .search-results-grid-item-detail-holder.search-results-grid-item.implicit-create-cta .search-results-grid-item-hover-thang,.search-results-grid-view-holder .search-results-grid-item-detail-other-results-item.search-results-grid-item.implicit-create-cta .search-results-grid-item-hover-thang,.search-results-grid-view-holder .search-results-grid-item.search-results-grid-item.implicit-create-cta .search-results-grid-item-hover-thang{border:1px solid #1a1a1a;height:100%;top:0}.search-results-grid-view-holder .search-results-grid-item-detail-holder.search-results-grid-item.implicit-create-cta .search-results-grid-item-hover-thang .search-results-grid-item-hover-thang-background,.search-results-grid-view-holder .search-results-grid-item-detail-other-results-item.search-results-grid-item.implicit-create-cta .search-results-grid-item-hover-thang .search-results-grid-item-hover-thang-background,.search-results-grid-view-holder .search-results-grid-item.search-results-grid-item.implicit-create-cta .search-results-grid-item-hover-thang .search-results-grid-item-hover-thang-background{background-color:transparent}.search-results-grid-view-holder .search-results-grid-item-detail-holder.search-results-grid-item.implicit-create-cta:focus:not(.not-loaded),.search-results-grid-view-holder .search-results-grid-item-detail-holder.search-results-grid-item.implicit-create-cta:hover:not(.not-loaded),.search-results-grid-view-holder .search-results-grid-item-detail-other-results-item.search-results-grid-item.implicit-create-cta:focus:not(.not-loaded),.search-results-grid-view-holder .search-results-grid-item-detail-other-results-item.search-results-grid-item.implicit-create-cta:hover:not(.not-loaded),.search-results-grid-view-holder .search-results-grid-item.search-results-grid-item.implicit-create-cta:focus:not(.not-loaded),.search-results-grid-view-holder .search-results-grid-item.search-results-grid-item.implicit-create-cta:hover:not(.not-loaded){outline:2px solid #1a1a1a}.search-results-grid-view-holder .search-results-grid-item-detail-holder.search-results-grid-item.implicit-create-cta:focus:not(.not-loaded):focus,.search-results-grid-view-holder .search-results-grid-item-detail-holder.search-results-grid-item.implicit-create-cta:hover:not(.not-loaded):focus,.search-results-grid-view-holder .search-results-grid-item-detail-other-results-item.search-results-grid-item.implicit-create-cta:focus:not(.not-loaded):focus,.search-results-grid-view-holder .search-results-grid-item-detail-other-results-item.search-results-grid-item.implicit-create-cta:hover:not(.not-loaded):focus,.search-results-grid-view-holder .search-results-grid-item.search-results-grid-item.implicit-create-cta:focus:not(.not-loaded):focus,.search-results-grid-view-holder .search-results-grid-item.search-results-grid-item.implicit-create-cta:hover:not(.not-loaded):focus{outline:2px solid #1473e6}.search-results-grid-view-holder .search-results-grid-item-detail-holder.search-results-grid-item.implicit-create-cta:focus:not(.not-loaded) .search-results-grid-item-hover-thang,.search-results-grid-view-holder .search-results-grid-item-detail-holder.search-results-grid-item.implicit-create-cta:hover:not(.not-loaded) .search-results-grid-item-hover-thang,.search-results-grid-view-holder .search-results-grid-item-detail-other-results-item.search-results-grid-item.implicit-create-cta:focus:not(.not-loaded) .search-results-grid-item-hover-thang,.search-results-grid-view-holder .search-results-grid-item-detail-other-results-item.search-results-grid-item.implicit-create-cta:hover:not(.not-loaded) .search-results-grid-item-hover-thang,.search-results-grid-view-holder .search-results-grid-item.search-results-grid-item.implicit-create-cta:focus:not(.not-loaded) .search-results-grid-item-hover-thang,.search-results-grid-view-holder .search-results-grid-item.search-results-grid-item.implicit-create-cta:hover:not(.not-loaded) .search-results-grid-item-hover-thang{opacity:1}.search-results-grid-view-holder .search-results-grid-holder .search-results-grid-row.hide-assets .search-results-grid-item:hover:not(.not-loaded) .search-results-grid-item-hover-thang{opacity:0}.search-results-grid-view-holder .search-results-grid-holder .search-results-grid-row.hide-assets .search-results-grid-item .search-results-grid-item-thumb{opacity:0;-webkit-transform:scale(.8);transform:scale(.8)}.search-results-grid-view-holder .search-results-grid-holder .search-results-grid-row .search-results-grid-item-post:hover .search-results-grid-item-thumb-animation-icon{opacity:0}.search-results-tag-button{font-size:15px;padding:8px 12px;margin:9px 6px 0 0;color:#1a1a1a;border:1px solid #c5ccd0;cursor:pointer;background-color:#fff;border-radius:18px;font-weight:500;height:30px;line-height:10px;-webkit-flex-shrink:0;flex-shrink:0;box-sizing:border-box;background-color:transparent}.search-results-tag-button:hover{background-color:#f8f8f8}.search-results-tag-button.selected{border:1px solid transparent;color:#fff;background-color:#1a1a1a}.search-results-tag-button.if-showing-all{display:none}.search-results-tag-button.debug-tagging.search-results-tag-prefix-categories,.search-results-tag-button.debug-tagging.search-results-tag-prefix-explore{color:red}.search-results-tag-button.debug-tagging.search-results-tag-prefix-spcase,.search-results-tag-button.debug-tagging.search-results-tag-prefix-tasks{color:blue}.search-results-tag-button.debug-tagging.search-results-tag-prefix-spterm,.search-results-tag-button.debug-tagging.search-results-tag-prefix-topics{color:orange}.search-results-tag-button.debug-tagging.search-results-tag-prefix-colors,.search-results-tag-button.debug-tagging.search-results-tag-prefix-spcolor{color:#000}.search-results-tag-button.debug-tagging.search-results-tag-prefix-multi{color:green}.search-results-tag-button.debug-tagging.search-results-tag-prefix-spstyle,.search-results-tag-button.debug-tagging.search-results-tag-prefix-styles{color:#fe0}.search-results-tag-button.debug-tagging.selected{background-color:#1a1a1a}.search-view{color:#fff;height:66vh;min-height:400px}.search-view .search-overlay{display:block;position:fixed;left:0;top:0;width:100%;height:100%;opacity:.1;background-color:#000;z-index:1}.search-view .search-input,.search-view .search-input-disabled{text-overflow:ellipsis;white-space:nowrap;overflow:hidden}.search-view .search-top-container{position:relative;top:0;width:100%;height:inherit;min-height:400px;display:-webkit-flex;display:flex;-webkit-flex-direction:column;flex-direction:column;-webkit-align-items:center;align-items:center;-ms-grid-column-align:center;justify-items:center;padding-top:120px}.search-view .search-top-container .search-bar{padding-top:46px;font-size:0;z-index:1;position:relative;max-width:90vw}.search-view .search-top-container .search-bar .search-input-holder{position:relative}.search-view .search-top-container .search-bar .search-input,.search-view .search-top-container .search-bar .search-input-disabled{margin:0 auto;height:40px;width:500px;max-width:90vw;border-radius:4px;font-size:15px;line-height:23px;padding:0 30px 1px 40px;text-overflow:ellipsis;color:#3e3f41;caret-color:#1473e6;background-color:#fff;position:relative;font-weight:500;transition:border-color .2s ease-in-out;border-radius:24px}.search-view .search-top-container .search-bar .search-input-disabled:active,.search-view .search-top-container .search-bar .search-input-disabled:focus,.search-view .search-top-container .search-bar .search-input:active,.search-view .search-top-container .search-bar .search-input:focus{outline:none;border:1px solid #1473e6}.search-view .search-top-container .search-bar .search-input-disabled.search-input-disabled,.search-view .search-top-container .search-bar .search-input-disabled::-webkit-input-placeholder,.search-view .search-top-container .search-bar .search-input.search-input-disabled,.search-view .search-top-container .search-bar .search-input::-webkit-input-placeholder{color:#808990}.search-view .search-top-container .search-bar .search-input-disabled.search-input-disabled,.search-view .search-top-container .search-bar .search-input-disabled::-moz-placeholder,.search-view .search-top-container .search-bar .search-input.search-input-disabled,.search-view .search-top-container .search-bar .search-input::-moz-placeholder{color:#808990}.search-view .search-top-container .search-bar .search-input-disabled.search-input-disabled,.search-view .search-top-container .search-bar .search-input-disabled:-ms-input-placeholder,.search-view .search-top-container .search-bar .search-input.search-input-disabled,.search-view .search-top-container .search-bar .search-input:-ms-input-placeholder{color:#808990}.search-view .search-top-container .search-bar .search-input-disabled.search-input-disabled,.search-view .search-top-container .search-bar .search-input-disabled::placeholder,.search-view .search-top-container .search-bar .search-input.search-input-disabled,.search-view .search-top-container .search-bar .search-input::placeholder{color:#808990}.search-view .search-top-container .search-bar .search-input-disabled.search-input-disabled,.search-view .search-top-container .search-bar .search-input.search-input-disabled{line-height:38px;text-align:left;font-style:italic}.search-view .search-top-container .search-bar .search-input-disabled::-ms-clear,.search-view .search-top-container .search-bar .search-input::-ms-clear{display:none;width:0;height:0}.search-view .search-top-container .search-bar .search-button,.search-view .search-top-container .search-bar .search-clear{position:absolute;height:32px;width:30px;top:4px;background-position:50%;background-repeat:no-repeat;background-color:#fff;z-index:2;cursor:pointer;opacity:.7;transition:opacity .02s ease-in-out}.search-view .search-top-container .search-bar .search-button.search-clear,.search-view .search-top-container .search-bar .search-clear.search-clear{background-image:url(/images/search/search-clear-x-midnight.svg);right:4px;border-top-right-radius:24px;border-bottom-right-radius:24px;background-size:14px}.search-view .search-top-container .search-bar .search-button.search-button,.search-view .search-top-container .search-bar .search-clear.search-button{background-image:url(/images/search/search.svg);left:8px;border-top-left-radius:24px;border-bottom-left-radius:24px;background-size:18px;opacity:.7;transition:opacity .2s ease-in-out}.search-view .search-top-container .search-bar .search-button.search-button:not(.searching).active,.search-view .search-top-container .search-bar .search-button:not(.searching):hover,.search-view .search-top-container .search-bar .search-clear.search-button:not(.searching).active,.search-view .search-top-container .search-bar .search-clear:not(.searching):hover{opacity:1}.search-view .search-top-container .search-bar .search-button:not(.searching):hover.active,.search-view .search-top-container .search-bar .search-clear:not(.searching):hover.active{opacity:.7}.search-view .search-top-container .search-bar .search-button.disabled,.search-view .search-top-container .search-bar .search-clear.disabled{cursor:default;opacity:0}.search-view .search-top-container .search-bar .search-button.disabled:hover,.search-view .search-top-container .search-bar .search-clear.disabled:hover{opacity:0}.search-view .search-top-container .search-bar .search-button.disabled.search-clear,.search-view .search-top-container .search-bar .search-clear.disabled.search-clear{display:none}.search-view .search-input-library-dropdown{text-align:center;padding-bottom:20px}.search-view .search-input-library-select{width:99%;background-color:#fafafa;border:1px solid #e1e1e1;border-radius:4px;color:#8e8e8e;padding:6px}.search-view.search-view-in-container{height:100%;width:100%}.search-view.search-view-in-container .search-top-container{padding:16px;position:absolute;top:0;overflow-y:auto}.search-view.search-view-in-container .search-top-container .search-bg-underlay{display:none;position:absolute;width:100vw;height:100vh;top:0;right:0;z-index:-1;background-color:rgba(0,0,0,.4)}.search-view.search-view-in-container .search-top-container .search-bg-underlay.showing{display:block}.search-view.search-view-in-container .search-top-container .search-bar{padding-top:0;max-width:500px;width:100%}.search-view.search-view-in-container .search-top-container .search-bar .search-results{width:100%;margin-top:0;box-shadow:0 0 20px #00000029;top:96px!important}.search-view.search-view-in-container .search-top-container .search-bar .search-results .earch-results-pagination{color:#fff}.search-view.search-view-in-container .search-top-container .search-bar .search-input,.search-view.search-view-in-container .search-top-container .search-bar .search-input-disabled{width:100%;box-shadow:none;border:1px solid #dce0e3;transition:border-color .2s ease-in-out}.search-view.search-view-in-container .search-top-container .search-bar .search-input-disabled:active,.search-view.search-view-in-container .search-top-container .search-bar .search-input-disabled:focus,.search-view.search-view-in-container .search-top-container .search-bar .search-input:active,.search-view.search-view-in-container .search-top-container .search-bar .search-input:focus{outline:none;border:1px solid #1473e6}.search-view.search-view-in-container .search-top-container .search-bar .search-input-disabled.search-input-disabled,.search-view.search-view-in-container .search-top-container .search-bar .search-input.search-input-disabled{text-align:left;line-height:38px}.search-view .search-results{position:absolute;display:block;background-color:#fff;max-height:500px;width:500px;max-width:90vw;margin:0 auto;color:#1a1a1a;font-size:15px;font-weight:400;z-index:1;box-shadow:0 0 20px #00000029;border-radius:10px;top:56px;margin-top:56px;overflow-y:hidden;padding-top:12px;padding-bottom:12px}.search-view .search-results .search-results-ul-scroller{max-height:inherit;overflow-y:auto}.search-view .search-results ul{margin:7px 0}.search-view .search-results ul div.search-result-group-line,.search-view .search-results ul li{display:block;text-align:left;padding:4px 16px 6px;font-weight:400;font-size:14px;line-height:18px;cursor:default}.search-view .search-results ul div.search-result-group-line.if-showing-all:not(.show-more-tags-tags),.search-view .search-results ul div.search-result-group-line.is-more-tags-tag:not(.show-more-tags-tags),.search-view .search-results ul li.if-showing-all:not(.show-more-tags-tags),.search-view .search-results ul li.is-more-tags-tag:not(.show-more-tags-tags){display:none}.search-view .search-results ul div.search-result-group-line.search-result-result-line,.search-view .search-results ul div.search-result-group-line.search-result-search-suggest-line,.search-view .search-results ul li.search-result-result-line,.search-view .search-results ul li.search-result-search-suggest-line{cursor:pointer;margin-left:21px;margin-right:21px;border-radius:40px}.search-view .search-results ul div.search-result-group-line.search-result-result-line.arrow-selected,.search-view .search-results ul div.search-result-group-line.search-result-result-line.selected,.search-view .search-results ul div.search-result-group-line.search-result-result-line:hover,.search-view .search-results ul div.search-result-group-line.search-result-search-suggest-line.arrow-selected,.search-view .search-results ul div.search-result-group-line.search-result-search-suggest-line.selected,.search-view .search-results ul div.search-result-group-line.search-result-search-suggest-line:hover,.search-view .search-results ul li.search-result-result-line.arrow-selected,.search-view .search-results ul li.search-result-result-line.selected,.search-view .search-results ul li.search-result-result-line:hover,.search-view .search-results ul li.search-result-search-suggest-line.arrow-selected,.search-view .search-results ul li.search-result-search-suggest-line.selected,.search-view .search-results ul li.search-result-search-suggest-line:hover{background-color:#e8ebed}.search-view .search-results ul div.search-result-group-line.search-result-result-line:not(.search-result-line-can-arrow-nav),.search-view .search-results ul div.search-result-group-line.search-result-search-suggest-line:not(.search-result-line-can-arrow-nav),.search-view .search-results ul li.search-result-result-line:not(.search-result-line-can-arrow-nav),.search-view .search-results ul li.search-result-search-suggest-line:not(.search-result-line-can-arrow-nav){cursor:default}.search-view .search-results ul div.search-result-group-line.search-result-result-line:not(.search-result-line-can-arrow-nav):hover,.search-view .search-results ul div.search-result-group-line.search-result-search-suggest-line:not(.search-result-line-can-arrow-nav):hover,.search-view .search-results ul li.search-result-result-line:not(.search-result-line-can-arrow-nav):hover,.search-view .search-results ul li.search-result-search-suggest-line:not(.search-result-line-can-arrow-nav):hover{background-color:inherit}.search-view .search-results ul div.search-result-group-line.search-result-result-line .search-result-line-app-label,.search-view .search-results ul div.search-result-group-line.search-result-search-suggest-line .search-result-line-app-label,.search-view .search-results ul li.search-result-result-line .search-result-line-app-label,.search-view .search-results ul li.search-result-search-suggest-line .search-result-line-app-label{font-size:13px;text-transform:uppercase;line-height:16px}.search-view .search-results ul div.search-result-group-line.search-result-result-line .search-result-line-popular-translation,.search-view .search-results ul div.search-result-group-line.search-result-search-suggest-line .search-result-line-popular-translation,.search-view .search-results ul li.search-result-result-line .search-result-line-popular-translation,.search-view .search-results ul li.search-result-search-suggest-line .search-result-line-popular-translation{font-style:italic}.search-view .search-results ul div.search-result-group-line.search-result-result-line.search-result-search-suggest-line-popular-use-cases,.search-view .search-results ul div.search-result-group-line.search-result-search-suggest-line.search-result-search-suggest-line-popular-use-cases,.search-view .search-results ul li.search-result-result-line.search-result-search-suggest-line-popular-use-cases,.search-view .search-results ul li.search-result-search-suggest-line.search-result-search-suggest-line-popular-use-cases{color:#1473e6;padding-left:32px}.search-view .search-results ul div.search-result-group-line.search-result-result-line.search-result-search-suggest-line-popular-use-cases:hover,.search-view .search-results ul div.search-result-group-line.search-result-search-suggest-line.search-result-search-suggest-line-popular-use-cases:hover,.search-view .search-results ul li.search-result-result-line.search-result-search-suggest-line-popular-use-cases:hover,.search-view .search-results ul li.search-result-search-suggest-line.search-result-search-suggest-line-popular-use-cases:hover{background-color:#f4f5f5;color:#1473e6;cursor:pointer}.search-view .search-results ul div.search-result-group-line.search-result-result-line.search-result-search-suggest-line-popular-use-cases.arrow-selected,.search-view .search-results ul div.search-result-group-line.search-result-result-line.search-result-search-suggest-line-popular-use-cases.selected,.search-view .search-results ul div.search-result-group-line.search-result-search-suggest-line.search-result-search-suggest-line-popular-use-cases.arrow-selected,.search-view .search-results ul div.search-result-group-line.search-result-search-suggest-line.search-result-search-suggest-line-popular-use-cases.selected,.search-view .search-results ul li.search-result-result-line.search-result-search-suggest-line-popular-use-cases.arrow-selected,.search-view .search-results ul li.search-result-result-line.search-result-search-suggest-line-popular-use-cases.selected,.search-view .search-results ul li.search-result-search-suggest-line.search-result-search-suggest-line-popular-use-cases.arrow-selected,.search-view .search-results ul li.search-result-search-suggest-line.search-result-search-suggest-line-popular-use-cases.selected{background-color:#f4f5f5;color:#1473e6}.search-view .search-results ul div.search-result-group-line.search-result-create-one-line,.search-view .search-results ul div.search-result-group-line.search-result-group-line,.search-view .search-results ul li.search-result-create-one-line,.search-view .search-results ul li.search-result-group-line{font-size:14px;font-weight:500;color:#808990;padding-left:24px}.search-view .search-results ul div.search-result-group-line.search-result-create-one-line:not(.search-result-group-line),.search-view .search-results ul div.search-result-group-line.search-result-group-line:not(.search-result-group-line),.search-view .search-results ul li.search-result-create-one-line:not(.search-result-group-line),.search-view .search-results ul li.search-result-group-line:not(.search-result-group-line){display:none}.search-view .search-results ul div.search-result-group-line.search-result-create-one-line.search-result-group-line-rule,.search-view .search-results ul div.search-result-group-line.search-result-group-line.search-result-group-line-rule,.search-view .search-results ul li.search-result-create-one-line.search-result-group-line-rule,.search-view .search-results ul li.search-result-group-line.search-result-group-line-rule{padding:0;margin:8px 24px;width:calc(100% - 48px);opacity:.25;border-bottom:1px solid #808990}.search-view .search-results ul div.search-result-group-line.search-result-create-one-line.show-all .search-result-group-line-tag.if-showing-all,.search-view .search-results ul div.search-result-group-line.search-result-create-one-line.show-all .search-results-tag-button.if-showing-all,.search-view .search-results ul div.search-result-group-line.search-result-group-line.show-all .search-result-group-line-tag.if-showing-all,.search-view .search-results ul div.search-result-group-line.search-result-group-line.show-all .search-results-tag-button.if-showing-all,.search-view .search-results ul li.search-result-create-one-line.show-all .search-result-group-line-tag.if-showing-all,.search-view .search-results ul li.search-result-create-one-line.show-all .search-results-tag-button.if-showing-all,.search-view .search-results ul li.search-result-group-line.show-all .search-result-group-line-tag.if-showing-all,.search-view .search-results ul li.search-result-group-line.show-all .search-results-tag-button.if-showing-all{display:block}.search-view .search-results ul div.search-result-group-line.search-result-no-results-line,.search-view .search-results ul li.search-result-no-results-line{line-height:25px}.search-view .search-results ul div.search-result-group-line.search-result-no-results-line .search-term-link,.search-view .search-results ul li.search-result-no-results-line .search-term-link{font-weight:500;cursor:pointer;opacity:.85}.search-view .search-results ul div.search-result-group-line.search-result-no-results-line .search-term-link:hover,.search-view .search-results ul li.search-result-no-results-line .search-term-link:hover{opacity:1}.search-view .search-results ul div.search-result-group-line.search-add-text-tag,.search-view .search-results ul li.search-add-text-tag{height:28px;padding:4px 8px 6px;border:none;margin:0 16px}.search-view .search-results ul div.search-result-group-line.search-add-text-tag.arrow-selected,.search-view .search-results ul div.search-result-group-line.search-add-text-tag:hover,.search-view .search-results ul li.search-add-text-tag.arrow-selected,.search-view .search-results ul li.search-add-text-tag:hover{background-color:#e8ebed}.search-view .search-results ul div.search-result-group-line.search-add-text-tag.show-more-tags-btn,.search-view .search-results ul li.search-add-text-tag.show-more-tags-btn{text-align:center;color:#808990}.search-view .search-results ul div.search-result-group-line span,.search-view .search-results ul li span{font-size:inherit;font-weight:inherit}.search-view .search-results ul div.search-result-group-line span:not(.search-result-result-line-span-count),.search-view .search-results ul li span:not(.search-result-result-line-span-count){color:inherit}.search-view .search-results ul div.search-result-group-line span.search-result-result-line-span-hint,.search-view .search-results ul li span.search-result-result-line-span-hint{font-weight:700}.search-view .search-results ul.show-group-lines div.search-result-group-line.search-result-search-suggest-line:not(.no-indent),.search-view .search-results ul.show-group-lines li.search-result-search-suggest-line:not(.no-indent){padding-left:14px}.search-view .search-results ul.show-group-lines div.search-result-group-line.search-result-group-line-tags-label,.search-view .search-results ul.show-group-lines li.search-result-group-line-tags-label{color:#808990;font-weight:500;padding-left:22px}.search-view .search-results ul.show-group-lines div.search-result-group-line.search-result-create-one-line,.search-view .search-results ul.show-group-lines div.search-result-group-line.search-result-group-line,.search-view .search-results ul.show-group-lines li.search-result-create-one-line,.search-view .search-results ul.show-group-lines li.search-result-group-line{display:block}.search-view .search-results ul.show-group-lines div.search-result-group-line.search-result-create-one-line .tags-label-and-clear,.search-view .search-results ul.show-group-lines div.search-result-group-line.search-result-group-line .tags-label-and-clear,.search-view .search-results ul.show-group-lines li.search-result-create-one-line .tags-label-and-clear,.search-view .search-results ul.show-group-lines li.search-result-group-line .tags-label-and-clear{display:-webkit-flex;display:flex;-webkit-justify-content:space-between;justify-content:space-between;font-weight:inherit}.search-view .search-results ul.show-group-lines div.search-result-group-line.search-result-create-one-line .search-box-filters-clear-all,.search-view .search-results ul.show-group-lines div.search-result-group-line.search-result-group-line .search-box-filters-clear-all,.search-view .search-results ul.show-group-lines li.search-result-create-one-line .search-box-filters-clear-all,.search-view .search-results ul.show-group-lines li.search-result-group-line .search-box-filters-clear-all{right:16px;color:#808990;font-weight:500;font-size:14px;opacity:.5;background-color:transparent}.search-view .search-results ul.show-group-lines div.search-result-group-line.search-result-create-one-line .search-box-filters-clear-all.enabled,.search-view .search-results ul.show-group-lines div.search-result-group-line.search-result-group-line .search-box-filters-clear-all.enabled,.search-view .search-results ul.show-group-lines li.search-result-create-one-line .search-box-filters-clear-all.enabled,.search-view .search-results ul.show-group-lines li.search-result-group-line .search-box-filters-clear-all.enabled{cursor:pointer;opacity:1}.search-view .search-results ul.show-group-lines div.search-result-group-line.search-result-create-one-line .search-box-filters-clear-all.enabled:hover,.search-view .search-results ul.show-group-lines div.search-result-group-line.search-result-group-line .search-box-filters-clear-all.enabled:hover,.search-view .search-results ul.show-group-lines li.search-result-create-one-line .search-box-filters-clear-all.enabled:hover,.search-view .search-results ul.show-group-lines li.search-result-group-line .search-box-filters-clear-all.enabled:hover{color:#3e3f41}.search-view .search-results ul.show-group-lines div.search-result-group-line.search-result-create-one-line:first-letter,.search-view .search-results ul.show-group-lines div.search-result-group-line.search-result-group-line:first-letter,.search-view .search-results ul.show-group-lines li.search-result-create-one-line:first-letter,.search-view .search-results ul.show-group-lines li.search-result-group-line:first-letter{text-transform:uppercase}.search-view .search-results ul.show-group-lines div.search-result-group-line.search-result-create-one-line.search-result-group-line-tags .search-result-group-line-tags-tags,.search-view .search-results ul.show-group-lines div.search-result-group-line.search-result-group-line.search-result-group-line-tags .search-result-group-line-tags-tags,.search-view .search-results ul.show-group-lines li.search-result-create-one-line.search-result-group-line-tags .search-result-group-line-tags-tags,.search-view .search-results ul.show-group-lines li.search-result-group-line.search-result-group-line-tags .search-result-group-line-tags-tags{margin-top:5px;display:-webkit-flex;display:flex;-webkit-flex-direction:row;flex-direction:row;-webkit-flex-wrap:wrap;flex-wrap:wrap}.search-view .search-results ul.show-group-lines div.search-result-group-line.search-result-create-one-line.show-more-tags-tags .search-result-group-line-tags-tags .search-result-group-line-tag.if-showing-all,.search-view .search-results ul.show-group-lines div.search-result-group-line.search-result-create-one-line.show-more-tags-tags .search-result-group-line-tags-tags .search-result-group-line-tag.is-more-tags-tag,.search-view .search-results ul.show-group-lines div.search-result-group-line.search-result-group-line.show-more-tags-tags .search-result-group-line-tags-tags .search-result-group-line-tag.if-showing-all,.search-view .search-results ul.show-group-lines div.search-result-group-line.search-result-group-line.show-more-tags-tags .search-result-group-line-tags-tags .search-result-group-line-tag.is-more-tags-tag,.search-view .search-results ul.show-group-lines li.search-result-create-one-line.show-more-tags-tags .search-result-group-line-tags-tags .search-result-group-line-tag.if-showing-all,.search-view .search-results ul.show-group-lines li.search-result-create-one-line.show-more-tags-tags .search-result-group-line-tags-tags .search-result-group-line-tag.is-more-tags-tag,.search-view .search-results ul.show-group-lines li.search-result-group-line.show-more-tags-tags .search-result-group-line-tags-tags .search-result-group-line-tag.if-showing-all,.search-view .search-results ul.show-group-lines li.search-result-group-line.show-more-tags-tags .search-result-group-line-tags-tags .search-result-group-line-tag.is-more-tags-tag{display:block}.search-view .search-results ul.show-group-lines div.search-result-group-line.search-result-create-one-line.show-more-tags-tags .search-result-group-line-tags-tags .search-result-group-line-tag.show-more-tags-btn,.search-view .search-results ul.show-group-lines div.search-result-group-line.search-result-group-line.show-more-tags-tags .search-result-group-line-tags-tags .search-result-group-line-tag.show-more-tags-btn,.search-view .search-results ul.show-group-lines li.search-result-create-one-line.show-more-tags-tags .search-result-group-line-tags-tags .search-result-group-line-tag.show-more-tags-btn,.search-view .search-results ul.show-group-lines li.search-result-group-line.show-more-tags-tags .search-result-group-line-tags-tags .search-result-group-line-tag.show-more-tags-btn{display:none}.search-view .search-results ul.show-group-lines div.search-result-group-line.search-result-create-one-line .search-result-group-line-tags-tags.at-max-tags .search-result-group-line-tag:not(.selected):not(.ignore-at-max-tags):not(.show-more-tags-btn),.search-view .search-results ul.show-group-lines div.search-result-group-line.search-result-group-line .search-result-group-line-tags-tags.at-max-tags .search-result-group-line-tag:not(.selected):not(.ignore-at-max-tags):not(.show-more-tags-btn),.search-view .search-results ul.show-group-lines li.search-result-create-one-line .search-result-group-line-tags-tags.at-max-tags .search-result-group-line-tag:not(.selected):not(.ignore-at-max-tags):not(.show-more-tags-btn),.search-view .search-results ul.show-group-lines li.search-result-group-line .search-result-group-line-tags-tags.at-max-tags .search-result-group-line-tag:not(.selected):not(.ignore-at-max-tags):not(.show-more-tags-btn){background-color:#f4f5f5;opacity:.5}.search-view .search-results ul.show-group-lines div.search-result-group-line .search-result-line-span-tag,.search-view .search-results ul.show-group-lines li .search-result-line-span-tag{display:inline-block}.search-view .search-results ul.show-group-lines div.search-result-group-line .debug-tagging.search-result-colored-tag-explore,.search-view .search-results ul.show-group-lines li .debug-tagging.search-result-colored-tag-explore{color:red}.search-view .search-results ul.show-group-lines div.search-result-group-line .debug-tagging.search-result-colored-tag-spcase,.search-view .search-results ul.show-group-lines li .debug-tagging.search-result-colored-tag-spcase{color:blue}.search-view .search-results ul.show-group-lines div.search-result-group-line .debug-tagging.search-result-colored-tag-spterm,.search-view .search-results ul.show-group-lines li .debug-tagging.search-result-colored-tag-spterm{color:orange}.search-view .search-results ul.show-group-lines div.search-result-group-line .debug-tagging.search-result-colored-tag-color,.search-view .search-results ul.show-group-lines li .debug-tagging.search-result-colored-tag-color{color:#000}.search-view .search-results ul.show-group-lines div.search-result-group-line .debug-tagging.search-result-colored-tag-multi,.search-view .search-results ul.show-group-lines li .debug-tagging.search-result-colored-tag-multi{color:green}.search-view .search-results ul.show-group-lines div.search-result-group-line .debug-tagging.search-result-colored-tag-spstyle,.search-view .search-results ul.show-group-lines li .debug-tagging.search-result-colored-tag-spstyle{color:#fe0}.search-view .search-overlay.overlay-showing{-webkit-animation-name:fadeTo;animation-name:fadeTo;-webkit-animation-duration:.3s;animation-duration:.3s;-webkit-animation-timing-function:ease-out;animation-timing-function:ease-out}.search-view .search-overlay.overlay-opaque{opacity:1;-webkit-animation-name:none;animation-name:none;background-color:#f4f5f5}.search-view.searching .search-results{-webkit-animation-name:appear;animation-name:appear;-webkit-animation-duration:.2s;animation-duration:.2s;-webkit-animation-timing-function:cubic-bezier(.22,.61,.36,1);animation-timing-function:cubic-bezier(.22,.61,.36,1);z-index:1}.search-view .search-bar.show-search-button .search-input,.search-view .search-bar.show-search-button .search-input-disabled{border-radius:4px 0 0 4px}.search-view .search-bar.show-search-button .search-results{-webkit-transform:translateX(-43px);transform:translateX(-43px)}.search-view.search-view-parent-height-control{height:auto;min-height:0}.search-view.search-view-parent-height-control .search-top-container{min-height:0;padding-top:0}.search-view.search-view-bar-only{min-height:66px;height:66px;padding:16px}.search-view.search-view-bar-only .search-top-container{min-height:66px}.search-view.search-view-bar-only .search-bar{width:100%;padding-top:0}.search-view.search-view-bar-only .search-welcome-text{display:none}.search-view.in-main-search-header{position:relative}.search-view.in-vb-search-header{padding-top:0;padding-bottom:120px;width:auto}.search-view.in-vb-search-header .search-top-container{padding-top:0}.search-view.in-vb-search-header.search-view-bar-only{padding-top:56px;padding-bottom:100px}.search-view.in-vb-search-header.search-view-fixed{position:fixed;top:0;left:50vw;max-width:calc(100vw - 466px);-webkit-transform:translateX(-50%);transform:translateX(-50%);padding:13px 0 0;z-index:2;width:500px}@media (max-width:840px){.search-view.in-vb-search-header.search-view-fixed{top:56px;max-width:90vw}}.search-view.in-vb-search-header.search-view-fixed .search-overlay{width:200vw;height:200vh;top:-100px;left:50%;-webkit-transform:translateX(-50%);transform:translateX(-50%)}.search-view.in-vb-search-header.search-view-fixed.search-view-in-header .search-overlay{background-color:#0b0f1d}.search-view.in-vb-search-header.search-view-fixed.search-view-in-header .search-overlay.overlay-opaque{background-color:#f4f5f5}.search-view.in-vb-search-header.search-view-fixed.search-view-in-header .search-input,.search-view.in-vb-search-header.search-view-fixed.search-view-in-header .search-input-disabled{box-shadow:none;border:1px solid #dce0e3}.search-view.in-vb-search-header.search-view-fixed.search-view-in-header .search-input-disabled:focus,.search-view.in-vb-search-header.search-view-fixed.search-view-in-header .search-input:focus{background-color:#fff}.search-view.in-vb-search-header.search-view-fixed.search-view-in-header:not(.searching) .search-input,.search-view.in-vb-search-header.search-view-fixed.search-view-in-header:not(.searching) .search-input-disabled{border:1px solid #dce0e3;background-color:#fff}.search-view.in-vb-search-header.search-view-fixed.search-view-in-header:not(.searching) .search-button,.search-view.in-vb-search-header.search-view-fixed.search-view-in-header:not(.searching) .search-clear{background-color:#fff}body.showing-search-header-results-grid .mrvl-main-page{display:none}body.showing-search-header-results-grid .mrvl-header .mrvl-logo{z-index:105}body.showing-search-header-results-grid .mrvl-header .mrvl-logo-link:focus .mrvl-logo{outline:1px dotted #212121;outline:5px auto -webkit-focus-ring-color}body.showing-search-header-results-grid .mrvl-header .site-nav-upgrade{display:none}.search-in-main-header,.vb-search-header{height:66px}.search-in-main-header.vb-search-header,.vb-search-header.vb-search-header{position:fixed;top:0;left:0;width:100%;z-index:2000}.search-in-main-header .vb-search-header-background,.vb-search-header .vb-search-header-background{position:absolute;height:100%;width:100%;top:0;left:0;background-color:#fff;opacity:1;z-index:-1}.search-in-main-header .search-view .search-top-container,.vb-search-header .search-view .search-top-container{min-height:40px;height:40px}.search-in-main-header .search-view .search-top-container .search-bar .search-results,.vb-search-header .search-view .search-top-container .search-bar .search-results{width:100%;max-height:calc(100vh - 100px);margin-top:0}.search-in-main-header .search-view .search-top-container .search-bar .search-results .search-results-ul-scroller,.vb-search-header .search-view .search-top-container .search-bar .search-results .search-results-ul-scroller{max-height:calc(100vh - 100px - 24px)}.search-in-main-header .search-view .search-top-container .search-bar .search-input,.search-in-main-header .search-view .search-top-container .search-bar .search-input-disabled,.vb-search-header .search-view .search-top-container .search-bar .search-input,.vb-search-header .search-view .search-top-container .search-bar .search-input-disabled{height:40px;width:100%;opacity:1;background-position:left 12px center;background-size:18px;border-radius:20px;transition:border-color .2s ease-in-out}.search-in-main-header .search-view .search-top-container .search-bar .search-input-disabled:active,.search-in-main-header .search-view .search-top-container .search-bar .search-input-disabled:focus,.search-in-main-header .search-view .search-top-container .search-bar .search-input:active,.search-in-main-header .search-view .search-top-container .search-bar .search-input:focus,.vb-search-header .search-view .search-top-container .search-bar .search-input-disabled:active,.vb-search-header .search-view .search-top-container .search-bar .search-input-disabled:focus,.vb-search-header .search-view .search-top-container .search-bar .search-input:active,.vb-search-header .search-view .search-top-container .search-bar .search-input:focus{border:1px solid #1473e6;outline:none}.search-in-main-header .search-view .search-top-container .search-bar .search-button,.search-in-main-header .search-view .search-top-container .search-bar .search-clear,.vb-search-header .search-view .search-top-container .search-bar .search-button,.vb-search-header .search-view .search-top-container .search-bar .search-clear{height:32px}.search-in-main-header .search-header-logo-and-back,.vb-search-header .search-header-logo-and-back{height:66px}.search-in-main-header .search-header-logo-and-back .mrvl-logo-link:focus .mrvl-logo,.vb-search-header .search-header-logo-and-back .mrvl-logo-link:focus .mrvl-logo{outline:1px dotted #212121;outline:5px auto -webkit-focus-ring-color}.search-in-main-header .search-header-logo-and-back .npw-visual-browse-header-back-arrow,.vb-search-header .search-header-logo-and-back .npw-visual-browse-header-back-arrow{display:none}.search-in-main-header .search-header-logo-and-back .npw-visual-browse-header-back-arrow.has-text,.vb-search-header .search-header-logo-and-back .npw-visual-browse-header-back-arrow.has-text{display:block;cursor:pointer;height:100%;background-color:transparent;margin-left:90px;line-height:66px;text-transform:uppercase;width:auto;font-weight:700;font-size:12px;color:#808990;transition:color .2s ease-in-out}.search-in-main-header .search-header-logo-and-back .npw-visual-browse-header-back-arrow.has-text:hover,.vb-search-header .search-header-logo-and-back .npw-visual-browse-header-back-arrow.has-text:hover{color:#3e3f41}.search-in-main-header .npw-visual-browser-header-favorites,.vb-search-header .npw-visual-browser-header-favorites{text-transform:uppercase;cursor:pointer;color:#3e3f41;font-size:14px;font-weight:700;height:32px;line-height:30px;border:1px solid #fff;border-radius:20px;padding:0 8px 0 26px;background-position:4px;background-repeat:no-repeat;background-image:url(/images/npw/visualBrowse/icon-heart-empty-with-background.svg);opacity:1;transition:opacity .1s ease-in-out,background-color .1s ease-in-out;position:absolute;right:280px;top:18px}.search-in-main-header .npw-visual-browse-header-create-new-dropdown,.search-in-main-header .npw-visual-browse-header-create-new-dropdown-v-spacer,.vb-search-header .npw-visual-browse-header-create-new-dropdown,.vb-search-header .npw-visual-browse-header-create-new-dropdown-v-spacer{position:absolute;min-width:160px;height:40px;line-height:23px;top:13px;right:36px}.search-in-main-header .npw-visual-browse-header-create-new-dropdown-v-spacer.npw-visual-browse-header-create-new-dropdown-v-spacer,.search-in-main-header .npw-visual-browse-header-create-new-dropdown.npw-visual-browse-header-create-new-dropdown-v-spacer,.vb-search-header .npw-visual-browse-header-create-new-dropdown-v-spacer.npw-visual-browse-header-create-new-dropdown-v-spacer,.vb-search-header .npw-visual-browse-header-create-new-dropdown.npw-visual-browse-header-create-new-dropdown-v-spacer{height:0;top:55px}.search-in-main-header .npw-visual-browse-header-create-new-dropdown-v-spacer.npw-visual-browse-header-create-new-dropdown,.search-in-main-header .npw-visual-browse-header-create-new-dropdown.npw-visual-browse-header-create-new-dropdown,.vb-search-header .npw-visual-browse-header-create-new-dropdown-v-spacer.npw-visual-browse-header-create-new-dropdown,.vb-search-header .npw-visual-browse-header-create-new-dropdown.npw-visual-browse-header-create-new-dropdown{opacity:1}.search-in-main-header .npw-visual-browse-header-create-new-dropdown-v-spacer.npw-visual-browse-header-create-new-dropdown .react-spectrum-provider,.search-in-main-header .npw-visual-browse-header-create-new-dropdown.npw-visual-browse-header-create-new-dropdown .react-spectrum-provider,.vb-search-header .npw-visual-browse-header-create-new-dropdown-v-spacer.npw-visual-browse-header-create-new-dropdown .react-spectrum-provider,.vb-search-header .npw-visual-browse-header-create-new-dropdown.npw-visual-browse-header-create-new-dropdown .react-spectrum-provider{background-color:transparent}.search-in-main-header .npw-visual-browse-header-create-new-dropdown-v-spacer.npw-visual-browse-header-create-new-dropdown .react-spectrum-provider .spectrum-Underlay,.search-in-main-header .npw-visual-browse-header-create-new-dropdown.npw-visual-browse-header-create-new-dropdown .react-spectrum-provider .spectrum-Underlay,.vb-search-header .npw-visual-browse-header-create-new-dropdown-v-spacer.npw-visual-browse-header-create-new-dropdown .react-spectrum-provider .spectrum-Underlay,.vb-search-header .npw-visual-browse-header-create-new-dropdown.npw-visual-browse-header-create-new-dropdown .react-spectrum-provider .spectrum-Underlay{height:100vh}.search-in-main-header .npw-visual-browse-header-create-new-dropdown-v-spacer.npw-visual-browse-header-create-new-dropdown .react-spectrum-provider .spectrum-Popover,.search-in-main-header .npw-visual-browse-header-create-new-dropdown.npw-visual-browse-header-create-new-dropdown .react-spectrum-provider .spectrum-Popover,.vb-search-header .npw-visual-browse-header-create-new-dropdown-v-spacer.npw-visual-browse-header-create-new-dropdown .react-spectrum-provider .spectrum-Popover,.vb-search-header .npw-visual-browse-header-create-new-dropdown.npw-visual-browse-header-create-new-dropdown .react-spectrum-provider .spectrum-Popover{-webkit-transform:translate(-40px,6px);transform:translate(-40px,6px)}.search-in-main-header.white,.vb-search-header.white{background-color:#fff}.search-in-main-header.short-header .in-vb-search-header,.search-in-main-header.short-header .npw-visual-browse-header-back-arrow,.search-in-main-header.short-header .npw-visual-browse-header-create-new-dropdown,.search-in-main-header.short-header .search-header-logo-and-back,.search-in-main-header.short-header .search-input,.vb-search-header.short-header .in-vb-search-header,.vb-search-header.short-header .npw-visual-browse-header-back-arrow,.vb-search-header.short-header .npw-visual-browse-header-create-new-dropdown,.vb-search-header.short-header .search-header-logo-and-back,.vb-search-header.short-header .search-input{display:none}.search-in-main-header.short-header .grid-detail-header-back-arrow,.vb-search-header.short-header .grid-detail-header-back-arrow{display:block}.search-in-main-header.short-header .vb-search-header-short-v-filler,.vb-search-header.short-header .vb-search-header-short-v-filler{height:66px}.search-in-main-header.search-in-main-header,.vb-search-header.search-in-main-header{position:absolute;height:66px;top:0;z-index:104}.search-in-main-header.search-in-main-header .vb-search-header-background,.vb-search-header.search-in-main-header .vb-search-header-background{background-color:transparent}.search-in-main-header.search-in-main-header:not(.showing-results-grid),.vb-search-header.search-in-main-header:not(.showing-results-grid){width:500px;-webkit-transform:translateX(-50%);transform:translateX(-50%);left:calc(50% + 8px);max-width:calc(100% - 320px);min-width:400px}.search-in-main-header.search-in-main-header:not(.showing-results-grid) .npw-visual-browse-header-back-arrow,.search-in-main-header.search-in-main-header:not(.showing-results-grid) .npw-visual-browse-header-create-new-dropdown,.search-in-main-header.search-in-main-header:not(.showing-results-grid) .search-header-logo-and-back,.vb-search-header.search-in-main-header:not(.showing-results-grid) .npw-visual-browse-header-back-arrow,.vb-search-header.search-in-main-header:not(.showing-results-grid) .npw-visual-browse-header-create-new-dropdown,.vb-search-header.search-in-main-header:not(.showing-results-grid) .search-header-logo-and-back{display:none}.search-in-main-header.search-in-main-header:not(.showing-results-grid) .search-results,.vb-search-header.search-in-main-header:not(.showing-results-grid) .search-results{top:52px;margin-top:52px}.search-in-main-header.search-in-main-header.showing-results-grid,.vb-search-header.search-in-main-header.showing-results-grid{background-color:#fff;width:100vw}.search-in-main-header.search-in-main-header.showing-results-grid .search-view,.vb-search-header.search-in-main-header.showing-results-grid .search-view{top:-66px;width:500px;left:50%;-webkit-transform:translateX(-50%);transform:translateX(-50%);max-width:calc(100vw - 466px)}@media (max-width:840px){.search-in-main-header.search-in-main-header.showing-results-grid,.vb-search-header.search-in-main-header.showing-results-grid{height:114px}.search-in-main-header.search-in-main-header.showing-results-grid .npw-visual-browse-header-back-arrow,.vb-search-header.search-in-main-header.showing-results-grid .npw-visual-browse-header-back-arrow{height:66px}.search-in-main-header.search-in-main-header.showing-results-grid .search-view,.vb-search-header.search-in-main-header.showing-results-grid .search-view{top:-16px;max-width:90vw}.search-in-main-header.search-in-main-header.showing-results-grid .search-view .search-overlay,.vb-search-header.search-in-main-header.showing-results-grid .search-view .search-overlay{top:-50px}}.search-in-main-header.search-in-main-header .search-overlay,.vb-search-header.search-in-main-header .search-overlay{width:calc(100vw + 40px);height:100vh;left:50%;position:absolute;-webkit-transform:translateX(-50%);transform:translateX(-50%)}.search-in-main-header.search-in-main-header .search-results,.vb-search-header.search-in-main-header .search-results{top:56px}.search-in-main-header.search-in-main-header .search-view,.vb-search-header.search-in-main-header .search-view{padding:13px}.search-in-main-header.search-in-main-header .search-view .search-input,.search-in-main-header.search-in-main-header .search-view .search-input-disabled,.vb-search-header.search-in-main-header .search-view .search-input,.vb-search-header.search-in-main-header .search-view .search-input-disabled{width:100%;box-shadow:none;border:1px solid #dce0e3;transition:border-color .2s ease-in-out}.search-in-main-header.search-in-main-header .search-view .search-input-disabled:active,.search-in-main-header.search-in-main-header .search-view .search-input-disabled:focus,.search-in-main-header.search-in-main-header .search-view .search-input:active,.search-in-main-header.search-in-main-header .search-view .search-input:focus,.vb-search-header.search-in-main-header .search-view .search-input-disabled:active,.vb-search-header.search-in-main-header .search-view .search-input-disabled:focus,.vb-search-header.search-in-main-header .search-view .search-input:active,.vb-search-header.search-in-main-header .search-view .search-input:focus{outline:none;border:1px solid #1473e6}.search-in-main-header.search-in-main-header .search-view .search-input-disabled.search-input-disabled,.search-in-main-header.search-in-main-header .search-view .search-input.search-input-disabled,.vb-search-header.search-in-main-header .search-view .search-input-disabled.search-input-disabled,.vb-search-header.search-in-main-header .search-view .search-input.search-input-disabled{text-align:left;line-height:38px}@media (min-width:768px){.mrvl-header.unentitled .search-in-main-header:not(.showing-results-grid){max-width:calc(100% - 638px)}}.vb-search-header-filters-background{width:100%;background-color:#fff;padding:8px 0 0}.vb-search-header-filters-background,.vb-search-header-filters-background .vb-search-header-formats{position:relative;display:-webkit-flex;display:flex;-webkit-justify-content:center;justify-content:center}.vb-search-header-filters-background .vb-search-header-formats{max-width:90vw;-webkit-flex-wrap:wrap;flex-wrap:wrap}.vb-search-header-filters-background .vb-search-header-formats .vb-search-header-formats-format,.vb-search-header-filters-background .vb-search-header-formats .vb-search-header-formats-format-sep{font-size:12px;font-weight:700;color:#808990;margin:0;padding:12px;text-transform:uppercase;cursor:pointer;border-bottom:3px solid transparent}.vb-search-header-filters-background .vb-search-header-formats .vb-search-header-formats-format-sep.selected,.vb-search-header-filters-background .vb-search-header-formats .vb-search-header-formats-format.selected{color:#1473e6;border-bottom-color:#1473e6}.vb-search-header-filters-background .vb-search-header-formats .vb-search-header-formats-format-sep:hover,.vb-search-header-filters-background .vb-search-header-formats .vb-search-header-formats-format:hover{color:#1473e6}.vb-search-header-filters-background .vb-search-header-formats .vb-search-header-formats-format-sep:first-child,.vb-search-header-filters-background .vb-search-header-formats .vb-search-header-formats-format:first-child{margin-left:0}@media (max-width:840px){.vb-search-header-filters-background{height:84px}.vb-search-header-filters-background .vb-search-header-formats{top:36px;height:40px}}.vb-search-header-filters-background .vb-search-header-formats{margin-top:0}.vb-search-header-filters-background.hide-formats{height:47px}.vb-search-header-filters-background.hide-formats .vb-search-header-formats{display:none}@-webkit-keyframes auto-load-spinner-rotate{0%{-webkit-transform:rotate(0deg);transform:rotate(0deg)}to{-webkit-transform:rotate(1turn);transform:rotate(1turn)}}@keyframes auto-load-spinner-rotate{0%{-webkit-transform:rotate(0deg);transform:rotate(0deg)}to{-webkit-transform:rotate(1turn);transform:rotate(1turn)}}.search-view-common .load-more-toggle{display:block;clear:both;padding:0 18px;height:40px;margin:40px auto;cursor:pointer;text-align:center;font-size:1.3em;font-weight:600;text-decoration:none;line-height:36px;color:#3e3f41;background:transparent;border-radius:40px;border:2px solid #3e3f41;opacity:1;transition:opacity .3s ease-out}.search-view-common .load-more-toggle:not(.spinner):hover{background:#3e3f41;color:#fff}.search-view-common .load-more-toggle:not(.spinner).melting{opacity:0;transition:opacity .3s ease-out}.search-view-common .load-more-toggle:not(.spinner).disabled{cursor:default;border:2px solid #dce0e3;color:#dce0e3;background-color:transparent}.search-view-common .load-more-toggle.spinner{color:transparent;border-color:transparent;background-color:transparent;cursor:default;width:40px;height:40px;outline:none}.search-view-common .load-more-toggle.spinner.spinner-loading{background-repeat:no-repeat;background-position:50%;background-size:40px;background-image:url(/marvel-core/images/common/light-spinner.svg);transition:opacity;transition-duration:.75s;-webkit-animation-name:auto-load-spinner-rotate;animation-name:auto-load-spinner-rotate;-webkit-animation-duration:.75s;animation-duration:.75s;-webkit-animation-iteration-count:infinite;animation-iteration-count:infinite;-webkit-animation-timing-function:linear;animation-timing-function:linear}.search-view-common .load-more-toggle.spinner.no-more{cursor:default}.search-results-grid-item-detail-confirm-overlay{width:100vw;height:100vh;position:absolute;top:0;left:0;background-color:rgba(0,0,0,.45);z-index:2002}.search-results-grid-item-detail-confirm-overlay .search-results-grid-item-detail-confirm-button{cursor:pointer;z-index:2}.search-results-grid-item-detail-confirm-overlay .search-results-grid-item-detail-premium-blurbs{height:30%}.search-results-grid-item-detail-confirm-overlay .search-results-grid-item-detail-premium-blurbs .search-results-grid-item-detail-premium-blurb{display:block;color:#808990;font-size:14px;font-weight:400;height:18px;padding-left:32px;background-position:0;background-repeat:no-repeat;background-size:contain}.search-results-grid-item-detail-confirm-overlay .search-results-grid-item-detail-premium-blurbs .search-results-grid-item-detail-premium-blurb.search-results-grid-item-detail-premium-template{height:20px;line-height:20px;padding-left:22px;background-image:url(/images/icon-premium-gold-no-border.svg)}.search-results-grid-item-detail-confirm-overlay .search-results-grid-item-detail-premium-blurbs .search-results-grid-item-detail-premium-blurb.search-results-grid-item-detail-premium-template.show-premium-user-badge-shield-dark{background-image:url(/images/icon-premium-user-premium-badge-shield-dark.svg)}.search-results-grid-item-detail-confirm-overlay .search-results-grid-item-detail-premium-blurbs .search-results-grid-item-detail-premium-blurb.search-results-grid-item-detail-premium-template.show-premium-user-badge-shield-light{background-image:url(/images/icon-premium-user-premium-badge-shield-light.svg)}.search-results-grid-item-detail-confirm-overlay .search-results-grid-item-detail-premium-blurbs .search-results-grid-item-detail-premium-blurb.search-results-grid-item-detail-premium-blurb-fonts{background-image:url(/images/npw/visualBrowse/premium-blurb-fonts.svg)}.search-results-grid-item-detail-confirm-overlay .search-results-grid-item-detail-premium-blurbs .search-results-grid-item-detail-premium-blurb.search-results-grid-item-detail-premium-blurb-animation{background-image:url(/images/thumb-icon-post-animated.svg)}.search-results-grid-item-detail-confirm-overlay .search-results-grid-item-detail-confirm-right{width:40%;min-width:350px;display:-webkit-flex;display:flex;-webkit-flex-direction:column;flex-direction:column;height:340px;-webkit-justify-content:space-around;justify-content:space-around;padding:0 40px}.search-results-grid-item-detail-confirm-overlay .search-results-grid-item-detail-confirm-right .search-results-grid-item-detail-message-and-ctas{display:-webkit-flex;display:flex;-webkit-flex-direction:column;flex-direction:column;height:330px;-webkit-justify-content:space-around;justify-content:space-around}.search-results-grid-item-detail-confirm-overlay .search-results-grid-item-detail-confirm-right .search-results-grid-item-detail-confirm-title{font-size:26px;font-weight:900}.search-results-grid-item-detail-confirm-overlay .search-results-grid-item-detail-confirm-right .search-results-grid-item-detail-confirm-subtitle{font-size:16px;font-weight:400;line-height:23px}.search-results-grid-item-detail-confirm-overlay .search-results-grid-item-detail-confirm-right .search-results-grid-item-detail-confirm-ctas{display:-webkit-flex;display:flex;-webkit-flex-direction:row;flex-direction:row;width:100%;max-width:300px;-webkit-justify-content:flex-start;justify-content:flex-start}.search-results-grid-item-detail-confirm-overlay .search-results-grid-item-detail-confirm-right .search-results-grid-item-detail-confirm-ctas .search-results-grid-item-detail-confirm-cta{display:block;cursor:pointer;height:34px;font-weight:700;font-size:16px;z-index:1;padding:16px;line-height:1px;color:#fff;background-color:#1473e6;border-radius:20px;transition:width .3s,background-color .3s,top .2s,opacity .3s ease-in-out .2s;opacity:1}.search-results-grid-item-detail-confirm-overlay .search-results-grid-item-detail-confirm-right .search-results-grid-item-detail-confirm-ctas .search-results-grid-item-detail-confirm-cta:hover{background-color:#1269d0}.search-results-grid-item-detail-confirm-overlay .search-results-grid-item-detail-confirm-right .search-results-grid-item-detail-confirm-ctas .search-results-grid-item-detail-confirm-cta:active{background-color:#1056a7}.search-results-grid-item-detail-confirm-overlay .search-results-grid-item-detail{padding:0;height:60vh;width:75vw;max-width:1024px;max-height:800px;min-height:450px;min-width:800px;position:absolute;left:50%;top:50%;-webkit-transform:translate(-50%,-50%);transform:translate(-50%,-50%);background-color:#fff;display:-webkit-flex;display:flex;-webkit-justify-content:space-between;justify-content:space-between;-webkit-align-items:center;align-items:center;border-radius:10px}.search-results-grid-item-detail-confirm-overlay .search-results-grid-item-detail .search-results-detail-confirm-premium-and-num-remixes{display:-webkit-flex;display:flex;margin-top:26px;background-color:#f4f5f5;padding:0;-webkit-flex-direction:row;flex-direction:row;-webkit-justify-content:space-between;justify-content:space-between;color:#808990;font-size:15px;min-width:300px}.search-results-grid-item-detail-confirm-overlay .search-results-grid-item-detail .search-results-detail-confirm-premium-and-num-remixes .search-results-detail-confirm-num-remixes,.search-results-grid-item-detail-confirm-overlay .search-results-grid-item-detail .search-results-detail-confirm-premium-and-num-remixes .search-results-grid-item-detail-premium-blurb{font-size:16px;font-weight:400}.search-results-grid-item-detail-confirm-overlay .search-results-grid-item-detail .search-results-detail-confirm-premium-and-num-remixes .search-results-detail-confirm-num-remixes.search-results-grid-item-detail-premium-blurb,.search-results-grid-item-detail-confirm-overlay .search-results-grid-item-detail .search-results-detail-confirm-premium-and-num-remixes .search-results-grid-item-detail-premium-blurb.search-results-grid-item-detail-premium-blurb{margin-top:-2px}.search-results-grid-item-detail-confirm-overlay .search-results-grid-item-detail .detail-close-button{position:absolute;height:24px;width:24px;top:16px;right:16px;background-color:transparent;background-image:url(/images/search/search-clear-x-midnight.svg);background-size:20px;background-repeat:no-repeat}.search-results-grid-item-detail-confirm-overlay .search-results-grid-item-detail:not(.vertical-default) .search-results-detail-confirm-premium-and-num-remixes{display:none}.search-results-grid-item-detail-confirm-overlay .search-results-grid-item-detail.vertical-default{-webkit-flex-direction:column;flex-direction:column;height:calc(100vh - 100px);width:auto}.search-results-grid-item-detail-confirm-overlay .search-results-grid-item-detail.vertical-default .detail-close-button{height:28px;width:28px;top:4px;right:4px;background-position:50%}.search-results-grid-item-detail-confirm-overlay .search-results-grid-item-detail.vertical-default .search-results-grid-item-detail-premium-blurbs{height:30px;width:auto;display:-webkit-flex;display:flex;-webkit-flex-direction:column;flex-direction:column;-webkit-align-items:center;align-items:center}@media (max-width:800px){.search-results-grid-item-detail-confirm-overlay .search-results-grid-item-detail.vertical-default{width:calc(100vw - 48px);min-width:200px}}.search-results-grid-item-detail-confirm-overlay .search-results-grid-item-detail.vertical-default .search-results-grid-item-detail-image-section{width:100%;height:100%;border-top-left-radius:10px;border-top-right-radius:10px;border-bottom-left-radius:0}.search-results-grid-item-detail-confirm-overlay .search-results-grid-item-detail.vertical-default .search-results-grid-item-detail-confirm-right{height:120px;width:100%;padding:20px 40px}.search-results-grid-item-detail-confirm-overlay .search-results-grid-item-detail.vertical-default .search-results-grid-item-detail-confirm-right .search-results-grid-item-detail-message-and-ctas{height:120px;-webkit-align-items:center;align-items:center}.search-results-grid-item-detail-confirm-overlay .search-results-grid-item-detail.vertical-default .search-results-grid-item-detail-confirm-right .search-results-grid-item-detail-confirm-ctas{-webkit-justify-content:space-between;justify-content:space-between;max-width:100%}.search-results-grid-item-detail-confirm-overlay .search-results-grid-item-detail.vertical-default .search-results-grid-item-detail-confirm-right .search-results-grid-item-detail-confirm-ctas:after,.search-results-grid-item-detail-confirm-overlay .search-results-grid-item-detail.vertical-default .search-results-grid-item-detail-confirm-right .search-results-grid-item-detail-confirm-ctas:before{content:"";display:block}.search-results-grid-item-detail-confirm-overlay .search-results-grid-item-detail:not(.has-ingredient-animation) .show-if-premium-ingredient-animation,.search-results-grid-item-detail-confirm-overlay .search-results-grid-item-detail:not(.has-premium-ingredient-fonts) .show-if-premium-ingredient-fonts,.search-results-grid-item-detail-confirm-overlay .search-results-grid-item-detail:not(.is-premium-template) .hide-if-not-premium{display:none}.search-results-grid-item-detail-confirm-overlay .search-results-grid-item-detail .search-results-grid-item-detail-image-section{width:60%;height:100%;min-height:160px;display:-webkit-flex;display:flex;-webkit-flex-direction:column;flex-direction:column;background-color:#f4f5f5;border-top-left-radius:10px;border-bottom-left-radius:10px}.search-results-grid-item-detail-confirm-overlay .search-results-grid-item-detail .search-results-grid-item-detail-image-section.show-preview-nav-side{-webkit-flex-direction:row;flex-direction:row}.search-results-grid-item-detail-confirm-overlay .search-results-grid-item-detail .search-results-grid-item-detail-image-section .search-results-grid-item-detail-preview-nav{display:-webkit-flex;display:flex;-webkit-justify-content:center;justify-content:center;height:32px;margin-top:16px;width:100%}.search-results-grid-item-detail-confirm-overlay .search-results-grid-item-detail .search-results-grid-item-detail-image-section .search-results-grid-item-detail-image-and-tags-holder{position:relative;width:100%;max-width:100%;height:100%;background-color:#f4f5f5;padding:0;display:-webkit-flex;display:flex;-webkit-flex-direction:column;flex-direction:column;-webkit-justify-content:space-between;justify-content:space-between;-webkit-align-items:center;align-items:center}.search-results-grid-item-detail-confirm-overlay .search-results-grid-item-detail .search-results-grid-item-detail-image-section .search-results-grid-item-detail-image-and-tags-holder .search-results-detail-confirm-asset-label{color:#1a1a1a;font-size:16px;width:100%;text-align:center;position:relative;height:56px;padding-bottom:16px;padding-top:16px;font-weight:700}.search-results-grid-item-detail-confirm-overlay .search-results-grid-item-detail .search-results-grid-item-detail-image-section .search-results-grid-item-detail-image-and-tags-holder .search-results-grid-item-detail-tags{margin:8px 0 0;height:40px;-webkit-justify-content:left;justify-content:left;overflow-x:auto;overflow-y:hidden;position:relative;left:50%;-webkit-transform:translateX(-50%);transform:translateX(-50%)}.search-results-grid-item-detail-confirm-overlay .search-results-grid-item-detail .search-results-grid-item-detail-image-section .search-results-grid-item-detail-image-and-tags-holder .search-results-grid-item-detail-image-holder{height:100%;width:auto;position:relative}.search-results-grid-item-detail-confirm-overlay .search-results-grid-item-detail .search-results-grid-item-detail-image-section .search-results-grid-item-detail-image-and-tags-holder .search-results-grid-item-detail-image-holder .search-results-grid-item-detail-animation,.search-results-grid-item-detail-confirm-overlay .search-results-grid-item-detail .search-results-grid-item-detail-image-section .search-results-grid-item-detail-image-and-tags-holder .search-results-grid-item-detail-image-holder .search-results-grid-item-detail-image,.search-results-grid-item-detail-confirm-overlay .search-results-grid-item-detail .search-results-grid-item-detail-image-section .search-results-grid-item-detail-image-and-tags-holder .search-results-grid-item-detail-image-holder .search-results-grid-item-detail-loading{position:absolute;background-repeat:no-repeat;background-size:contain;background-position:50%;width:100%;height:100%}.search-results-grid-item-detail-confirm-overlay .search-results-grid-item-detail .search-results-grid-item-detail-image-section .search-results-grid-item-detail-image-and-tags-holder .search-results-grid-item-detail-image-holder .search-results-grid-item-detail-animation.search-results-grid-item-detail-image,.search-results-grid-item-detail-confirm-overlay .search-results-grid-item-detail .search-results-grid-item-detail-image-section .search-results-grid-item-detail-image-and-tags-holder .search-results-grid-item-detail-image-holder .search-results-grid-item-detail-image.search-results-grid-item-detail-image,.search-results-grid-item-detail-confirm-overlay .search-results-grid-item-detail .search-results-grid-item-detail-image-section .search-results-grid-item-detail-image-and-tags-holder .search-results-grid-item-detail-image-holder .search-results-grid-item-detail-loading.search-results-grid-item-detail-image{z-index:1}.search-results-grid-item-detail-confirm-overlay .search-results-grid-item-detail .search-results-grid-item-detail-image-section .search-results-grid-item-detail-image-and-tags-holder .search-results-grid-item-detail-image-holder .search-results-grid-item-detail-animation.search-results-grid-item-detail-animation,.search-results-grid-item-detail-confirm-overlay .search-results-grid-item-detail .search-results-grid-item-detail-image-section .search-results-grid-item-detail-image-and-tags-holder .search-results-grid-item-detail-image-holder .search-results-grid-item-detail-image.search-results-grid-item-detail-animation,.search-results-grid-item-detail-confirm-overlay .search-results-grid-item-detail .search-results-grid-item-detail-image-section .search-results-grid-item-detail-image-and-tags-holder .search-results-grid-item-detail-image-holder .search-results-grid-item-detail-loading.search-results-grid-item-detail-animation{z-index:2}.search-results-grid-item-detail-confirm-overlay .search-results-grid-item-detail .search-results-grid-item-detail-image-section .search-results-grid-item-detail-nav{width:32px;-webkit-flex-shrink:0;flex-shrink:0}.search-results-grid-item-detail-confirm-overlay .search-results-grid-item-detail:not(.vertical-default) .search-results-grid-item-detail-image-and-tags-holder{padding-bottom:32px;padding-top:32px;-webkit-justify-content:center;justify-content:center}.search-results-grid-item-detail-confirm-overlay .search-results-grid-item-detail .search-results-grid-item-detail-nav{position:relative;background-repeat:no-repeat;width:32px;height:60px;top:calc(50% - 30px);z-index:1;pointer-events:none;opacity:0;background-color:transparent}.search-results-grid-item-detail-confirm-overlay .search-results-grid-item-detail .search-results-grid-item-detail-nav .search-results-grid-item-detail-nav-icon{background-size:28px;background-repeat:no-repeat;top:0;height:100%;width:32px;position:absolute;pointer-events:auto}.search-results-grid-item-detail-confirm-overlay .search-results-grid-item-detail .search-results-grid-item-detail-nav.search-results-grid-item-detail-nav-left{margin-right:10px}.search-results-grid-item-detail-confirm-overlay .search-results-grid-item-detail .search-results-grid-item-detail-nav.search-results-grid-item-detail-nav-left .search-results-grid-item-detail-nav-icon{right:0;background-position:100%;background-image:url(/images/npw/visualBrowse/caret-left-valley.svg)}.search-results-grid-item-detail-confirm-overlay .search-results-grid-item-detail .search-results-grid-item-detail-nav.search-results-grid-item-detail-nav-left:hover .search-results-grid-item-detail-nav-icon{background-image:url(/images/npw/visualBrowse/caret-left-dark-midnight.svg)}.search-results-grid-item-detail-confirm-overlay .search-results-grid-item-detail .search-results-grid-item-detail-nav.search-results-grid-item-detail-nav-right{margin-left:10px}.search-results-grid-item-detail-confirm-overlay .search-results-grid-item-detail .search-results-grid-item-detail-nav.search-results-grid-item-detail-nav-right .search-results-grid-item-detail-nav-icon{left:0;background-position:0;background-image:url(/images/npw/visualBrowse/caret-right-valley.svg)}.search-results-grid-item-detail-confirm-overlay .search-results-grid-item-detail .search-results-grid-item-detail-nav.search-results-grid-item-detail-nav-right:hover .search-results-grid-item-detail-nav-icon{background-image:url(/images/npw/visualBrowse/caret-right-dark-midnight.svg)}.search-results-grid-item-detail-confirm-overlay .search-results-grid-item-detail.can-nav .search-results-grid-item-detail-nav{opacity:1}.search-results-grid-item-detail-confirm-overlay .spectrum-Checkbox{display:-webkit-inline-flex;display:inline-flex;-webkit-align-items:center;align-items:center;position:relative;height:32px;max-width:100%;margin-right:16px;vertical-align:top}.search-results-grid-item-detail-confirm-overlay .spectrum-Checkbox:hover .spectrum-Checkbox-box-border{border-color:#6e6e6e}.search-results-grid-item-detail-confirm-overlay .spectrum-Checkbox:hover .spectrum-Checkbox-label{color:#2c2c2c}.search-results-grid-item-detail-confirm-overlay .spectrum-Checkbox .spectrum-Checkbox-input{font-family:inherit;font-size:100%;line-height:1.15;margin:0;overflow:visible;box-sizing:border-box;padding:0;position:absolute;top:0;left:-8px;width:calc(100% + 16px);height:100%;opacity:.0001;z-index:1;cursor:pointer}.search-results-grid-item-detail-confirm-overlay .spectrum-Checkbox .spectrum-Checkbox-input:disabled{cursor:default}.search-results-grid-item-detail-confirm-overlay .spectrum-Checkbox .spectrum-Checkbox-input:checked+.spectrum-Checkbox-box-holder .spectrum-Checkbox-box-check{opacity:1}.search-results-grid-item-detail-confirm-overlay .spectrum-Checkbox .spectrum-Checkbox-input:checked+.spectrum-Checkbox-box-holder .spectrum-Checkbox-box-border{border-width:7px;border-color:#1473e6}.search-results-grid-item-detail-confirm-overlay .spectrum-Checkbox .spectrum-Checkbox-box-border{border:2px solid #8e8e8e;position:absolute;width:14px;height:14px;border-radius:2px;transition:border .13s ease-in-out,box-shadow .13s ease-in-out}.search-results-grid-item-detail-confirm-overlay .spectrum-Checkbox .spectrum-Checkbox-box-check{background-image:url(/images/npw/visualBrowse/spectrum-checkbox-check.svg);background-size:28px;width:14px;height:14px;position:absolute;left:1px;top:1px;display:block;opacity:0;transition:opacity .13s ease-in-out}.search-results-grid-item-detail-confirm-overlay .spectrum-Checkbox .spectrum-Checkbox-label{line-height:32px;margin-left:10px;margin-top:0;font-size:14px;font-weight:400;transition:color .13s ease-in-out;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;color:#4b4b4b}.search-results-grid-item-detail-confirm-overlay .spectrum-Checkbox .spectrum-Checkbox-box-holder{position:relative;box-sizing:border-box;width:14px;height:14px;-webkit-flex-grow:0;flex-grow:0;-webkit-flex-shrink:0;flex-shrink:0}.search-results-grid-item-detail-confirm-overlay .spectrum-Checkbox .spectrum-Checkbox-checkmark{position:absolute;top:50%;left:50%;margin-top:-5px;margin-left:-5px;opacity:0;-webkit-transform:scale(0);transform:scale(0);transition:opacity .13s ease-in-out,-webkit-transform .13s ease-in-out;transition:opacity .13s ease-in-out,transform .13s ease-in-out;transition:opacity .13s ease-in-out,transform .13s ease-in-out,-webkit-transform .13s ease-in-out}.main-header-search-results.search-results-grid-view-holder{position:absolute;height:calc(100vh - 66px);width:100vw;left:0;top:66px}@media (max-width:840px){.main-header-search-results.search-results-grid-view-holder{top:114px}}.search-input-tooltip{position:relative;display:inline-block;color:#fff;background:#1473e6 0 0 no-repeat padding-box;border-radius:4px;opacity:1;pointer-events:none;font-size:14px;font-weight:500;padding:10px 20px;text-align:center;top:-1px;transition:top .25s ease-in,opacity .5s ease-in}.search-input-tooltip:after{position:absolute;bottom:100%;left:50%;margin-left:-5px;width:0;border-top:5px solid transparent;border-bottom:5px solid #1473e6;border-right:5px solid transparent;border-left:5px solid transparent;content:" ";font-size:0;line-height:0}.search-input-tooltip-holder{text-align:center;height:auto}.search-input-tooltip-holder.off{opacity:0;height:0}.search-input-tooltip-holder.off .search-input-tooltip{top:10px}.search-results-library-empty{display:-webkit-flex;display:flex;-webkit-flex-direction:column;flex-direction:column;-webkit-align-items:center;align-items:center;text-align:center}.search-results-library-empty .empty-library-templates-image{display:-webkit-flex;display:flex;background:url(/marvel-core/images/pickers/template_blankstate_150.svg) transparent no-repeat 50%;height:200px;width:200px;margin-top:50px;margin-bottom:20px}.search-results-library-empty .empty-library-templates-title-text{display:-webkit-flex;display:flex;font-weight:900;font-size:18px;margin-bottom:18px;width:215px;color:#181919}.search-results-library-empty .empty-library-templates-body-text{display:-webkit-flex;display:flex;font-size:13px;font-weight:400;width:215px;line-height:20px;margin-bottom:18px;color:#181919}.search-results-library-empty .empty-library-templates-learn-more{display:-webkit-flex;display:flex}.search-results-library-empty .empty-library-templates-learn-more>a{font-size:13px;color:#82919b;text-decoration:none}.search-results-libraries{width:100%;padding-bottom:30px}.search-results-libraries.showing .search-results-library-item{opacity:1;transition:opacity .25s,-webkit-transform .75s;transition:transform .75s,opacity .25s;transition:transform .75s,opacity .25s,-webkit-transform .75s}.search-results-libraries .search-results-library-item{opacity:0;width:100%;height:45px;position:relative;cursor:pointer}.search-results-libraries .search-results-library-item p span{overflow:hidden;text-overflow:ellipsis;display:block;width:180px;margin-right:3px}.search-results-libraries .search-results-library-item:hover{background-color:#f4f5f5}.search-results-libraries .search-results-library-item:before{content:"";display:block;position:absolute;width:35px;height:100%;-webkit-mask-image:url(/marvel-core/images/pickers/lib-icon.svg);mask-image:url(/marvel-core/images/pickers/lib-icon.svg);-webkit-mask-repeat:no-repeat;mask-repeat:no-repeat;-webkit-mask-position:center right;mask-position:center right;-webkit-mask-size:16px;mask-size:16px;background-color:#1a1a1a}.search-results-libraries .search-results-library-item .label{height:44px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;line-height:44px;font-weight:400;font-size:15px;padding-left:46px;text-align:left}.search-results-libraries .search-results-library-item .right-shared-icon{-webkit-mask-image:url(/marvel-core/images/pickers/library-shared.svg);mask-image:url(/marvel-core/images/pickers/library-shared.svg)}.search-results-libraries .search-results-library-item .right-shared-icon,.search-results-libraries .search-results-library-item .right-team-icon{-webkit-mask-repeat:no-repeat;mask-repeat:no-repeat;-webkit-mask-size:contain;mask-size:contain;background-color:#c5ccd0;height:18px;width:18px;position:absolute;right:18px;top:16px}.search-results-libraries .search-results-library-item .right-team-icon{-webkit-mask-image:url(/marvel-core/images/pickers/building_18.svg);mask-image:url(/marvel-core/images/pickers/building_18.svg)}.search-results-libraries .search-results-library-item .right-public-icon{-webkit-mask-image:url(/marvel-core/images/pickers/library-public.svg);mask-image:url(/marvel-core/images/pickers/library-public.svg);-webkit-mask-repeat:no-repeat;mask-repeat:no-repeat;-webkit-mask-size:contain;mask-size:contain;background-color:#c5ccd0;height:18px;width:18px;position:absolute;right:18px;top:16px}.more-to-come{display:none;opacity:0;position:absolute;width:28px;height:28px;bottom:100px;left:50%;margin:-14px 0 0 -14px;background-repeat:no-repeat;background-position:50%;background-size:contain;background-image:url(/marvel-core/images/common/dark-spinner.svg);transition:opacity .25s,-webkit-transform .75s;transition:transform .75s,opacity .25s;transition:transform .75s,opacity .25s,-webkit-transform .75s;-webkit-animation-name:picker-spinner-rotate;animation-name:picker-spinner-rotate;-webkit-animation-duration:.75s;animation-duration:.75s;-webkit-animation-iteration-count:infinite;animation-iteration-count:infinite;-webkit-animation-timing-function:linear;animation-timing-function:linear}.more-to-come.showing{display:block;opacity:1}.more-to-come.shared{bottom:100px;left:50%;margin:-1.5rem 0 0 -1.5rem;width:3rem;height:3rem;border-radius:3rem;background-size:56%;background-position:50%;background-repeat:no-repeat;background-color:rgba(0,0,0,.1);background-image:url(/marvel-core/images/common/dark-spinner.svg)}.search-libraries-breadcrumb{display:-webkit-flex;display:flex;font-size:13px;color:#3e3f41;padding:0 4px}.search-libraries-breadcrumb.hide{display:none}.search-libraries-breadcrumb .search-libraries-breadcrumb-library-type{cursor:pointer}.search-libraries-breadcrumb .search-libraries-breadcrumb-caret-icon{-webkit-mask-image:url(/marvel-core/images/pickers/left-arrow.svg);mask-image:url(/marvel-core/images/pickers/left-arrow.svg);-webkit-mask-position:center;mask-position:center;-webkit-mask-repeat:no-repeat;mask-repeat:no-repeat;-webkit-mask-size:contain;mask-size:contain;z-index:1;background-color:#c5ccd0;height:12px;width:10px;margin:2px 8px;cursor:pointer;-webkit-transform:rotate(180deg);transform:rotate(180deg)}.search-libraries-breadcrumb .search-libraries-breadcrumb-library{font-weight:700;overflow:hidden;text-overflow:ellipsis}.search-results-no-libraries{display:-webkit-flex;display:flex;margin-bottom:30px;-webkit-flex-direction:column;flex-direction:column;-webkit-align-items:center;align-items:center;text-align:center;color:#1a1a1a}.search-results-no-libraries .no-libraries-image{display:-webkit-flex;display:flex;background-image:url(/marvel-core/images/pickers/empty-state-illustration-light.svg);height:200px;width:200px;margin-top:50px;margin-bottom:20px}.search-results-no-libraries .no-libraries-title-text{display:-webkit-flex;display:flex;font-weight:900;font-size:18px;margin-bottom:18px;width:215px}.search-results-no-libraries .no-libraries-body-text{display:-webkit-flex;display:flex;font-size:13px;font-weight:400;width:215px;line-height:20px;margin-bottom:18px}.search-results-no-libraries .libraries-learn-more{display:-webkit-flex;display:flex;font-size:13px}',""])},3529:function(e,t,s){var r,i;r=[s(7),s(2),s(6),s(1),s(1053),s(188),s(25),s(141),s(1416),s(14),s(124),s(2593),s(3530),s(3531),s(3532),s(3533),s(3534),s(2708)],void 0===(i=function(e,t,s,r,i,a,l,o,n,h,c,d,u,g,m,p,f,v){"use strict";return s.View.extend({events:{"click .search-results-tag":"handleTagClick","click .search-results-tag-button":"handleTagClick","click .search-results-grid-item-hover-id":"handleDebugIdClick","click .search-results-pagination-more":"handleLoadMoreClick","click .search-results-grid-item":"handleItemClick","keyup .search-results-grid-item":"handleItemKeyUp","mouseover .search-results-grid-item.has-animation":"handleAnimationItemMouseOver","mouseout .search-results-grid-item.has-animation":"handleAnimationItemMouseOut","click .search-results-grid-main-cta":"handleItemMainCtaClick","click .search-results-grid-item-thumb-favorite-icon":"handleFavoriteIconClick","click .search-results-grid-item-hover-cta":"handleItemCtaClick","click .search-results-grid-item-detail-nav":"handleDetailNavClick","click .search-results-grid-item-detail-other-results-item-thumb":"handleDetailResultNavClick","click .search-results-grid-item-detail-cta":"handleDetailCtaClick","click .social-line":"handleShareTemplateCtaClick","click .social-overlay-bg":"handleShareModalCloseClick","click .js-close-modal":"handleShareModalCloseClick","click .grid-detail-header-back-arrow":"handleDetailBackArrowClick"},initialize:function(e){t.bindAll(this,t.functionsIn(this)),this.SearchController=e.SearchController,e.resultsData&&this.setResultsData(e.resultsData),this.parentRerendersOnResize=e.parentRerendersOnResize,this._debouncedBound||(this._debouncedBound=!0,this._debouncedVerticalScroll=t.debounce(this.handleScroll.bind(this),500),this.parentRerendersOnResize||(this._debouncedResize=t.debounce(this.handleResize.bind(this),500)))},applyNewInitOptions:function(s){this.setElement(s.el),s.parentRerendersOnResize!==this.parentRerendersOnResize&&(this.parentRerendersOnResize=s.parentRerendersOnResize,this.parentRerendersOnResize?(this._debouncedResize.cancel(),this._resizeRegistered&&(this._resizeRegistered=!1,e(window).off("resize.srgv",this._debouncedResize))):this._debouncedResize=t.debounce(this.handleResize.bind(this),500))},_partialRowClass:"partial-row",_getRowWidth:function(e){var s=0;return t.each(e.assets,(function(e){s+=e.widthInGrid})),s+=this.gridDims.borderSpace*(e.assets.length-1)},_reduceHeight:function(e,s){var r=this.gridDims.borderSpace*(e.assets.length-1),i=0;return s=s||1,t.each(e.assets,(function(e){e.heightInGrid-=s,i=Math.max(i,e.heightInGrid),e.widthInGrid=Math.floor(e.width*e.heightInGrid/e.height),r+=e.widthInGrid})),e.heightInGrid=i,r},_rerenderGridAfterResize:function(){this._render({isResize:!0})},_getViewportWidth:function(){return window.innerWidth?window.innerWidth:document.documentElement.clientWidth?document.documentElement.clientWidth:screen.width},_getViewportHeight:function(){return window.innerHeight?window.innerHeight:document.documentElement.clientHeight?document.documentElement.clientHeight:screen.height},_imagePreloads:{},_setBackgroundUrl:function(e,t){e.css("background-image","url("+t+")")},_couldNotLoadBackgroundFromLoad:function(e){var t=this.resultsGrid$.find("#"+e.thumbId);if(e.hadLoadError=!0,this.gridOptions.assetLoadFailed(e),this.pagination.lastShowing--,this.pagination.total--,this._updatePaginationDisplay(),t.length){var s=t.parents(".search-results-grid-item");s.parent(".search-results-grid-row").addClass(this._partialRowClass),s.addClass("had-load-error"),this.gridOptions.detailViewEnabled&&this.detailView$.find("#"+e.thumbId).parents(".search-results-grid-item-detail-other-results-item").addClass("had-load-error")}},_setBackgroundFromLoad:function(e){var t="url("+e.renditions[this._currentPreload.fieldId]+")",s=this.resultsGrid$.find("#"+e.thumbId);if(s.length){this.gridOptions.detailViewEnabled&&this.detailView$.find("#"+e.thumbId).css("background-image",t);var r=s.parents(".search-results-grid-item");s.css("background-image",t),r.removeClass("not-loaded")}},_preloadNextAsset:function(){if(this._currentPreload&&this._currentPreload.nextIndex<this._currentPreload.assetsToPreload.length){var e=this._currentPreload,s=this._currentPreload.assetsToPreload[this._currentPreload.nextIndex],r=s.renditions[this._currentPreload.fieldId],i=this._currentPreload.nextIndex;this._currentPreload.nextIndex++;var a=this._currentPreload.nextIndex==this._currentPreload.assetsToPreload.length;this._currentPreload.currentAsset=s;var l=new Image;l.onload=function(t){if(e===this._currentPreload&&(s.hideUntilLoaded=!1,this._currentPreload.loadedByIndex[i]=s,this._lastGridData.successfulPreloads[s.id]=!0,i==this._currentPreload.nextLoadedIndex&&(this._currentPreload.nextLoadedIndex++,this._lastGridData.hideAssetsUntilLoaded))){this._setBackgroundFromLoad(s);for(var r=this._currentPreload.nextLoadedIndex;r<this._currentPreload.assetsToPreload.length;r++){var a=this._currentPreload.loadedByIndex[r];if(!a)break;this._currentPreload.nextLoadedIndex=r+1,a.hadLoadError||this._setBackgroundFromLoad(a)}}}.bind(this),l.onerror=function(t){if(e===this._currentPreload&&(window.marvel.logger.warn("error loading image in template search results",l.src),this._currentPreload.loadedByIndex[i]=s,this._couldNotLoadBackgroundFromLoad(s),i==this._currentPreload.nextLoadedIndex&&(this._currentPreload.nextLoadedIndex++,this._lastGridData.hideAssetsUntilLoaded)))for(var r=this._currentPreload.nextLoadedIndex;r<this._currentPreload.assetsToPreload.length;r++){var a=this._currentPreload.loadedByIndex[r];if(!a)break;this._currentPreload.nextLoadedIndex=r+1,this._setBackgroundFromLoad(a)}}.bind(this),l.src=r,a||t.defer(this._preloadNextAsset.bind(this))}},_setupAssetRenditionsLoader:function(e){e.assetsToPreload.length?this._currentPreload={assetsToPreload:e.assetsToPreload,nextIndex:0,nextLoadedIndex:0,fieldId:this.isRetina()?"rendition2x":"rendition",loadedByIndex:[]}:this._currentPreload=null},_generateGrid:function(e){var s=(e=e||{}).containerDims;s||(s={height:this.$el.height(),width:this.$el.width()},this.$el.hasClass("hide")&&(this.$el.removeClass("hide"),s.width=this.$el.width(),s.height=this.$el.height(),this.$el.addClass("hide")),s.height<=0&&(s.height=this._getViewportHeight()-122),s.width<=0&&(s.width=this._getViewportWidth()));var r=s.width-2*this.gridDims.rowHMargin,i=this.gridDims.minHeight,a=this.gridDims.minPerRowForMinHeight||2,l=this.gridDims.maxWidth?Math.min(r,this.gridDims.maxWidth):r,o=Math.floor(this.gridDims.targetNumRows)-1,n=s.height-o*this.gridDims.rowVSpace,c=this.gridDims.targetNumRows?Math.round(n/this.gridDims.targetNumRows):this.gridDims.maxHeight,d=this.gridOptions.hideAssetUntilLoaded;d&&e.preLoadMoreGridData&&e.preLoadMoreGridData.stylesData.length;this._partialRowClass=s.width<=300?"partial-row-narrow":"partial-row",c<this.gridDims.minHeight?c=this.gridDims.minHeight:c>this.gridDims.maxHeight&&(c=this.gridDims.maxHeight);var u=[],g={assets:[],width:0};u.push(g),t.each(this.assets,function(e){var s=e.width,r=e.height;if(e.heightInGrid=c,e.widthInGrid=s*e.heightInGrid/r,e.heightInGrid=parseInt(e.heightInGrid),e.widthInGrid=parseInt(e.widthInGrid),e.originalHeightInGrid=e.heightInGrid,e.originalWidthInGrid=e.widthInGrid,g.assets.push(e),g.width+=e.widthInGrid,g.width>=l){var o=null;if(g.assets.length>a){for(var n=this._getRowWidth(g),h=!1;n>l;)if(n=this._reduceHeight(g),g.heightInGrid<=i){n>l&&(h=!0);break}t.each(g.assets,(function(e){e.widthInGrid=e.originalWidthInGrid,e.heightInGrid=e.originalHeightInGrid})),h&&(o=g.assets.pop())}g={assets:[],width:0},o&&(g.assets.push(o),g.width+=o.widthInGrid),u.push(g)}}.bind(this)),0===u[u.length-1].length&&u.pop();var m=[],p=[],f=[],v=1e6,w=(this.gridDims.detailResultsThumbHeight,this.gridDims.detailResaultsMinThumbHeight||0),b={},_=[];t.each(u,function(s,r){for(var i=this._getRowWidth(s),a={assets:[],index:r};i>l;)i=this._reduceHeight(s);a.partialRow=l-i>this.gridDims.borderSpace&&this._partialRowClass,r||(a.rowVSpace=0);var o=s.assets.length-1;t.each(s.assets,function(s,r){var i=s.usecases&&s.usecases[0]||s.app,l=s.favoriteData&&s.favoriteData.favDate>0,n="thumb_"+s.id,h=d,c=s.templatedImgHref,u={rendition:this._getRenditionUrl(c,s.heightInGrid),rendition2x:this._getRenditionUrl(c,2*s.heightInGrid)},g=s.animationHref&&{href:s.animationHref,width:s.widthInGrid,height:s.heightInGrid};e.preLoadMoreGridData&&e.preLoadMoreGridData.successfulPreloads[s.id]&&(h=!1),v=Math.min(v,s.heightInGrid);var m={id:n,w:s.widthInGrid+"px",h:s.heightInGrid+"px"};h?m.hideAssetUntilLoaded=!0:t.assign(m,u),p.push(m);var w={id:s.id,ctaItemId:s.id,thumbId:n,title:s.title,type:s.app,bgLoadWidth:s.widthInGrid-3+"px",bgLoadHeight:s.heightInGrid-3+"px",assetW:s.width,assetH:s.height,assetAspectRatio:s.width/s.height,label:i,isFavorite:l,tagsForData:s.tagsForData,allTags:s.allTags,score:s._score,hideUntilLoaded:h,isPremiumTemplate:s.isPremiumTemplate,premiumTemplateBadge:s.isPremiumTemplate&&this.gridOptions.premiumTemplateBadge,marginRight:r!==o&&this.gridDims.borderSpace+"px"||0,animation:g,indexInRow:a.assets.length};h&&(w.renditions=u,_.push(w)),b[n]=w,a.assets.push(w),f.push(w)}.bind(this)),m.push(a)}.bind(this));var y=s.height,x=Math.floor(.25*y)-40,S=this.detailResultHSpace*(f.length-2);t.each(f,(function(e){e.detailResultWidth=e.assetW*x/e.assetH,S+=e.detailResultWidth})),t.each(f,(function(e){e.detailResultWidth=100*e.detailResultWidth/S+"%",e.detailResultHeight="100%"})),d&&this._setupAssetRenditionsLoader({assetsToPreload:_});var k=e.preLoadMoreGridData&&e.preLoadMoreGridData.successfulPreloads||{};if(this.recommendedAssets){var T={assets:[],isCarousel:!0,rowVSpace:0,recommendedRow:{title:h.getString("search-results-recommend-header-title"),searchResultsTitle:h.getString("search-results-recommend-footer-title")}},C=this.recommendedAssets.length-1,R=this.gridDims.recommendedHeight||Math.round(.5*c),F=0;t.each(this.recommendedAssets,function(s,r){s.heightInGrid=R,s.widthInGrid=s.width*(R/s.height),F+=s.widthInGrid+this.gridDims.borderSpace;var i=s.usecases&&s.usecases[0]||s.app,a=s.favoriteData&&s.favoriteData.favDate>0,l="thumb_recommended_"+s.id,o=d,n=s.templatedImgHref,h={rendition:this._getRenditionUrl(n,s.heightInGrid),rendition2x:this._getRenditionUrl(n,2*s.heightInGrid)},c=s.animationHref&&{href:s.animationHref,width:s.widthInGrid,height:s.heightInGrid};e.preLoadMoreGridData&&e.preLoadMoreGridData.successfulPreloads[s.id]&&(o=!1),v=Math.min(v,s.heightInGrid);var u={id:l,w:s.widthInGrid+"px",h:s.heightInGrid+"px"};o?u.hideAssetUntilLoaded=!0:t.assign(u,h),p.push(u);var g={id:s.id,ctaItemId:s.id,thumbId:l,title:s.title,type:s.app,bgLoadWidth:s.widthInGrid-3+"px",bgLoadHeight:s.heightInGrid-3+"px",assetW:s.width,assetH:s.height,assetAspectRatio:s.width/s.height,label:i,isFavorite:a,tagsForData:s.tagsForData,allTags:s.allTags,score:s._score,hideUntilLoaded:o,isPremiumTemplate:s.isPremiumTemplate,premiumTemplateBadge:s.isPremiumTemplate&&this.gridOptions.premiumTemplateBadge,marginRight:r!==C&&this.gridDims.borderSpace+"px"||0,animation:c,indexInRow:T.assets.length,isRecommended:!0};o&&(g.renditions=h,_.push(g)),b[l]=g,T.assets.push(g),f.push(g)}.bind(this)),F-=this.gridDims.borderSpace,T.partialRow=l-F>this.gridDims.borderSpace&&this._partialRowClass,m.unshift(T)}return{hideAssetsUntilLoaded:d,delayAllAssets:!d,rowsData:m,stylesData:p,successfulPreloads:k,maxRowWidth:l+"px",rowVSpace:this.gridDims.rowVSpace,containerDims:s,detailData:this.gridOptions.detailViewEnabled&&{detailAssetsData:{assets:f,maxH:x+"px",totalWidth:S+"px",thumbHeight:"100%",maxTotalWidth:S+"px",minThumbHeight:w&&w+"px",minTotalWidth:w&&S*w/v+"px"},detailBackArrowText:this.gridOptions.backArrowTextForDetail}}},scrollToPreLoadMoreTop:function(){if(this._preLoadMoreLastElemId){var e=this.verticalScroller$.find("#"+this._preLoadMoreLastElemId);if(e&&e.length)return void e[0].focus()}this.verticalScroller$.scrollTop(this._preLoadMoreScrollTop)},scrollToGridRow:function(t){t>=this.rows$.length&&(t=this.rows$.length-1);var s=e(this.rows$[t]),r=e(this.rows$[0]),i=s.position(),a=r.position(),l=i&&a&&i.top-a.top||0;this._verticalScrollRegistered&&(this._ignoreNextVerticalScroll=!0),this.verticalScroller$.scrollTop(l)},_getRenditionUrl:function(e,t,s){return s=s||"height",e.replace("{format}","jpg").replace("{dimension}",s).replace("{size}",t)},setResultsData:function(e,s){this.assets=e.assets,this.assetsById=e.assetsById,this.tagsData=e.tagsData,this.tagsData.tags||(this.tagsData.tags=t.reduce(this.tagsData.tagsInOrder,(function(e,t){return e[t.id]=t,e}),{})),e.searchAnalytics={tagFilters:this.tagsData.tagFilters&&this.tagsData.tagFilters.map((function(e){return e.id})),searchTerm:e.searchStr},this.searchAnalytics=e.searchAnalytics,this._setAtMaxSelectedTagsForTagsData(this.tagsData,s),this.pagination={total:e.hasMore&&e.total||this.assets.length,firstShowing:1,lastShowing:this.assets.length,hasMore:e.hasMore}},_addPaginationToTemplateOptions:function(e){return e.paginationTotal=this.pagination.total,e.paginationFirst=this.pagination.firstShowing,e.paginationLast=this.pagination.lastShowing,e},_updatePaginationDisplay:function(){var e=this.$el.find(".search-results-pagination-pages-info"),t=this._addPaginationToTemplateOptions({}),s=this.pagination.total?"npw-vb-search-results-pagination-some":"npw-vb-search-results-pagination-none",r=h.formatMessage(s,t);e.text(r)},renderResults:function(e,t){this.gridOptions=t,this.gridDims=this.gridOptions.gridDims,this.setResultsData(e,t),this.render(t)},_extendDebugSettingsToTemplateSettings:function(e){return this.gridOptions.debugSettings&&(e.debugCssStr=this.gridOptions.debugSettings.debugCssStr),e},_recordExperiment:function(){return this._recordExperimentDefer||(this._recordExperimentDefer=r.defer(),a.run("npwSearchResults*").then(function(e){this._recordExperimentDefer.resolve(e)}.bind(this)).catch(function(e){window.marvel.logger.error("Error loading experiment in npw search results: ",e),this._recordExperimentDefer.resolve(null)}.bind(this)).done()),this._recordExperimentDefer.promise},render:function(e){return e.isReRender?this._render(e):this._recordExperiment().then(function(){this.gridOptions.autoShowRecommended?this.gridOptions.recommendNumberOfSearchResults?(this.mockedRecAssets=this.assets.splice(0,this.gridOptions.recommendNumberOfSearchResults),this.recommendedAssets=this.mockedRecAssets.map((function(e){return Object.assign({},e,{isRecommended:!0,isFakeRecommend:!0})})),this.recommendedAssetsById=t.reduce(this.recommendedAssets,function(e,t){return e[t.id]=t,delete this.assetsById[t.id],e}.bind(this),{}),this.pagination.lastShowing=Math.max(0,this.pagination.lastShowing-this.recommendedAssets.length),this.pagination.total=Math.max(0,this.pagination.total-this.recommendedAssets.length),this._render(e)):this.gridOptions.getRecommendedResults({isEdu:this.gridOptions.isEdu}).then(function(t){this.recommendedAssets=t.recommendedAssets,this.recommendedAssetsById=t.recommendedAssetsById,this._render(e)}.bind(this)):(this.recommendedAssets=null,this._render(e))}.bind(this)).done(),this},_isEdge:function(){return-1!==window.navigator.userAgent.indexOf("Edge/")},_isIE:function(){var e=window.navigator.userAgent;return-1!==e.indexOf("Trident/")||-1!==e.indexOf("MSIE ")},_setAtMaxSelectedTagsForTagsData:function(e,s){var r=!1;if(s.maxNumSelectedTags&&e.currentSelectedTags&&e.currentSelectedTags.length){var i=0;t.find(e.currentSelectedTags,(function(e){if(!e.selected)return!0;e.customFilterType||i++})),r=i>=this.gridOptions.maxNumSelectedTags}e.atMaxSelectedTags=r},focusFirstAsset:function(){if(this.rows$&&this.rows$.length){var t=e(this.rows$[0]).find(".search-results-grid-item");t.length&&e(t[0]).focus()}},keyEventFunc:function(s){if(this._detailConfirmInfo&&this._detailConfirmInfo.showing)this._detailConfirmInfo.keyEventFunc(s);else if("keydown"===s.type&&-1!==[o.DOM_VK_LEFT,o.DOM_VK_RIGHT,o.DOM_VK_UP,o.DOM_VK_DOWN].indexOf(s.keyCode)){if(s.metaKey||s.altKey)return void(s.keyCode===o.DOM_VK_UP&&this.focusFirstAsset());var r=e(document.activeElement);if(r.hasClass("search-results-grid-item")){var i,a,l=r.parent(".search-results-grid-row"),n=l.find(".search-results-grid-item"),h=l.data("index"),c=r.data("index-in-row"),d=0;if(s.keyCode===o.DOM_VK_LEFT)--c>-1?i=e(n[c]):h?(a=e(this.rows$[h-1]).find(".search-results-grid-item"),i=e(a[a.length-1])):d=-1;else if(s.keyCode===o.DOM_VK_RIGHT)++c<n.length?i=e(n[c]):h===this.rows$.length-1?d=1:(a=e(this.rows$[h+1]).find(".search-results-grid-item"),i=e(a[0]));else{var u;if(s.keyCode===o.DOM_VK_UP?(u=h-1)<0&&(d=-1):(u=h+1)>=this.rows$.length&&(d=1),-1!==d&&s.preventDefault(),!d){a=e(this.rows$[u]).find(".search-results-grid-item");var g=c?a.length-1:0,m=r.offset().left+.5*r.width(),p=0;t.find(a,(function(t,s){var r=e(t),i=r.width(),a=r.offset().left,l=a+i;return m<a?!!p&&(g=m>=.5*(p+a)?s:s-1,!0):m<=l?(g=s,!0):(p=l,!1)})),i=e(a[g])}}i?i.focus():1===d&&this.loadMoreIfNotLoadingAndMore()}else(document.activeElement===document.body||r.hasClass("search-results-tag-button"))&&(this.focusFirstAsset(),s.preventDefault())}},_render:function(s){s=s||{},this.keyFuncRegistered||(this.keyFuncRegistered=!0,this.keyEventElem$=e(document),this.keyEventElem$.on("keydown.searchDetailConfirm, keyup.searchDetailConfirm",this.keyEventFunc)),this._verticalScrollRegistered&&(this.verticalScroller$.off("scroll.searchresultsgridview",this._debouncedVerticalScroll),this._verticalScrollRegistered=!1),this._resizeRegistered||this.parentRerendersOnResize||(this._resizeRegistered=!0,e(window).on("resize.srgv",this._debouncedResize));var r=0;this.gridOptions.repeatOptions&&this.gridOptions.repeatOptions.loadNext&&(r=this.rows$&&this.rows$.length),this.detailResultMaxHeight=this.gridDims.maxHeight,this.detailResultHSpace=8,this._showingDetail=!1;var i={numCtas:0,ctas:[]},a=this._parseTags(this.gridOptions.debugSettings),l=this._generateGrid({preLoadMoreGridData:this._preLoadMoreGridData,containerDims:s.containerDims}),o=this.tagsData.atMaxSelectedTags,n=s.uiStrings||{};n.resultItemCreateFrom||(n.resultItemCreateFrom=h.getString("npw-vb-search-results-item-create-from"));var g={rows:l.rowsData,maxRowWidth:l.maxRowWidth,rowVSpace:l.rowVSpace,hoverCtas:i,detailData:l.detailData,tagsAboveResults:this._tagsAboveResultsEnabled(),tags:a,pagination:this.pagination,favoritesEnabled:this.gridOptions.favoritesEnabled,assetsStyles:c.to_html(d,{assets:l.stylesData}),isEdge:this._isEdge(),isIE:this._isIE(),uiStrings:n,implicitCreateCta:this.gridOptions.implicitCreateCta,delayAllAssets:l.delayAllAssets,atMaxSelectedTags:o,preloadAllResultMp4s:this.gridOptions.preloadAllResultMp4s};this._addPaginationToTemplateOptions(g),this._lastGridData=l,this._preLoadMoreGridData=null,g.detailData&&i.ctas.push({id:"detail"}),i.numCtas=i.ctas.length,this._extendDebugSettingsToTemplateSettings(g);var m,f=h.mustacheRender(p,g,{itemDetail:l.detailData&&u});return this.$el.html(f),this._applySelectedTagsToResultsAfterRender(),l.hideAssetsUntilLoaded&&this._preloadNextAsset(),this.verticalScroller$=this.$el.find(".search-results-grid-holder"),this.resultsGrid$=this.$el.find(".search-results-grid"),this.rows$=this.verticalScroller$.find(".search-results-grid-row"),this.detailView$=this.$el.find(".search-results-grid-item-detail-holder"),this.detailImage$=this.detailView$.find(".search-results-grid-item-detail-image"),this.detailThumbsRowScroller$=this.detailView$.find(".search-results-grid-item-detail-other-results-section-scroller"),this.detailRightSide$=this.detailView$.find(".search-results-grid-item-detail-right"),this.gridOptions.rightRailForDetail?this.detailView$.addClass("show-right-rail"):this.detailView$.removeClass("show-right-rail"),s.jumpToDetailAssetId&&this.jumpToDetailAsset(s.jumpToDetailAssetId),this.$el.removeClass("hide"),this.pagination.div$=this.$el.find(".search-results-pagination").removeClass("loading-more"),this.pagination.moreBtn$=this.pagination.div$.find(".load-more-toggle"),m=this.pagination.hasMore?this.gridOptions.showLoadMoreButton?this.pagination.lastShowing>s.maxResultsBeforeAutoLoadFromScroll?"spinner-loaded":"load-more":"spinner-loaded":"no-more",this._setMoreBtnState(m),"spinner-loaded"===m?(this._verticalScrollRegistered=!0,r&&!s.isReRender&&this.scrollToPreLoadMoreTop(),this.verticalScroller$.on("scroll.searchresultsgridview",this._debouncedVerticalScroll)):"no-more"===m&&r&&this.scrollToPreLoadMoreTop(),l.delayAllAssets&&t.delay(function(){this.rows$.removeClass("hide-assets")}.bind(this),5),this},hide:function(){this.$el.addClass("hide"),this._resizeRegistered&&(this._resizeRegistered=!1,e(window).off("resize.srgv",this._debouncedResize)),this.keyFuncRegistered&&(this.keyFuncRegistered=!1,this.keyEventElem$.off("keydown.searchDetailConfirm, keyup.searchDetailConfirm",this.keyEventFunc))},getLastAssetElemId:function(){if(this.rows$&&this.rows$.length){var t=e(this.rows$[this.rows$.length-1]),s=t.find(".search-results-grid-item");if(s.length||(s=t.prev().find(".search-results-grid-item")),s.length)return s[s.length-1].id}return""},handleLoadMoreClick:function(e){if(!this.pagination.moreBtn$.hasClass("no-more")){this.pagination.div$.addClass("loading-more"),this._setMoreBtnState("spinner-loading"),this._preLoadMoreScrollTop=this.verticalScroller$.scrollTop(),this._preLoadMoreLastElemId=this.getLastAssetElemId(),this._preLoadMoreGridData=this._lastGridData;var s=t.map(this.tagsData.currentSelectedTags,(function(e){return e.id}));this.gridOptions.loadMoreClickHandler({isClick:!!e,pagination:this.pagination,selectedTags:s})}},handleResize:function(e){this._rerenderGridAfterResize()},loadMoreIfNotLoadingAndMore:function(){this.pagination.moreBtn$.hasClass("spinner")&&!this.pagination.moreBtn$.hasClass("spinner-loading")&&this.pagination.hasMore&&this.handleLoadMoreClick()},handleScroll:function(e){if(this._ignoreNextVerticalScroll)this._ignoreNextVerticalScroll=!1;else{var t=this.verticalScroller$.scrollTop(),s=this.verticalScroller$[0].scrollHeight;t+this.verticalScroller$.height()>=s&&this.loadMoreIfNotLoadingAndMore()}},_setMoreBtnState:function(e){"load-more"===e?(this.pagination.moreBtn$.removeClass("disabled").removeClass("spinner"),t.delay(function(){this.pagination.moreBtn$.removeClass("hide").removeClass("melting")}.bind(this),300)):"spinner-loaded"===e||"no-more"===e?(this.pagination.moreBtn$.removeClass("disabled").addClass("spinner").removeClass("spinner-loading"),"no-more"===e?this.pagination.moreBtn$.addClass("no-more"):this.pagination.moreBtn$.removeClass("no-more")):"spinner-loading"===e&&this.pagination.moreBtn$.removeClass("disabled").addClass("spinner").addClass("spinner-loading").removeClass("no-more")},_currentVideoRollPlayTimer:{},_triggerVideoRollPlayTimer:function(t){var s=e(t.currentTarget),r=s.find(".search-results-grid-item-thumb-animation");this._getAssetFromElement(s);this._currentVideoRollPlayTimer.timer&&clearTimeout(this._currentVideoRollPlayTimer.timer),this._currentVideoRollPlayTimer.timer=setTimeout(function(){var e=r.get(0),t=r.find("source"),s=t.attr("src");e.loop=!0,s||(s=t.data("src"),t.attr("src",s),e.load()),this.SearchController.autoPlayVideo(e,(function(e){e.err||r.removeClass("hide")}))}.bind(this),500),this._currentVideoRollPlayTimer.video$=r},handleAnimationItemMouseOver:function(e){this._triggerVideoRollPlayTimer(e)},handleAnimationItemMouseOut:function(t){var s=e(t.currentTarget).find(".search-results-grid-item-thumb-animation");this._currentVideoRollPlayTimer.video$&&s[0]===this._currentVideoRollPlayTimer.video$[0]&&this._currentVideoRollPlayTimer.timer&&(clearTimeout(this._currentVideoRollPlayTimer.timer),this._currentVideoRollPlayTimer.timer=null,this._currentVideoRollPlayTimer.video$=null),s.get(0).loop=!1},handleItemKeyUp:function(e){e.keyCode===o.DOM_VK_RETURN&&e.stopPropagation()},handleItemClick:function(t){if(this.gridOptions.implicitCreateCta){var s=e(t.currentTarget),r=(s.data("cta"),s.closest(".search-results-grid-item"));this._handleCreateFromItem(t,r,{uiId:"thumb-hover-create"})}},_handleCreateFromItem:function(e,s,r){var i=this._getAssetFromElement(s);r=t.assign({},{context:"item-grid",alias:i.alias,sparkFormat:i.app},r||{}),this.gridOptions.createFromThumbClickHandler(i,{analytics:r,event:e})},getDataForRedraw:function(){return{showingDetailId:this._showingDetail&&this._detailInfo.asset&&this._detailInfo.asset.id}},handleItemMainCtaClick:function(t){var s=e(t.currentTarget),r=s.data("cta"),i=s.data("analytics-id"),a=s.closest(".search-results-grid-item");"create"===r&&this._handleCreateFromItem(t,a,{uiId:i})},isRetina:function(){return window.devicePixelRatio>1||!(!window.matchMedia||!window.matchMedia("(-webkit-min-device-pixel-ratio: 1.5),(min--moz-device-pixel-ratio: 1.5),(-o-min-device-pixel-ratio: 3/2),(min-resolution: 1.5dppx)").matches)},_getAssetFromClickTarget:function(e,t){t=t||".search-results-grid-item";var s=e.closest(t);return this._getAssetFromElement(s)},_getAssetFromElement:function(e){var t=e.data("id");return(e.data("is-recommended")?this.recommendedAssetsById:this.assetsById)[t]},handleItemCtaClick:function(t){var s=e(t.currentTarget),r=s.data("id"),i=this._getAssetFromClickTarget(s);if(t.preventDefault(),t.stopImmediatePropagation(),"detail"===r){if(this.gridOptions.preDetailViewCallback){var a=this.gridOptions.preDetailViewCallback(i);a.resized&&this.containerResized(a)}this._showDetailViewForAsset(i,this.assets,{context:"from-results-cta"})}},jumpToDetailAsset:function(e){"string"==typeof e&&(e=this.assetsById[e]),e&&this._showDetailViewForAsset(e,this.assets,{context:"from-jump"})},handleFavoriteIconClick:function(t){t.preventDefault(),t.stopImmediatePropagation();var s,r,i,a,l=e(t.currentTarget),o=l.parents(".search-results-grid-item");l.hasClass("search-results-grid-item-detail-cta")?(i=!0,a=this._detailInfo.asset,o=l,r=this.detailView$.find("#other-results-item-"+a.id)):(o.length||(o=l.parents(".search-results-grid-item-detail-other-results-item"),i=!0),a=this._getAssetFromElement(o));var n=o.hasClass("is-favorite");o.hasClass("is-setting-favorite")||(o.addClass("is-setting-favorite"),n=!n,i&&(s=this.resultsGrid$.find("#thumb_"+a.id).parents(".search-results-grid-item")),n?(o.addClass("is-favorite"),s&&s.addClass("is-favorite"),r&&r.addClass("is-favorite")):(o.removeClass("is-favorite"),s&&s.removeClass("is-favorite"),r&&r.removeClass("is-favorite")),this.gridOptions.setFavorite(a,n).then((function(){o.removeClass("is-setting-favorite")})))},remove:function(){return this.$el.empty(),this.$el.addClass("hide"),this._resizeRegistered&&(this._resizeRegistered=!1,e(window).off("resize.srgv",this._debouncedResize)),e(document.body).find(".vb-search-header").removeClass("short-header"),this},searchViewShown:function(e){var s=!1;if(e.gridDims||e.containerDims){this.gridDims&&this._lastGridData||window.marvel.logger.debug("null gridDims or lastGridData in searchViewShown",{gridDims:this.gridDims,lastGridData:this._lastGridData}),s=!0;var r=t.find(e.gridDims,function(e,t){return this.gridDims[t]!==e}.bind(this));if(t.isUndefined(r)&&this._lastGridData){var i=t.find(e.containerDims,function(e,t){return this._lastGridData.containerDims[t]!==e}.bind(this));s=!t.isUndefined(i)}}s&&this.containerResized(e)},containerResized:function(e){e.gridDims&&t.assign(this.gridDims,e.gridDims),this._render({isResize:!0,containerDims:e.containerDims}),this._detailConfirmInfo&&this._detailConfirmInfo.showing&&this._redrawCurrentConfirm()},_parseTags:function(e){var s=[],r=this.tagsData.tagsInOrder;return this.gridOptions.maxNumTagsInResults&&r.length>this.gridOptions.maxNumTagsInResults&&(r=r.slice(0,this.gridOptions.maxNumTagsInResults)),t.each(r,(function(r,i){var a={label:r.keyword.replace(/\-/g," "),index:i},l=r.prefix;if(!l&&r.fields&&(l=r.fields.length>1?"multi":r.fields[0]),l&&(a.prefix=l),e){var o=[];r.tags&&(o=r.tags),o.length&&(a.title=o.join(","))}s.push(t.assign(a,r))})),s},_applySelectedTagsToResultsAfterRender:function(){t.each(this.tagsData.currentSelectedTags,function(e){this._setTagDivsSelected(e.id,!0)}.bind(this))},_tagsAboveResultsEnabled:function(){return!this.gridDims.hideTagsAboveResults},_setTagDivsSelected:function(e,t){var s=this.$el.find(".search-results-tag-tag-"+e+'[data-id="'+e+'"]');t?s.addClass("selected"):s.removeClass("selected")},_isTagSelectedInDetail:function(e){return this.$el.find(".search-results-detail-tag-tag-"+e).hasClass("selected")},handleDebugIdClick:function(t){if(this.gridOptions.debugSettings.cpAssetPathTemplate){t.stopImmediatePropagation();var s=e(t.currentTarget),r=s.data("id"),i=this._getAssetFromElement(s),a=n.getFormatInfo(i.app).app.getCPCommunity(),l=this.gridOptions.debugSettings.cpAssetPathTemplate.replace("{assetId}",r).replace("{community}",a);window.open(l,"_blank")}},handleTagClick:function(s){var r,i=e(s.currentTarget),a=i.data("id"),l=a;if(s.preventDefault(),s.stopImmediatePropagation(),this.tagsData.keysForTags){if(!(r=this.tagsData.tags[l])){var o=a.split("-");l=2===o.length?o[1]:o.slice(1).join("-"),r=this.tagsData.tags[l]}}else r=this.tagsData.tags[l];if(!this.tagsData.atMaxSelectedTags||!r||r.selected||r.customFilterType){var n=[],h={selectedTags:t.map(this.tagsData.currentSelectedTags,(function(e){return n.push(e.srcKey||e.id),e.id})),selectedTagKeys:n};if(r)if(i.hasClass("search-results-grid-item-detail-tag")){var c=this._isTagSelectedInDetail(a);this._setTagDivsSelected(a,!c),//!tagData.selected would be if we show selected when displaying detail
h.changeSelectionValue=!c,this.gridOptions.tagClickHandler(r,h)}else this._setTagDivsSelected(a,!r.selected),this.gridOptions.tagClickHandler(r,h);else window.marvel.logger.debug("tagData not found for tag click:"+a)}},searchTriggered:function(){this._showingDetail&&this.closeDetail()},_setDetailRightSide:function(e){if(this.gridOptions.rightRailForDetail){var s=[],r=n.getFormatInfo(e.app);t.each(e.allTags,function(e){var r=!!t.find(this.tagsData.currentSelectedTags,(function(t){return t.id===e.id}));s.push(t.assign({},e,{selected:r}))}.bind(this));var i=t.assign({},e,{allTags:s,appLabel:r.formatLabel});this._extendDebugSettingsToTemplateSettings(i);var a=c.to_html(m,i);this.detailRightSide$.html(a)}else{var l=this.detailView$.find(".search-results-grid-item-detail-tags"),o=this.detailView$.find(".search-results-grid-item-detail-header-cta-favorite");e.favoriteData&&e.favoriteData.favDate>0?o.addClass("is-favorite"):o.removeClass("is-favorite"),l.html(c.to_html('{{#allTags}}{{^hideTag}}<div class="search-results-grid-item-detail-tag search-results-tag-button search-results-tag-prefix-{{prefix}}{{#selected}} selected{{/selected}} search-results-detail-tag-tag-{{id}} search-results-tag-tag-{{id}} {{debugCssStr}}" data-id="{{id}}">{{label}}</div>{{/hideTag}}{{/allTags}}',this._extendDebugSettingsToTemplateSettings({allTags:e.allTags})))}},_hiRezDetailRequests:{hrefs:{},forceNext:!1,delay:1e3},_cancelDetailImageBackgroundNextLoad:function(){this._hiRezDetailRequests.timeout&&(clearTimeout(this._hiRezDetailRequests.timeout),this._hiRezDetailRequests.timeout=null)},_resetHiRezDetailRequests:function(e){this._cancelDetailImageBackgroundNextLoad(),t.isUndefined(e)||(this._hiRezDetailRequests.forceNext=e)},_requestDetailImageBackground:function(e,t){this._cancelDetailImageBackgroundNextLoad(),!this._hiRezDetailRequests.delay||this._hiRezDetailRequests.forceNext||this._hiRezDetailRequests.hrefs[t]?(this._hiRezDetailRequests.forceNext=!1,this._hiRezDetailRequests.hrefs[t]=!0,e.css("background-image","url("+t+")")):(e.css("background-image","none"),this._hiRezDetailRequests.timeout=setTimeout(function(){this._hiRezDetailRequests.hrefs[t]=!0,e.css("background-image","url("+t+")")}.bind(this),this._hiRezDetailRequests.delay))},_setDetailImage:function(e,t,s,r){var i,a,l=e.height,o=e.width,n=s,h=t,c=this.isRetina();l>n?o>t?h/o>=n/l?(i="height",a=n):(i="width",a=h):(i="height",a=n):o>h?(i="width",a=t):(i="width",a=o);var d,u,g,m=a*(c?2:1),p=this._getRenditionUrl(e.templatedImgHref,m,i),f=r&&r.detailImage$||this.detailImage$,v=r&&r.loader$||this.$el.find(".search-results-grid-item-detail-image-holder").find(".search-results-grid-item-detail-loading");r&&(r.renditionInfo={href:p,dim:m,isRetina:c,dimType:i},r.resizer$&&("width"===i?(u=a,g=Math.round(e.height*u/e.width)):(g=a,u=Math.round(e.width*g/e.height)),g=Math.min(g,s),u=Math.min(u,t),r.resizer$.css("width",u+"px"),r.resizer$.css("height",g+"px"),r.matchImageHolderWitdh$.css("width",u+"px"),e.animationHref&&(d={href:e.animationHref,width:u,height:g})));if(e.preloadedRendition)v.css("background-image",'url("'+e.preloadedRendition.url+'")');else{var w=this.$el.find("#thumb_"+e.id);this._copyCss(w,v,["background-image"])}if(this.gridOptions.animationEnabled){var b=r.detailView$.find(".search-results-grid-item-detail-animation");d?(r.animation=d,b.attr("width",d.width),b.attr("height",d.height),b.find("source").attr("src",d.href),b[0].load(),this.gridOptions.autoPlayDetailAnimation&&this.SearchController.autoPlayVideo(b),b.removeClass("hide"),f.addClass("hide"),r.detailView$.addClass("has-ingredient-animation")):(r.animation=null,b.addClass("hide"),b.find("source").attr("src",""),f.removeClass("hide"),this._requestDetailImageBackground(f,p),r.detailView$.removeClass("has-ingredient-animation"))}else f.removeClass("hide"),this._requestDetailImageBackground(f,p)},_copyCss:function(e,s,r){t.each(r,(function(t){s.css(t,e.css(t))}))},_setAssetDetailTagsForTagFilters:function(e){t.each(e.allTags,function(e){var t=this.tagsData.tags[e.keyword];t?(e.isFilter=t.isFilter,e.isSearchTerm=t.isSearchTerm,e.isFilter?(e.selected=!0,e.hideTag=!1):(e.hideTag=t.isSearchTerm,e.selected=!1)):window.marvel.logger.debug("no srcTag match in _setAssetDetailTagsForTagFilters")}.bind(this))},_detailAssetSet:function(e){if(e.itemsViewed.byId[e.asset.id]||(e.itemsViewed.byId[e.asset.id]=e.asset,e.itemsViewed.total++),e.ctasForPremium){var s=e.asset.premium||e.asset.isPremiumTemplate;t.each(e.ctasForPremium,(function(e){var t=s&&e.settings.textIfAssetRequiresUpgrade||e.settings.text;e.elem$.text(t)}))}},_setDetailAsset:function(e,t){t=t||{},this._setAssetDetailTagsForTagFilters(e),t.analytics&&this.gridOptions.assetDetailShownCallback&&this.gridOptions.assetDetailShownCallback({asset:e,analytics:t.analytics}),this._detailInfo.selectedThumbItem$&&this._detailInfo.selectedThumbItem$.removeClass("selected"),this._detailInfo.selectedThumbItem$=this.detailView$.find("#other-results-item-"+e.id).addClass("selected"),this._detailInfo.asset=e,this._detailInfo.index=e._orderedIndex,this.gridOptions.allowPremiumTemplates&&(e.isPremiumTemplate?this.detailView$.addClass("is-premium-template"):this.detailView$.removeClass("is-premium-template")),this._setDetailImage(e,this._detailInfo.maxW,this._detailInfo.maxH),this._setDetailRightSide(e),this._setShareTemplateHtml(e),this._detailAssetSet(this._detailInfo),t.noScroll||this._scrollDetailAssetIntoView()},_redrawCurrentConfirm:function(){if(this._detailConfirmInfo&&this._detailConfirmInfo.showing){var e=t.assign({},this._detailConfirmInfo.currentOptions,{isRedraw:!0});this._setDetailConfirmAsset(this._detailConfirmInfo.asset,e)}},_getAssetLabel:function(e){return""},_setDetailConfirmAsset:function(e,t){t=t||this._detailConfirmInfo.currentOptions||{},this._detailConfirmInfo.currentOptions=t,this._detailConfirmInfo.asset=e,this._detailConfirmInfo.index=e._orderedIndex,this._detailConfirmInfo.resizer$.css("width","100%"),this._detailConfirmInfo.resizer$.css("height","100%");var s=this._detailConfirmInfo.resizer$.width(),r=s,i=this._detailConfirmInfo.resizer$.height();this._detailConfirmInfo.detailImageContainer$.width(s),this.gridOptions.allowPremiumTemplates&&(e.isPremiumTemplate?this._detailConfirmInfo.detailView$.addClass("is-premium-template has-premium-ingredient-fonts"):this._detailConfirmInfo.detailView$.removeClass("is-premium-template has-premium-ingredient-fonts")),this._detailConfirmInfo.remixCount$.text(h.formatMessage("search-results-confirm-num-remixes",{remixCount:e.remixCount}));var a=this._getAssetLabel(e);this._detailConfirmInfo.assetLabel$.html(a),this._setDetailImage(e,r,i,this._detailConfirmInfo),this._detailAssetSet(this._detailConfirmInfo)},closeDetailConfirm:function(e){this._resetHiRezDetailRequests(),this._detailConfirmInfo&&(this._detailConfirmInfo.buttons$.off("click",this._detailConfirmInfo.buttonClickFunc),this._detailConfirmInfo.showing=!1,this._detailConfirmInfo.overlay$.addClass("hide"),e&&(this._detailConfirmInfo.overlay$.empty(),this._detailConfirmInfo.emptied=!0),this._detailConfirmInfo.keyEventElem$&&(this._detailConfirmInfo.keyEventElem$.off("keydown.searchDetailConfirm, keyup.searchDetailConfirm",this._detailConfirmInfo.keyEventFunc),this._detailConfirmInfo.keyEventElem$=null))},_previewLocationToSparkFormat:function(e){return"editorPost"===e?"post":null},_trackConfirmEvent:function(e,s){var r="templateType:"+(this._detailConfirmInfo.asset.premium?"premium":"free"),i=this.gridOptions.animationEnabled&&"hasAnimation:"+(this._detailConfirmInfo.asset.animated?"true":"false"),a=this._detailConfirmInfo.previewLocation,o=this._detailConfirmInfo.analytics.context;"header"===o&&(o="search");var n={},h="previewLocation:"+a,c="tagNames:"+this.gridOptions.getTagNamesAnalyticValForAsset(this._detailConfirmInfo.asset),d=this._previewLocationToSparkFormat(a);if(d&&(n.sparkFormat=d),"templatePreviewClosed"===e){var u=this._detailConfirmInfo.asset.locales;t.assign(n,{contextualData2:h,contextualData3:"isNav:"+(this._detailConfirmInfo.asset!==s.originalAsset),templateId:this._detailConfirmInfo.asset.id,contextualData1:"numPreviewed:"+this._detailConfirmInfo.itemsViewed.total,contextualData4:r,contextualData6:c,contextualData7:"templateLocale:"+u}),i&&(n.contextualData10=i)}!this.searchAnalytics||"search"!==a&&"editorPost"!==a||(n.contextualData8="keyword:"+(this.searchAnalytics.searchTerm||""),n.contextualData9="tagFilters:["+this.searchAnalytics.tagFilters.join(",")+"]",this._detailConfirmInfo.asset.isRecommended?this._detailConfirmInfo.asset.isFakeRecommend?n.contextualData18="section:fakeRecommended":n.contextualData18="section:recommended":n.contextualData18="section:searchResults");var g=this._detailConfirmInfo.analytics[e];g&&(g.data&&t.assign(n,g.data),g.callback&&g.callback(n,s)),l.trackEvent(e,n,o)},showDetailConfirmForCurrentClickedThumb:function(s){var i,a,l,n=e(document.body).find(".search-results-grid-item-detail-confirm-overlay");n.length||(n=e('<div class="search-results-grid-item-detail-confirm-overlay search-results-grid-item-detail-confirm-button hide"></div>'),e(document.body).append(n)),s.gridlessOptions?(i=this.assets,this.assets=s.gridlessOptions.assets,a=this.searchAnalytics,this.searchAnalytics=s.gridlessOptions.searchAnalytics,s.gridlessOptions.gridOptions&&(this.gridOptions=s.gridlessOptions.gridOptions)):s.asset.isRecommended&&(l=this.assets,this.assets=this.recommendedAssets),s.analytics&&s.analytics.templatePreviewedClosed&&(s.analytics.templatePreviewClosed=s.analytics.templatePreviewedClosed),this._detailConfirmInfo={totalAssets:this.assets.length,canNav:s.showPreviewNav&&this.assets.length>1,assets:this.assets,maxW:600,maxH:600,closeDefer:r.defer(),overlay$:n,showing:!0,analytics:s.analytics,previewLocation:s.previewLocation,itemsViewed:{byId:{},total:0},premiumRequiresUpgrade:s.premiumRequiresUpgrade,ctasForPremium:s.ctasForPremium};var c=function(n,h){var c,u,g,m;if(n){var p=e(n.currentTarget),f=e(n.target).hasClass("search-results-grid-item-detail-confirm-overlay");if(p.hasClass("detail-close-button")||f)c="close";else if(p.hasClass("search-results-grid-item-detail-nav"))c="nav";else{if(!p.hasClass("search-results-grid-item-detail-confirm-cta"))return;c="cta";var v=p.data("id");u=t.find(s.ctas,(function(e){return e.id===v}))}n.preventDefault(),n.stopPropagation()}else if(h===o.DOM_VK_ESCAPE)c="close";else{if(h!==o.DOM_VK_RETURN)return;if(1!==s.ctas.length)return;c="cta",u=s.ctas[0]}if("close"===c)m={cancelled:!0,closeDefer:g=r.defer(),originalAsset:s.asset},this._trackConfirmEvent("templatePreviewClosed",m),this._detailConfirmInfo.closeDefer.resolve(m);else if("cta"===c){if(m={closeDefer:g=r.defer(),cta:u,asset:this._detailConfirmInfo.asset,originalAsset:s.asset,detailRenditionInfo:this._detailConfirmInfo.renditionInfo,showUpgradeForPremium:this.gridOptions.showUpgradeForPremium},d.numCheckboxes){var w=t.reduce(this._detailConfirmInfo.detailView$.find(":checkbox"),(function(e,t){return e[t.id]=t.checked,e}),{});m.checkboxValues=w}this._trackConfirmEvent("templatePreviewClosed",m),this._detailConfirmInfo.closeDefer.resolve(m)}else{if("nav"!==c)return;this.handleDetailNavClick(n,{isConfirm:!0})}g&&g.promise.then(function(){s.gridlessOptions?(this.assets=i,this.searchAnalytics=a):l&&(this.assets=l),this.closeDetailConfirm(!0)}.bind(this))}.bind(this);this._detailConfirmInfo.buttonClickFunc=c;var d=t.assign({},s);d.checkboxes&&d.checkboxes.length&&(d.numCheckboxes=d.checkboxes.length),s.stringsAreIds&&(d.title=h.getString(d.title),d.subtitle=h.getString(d.subtitle),t.each(d.ctas,(function(e){e.text=h.getString(e.text),e.textIfAssetRequiresUpgrade&&(e.textIfAssetRequiresUpgrade=h.getString(e.textIfAssetRequiresUpgrade))})),d.checkboxes&&t.each(d.checkboxes,(function(e){e.text=h.getString(e.text)}))),d.canNav=d.previewNavType&&this.assets.length>1,"side"===d.previewNavType?d.showPreviewNavSide=!0:"bottom"===d.previewNavType&&(d.showPreviewNavBototm=!0),this.gridOptions.animationEnabled&&(d.animationEnabled=!0,d.autoPlayDetailAnimation=this.gridOptions.autoPlayDetailAnimation);var u=h.mustacheRender(g,d);this._detailConfirmInfo.detailView$=e(u),this._detailConfirmInfo.remixCount$=this._detailConfirmInfo.detailView$.find(".search-results-detail-confirm-num-remixes"),this._detailConfirmInfo.assetLabel$=this._detailConfirmInfo.detailView$.find(".search-results-detail-confirm-asset-label"),s.premiumRequiresUpgrade&&s.ctasForPremium&&(this._detailConfirmInfo.ctasForPremium=t.reduce(s.ctasForPremium,function(e,t){var s=this._detailConfirmInfo.detailView$.find("[data-id="+t.id+"]");return s&&e.push({elem$:s,settings:t}),e}.bind(this),[])),this._detailConfirmInfo.detailImageContainer$=this._detailConfirmInfo.detailView$.find(".search-results-grid-item-detail-image-and-tags-holder");var m=this._detailConfirmInfo.detailImageContainer$.find(".search-results-grid-item-detail-image-holder");this._detailConfirmInfo.resizer$=m,this._detailConfirmInfo.matchImageHolderWitdh$=this._detailConfirmInfo.detailView$.find(".match-image-holder-width"),this._detailConfirmInfo.detailImage$=m.find(".search-results-grid-item-detail-image"),this._detailConfirmInfo.loader$=this._detailConfirmInfo.detailView$.find(".search-results-grid-item-detail-loading"),n.append(this._detailConfirmInfo.detailView$),n.removeClass("hide"),this._resetHiRezDetailRequests(!0),this._setDetailConfirmAsset(s.asset,s);var p=".search-results-grid-item-detail-confirm-button";this._detailConfirmInfo.buttons$=n.find(p).addBack(p),this._detailConfirmInfo.buttons$.on("click",c);var f=-1,v=[this._detailConfirmInfo.detailView$.find(".primary-cta"),this._detailConfirmInfo.detailView$.find(".detail-close-button"),this._detailConfirmInfo.detailView$.find(".search-results-grid-item-detail-nav-left"),this._detailConfirmInfo.detailView$.find(".search-results-grid-item-detail-nav-right")];return this._detailConfirmInfo.keyEventFunc=function(e){if(-1!==[o.DOM_VK_LEFT,o.DOM_VK_RIGHT,o.DOM_VK_ESCAPE,o.DOM_VK_RETURN,o.DOM_VK_TAB].indexOf(e.keyCode)){var t=!0;"keyup"===e.type?e.keyCode===o.DOM_VK_LEFT||e.keyCode===o.DOM_VK_RIGHT?this.handleDetailNavClick(null,{isConfirm:!0,domKey:e.keyCode}):e.keyCode===o.DOM_VK_ESCAPE?c(null,e.keyCode):e.keyCode===o.DOM_VK_RETURN?f||c(null,e.keyCode):e.keyCode===o.DOM_VK_TAB&&(e.shiftKey?--f<0&&(f=v.length-1):++f>v.length-1&&(f=0),v[f].focus()):"keydown"===e.type&&f&&e.keyCode===o.DOM_VK_RETURN&&(t=!1),t&&e.preventDefault()}}.bind(this),s.gridlessOptions&&(this._detailConfirmInfo.keyEventElem$=e(document),this._detailConfirmInfo.keyEventElem$.on("keydown.searchDetailConfirm, keyup.searchDetailConfirm",this._detailConfirmInfo.keyEventFunc)),this._detailConfirmInfo.closeDefer.promise},_showDetailViewForAsset:function(s,r,i){this._detailInfo={totalAssets:r.length,canNav:r.length>1,assets:r,maxW:1e3,maxH:1e3,itemsViewed:{byId:{},total:0}},this._showingDetail||(this.detailView$.addClass("revealing"),this.detailView$.removeClass("hide"),t.delay(function(){this.detailView$.removeClass("revealing")}.bind(this),0)),this._resetHiRezDetailRequests(!0),this._setDetailAsset(s,{noScroll:!0,analytics:i}),this._detailInfo.canNav?(this.detailView$.addClass("can-nav"),this._setupDetailResultsScroll({current:!0})):(this.detailView$.removeClass("can-nav"),this._setupDetailResultsScroll({reset:!0})),this._showingDetail=!0,this.tagClickedSinceChangingToGridDetail=!1,e(document.body).find(".vb-search-header").addClass("short-header")},closeDetail:function(){this._showingDetail=!1,this.detailView$.addClass("hide"),this._resetHiRezDetailRequests(),e(document.body).find(".vb-search-header").removeClass("short-header")},handleDetailNavClick:function(t,s){var r=(s=s||{}).isConfirm&&this._detailConfirmInfo||this._detailInfo,i=0,a=r.index;t?i="right"===e(t.currentTarget).data("id")?1:-1:s.domKey===o.DOM_VK_LEFT?i=-1:s.domKey===o.DOM_VK_RIGHT&&(i=1);if(i){(a=r.index+i)<0?a=r.totalAssets-1:a>=r.totalAssets&&(a=0);var l=r.assets[a];s.isConfirm?this._setDetailConfirmAsset(l):this._setDetailAsset(l,{analytics:{context:"from-results-detail-nav"}})}},handleDetailBackArrowClick:function(e){this.closeDetail()},handleDetailCtaClick:function(t){var s=e(t.currentTarget).data("cta-type");if("create"===s){var r={context:"item-detail-create",alias:this._detailInfo.asset.alias||this._detailInfo.asset.id};this.gridOptions.createFromThumbClickHandler(this._detailInfo.asset,{analytics:r,event:t,detailRenditionInfo:this._detailInfo.renditionInfo})}else"share"===s?this.handleShareTemplateButton(t):"favorite"===s&&this.handleFavoriteIconClick(t)},handleDetailResultNavClick:function(t){var s=e(t.currentTarget),r=this._getAssetFromClickTarget(s,".search-results-grid-item-detail-other-results-item");this._setDetailAsset(r,{analytics:{context:"from-results-detail-thumb"}})},_scrollDetailAssetIntoView:function(e){e=e||{};this._detailResultsScroll.resultsSection$[0].scrollWidth;var t,s,r=this._detailResultsScroll.scroller$.innerWidth(),i=(t=e.asset?this.detailView$.find("#other-results-item-"+e.asset.id):this._detailInfo.selectedThumbItem$).offset().left,a=this._detailResultsScroll.scroller$.scrollLeft();if(i<0)s=i;else{var l=i+t.outerWidth();l>r&&(s=l-r)}s&&this._detailResultsScroll.scroller$.scrollLeft(a+s)},_setupDetailResultsScroll:function(e){e=e||{};var t=this.$el.find(".search-results-grid-item-detail-other-results-section-scroller-holder"),s=t.find(".search-results-grid-item-detail-other-results-section-scroller"),r=s.find(".search-results-grid-item-detail-other-results-section");this._detailResultsScroll={scrollerHolder$:t,scroller$:s,resultsSection$:r},e.current?this._scrollDetailAssetIntoView():e.reset?this._detailResultsScroll.scroller$.scrollLeft(0):e.asset&&this._scrollDetailAssetIntoView(e)},handleShareTemplateButton:function(e){this._shareModal$.removeClass("hide"),this._shareModalMenu$.removeClass("hide")},handleShareTemplateCtaClick:function(t){t.preventDefault(),t.stopImmediatePropagation();var s=e(t.currentTarget).data("share-type");"twitter"===s?this.onTwitterShare():"facebook"===s?this.onFacebookShare():"email"===s?this.onEmailShare():"copy"===s&&this.onCopyShare()},handleShareModalCloseClick:function(e){e.preventDefault(),this.closeModal()},onCopyShare:function(){if(this._supportsClipboard){var e=this._shareModal$.find(".js-copy-link"),t=e.data("copy-url");try{i.copyStringToClipboard(t),e.addClass("copied"),e.one("mouseleave",function(t){t.target===t.currentTarget&&e.removeClass("copied"),this.closeModal()}.bind(this))}catch(s){}}},popup:function(e,t,s,r){var i=screen.width/2-s/2,a=screen.height/2-r/2;window.open(e,t,"width="+s+",height="+r+",left="+i+",top="+a+",scrollbars=no,status=0")},closeModal:function(e){this._shareModal$.addClass("hide")},onEmailShare:function(){window.location.href=this._shareModal$.find(".js-email").attr("href"),this.closeModal()},onTwitterShare:function(){var e=this._shareModal$.find(".js-twitter-share").attr("href");this.popup(e,h.getString("npw-vb-search-results-detail-share-modal-title-twitter"),680,500),this.closeModal()},onFacebookShare:function(){var e=this._shareModal$.find(".js-facebook-share").attr("href");this.popup(e,h.getString("npw-vb-search-results-detail-share-modal-title-fb"),680,500),this.closeModal()},_setShareTemplateHtml:function(e){var t="https://spark.adobe.com/"+e.app+"/"+(e.alias||e.id);this._supportsClipboard=i.isClipboardSupported();var s={twitterShareUrl:"https://twitter.com/intent/tweet?url="+encodeURIComponent(t)+"&via=AdobeSpark&hashtags=adobespark",facebookShareUrl:"https://www.facebook.com/sharer/sharer.php?u="+encodeURIComponent(t),mailtoString:this.getMailtoString(t,e),copyUrl:this._supportsClipboard&&t};this._extendDebugSettingsToTemplateSettings(s);var r=h.mustacheRender(f,s);this.share$=this.$el.find(".search-results-grid-item-detail-share"),this.share$.html(r),this._shareModal$=this.share$.find(".social-modal"),this._shareModalMenu$=this._shareModal$.find(".social-modal-menu")},getMailtoString:function(e,t){encodeURIComponent("\r\n\r\n");var s={format:n.getFormatInfo(t.app).type,url:e};return"mailto:"+h.formatMessage("npw-vb-search-results-detail-share-modal-mailto",s)}})}.apply(t,r))||(e.exports=i)},3530:function(e,t){e.exports='{{#detailData}}\n<div class="search-results-grid-item-detail-header">\n    <button class="npw-visual-browse-header-back-arrow grid-detail-header-back-arrow{{#detailBackArrowText}} has-text{{/detailBackArrowText}}" title="{{detailBackArrowText}}">{{detailBackArrowText}}</button>\n    <button class="search-results-grid-item-detail-header-create search-results-grid-item-detail-cta" data-cta-type="create">{{npw-vb-search-results-detail-create-btn}}</button>\n    <div class="search-results-grid-item-detail-header-ctas">\n        <div class="search-results-grid-item-detail-header-cta search-results-grid-item-detail-header-cta-share search-results-grid-item-detail-cta" data-cta-type="share">{{npw-vb-search-results-detail-share}}</div>\n        <div class="search-results-grid-item-detail-header-cta search-results-grid-item-detail-header-cta-favorite search-results-grid-item-detail-cta" data-cta-type="favorite"><span class="search-results-grid-item-detail-header-cta-favorite-is-not">{{npw-vb-search-results-detail-add-to-favorites}}</span><span class="search-results-grid-item-detail-header-cta-favorite-is">npw-vb-search-results-detail-favorited</span></div>\n    </div>\n</div>\n<div class="search-results-grid-item-detail-share"></div>\n<div class="search-results-grid-item-detail">\n    <div class="search-results-grid-item-detail-image-section">\n        <div class="search-results-grid-item-detail-nav search-results-grid-item-detail-nav-left" data-id="left">\n            <div class="search-results-grid-item-detail-nav-icon"></div>\n        </div>\n        <div class="search-results-grid-item-detail-image-and-tags-holder">\n            <div class="search-results-grid-item-detail-image-holder">\n                <div class="search-results-grid-item-thumb-premium-icon"></div>\n                <div class="search-results-grid-item-detail-loading"></div>\n                <div class="search-results-grid-item-detail-image"></div>\n            </div>\n            {{^detailsOnRight}}\n            <div class="search-results-grid-item-detail-tags">\n                {{#allTags}}\n                    {{^hideTag}}\n                    <div class="search-results-grid-item-detail-tag search-results-tag-button search-results-tag-prefix-{{prefix}}{{#selected}} selected{{/selected}} search-results-detail-tag-tag-{{id}} search-results-tag-tag-{{id}} {{debugCssStr}}" data-id="{{id}}">{{label}}</div>\n                    {{/hideTag}}\n                {{/allTags}}\n            </div>\n            {{/detailsOnRight}}\n        </div>\n        <div class="search-results-grid-item-detail-nav search-results-grid-item-detail-nav-right" data-id="right">\n            <div class="search-results-grid-item-detail-nav-icon"></div>\n        </div>\n    </div>\n    <div class="search-results-grid-item-detail-other-results-section-scroller-holder">\n        <div class="search-results-grid-item-detail-other-results-section-scroller">\n            <div class="search-results-grid-item-detail-other-results-section" style="width:{{detailAssetsData.totalWidth}};max-width:{{detailAssetsData.maxTotalWidth}};{{#detailAssetsData.minTotalWidth}}min-width:{{.}};{{/detailAssetsData.minTotalWidth}}">\n            {{#detailAssetsData}}\n            {{#assets}}\n                <div class="search-results-grid-item-detail-other-results-item{{#selected}} selected{{/selected}}{{#isFavorite}} is-favorite{{/isFavorite}}{{#isPremiumTemplate}} is-premium-template{{/isPremiumTemplate}}" data-premium="{{isPremiumTemplate}}" style="width:{{detailResultWidth}};" id="other-results-item-{{id}}" data-id="{{id}}">\n                    {{#favoritesEnabled}}\n                    <div class="search-results-grid-item-thumb-favorite-icon"></div>\n                    {{/favoritesEnabled}}\n                    {{#isPremiumTemplate}}\n                    <div class="search-results-grid-item-thumb-premium-icon"></div>\n                    {{/isPremiumTemplate}}\n                    <div class="search-results-grid-item-detail-other-results-item-thumb" style="width:100%;height:{{detailAssetsData.thumbHeight}};{{#detailAssetsData.minThumbHeight}}min-height:{{.}}{{/detailAssetsData.minThumbHeight}}" id="{{thumbId}}">\n                    <div class="search-results-grid-item-detail-other-results-item-thumb-loader">\n                    </div>\n                    </div>\n                    <div class="search-results-grid-item-detail-other-results-item-selection"></div>\n                    {{! not setting for now}}{{#showDetailThumbLabels}}{{#label}}<div class="search-results-grid-item-detail-other-results-item-label">{{.}}</div>{{/label}}{{/showDetailThumbLabels}}\n                </div>\n            {{/assets}}\n            {{/detailAssetsData}}\n            </div>\n        </div>\n    </div>\n</div>\n<div class="search-results-grid-item-detail-right">\n</div>\n{{/detailData}}\n'},3531:function(e,t){e.exports='<div class="search-results-grid-item-detail{{#canNav}} can-nav{{/canNav}}{{#cssClass}} {{.}}{{/cssClass}}" data-auto="search-results-detail-confirm">\n    <button class="detail-close-button search-results-grid-item-detail-confirm-button" data-auto="search-results-detail-confirm-close-btn"></button>\n    <div class="search-results-grid-item-detail-image-section{{#previewNavType}} show-preview-nav show-preview-nav-{{previewNavType}}{{/previewNavType}}">\n        {{#showPreviewNavSide}}\n        <button class="search-results-grid-item-detail-nav search-results-grid-item-detail-nav-left search-results-grid-item-detail-confirm-button" data-id="left">\n            <div class="search-results-grid-item-detail-nav-icon"></div>\n        </button>\n        {{/showPreviewNavSide}}\n        <div class="search-results-grid-item-detail-image-and-tags-holder">\n            {{#isVertical}}\n            <div class="search-results-detail-confirm-asset-label"></div>\n            {{/isVertical}}\n            <div class="search-results-grid-item-detail-image-holder">\n                <div class="search-results-grid-item-thumb-premium-icon hide-if-not-premium{{#premiumTemplateBadge}} {{.}}{{/premiumTemplateBadge}}"></div>\n                <div class="search-results-grid-item-detail-loading"></div>\n                <div class="search-results-grid-item-detail-image"></div>\n                {{#animationEnabled}}\n                    {{#autoPlayDetailAnimation}}\n                        <video class="search-results-grid-item-detail-animation hide" autoplay loop>\n                            <source src="" type="video/mp4">\n                        </video>\n                    {{/autoPlayDetailAnimation}}\n                    {{^autoPlayDetailAnimation}}\n                        <video class="search-results-grid-item-detail-animation hide" controls>\n                            <source src="" type="video/mp4">\n                        </video>\n                    {{/autoPlayDetailAnimation}}\n                {{/animationEnabled}}\n            </div>\n            {{#isVertical}}\n            <div class="search-results-detail-confirm-premium-and-num-remixes match-image-holder-width">\n                <div class="search-results-grid-item-detail-premium-blurbs">\n                    <div class="search-results-grid-item-detail-premium-blurb search-results-grid-item-detail-premium-template hide-if-not-premium{{#premiumTemplateBadge}} {{.}}{{/premiumTemplateBadge}}">{{search-results-confirm-premium-template}}</div>\n                    <div class="hide search-results-grid-item-detail-premium-blurb search-results-grid-item-detail-premium-blurb-fonts show-if-premium-ingredient-fonts">{{search-results-confirm-made-width-adobe-fonts}}</div>\n                </div>\n                <div class="search-results-detail-confirm-num-remixes"></div>\n            </div>\n            {{/isVertical}}\n        </div>\n        {{#showPreviewNavSide}}\n        <button class="search-results-grid-item-detail-nav search-results-grid-item-detail-nav-right search-results-grid-item-detail-confirm-button" data-id="right">\n            <div class="search-results-grid-item-detail-nav-icon"></div>\n        </button>\n        {{/showPreviewNavSide}}\n        {{#showPreviewNavBottom}}\n        <div class="search-results-grid-item-detail-preview-nav">\n            <button class="search-results-grid-item-detail-nav search-results-grid-item-detail-nav-left  search-results-grid-item-detail-confirm-button" data-id="left">\n                <div class="search-results-grid-item-detail-nav-icon"></div>\n            </button>\n            <button class="search-results-grid-item-detail-nav search-results-grid-item-detail-nav-right  search-results-grid-item-detail-confirm-button" data-id="right">\n                <div class="search-results-grid-item-detail-nav-icon"></div>\n            </button>\n        </div>\n        {{/showPreviewNavBottom}}\n    </div>\n    <div class="search-results-grid-item-detail-confirm-right">\n        {{^isVertical}}\n        <div class="search-results-grid-item-detail-premium-blurbs">\n            <div class="search-results-grid-item-detail-premium-blurb search-results-grid-item-detail-premium-template hide-if-not-premium{{#premiumTemplateBadge}} {{.}}{{/premiumTemplateBadge}}">{{search-results-confirm-premium-template}}</div>\n            <div class="hide search-results-grid-item-detail-premium-blurb search-results-grid-item-detail-premium-blurb-fonts show-if-premium-ingredient-fonts">{{search-results-confirm-made-width-adobe-fonts}}</div>\n        </div>\n        {{/isVertical}}\n        <div class="search-results-grid-item-detail-message-and-ctas">\n            {{#title}}\n            <h2 class="search-results-grid-item-detail-confirm-title">{{title}}</h2>\n            {{/title}}\n            {{#subtitle}}\n            <h3 class="search-results-grid-item-detail-confirm-subtitle">{{{subtitle}}}</h3>\n            {{/subtitle}}\n            {{#numCheckboxes}}\n            {{#checkboxes}}\n            <label class="spectrum-Checkbox">\n                {{#checked}}\n                <input type="checkbox" class="spectrum-Checkbox-input" name="{{id}}" id="{{id}}" data-auto="search-results-detail-confirm-checkbox-{{id}}" checked>\n                {{/checked}}\n                {{^checked}}\n                <input type="checkbox" class="spectrum-Checkbox-input" name="{{id}}" id="{{id}}" data-auto="search-results-detail-confirm-checkbox-{{id}}">\n                {{/checked}}\n                <span class="spectrum-Checkbox-box-holder">\n                <span class="spectrum-Checkbox-box-border"></span>\n                <span class="spectrum-Checkbox-box-check"></span>\n                </span>\n                <span class="spectrum-Checkbox-label">{{text}}</span>\n            </label>\n            {{/checkboxes}}\n            {{/numCheckboxes}}\n            <div class="search-results-grid-item-detail-confirm-ctas">\n            {{#ctas}}\n                <button class="search-results-grid-item-detail-confirm-cta {{#primary}} primary-cta{{/primary}} search-results-grid-item-detail-confirm-button" data-id="{{id}}" data-auto="search-results-detail-confirm-cta-{{id}}">{{text}}</button>\n            {{/ctas}}\n            </div>\n        </div>\n    </div>\n</div>\n'},3532:function(e,t){e.exports='<div class="search-results-grid-item-detail-right-ctas">\n    <div class="search-results-grid-item-detail-right-cta search-results-grid-item-detail-cta" data-cta-type="create">Create a {{appLabel}} like this</div>\n\n    <div class="search-results-grid-item-detail-share">\n    </div>\n</div>\n<div class="search-results-grid-item-detail-right-tags">\n    {{#allTags}}\n        <div class="search-results-grid-item-detail-right-tag search-results-tag-button search-results-tag-prefix-{{prefix}}{{#selected}} selected{{/selected}} search-results-tag-tag-{{id}} {{debugCssStr}}" data-id="{{id}}">{{label}}</div>\n    {{/allTags}}\n</div>'},3533:function(e,t){e.exports='<div class="search-results-grid-view{{#favoritesEnabled}} favorites-enabled{{/favoritesEnabled}}" data-auto="search-reults-grid-view">\n{{#tagsAboveResults}}\n<div class="search-results-tags{{#atMaxSelectedTags}} at-max-tags{{/atMaxSelectedTags}}" data-auto="search-results-grid-view-tags">\n    {{#tags}}\n    <button class="search-results-tag search-results-tag-button search-results-tag-prefix-{{prefix}}{{#selected}} selected{{/selected}} search-results-tag-tag-{{id}}{{#customFilterType}} ignore-at-max-tags{{/customFilterType}} {{debugCssStr}}" title="{{title}}" data-id="{{id}}" data-src-key="{{srcKey}}" data-index="{{index}}">{{label}}</button>\n    {{/tags}}\n</div>\n{{/tagsAboveResults}}\n<div class="search-results-grid-item-detail-holder hide">\n    {{ > itemDetail}}\n</div>\n<div class="search-results-grid-holder">\n    <div class="search-results-grid{{#favoritesEnabled}} favorites-enabled{{/favoritesEnabled}}" style="max-width:{{maxRowWidth}}">\n    {{{assetsStyles}}}\n    {{#rows}}\n    {{#recommendedRow}}\n        <h1 class="recommended-row-header">{{title}}</h1>\n    {{/recommendedRow}}\n    <div class="search-results-grid-row{{#isCarousel}} is-carousel-row {{/isCarousel}}{{#partialRow}} {{partialRow}}{{/partialRow}}{{#delayAllAssets}} hide-assets{{/delayAllAssets}}" style="{{#rowVSpace}}margin-top:{{rowVSpace}}px;{{/rowVSpace}}" data-auto="search-results-grid-view-row" data-index="{{index}}">\n        {{#assets}}\n            <button class="search-results-grid-item search-results-grid-item-{{type}}{{#isPremiumTemplate}} is-premium-template{{/isPremiumTemplate}}{{#isFavorite}} is-favorite{{/isFavorite}}{{#animation}} has-animation{{/animation}}{{#hideUntilLoaded}} not-loaded{{/hideUntilLoaded}}{{#hadLoadError}} had-load-error{{/hadLoadError}}{{#implicitCreateCta}} implicit-create-cta{{/implicitCreateCta}}{{#isEdge}} is-edge{{/isEdge}}{{#isIE}} is-IE{{/isIE}}" style="{{#marginRight}}margin-right:{{marginRight}};{{/marginRight}}" id="{{id}}" data-tags="{{tagsForData}}" data-id="{{id}}" data-is-recommended="{{isRecommended}}" data-cta="{{#implicitCreateCta}}create{{/implicitCreateCta}}"  data-cta-item-id="{{#implicitCreateCta}}{{ctaItemId}}{{/implicitCreateCta}}" data-premium="{{isPremiumTemplate}}" data-auto="search-results-grid-item" data-index-in-row="{{indexInRow}}">                <div class="search-results-grid-item-thumb-bg-load" style="width:{{bgLoadWidth}};height:{{bgLoadHeight}}"></div>\n                <div class="search-results-grid-item-thumb" id="{{thumbId}}">\n                    {{#favoritesEnabled}}\n                    <div class="search-results-grid-item-thumb-favorite-icon"></div>\n                    {{/favoritesEnabled}}\n                    {{#isPremiumTemplate}}\n                    <div class="search-results-grid-item-thumb-premium-icon{{#premiumTemplateBadge}} {{.}}{{/premiumTemplateBadge}}"></div>\n                    {{/isPremiumTemplate}}\n                    {{#animation}}\n                    <div class="search-results-grid-item-thumb-animation-icon"></div>\n                    <video class="search-results-grid-item-thumb-animation hide" height="{{height}}" width="{{width}}" loop>\n                    {{#preloadAllResultMp4s}}\n                    <source src="{{{href}}}" type="video/mp4">\n                    {{/preloadAllResultMp4s}}\n                    {{^preloadAllResultMp4s}}\n                    <source src="" data-src="{{{href}}}" type="video/mp4">\n                    {{/preloadAllResultMp4s}}\n                    </video>\n                    {{/animation}}\n                    <div class="search-results-grid-item-thumb-icon"></div>\n                    <div class="search-results-grid-item-hover-thang{{#isEdge}} is-edge{{/isEdge}}{{#isIE}} is-IE{{/isIE}}">\n                        <div class="search-results-grid-item-hover-thang-background"></div>\n                        {{#hoverCtas.numCtas}}\n                        <div class="search-results-grid-item-hover-ctas">\n                            {{#hoverCtas.ctas}}\n                            <div class="search-results-grid-item-hover-cta search-results-grid-item-hover-cta-{{id}}" data-id="{{id}}"></div>\n                            {{/hoverCtas.ctas}}\n                        </div>\n                        {{/hoverCtas.numCtas}}\n                        {{^implicitCreateCta}}\n                        <div class="search-results-grid-main-cta search-results-grid-main-cta-create" data-analytics-id="thumb-hover-create" data-auto="search-result-item-cta-create" data-cta="create" data-cta-item-id="{{ctaItemId}}">{{uiStrings.resultItemCreateFrom}}</div>\n                        {{/implicitCreateCta}}\n                        <div class="search-results-grid-item-hover-tags {{debugCssStr}}">\n                        {{#debugCssStr}}\n                        <div class="search-results-grid-item-hover-id {{debugCssStr}}" data-id="{{id}}">{{id}}</div>\n                        <div class="search-results-grid-item-hover-size {{debugCssStr}}">{{assetW}}x{{assetH}}({{assetAspectRatio}})</div>\n                        {{#score}}\n                        <div class="search-results-grid-item-hover-score {{debugCssStr}}">{{score}}</div>\n                        {{/score}}\n                        {{/debugCssStr}}\n                        {{#allTags}}\n                        <div class="search-results-grid-item-hover-tag search-results-tag-button search-results-tag-prefix-{{prefix}}{{#selected}} selected{{/selected}} search-results-tag-tag-{{id}} {{debugCssStr}}" title="{{#debugCssStr}}{{prefix}}{{/debugCssStr}}" data-id="{{id}}">{{label}}</div>\n                        {{/allTags}}\n                        </div>\n                    </div>\n                </div>\n                {{#label}}\n                <div class="search-results-grid-item-label {{debugCssStr}}">{{.}}</div>\n                {{/label}}\n            </button>\n        {{/assets}}\n    </div>\n    {{#recommendedRow}}\n        <h1 class="recommended-row-footer">{{searchResultsTitle}}</h1>\n    {{/recommendedRow}}\n    {{/rows}}\n    </div>\n    {{#pagination}}\n    <div class="search-results-pagination{{#hasMore}} has-more{{/hasMore}}">\n        <div class="search-results-pagination-pages-info">{{^total}}{{#fm}}npw-vb-search-results-pagination-none{{/fm}}{{/total}}{{#total}}{{#fm}}npw-vb-search-results-pagination-some{{/fm}}{{/total}}</div>\n\n        <button class="search-results-pagination-more load-more-toggle">{{npw-vb-search-results-see-more}}</button>\n\n    </div>\n    {{/pagination}}\n</div>\n</div>\n'},3534:function(e,t){e.exports='<div class="social-modal js-share-modal social-overlay-bg hide">\n            <div class="social-modal-bg">\n                <button class="x-close-btn js-close-modal">X</button>\n                <div class="social-modal-header">{{npw-vb-search-results-detail-share-modal-title}}</div>\n                <div class="social-modal-menu hide js-social-modal-menu">\n                    <div href="{{{ twitterShareUrl }}}" target="_blank" data-share-type="twitter" class="social-line twitter js-twitter-share">{{npw-vb-search-results-detail-share-modal-btn-tweet}}</div>\n                    <div href="{{{ facebookShareUrl }}}" target="_blank" data-share-type="facebook" class="social-line facebook js-facebook-share">{{npw-vb-search-results-detail-share-modal-btn-fb}}</div>\n\n                    <div href="{{ mailtoString }}" target="_blank" data-share-type="email" class="social-line email js-email">{{npw-vb-search-results-detail-share-modal-btn-email}}</div>\n                    {{#copyUrl}}\n                    <div class="social-line copy js-copy-link" data-copy-url="{{.}}"" data-share-type="copy"><span class="copy-span">{{npw-vb-search-results-detail-share-modal-btn-copy-link}}</span><span class="copied-span">{{npw-vb-search-results-detail-share-modal-link-copied}}</span></div>\n                    {{/copyUrl}}\n                </div>\n            </div>\n        </div>\n'},3535:function(e,t,s){var r,i;r=[s(7),s(2),s(1),s(6),s(95),s(14)],void 0===(i=function(e,t,s,r,i,a){"use strict";var l={};return r.Model.extend({initialize:function(e){e=e||{},l={},this.MAX_TEMPLATE_SEARCH_STRING_LENGTH=e.MAX_TEMPLATE_SEARCH_STRING_LENGTH,this.MAX_TEMPLATE_SEARCH_TERMS=e.MAX_TEMPLATE_SEARCH_TERMS,this.MAX_SUGGEST_IF_FILTERS=3,this.MAX_RESULTS_CACHE_TIME=e.MAX_RESULTS_CACHE_TIME||72e5,this.FALLBACK_NUM_TEMPLATES_IF_INIT_ERROR=25e3,l[e.REMIX_PAID_MAP_TAG]={tag:e.REMIX_PAID_MAP_TAG,dflt:"hide"},l[e.GIPHY_TAG]={tag:e.GIPHY_TAG,dflt:"hide"},this._cachedResults=window._cachedSearchSuggestControllerResults||{},window._cachedSearchSuggestControllerResults||(window._cachedSearchSuggestControllerResults=this._cachedResults),this._setupFilters(),this.searchServiceSuggestOptions=t.assign({},e.searchServiceSuggestOptions),this.SearchRequestsController=e.SearchRequestsController,this._initMostCommonAggs(this.searchServiceSuggestOptions.optionsForAllQuery).done()},suggestAggsOnSpace:function(){return this.searchServiceSuggestOptions.suggestAggsOnSpace},_setupFilters:function(e){this._specialTagFilters=e&&e.specialTagFilters||l,t.each(this._specialTagFilters,(function(e){e.key=e.tag.split("-")[1]}))},_suggestedTagPrefixOrder:["spterm","spstyle","spcolor","spsize","spcase","explore","spingred","spinfluencer","spcollect","spmap"],_tagPrefixLabels:{explore:{singular:"category",plural:"categories"},spcase:{singluar:"use case",plural:"use cases"},spterm:{singular:"term",plural:"terms"},spstyle:{singular:"style",plural:"styles"},spcolor:{singular:"color",plural:"colors"},spsize:{singular:"size",plural:"sizes"},spmap:{singlar:"map",plural:"maps"},spingred:{singular:"ingredient",plural:"ingredients"},spinfluencer:{singular:"influencer",plural:"influencers"},spcollect:{singular:"collection",plural:"collections"},sploc:{singluar:"locale",plural:"locales"},all:{singular:"tag",plural:"tags"}},_getGroupedTagLinesForService:function(e){var s=e.prefix,r=e.aggs,i=r&&r.length&&r[0],a=i&&i.tagsInOrder,l=" "+s.toLowerCase()+" ";if(!a)return[];var o={},n=[];return t.each(a,function(t){var s,r;if(e.useKeys)t.label||window.marvel.logger.debug("[SearchSuggestController]no tabel for tag",t),s=t.label||t.keyword,r="all";else{var i=t.split("-");r=i[0],s=i[1]}var a=o[r];a||(a={prefix:r,groupId:r,id:r,keywordsById:{},items:[],label:this._tagPrefixLabels[r],isAddText:!0,numMoreItems:0},o[r]=a,n.push(a));var h=a.keywordsById[s];h||-1===l.indexOf(" "+s.toLowerCase()+" ")&&(h={id:s,label:s,count:t.numAssets},e.useKeys?(e.debug&&(h.itemTitle=t.tags.slice(0).sort().join(",")),h.key=s):h.tag=t,h.srcKey=t.srcKey||t.key,a.keywordsById[s]=h,a.items.push(h))}.bind(this)),n.sort(function(e,t){return this._suggestedTagPrefixOrder.indexOf(e.prefix)-this._suggestedTagPrefixOrder.indexOf(t.prefix)}.bind(this)),t.each(n,function(s){s.items.sort((function(e,t){return t.count-e.count})),e.maxItemsToDisplayInGroup&&s.items.length>e.maxItemsToDisplayInGroup&&(s.numMoreItems=s.items.length-e.maxItemsToDisplayInGroup,t.each(s.items.slice(e.maxItemsToDisplayInGroup),(function(e){e.ifShowingAll=!0})))}.bind(this)),n},_getNewTagGroup:function(e,t){return t=t||{},{prefix:e,groupId:e,id:e,items:[],label:this._tagPrefixLabels[e],numMoreItems:0,maxNumSelectedTags:t.maxNumSelectedTags||0,maxKeywordFiltersToDisplay:t.maxKeywordFiltersToDisplay||0,atMaxTags:!1,numMaxTagsSelected:0}},_applyMaxKewywordFiltersToDisplayForGroup:function(e,s){e.maxKeywordFiltersToDisplay&&(e.numMoreItems=0,t.each(e.items,(function(t,r){s&&(t.selected=!1),r<e.maxKeywordFiltersToDisplay?t.ifShowingAll=!1:(t.ifShowingAll=!0,e.numMoreItems++)})))},getSelectedTagsForNoResults:function(e,s){if(s){var r=!1;if(e&&e.length){var i=[],a=[],l={},o=0;t.each(e,(function(e){l[e.label]=!0})),t.each(s.items,(function(e){e.selected=!!l[e.label],e.selected?(a.push(e),e.customFilterType||o++):i.push(e)})),s.items=a.concat(i),s.numSelected=a.length,s.maxNumSelectedTags&&(s.numMaxTagsSelected=o)}else r=!0,s.numSelected=0,s.numMaxTagsSelected=0,s.atMaxTags=!1;return this._applyMaxKewywordFiltersToDisplayForGroup(s,r),s}return this._getTagLinesForSelectedTags({tagFilters:e})},_getTagLinesForSelectedTags:function(e,s){var r,i=s&&s.tagsInOrder&&s.tagsInOrder.length&&s.tagsInOrder,a=e.tagFilters&&e.tagFilters.length&&e.tagFilters;if(i&&!e.showOnlySelectedKeywordFilters||a){r=this._getNewTagGroup("all",e);var l={};if(a){var o=0;t.each(a,(function(s){var i=s.label||s.keyword,a={aggTag:s,label:i,id:i,srcKey:s.srcKey,count:s.numAssets,selected:!0,tags:s.tags&&t.clone(s.tags).sort().join(",")||"",customFilterType:s.customFilterType};e.debug&&(a.itemTitle=a.tags),s.customFilterType||o++,r.items.push(a),l[a.label]=a})),r.numSelected=r.items.length,r.atMaxTags=r.maxNumSelectedTags>0&&o>=r.maxNumSelectedTags,r.numMaxTagsSelected=o}i&&!e.showOnlySelectedKeywordFilters&&(!e.maxKeywordFilters||r.items.length<e.maxKeywordFilters)&&t.find(i,(function(s){var i=s.label;if(!l[i]){l[i]=s;var a={label:i,id:i,count:s.numAssets,aggTag:s,tags:s.tags&&t.clone(s.tags).sort().join(",")||"",srcKey:s.srcKey||i,customFilterType:s.customFilterType};if(e.debug&&(a.itemTitle=a.tags),e.maxKeywordFiltersToDisplay&&r.items.length>=e.maxKeywordFiltersToDisplay&&(a.ifShowingAll=!0,r.numMoreItems++),r.items.push(a),e.maxKeywordFilters&&r.items.length>=e.maxKeywordFilters)return!0}}))}return r},_textLinesFromData:function(e,s){if(!s)return[];var r=[],i=s.toLowerCase();return t.each(e,(function(e,t){var a,l=s,o=e.str,n=o.toLowerCase(),h={chunks:[],key:o};if(n!==i&&(n.startsWith(i)?a=o.substring(s.length):(l="",a=o)),l){var c=s;s.split(" ");h.chunks.push({src:c})}a&&h.chunks.push({hint:a});var d={keysArray:[o.split(" | ").join(" ")],displayArray:[h],totalCount:e.numAssets,srcObj:e};r.push(d)})),r},_recalcNumberOfSplitLines:function(e,t,s){if(e.textLines.length+e.suggestionLines.length>t)if(e.suggestionLines.length<s){var r=t-e.suggestionLines.length;r<e.textLines.length&&(e.textLines=e.textLines.slice(0,r))}else if(t-e.textLines.length>s){var i=t-e.textLines.length;e.suggestionLines=e.suggestionLines.slice(0,i)}else{var a=Math.min(t-s);e.suggestionLines=e.suggestionLines.slice(0,s),e.textLines=e.textLines.slice(0,a)}},_cachedResults:{},_getCachedInfoForOptions:function(e,s){var r=s.cacheId,i=s.tagFilters&&s.tagFilters.length&&s.tagFilters;if(r||(e?r=e:i||(r="_all")),r){var a={cacheId:r},l=this._cachedResults[r];return l&&Date.now()-l.timeStamp<this.MAX_RESULTS_CACHE_TIME&&(a.result=t.cloneDeep(l.result)),a}return{ignore:!0}},_cacheAResult:function(e,s){e.cacheId&&(this._cachedResults[e.cacheId]={result:t.cloneDeep(s),timeStamp:Date.now()})},_getAggsFromResultsTags:function(e,t){var s=this.SearchRequestsController.appendFragStringEmptyAggsToArray([],e,0);return s[0].tagsInOrder=t,s},_getMostCommonAggs:function(e,t){var r=this._getCachedInfoForOptions("",{cacheId:"_allCommonAggs"});if(r.result)return r.result[0].str=e[0],r.result=this.SearchRequestsController.appendFragStringEmptyAggsToArray(r.result,e,1),s(r.result);var i=[];this.searchServiceSuggestOptions.allowPremiumTemplates&&i.push("premium"),this.searchServiceSuggestOptions.animationEnabled&&i.push("animated");var a={tagFilters:null,calcAggsForAllFragments:!0,prepends:i,includeEnglishIfNonEnglish:!0};return this.SearchRequestsController.doAggregatesFromFragmentsQuery([""],a).then(function(t){return this._cacheAResult(r,t),t[0].str=e[0],t=this.SearchRequestsController.appendFragStringEmptyAggsToArray(t,e,1)}.bind(this))},getTotalTemplatesCount:function(){return this._initMostCommonAggsDefer.promise.then(function(e){var t=e&&e[0];return t&&t.totalResults||this.FALLBACK_NUM_TEMPLATES_IF_INIT_ERROR}.bind(this),function(){return this.FALLBACK_NUM_TEMPLATES_IF_INIT_ERROR}.bind(this))},_initMostCommonAggs:function(e){return this._initMostCommonAggsDefer||(this._initMostCommonAggsDefer=s.defer(),this._getMostCommonAggs([""],e).then(function(e){this._initMostCommonAggsDefer.resolve(e)}.bind(this),function(e){window.marvel.logger.warn("[SearchSuggestController] Error getting common aggs in _initMostCommonAggs",e&&e.responseJSON||e),this._initMostCommonAggsDefer.reject(e)}.bind(this))),this._initMostCommonAggsDefer.promise},_getCpPrefixDataFromService:function(e,r){var i=e.prefix,a=1*e.preferredNumSuggestedResults||5,l=1*e.maxTotalResultLinesToDisplay||8,o=e.lastSearchResults&&e.lastSearchResults.tagsData;l<a&&(a=l),i&&(i=this.SearchRequestsController.cleanUserString(i.replace(/  +/g," ").trim())).length>this.MAX_TEMPLATE_SEARCH_STRING_LENGTH&&(i=i.substring(0,this.MAX_TEMPLATE_SEARCH_STRING_LENGTH));var n=this._getCachedInfoForOptions(i,e),h=s.defer(),c=s.defer(),d=this.searchServiceSuggestOptions.numFragmentsToRequest,u=this.searchServiceSuggestOptions.calcAggsForAllFragments;if(n.result)c.resolve(n.result);else if(i){var g,m,p=i,f=i.split(" ");f.length>1&&(this.searchServiceSuggestOptions.multiWordBabel?g=!0:(p=f.pop(),m=f.join(" ")+" "));var v={prefix:p,numFragmentsToRequest:d};this._getSingleFragmentResults(v).then(function(e){if(e.length>0||!g)if(m){var s=t.map(e,(function(e){return m+e}));c.resolve(s)}else c.resolve(e);else v.prefix=f.pop(),this._getSingleFragmentResults(v).then((function(e){if(e.length){m=f.join(" ")+" ";var s=t.map(e,(function(e){return m+e}));c.resolve(s)}else c.resolve(e)})).catch((function(e){c.resolve({err:e})}))}.bind(this)).catch((function(e){c.resolve({err:e})}))}else c.resolve([]);return c.promise.then(function(r){r.err?r=[i]:n.result||this._cacheAResult(n,r);var c,d={},g=e.tagFilters,m=o&&o.tagsInOrder.length&&o.tagsInOrder;r.length||(r=[i]),(this.searchServiceSuggestOptions.updateKeysForUserStringUpdate||e.spaceAggsRecalc)&&(c=!0);var p,f={tagFilters:g,calcAggsForAllFragments:u,includeEnglishIfNonEnglish:!0};if(c){var v=s.defer();p=v.promise,this.SearchRequestsController.doAggregatesFromFragmentsQuery(r,f).then((function(e){v.resolve(e)}),function(t){m?v.resolve(this._getAggsFromResultsTags(r,m)):this._getMostCommonAggs(r,e,f).then((function(e){v.resolve(e)}),(function(){v.reject(t)}))}.bind(this))}else p=m?s(this._getAggsFromResultsTags(r,m)):this._getMostCommonAggs(r,e,f);p.then(function(s){if(e.spaceAggsRecalc&&m){var o=this._getAggsFromResultsTags(r,m);d.selectedTags=this._getTagLinesForSelectedTags(e,o[0])}else d.selectedTags=this._getTagLinesForSelectedTags(e,s[0]);var n=[],c=[];t.each(s,(function(e){var t={str:e.str,numAssets:e.totalResults};t.numAssets&&n.push(t)})),c.sort((function(e,t){return t.numAssets-e.numAssets})),d.splitLinesData={textLines:this._textLinesFromData(n,i),suggestionLines:this._textLinesFromData(c,i)},d.tagLinesGroups=this._getGroupedTagLinesForService({prefix:i,aggs:s,useKeys:!0,maxItemsToDisplayInGroup:e.maxItemsToDisplayInGroup,debug:e.debug}),e.tagFilters&&(d.srcTagFilters=t.cloneDeep(e.tagFilters)),this._recalcNumberOfSplitLines(d.splitLinesData,l,a),h.resolve(d)}.bind(this),(function(e){h.reject(e)}))}.bind(this)).done(),h.promise},_allowedFilterSettings:["hide","only","allow","ignore"],_specialTagFilters:l,remove:function(){},_getSingleFragmentResults:function(r){var a=s.defer(),l={locale:this.searchServiceSuggestOptions.locale,prefix:r.prefix,limit:r.numFragmentsToRequest},o=i.format({protocol:"https",host:this.searchServiceSuggestOptions.host,pathname:this.searchServiceSuggestOptions.pathPrefix,query:l});return e.ajax({type:"GET",url:o,headers:{"X-Api-Key":this.searchServiceSuggestOptions.apiKey,Accept:"application/hal+json"},success:function(e,s,r){e.length&&(e=t.uniqBy(e,(function(e){return e.toLowerCase()}))),a.resolve(e)}.bind(this),error:function(e,t,s){window.marvel.logger.error("[SearchSuggestController] Errored out while attempting to get suggestion: ["+e.status+"]",e.responseJSON||e.responseText||s),a.reject(e)}.bind(this)}),a.promise},getCpPrefixData:function(e,t){return this._getCpPrefixDataFromService(e,t)}})}.apply(t,r))||(e.exports=i)},684:function(e,t,s){var r,i;r=[s(7),s(2),s(1),s(6),s(14),s(25),s(11),s(23),s(287),s(5),s(0),s(47),s(45),s(67),s(95),s(627),s(1384)],void 0===(i=function(e,t,r,i,a,l,o,n,h,c,d,u,g,m,p,f,v){"use strict";var w=g.default,b=new c.default({color:"green",name:"SearchController"}),_=["visualBrowse","projects","home","branding"],y=d.cpTemplateSearchRemixFeedTag,x=d.cpTemplateSearchRemixPaidTag,S=d.cpTemplateSearchMappedTagRemixPaid,k={default:a.getString("npw-vb-back-to-default"),projects:a.getString("npw-vb-back-to-organizer"),branding:a.getString("npw-vb-back-to-branding"),visualBrowse:a.getString("npw-vb-back-to-visual-browse"),searchResults:a.getString("npw-vb-back-to-results"),home:a.getString("npw-vb-back-to-home"),learn:a.getString("npw-vb-back-to-learn")},T={projects:"projects",branding:"branding",learn:"learn",home:""},C={"cy-GB":"en-US"};return new(i.Model.extend({initialize:function(){t.defer(function(){o.isValid().then(this._initSearchRequires.bind(this),(function(){})).done()}.bind(this)),t.bindAll(this,["handleCreateFromHomeTemplateThumb","handleHomeCreateFromScratch"])},_searchViews:{},_searchViewsPreviousInstancesData:{},_findTagsWithPrefix:function(e,s,r){return t.reduce(e,(function(e,t){var i=t.split(s+"-");return""===i[0]&&(r?e.push(i.slice(1)).join("-"):e.push(t)),e}),[])},_seoPageToSearch:{"photo-collage-maker":{keys:"collage"}},setupUrlSearchFromRemixMetadataAndOrSeoPageOrQuery:function(e){if((e=e||{}).query)return this.setupUrlSearchFromArgs(e.query);var s,r,i,a=e.seoPage,l=e.searchRemixMetadata;if(a){if("templates"===a.type||"make"===a.type){var o=a.id.split(":").join("_");i=a.id.split(":"),"templates"===a.type?(i=a.id.split(":"),v.isPlural(i[0])&&(i[0]=v.singular(i[0]))):i=t.map(i,(function(e){var t=e.split("-"),s=t[t.length-1];return"builder"!==s&&"maker"!==s||(e=t.slice(0,t.length-1).join("-")),e})),r="seo:"+a.type+":"+o+":"+(l?"remix":"new")}}else r="remix";var n={trigger:r},h=a.customSearch;if(h)t.assign(n,h);else{var c=[],d=a.id&&this._seoPageToSearch[a.id];if(d)t.assign(n,d);else if(l&&"[]"!=l.tagNames){try{var u=l.tagNames.substring(1,l.tagNames.length-1);s=u.length?t.reduce(u.split(","),(function(e,t){return(t=t.trim())!==y&&e.push(t.trim()),e}),[]):[]}catch(p){s=[]}var g=[];if(s.length){var m=this._findTagsWithPrefix(s,"spcase",!1);m.length?g.push(m[0]):(m=this._findTagsWithPrefix(s,"explore",!1)).length&&g.push(m[0])}g.length||a.id||g.push("spcase-social"),c=t.map(g,(function(e){return e.split("-").splice(1).join("-")}))}i&&i.length&&!d&&(c=c.concat(i)),(c=t.uniq(c)).length?n.keys=c.join("+"):n.all=!0}return l&&!n.assetId&&(n.assetId=l.templateId),this.setupUrlSearchFromArgs(n)},vbTriggeringRemixFromSearchThumb:function(e,t,s){var r;s||(r=t&&t.getDataForReopenRedraw()),this._triggeredRemixData={useCase:e,from:"vb",searchQueryForReopen:s,reopenRedrawData:r}},editorTriggeringRemixFromSearchThumb:function(e,t){this.saveSessionForNewDocRequest(t,null,e,"createFromSearchThumb"),this._triggeredRemixData={useCase:e,from:t.editorApp,reopenRedrawData:t&&t.getDataForReopenRedraw()}},getInitialHomeModuleResults:function(e){return this._initialHomeModuleResultsDefer||(this._initialHomeModuleResultsDefer=r.defer(),this.getASearchRequestsController({addDefaultCallbacks:!0}).then(function(s){var r,i=e.limit;e.eduType?r="spterm-k12":"en"===a.getLocale().split("-")[0]&&(r="explore-feed");e.randomizeOrder&&e.randomSampleSize&&e.randomSampleSize>i&&(i=e.randomSampleSize);var l={limit:i,forceLowerLimit:!0,filters:r};e.allPremium&&(l.filters="premium"),e.forceAnimations&&(l.filters="animated"),s.getTemplateResultsForOpeningEditor("post",l).then(function(s){if(e.randomizeOrder){if(s.nonRamdomAssets=t.clone(s.assets),e.randomSampleSize&&e.randomSampleSize!==e.limit)if(e.randomSampleSize>e.limit)s.assets=t.shuffle(s.assets).slice(0,e.limit);else{var r=s.assets.splice(0,e.randomizeOrder);r=t.shuffle(r),s.assets=r.concat(s.assets)}else s.assets=t.shuffle(s.assets);t.each(s.assets,(function(e,t){e._orderedIndex=t}))}this._initialHomeModuleResults=s,this._initialHomeModuleOriginalQuery=l,this._initialHomeModuleResultsDefer.resolve(s)}.bind(this)).done()}.bind(this)).done()),this._initialHomeModuleResultsDefer.promise},renderingHome:function(){this._hideSearchView()},_hideSearchView:function(){this._headerSearchView&&this._headerSearchView._showingCpResults&&this._headerSearchView.hideResultsForHomeRender()},getHeaderBackInfo:function(){var e,t,s;if(marvel._isInApp){t=(s=p.parse(i.history.fragment,!0).pathname||"").split("/"),s="/"+s}else{var r=a.localePathPrefix,l=window.location.pathname||"";if(t=window.location.pathname.split("/"),r){var o=t.indexOf(r);-1!==o&&(t=t.slice(o))}else"/"===l[0]&&(t=t.slice(1))}if("search"!==(e=t[0])&&"npw"!==e){var n;n=e?"folders"===e?"projects":marvel._isInApp?T[e]||"home":"landing:"+e:"home";return marvel._isInApp?window.marvel.navigate("/search",{trigger:!1,replace:!1}):window.location.href=a.getLocalizedSparkPath("/sp/search"),{backPath:s,backType:n}}return null},_getValidBackInfoQuery:function(e){var s;if(e.backType){var r=e.backType.split("/"),i=r[0].toLowerCase();"organizer"===i&&(i="projects"),t.find(_,(function(e){return e.toLowerCase()===i}))&&(s={backType:i},r.length>1&&(s.backPath=r.join("/")))}return s},setupUrlSearchFromArgs:function(e){if("string"==typeof e)if(-1!==e.indexOf("="))try{e=p.parse("?"+e,!0).query}catch(i){return null}else e={keys:e};t.isUndefined(e.fallbackThresh)&&(e.fallbackThresh=10);var s={searchQuery:e,trigger:e.trigger||"urlSearch",needsToBeTriggered:!0},r=this._getValidBackInfoQuery(e);return r&&(s.backInfo=r),s},triggerSearchForView:function(e,t){},defaultHandleCreateFromSearchResultsThumbClick:function(e,t){w.trigger("create-from-search-results",{asset:e,analytics:t})},_getAppFromAppOrAppProperty:function(e){return e&&(this._searchRequires?e=this._searchRequires.VisualBrowseAndSearchAppsController.getApp(e):("string"==typeof e&&(e=u.getAppByType(e)||u.getAppByName(e)||u.getAppByDocType(e)),!e||e.isaProjectFormat&&e.isaProjectFormat()||(e=null))),e},appSupportsEditorSearch:function(e){return(e=this._getAppFromAppOrAppProperty(e))&&e.appSupportsEditorSearch&&e.appSupportsEditorSearch()?"post"===e.typeName?n.hasFeature("post-templates-search-enabled")&&e:e:null},getBackArrowText:function(e){if(e&&t.startsWith("landing:"))return a.formatMessage("npw-vb-back-to-landing",{landing:e.split(":")[1]});var s=k[e];return s||""===s?s:k.default},getBackInfoFromNPWCurrentPath:function(e,t){var s,r,a=p.parse(e||i.history.fragment,!0);t?s=a.query&&a.query.backType?a.query.backType:"visualBrowse":a.query&&a.query.homeBackType?(s=a.query.homeBackType,r=a.query.backAppPath):s="home";return{text:this.getBackArrowText(s),backId:s,backPath:r}},_getUserFlagTemplatesData:function(){if(!this._userFlagTemplatesData){var e,t,s=!1;this._isLoggedOut?(e=n.hasUnauthenticatedFeature("npw-vb-search-enable-premium-templates-pre-susi"))&&(t=d.cpTemplateSearchRemixPaidDefaultFilter):(e=n.hasFeature("enable-premium-templates"),s=n.hasFeature("enable-giphy-templates-web")&&n.hasFeature("user-flag-image-source-giphy"),e&&n.hasFeature("is-paid-user")&&!n.hasFeature("has-premium-typekit")&&(e=!1),e&&(t=n.hasFeature("is-paid-user")?d.cpTemplateSearchRemixPaidDefaultFilterPremiumUser:d.cpTemplateSearchRemixPaidDefaultFilter));var r=f.getBadgeForPremiumContent("template"),i=n.hasFeature("enable-search-recommend"),a=i&&n.hasFeature("search-recommend-only-for-empty-search"),l=i&&n.hasFeature("search-recommend-uses-first-search-results");this._userFlagTemplatesData={premiumFilter:t,allowPremiumTemplates:e,allowGiphyTemplates:s,showUpgradeForPremium:e&&!n.hasFeature("is-paid-user"),animationEnabled:this.animationEnabled(),autoPlayDetailAnimation:!n.hasFeature("search-animation-detail-no-auto-play"),preloadAllResultMp4s:n.hasFeature("search-animation-preload-for-all-results"),premiumTemplateBadge:r,autoShowRecommended:i,autoShowRecommendedOnlyOnFindAll:a,recommendNumberOfSearchResults:l&&30,isEdu:this._isEDUAccount}}return this._userFlagTemplatesData},animationEnabled:function(){return!0},_getCommonOptions:function(){var e,s=this._getUserFlagTemplatesData(),r=n.hasFeature("npw-visual-browse-search-debug-tagging"),i=n.hasFeature("npw-visual-browse-search-page-and-video-as-related"),a=d.sparkContentSearchHostProd,l=!1,o={apiKey:d.sparkContentSearchApiKey,calcAggsForAllFragments:n.hasFeature("search-suggest-aggs-on-all-fragments"),updateKeysForUserStringUpdate:n.hasFeature("search-suggest-update-keys-for-string-update"),multiWordBabel:n.hasFeature("search-suggest-multi-word-babel"),suggestAggsOnSpace:!0,numFragmentsToRequest:8,animationEnabled:this._userFlagTemplatesData.animationEnabled,allowPremiumTemplates:this._userFlagTemplatesData.allowPremiumTemplates,locale:this._searchLocale};n.hasFeature("remix-and-search-use-stage-cp")?(a=d.sparkContentSearchHostStage,o.host=d.sparkContentSuggestHostStage,l=!0):o.host=d.sparkContentSuggestHostProd,s.autoShowRecommended&&!l&&n.hasFeature("search-recommend-requires-stage")&&(s.autoShowRecommended=!1),r&&(e=a===d.sparkContentSearchHostStage?d.cpCuratorAssetPathStage:d.cpCuratorAssetPathProd),o.pathPrefix="/suggestions";var h={debugTagging:r,debugTaggingAssetPathTemplate:e,showNumbersInLines:r||n.hasFeature("npw-visual-browse-search-numbers-per-line"),keysForTags:!n.hasFeature("npw-visual-browse-search-cp-separate-prefixes"),detailViewEnabled:n.hasFeature("npw-visual-browse-search-cp-enable-detail"),hideAssetUntilLoaded:n.hasFeature("search-results-hide-asset-until-loaded"),allowFieldDefault:n.hasFeature("npw-visual-browse-search-allow-field-default"),showLoadMoreButton:n.hasFeature("npw-visual-browse-show-load-more-button"),searchPageAndVideoAsRelated:i,enableSearchHistory:!0,defaultFallbackThresh:10,usingStageContent:l,searchHost:a,searchPathPrefix:"/v2/content",searchServiceSuggestOptions:o,SearchController:this,isLoggedOut:this._isLoggedOut,searchLocale:this._searchLocale};return t.assign(h,s),h},_moveAssetToHeadOfAssetsArray:function(e,s){var r=-1;t.find(s,(function(t,s){if(t.id===e.id)return r=s,!0})),r>0?(s.splice(r,1),s.unshift(e)):-1===r&&s.unshift(e)},_getAppliedDefaultOptions:function(e,s,r,i){var a=this._getCommonOptions(),l=this._triggeredRemixData;this._triggeredRemixData=null,a.popularSearchStrings=s,r&&!r.unsupported&&(a.sizeFilterInfo=r);var o=e.editorApp&&this._getAppFromAppOrAppProperty(e.editorApp);(e=t.assign({},a,e)).handleCreateFromSearchResultsThumbClick||(e.handleCreateFromSearchResultsThumbClick=this.defaultHandleCreateFromSearchResultsThumbClick.bind(this));var h="";if(this._isEDUAccount&&(h="edu"),e.userProps={eduType:h,isPremiumUser:n.hasFeature("entitle-brand-kit"),refAppEnabled:n.hasFeature("enable-reference-app"),createMenuIconOnlyTrigger:!0,allowPremiumTemplates:e.allowPremiumTemplates},i&&(e.searchReact=i),e.SearchRequestsController&&(e.searchPromise||e.SearchRequestsController._assets))e.autoSearch={useController:!0,needsToBeTriggered:!0,searchPromise:e.searchPromise};else if(e.searchQuery&&!e.autoSearch)e.autoSearch=this.setupUrlSearchFromArgs(e.searchQuery);else if(l&&l.searchQueryForReopen)e.autoSearch=this.setupUrlSearchFromArgs(l.searchQueryForReopen);else if(l&&l.reopenRedrawData){if(l.useCase){var c=l.reopenRedrawData.lastRenderedResults.results,d=c.assetsById[l.useCase.id];d&&(this._moveAssetToHeadOfAssetsArray(d,c.assets),this._moveAssetToHeadOfAssetsArray(d,l.reopenRedrawData.dataToRestore._assets.assetsArray),t.each(c.assets,(function(e,t){e._orderedIndex=t})))}e.searchData=l.reopenRedrawData}else e.searchIfNotVB?e.autoSearch=this.setupUrlSearchFromArgs(e.searchIfNotVB):e.autoSearch||(e.seoPage||e.searchRemixMetadata)&&(e.autoSearch=this.setupUrlSearchFromRemixMetadataAndOrSeoPageOrQuery(e));if(e.editorApp=o,o&&!e.context&&(e.context="editor:"+o.typeName),e.searchViewId=e.searchViewId||e.context,!e.searchData&&!e.autoSearch){var u=this.getCachedView(e.searchViewId),g=u&&u.SearchRequestsController,m=this._searchViewsPreviousInstancesData[e.searchViewId];m?e.searchData=g?g.getSearchDataForRestore(m):m:g&&(e.searchData=g.getSearchDataForRestore(null))}return e.resultsOptions&&!t.isUndefined(e.resultsOptions.implicitCreateCta)||(e.resultsOptions=t.assign({},e.resultsOptions||{},{implicitCreateCta:!0}),e.defaultCreateAction||(e.defaultCreateAction="confirm")),e.allowPremiumTemplates&&e.experimentPremiumFilter&&(e.premiumFilter=e.experimentPremiumFilter),e.SearchController=this,e},_getNonEditorSearchReactRequires:function(){return this._getHomeSearchReactRequiresDefer||(this._getHomeSearchReactRequiresDefer=r.defer(),Promise.all([s.e("m-react-spectrum"),s.e(0),s.e(1),s.e("vendors~auth-not-required-app~brand-kit-context-views~brand-kit-editor~brandswitcher~logged-in-app~n~567f5255"),s.e("non-editor-search-react")]).then(function(e){var t=s(693).default,r=s(1106).default;this._getHomeSearchReactRequiresDefer.resolve({reactWrapper:t,CreateProjectMenu:r})}.bind(this).bind(null,s)).catch(s.oe)),this._getHomeSearchReactRequiresDefer.promise},_initSearchRequires:function(){return this._initSearchRequiresDefer||(this._initSearchRequiresDefer=r.defer(),this._searchLocale=a.getLocale(),C[this._searchLocale]&&(this._searchLocale=C[this._searchLocale],"en-US"===this._searchLocale?this._searchIsInEnglish=!0:this._disablePopularSearchStrings=!0),o.isValid().then(function(){return this._isLoggedOut=!1,n.featuresLoaded()}.bind(this),function(e){this._isLoggedOut=!0}.bind(this)).finally(function(){(this._isLoggedOut?r(!1):h.getIsEDUAccount()).then(function(e){Promise.all([s.e("npw-visual-browse-view~search-controller~share-view"),s.e("search-controller")]).then(function(t){var r=s(1748),i=s(2260),a=s(1749),l=s(1416),o=s(2261),n=s(2262);this._isEDUAccount=e,this._searchRequires={SearchView:i,SearchViewTemplate:r,VisualBrowseUseCasesController:a,VisualBrowseAndSearchAppsController:l,SearchRequestsController:o,SearchControllerSizeFilterMapsJSON:n},this._initSearchRequiresDefer.resolve(this._searchRequires)}.bind(this).bind(null,s)).catch(s.oe)}.bind(this)).done()}.bind(this)).done()),this._initSearchRequiresDefer.promise},getCachedView:function(e){return this._searchViews[e]},_editorSizeInfoDefers:{},_getEditorSizeFilterInfoAfterRequires:function(e){var t={unsupported:!0};if(e=this._getAppFromAppOrAppProperty(e)){var s=this._editorSizeInfoDefers[e.typeName];if(!s)if(s=r.defer(),this._editorSizeInfoDefers[e.typeName]=s,e.getSizePickerInfo){var i={sizeFilterMapsJSON:this._searchRequires.SearchControllerSizeFilterMapsJSON};e.getSizePickerInfo().then((function(e){i.pickerInfo=e,s.resolve(i)})).catch((function(e){b.error("error getting size picker info",e),s.resolve(t)}))}else s.resolve(t);return s.promise}return r.resolve(t)},_getDataIdFromViewOptions:function(e){return e.editorApp?"editor:"+e.editorApp.getAppTypeID():e.searchViewId},_requestControllers:{},_getASearchRequestsControllerAfterRequires:function(e){if((e=e||{}).editorApp){var s=this.getCachedView("editor:"+e.editorApp.getAppTypeID());if(s&&s.SearchRequestsController)return s.SearchRequestsController}var r=this._getDataIdFromViewOptions(e),i=t.assign(this._getCommonOptions(),{logger:b,callbacks:{},dataId:r},e,{VisualBrowseUseCasesController:this._searchRequires.VisualBrowseUseCasesController,VisualBrowseAndSearchAppsController:this._searchRequires.VisualBrowseAndSearchAppsController});e.addDefaultCallbacks&&t.each(this._searchRequires.SearchRequestsController.requiredCallbackNames,(function(e){i.callbacks[e]||(i.callbacks[e]=function(){})}));var a=this._requestControllers[r];return a?a.updateOptions(i):(a=new this._searchRequires.SearchRequestsController(i),this._requestControllers[a.dataId]=a),a},getASearchRequestsController:function(e){return this._initSearchRequires().then(function(){return this._getEditorSizeFilterInfoAfterRequires(e.editorApp).then(function(t){return e.sizeFilterInfo=t,this._getASearchRequestsControllerAfterRequires(e)}.bind(this))}.bind(this))},getEditorSizeFilterInfo:function(e){return this._initSearchRequires().then(function(){return this._getEditorSizeFilterInfoAfterRequires(e)}.bind(this))},reopeningEditorWithSearchView:function(e){return this.getASearchView(e)},getASearchView:function(e){return this._initSearchRequires().then(function(){var s,i=[];return e.template=e.template||this._searchRequires.SearchViewTemplate,this._getPopularSearchStringsPromise||(this._getPopularSearchStringsPromise=this._searchRequires.VisualBrowseUseCasesController.getPopularSearchStrings({popularSearchStringsUseEnglish:this._searchIsInEnglish,disablePopularSearchStrings:this._disablePopularSearchStrings})),i.push(this._getPopularSearchStringsPromise),i.push(this._getEditorSizeFilterInfoAfterRequires(e.editorApp||"post")),e.editorApp||(i.push(this._getNonEditorSearchReactRequires()),s=!0),r.allSettled(i).then(function(r){var i,a=r[0].value,l=r[1].value;s&&(i=r[r.length-1].value),"header"!==e.context||this._headerOptions||(this._headerOptions=t.clone(e)),e=this._getAppliedDefaultOptions(e,a,l,i);var o=this.getCachedView(e.searchViewId);return o?("header"===e.searchViewId&&e.context!==o._options.context&&(e.reset=!0,e.SearchRequestsController||(e.SearchRequestsController=o.SearchRequestsController)),o.updateOptions(e)):(e.SearchRequestsController||(e.SearchRequestsController=this._getASearchRequestsControllerAfterRequires(e)),o=new this._searchRequires.SearchView(e),this._searchViews[e.searchViewId]=o),o}.bind(this))}.bind(this))},searchViewShown:function(e,t){e.searchViewShown(t)},removeSearchView:function(e){var s=e._options.searchViewId;if("header"!==s){var r=s&&this._searchViews[s];r&&(r!==e&&b.debug("mismatched views in removeSearchView",{cachedView:r,view:e}),this._searchViewsPreviousInstancesData[s]=r.getDataForReopenRedraw(),delete this._searchViews[s]),e.remove()}else{var i=t.clone(this._headerOptions);this.getASearchView(i).then((function(e){e.setElement(i.el),e.render()}))}},_maxTotalStringLengthForTranslate:512,_cachedTranslationsByTransGroup:{},_cacheTranslationTypeIdFromSendData:function(e){var t=[e.to[0]];return e.preferredSrcLang?t.push(e.preferredSrcLang):e.from&&t.push("f."+e.from),t.join(".")},_getTranslationFromCache:function(e){var t=this._cacheTranslationTypeIdFromSendData(e),s=this._cachedTranslationsByTransGroup[t];return s&&s[e.str[0]]},_addTranslationToCache:function(e,s){var r=this._cacheTranslationTypeIdFromSendData(e),i=this._cachedTranslationsByTransGroup[r],a=e.str[0];i||(i={},this._cachedTranslationsByTransGroup[r]=i),i[a]=t.clone(s)},_getTranslateSettingsFromOptions:function(e){var t,s=e.fromLang,r=e.toLang,i=a.getLocale().split("-").join("_"),l=e.translationType,o=!!l;if(l)if(o=!0,"guessToUs"===l){var n=s||i;t=n,r="en_US",e.guessIfUs||"en_US"===n&&(s=r)}else"currentToUs"===l?(s=i,r="en_US"):"usToCurrent"===l?(s="en_US",r=i):o=!1;o||(s=s&&s.split("-").join("_")||i,r=r&&r.split("-").join("_")||"en_US");var h={contentType:"UGC",domain:"GENERIC",to:[r]};return s&&(h.from=s),t&&(h.preferredSrcLang=t),h.from===h.to[0]&&(h.noTranslationNeeded=!0),h},_getNoTranslateResults:function(e,s){var r=t.map(e.str,(function(t){return{translatedText:t,originalText:t,success:!0,from:e.to,to:e.to[0]}}));return s?r:r[0]},getTranslatedSearchString:function(s){var i;if("string"==typeof s?(i=s,s={}):i=s.textToTranslate,i.length>this._maxTotalStringLengthForTranslate)return r.reject("string longer than "+this._maxTotalStringLengthForTranslate+":"+i.length);var a=this._getTranslateSettingsFromOptions(s),l=i;if(a.str=[l],a.noTranslationNeeded)return r.resolve(this._getNoTranslateResults(a));var o=this._getTranslationFromCache(a);if(o)return r(o);var n={},h=r.defer();return e.ajax({type:"POST",url:d.mtTranslationServicePath,headers:{"X-Api-Key":d.key,"Content-Type":"application/json"},data:JSON.stringify(a),dataType:"json",traditional:!0,success:function(e,s,r){if(e.code)-9!==e.code&&b.error("[Search:MachineTranslation] unexpected translation error:"+e.msg,e),n=this._getNoTranslateResults(a);else{var i=e.Bing;i||(i=t.find(e,(function(e){return e})));var o=i[0],c=o.translations[0];""===(n=t.assign({from:o.from,originalText:o.originalText},c)).translatedText&&(n.translatedText=l)}this._addTranslationToCache(a,n),h.resolve(n)}.bind(this),error:function(e,t,s){b.error("mt translation failure:"+t,e),h.reject(s||"translation service error")}.bind(this)}),h.promise},_navigateRequiringLogin:function(e,s){if(this._isLoggedOut)"/"!==e[0]&&(e="/"+e),window.location.href="/sp"+e;else{var r=t.assign({trigger:!0},s||{});window.marvel.navigate(e,r)}},_visualBrowseLoggedOutCreateNav:function(e,t,s){t&&"new"!==t||(t="newlo");var r="/npw/"+e+"/"+t;s&&("?"!==s.charAt(0)&&(r+="?"),r+=s),this._navigateRequiringLogin(r)},_getRemixUrlFromSearchResultAsset:function(e,t){return e.remixable||e.remixfeed?"design-remix/"+t.type+"/"+(e.alias||e.id):e.remixUrl?e.remixUrl:""},remixFromSearchThumb:function(e,t,s){var r,i=e;switch(s.analytics.context){case"item-detail-create":r="createFromSearchDetail";break;case"item-grid":r="createFromSearchThumb";break;case"home":r="createFromHomeThumb"}this.vbTriggeringRemixFromSearchThumb(e,t,s.searchQueryForReopen),this._handleSearchThumbCreateAnalytics(e,s),this._handleNewDocRequest(t,i.app,i,r,void 0,s.editorQuery)},addEditorQueryToRemixUrl:function(e,t){if(t){var s=new URLSearchParams;Object.entries(t).forEach((function(e){var t=e[0],r=e[1];void 0!==r&&s.set(t,r)})),e+=(e.includes("?")?"&":"?")+s.toString()}return e},_handleNewDocRequest:function(e,t,s,r,i,a){var l=this._searchRequires.VisualBrowseAndSearchAppsController.getFormatInfo(t),o="home:"+i;if(b.debug("need to pass in page info for _handleNewDocRequest"),this.saveSessionForNewDocRequest(e,t,s,r,i),s){var n=this._getRemixUrlFromSearchResultAsset(s,l);if(n)return void this._navigateRequiringLogin(this.addEditorQueryToRemixUrl(n,a))}this._isLoggedOut?this._visualBrowseLoggedOutCreateNav(t):l.app.requestAppCreateNew({},o)},_handleSearchThumbCreateAnalytics:function(e,t){var s=t&&t.analytics||{},r=t&&t.eventName||"NPWVisualBrowseCreateFromTemplateResult";this._handleProjectCreateClickedAnalyticsData({eventName:r,extraData:s})},_addCurrentSearchToContextData:function(e,s,r,i,a,l){var o=e.SearchRequestsController.getCurrentSearch();if(o){var n={str:o.searchStr};o.options.tagFilters&&(n.tagFilters=t.map(o.options.tagFilters,(function(e){return e.tag}))),s.search=n}},saveSessionForNewDocRequest:function(e,t,s,r,i){var a="npw"===(i=i||e&&e._options.context).split(":")[0]?"visual-browse":i,l={},o=e&&"createFromHomeThumb"!==r;s&&("useCaseClicked"===r?(l.useCaseId=s.id.split("_")[0],o=!1):"createFromSearchThumb"===r&&(a+=":search")),l.npwMethod=a,o&&this._addCurrentSearchToContextData(e,l,t,s,r),this._saveProjectContextData(l)},_saveProjectContextData:function(e){if(window.sessionStorage)try{sessionStorage.setItem("project_ctx",JSON.stringify(e))}catch(t){}},_headerSearchInittedDefer:r.defer(),headerSearchInitted:function(){return this._headerSearchInittedDefer.promise},_backArrowClickHandlerForHeader:function(t,s){var i=e(t.target).data("back-id"),a=e(t.target).data("back-path")||"/"+i;return a?("/home"===a&&(a="/"),marvel._isInApp&&window.marvel.navigate(a,{trigger:!0})):history.back(),r()},_formatFilters:{format:{id:"all",app:""}},initHeaderSearch:function(s){if(!this._initHeaderSearchPromise){s=s||{};var r={asHeader:!0,doNotRenderOnInit:!0,templateOptions:{searchViewBarOnly:!0,searchParentHeightControl:!0,searchViewNoBackground:!0,searchViewInHeader:!1,inVbSearchHeader:!0,inMainSearchHeader:!0},el:e(".search-in-main-header"),resultsHolder$:e(".main-header-search-results"),context:"header",sendDeferWithCreateEvent:!1,defaultCreateAction:"confirm",dropdownSelectorStr:".npw-visual-browse-header-create-new-dropdown",createFormats:!0,showFormatFilters:!1,showPlaceholderIfNotShowingResultsGrid:!0,navBackClickHandler:this._backArrowClickHandlerForHeader.bind(this),inMainSearchHeader:!0};t.assign(r,s),this._initHeaderSearchPromise=this.getASearchView(r).then(function(e){return e.render(),this._headerSearchInittedDefer.resolve(e),this._headerSearchView=e,window.marvel.events.on("design-view-unloading",this._handleDesignViewUnloading.bind(this)),window.marvel.events.on("designview-rendersubview-doc-loaded",this._handleDesignViewLoaded.bind(this)),e}.bind(this))}return this._initHeaderSearchPromise},_handleDesignViewUnloading:function(e){this._headerSearchView&&this._headerSearchView._cachedParent$&&(this._headerSearchView.$el.appendTo(this._headerSearchView._cachedParent$),this._headerSearchView._cachedParent$=null)},_handleDesignViewLoaded:function(e){if(this._headerSearchView){var t=this._headerSearchView.$el.parent();t.length&&(this._headerSearchView.$el.detach(),this._headerSearchView._cachedParent$=t)}},getTagNamesAnalyticValForAsset:function(e){var s=t.clone(e.tags||[]);if(s.push(y),e.nsTags&&(s=s.concat(e.nsTags)),e.isPremiumTemplate){s.push(x);var r=s.indexOf(S);-1!==r&&s.splice(r,1)}return s.push(e.sploc),"["+(s=t.uniq(s)).join(",")+"]"},showPremiumUpgradeModalForPremiumTemplate:function(e,t,s){var r=(t=t||{}).analyticsPage||"home",i=t.analyticsFullTagNames||this.getTagNamesAnalyticValForAsset(e);f.showMerchMessagingModal({workflow:"premiumTemplate",destinationUrl:"design-remix/post/"+(e.alias||e.id),asset:e,analyticsPage:r,analyticsFullTagNames:i,detailRenditionInfo:t.detailRenditionInfo,totalAssets:s})},_addFormatToAnalyticsData:function(e,t){var s="unknown";return"page"!==t&&"post"!==t&&"video"!==t||(s=t),e.sparkFormat=s,e},_trackEvent:function(e,s){var r,i;i=r=(s=s||{}).context||"header";var a=t.assign(s,{context:r});l.trackEvent(e,a,i)},_handleProjectCreateClickedAnalyticsData:function(e){e=t.cloneDeep(e),this._trackEvent("project:"+e.eventName,e.extraData)},_handleProjectCreateClickedAnalytics:function(e,t){t=t||{},this._addFormatToAnalyticsData(t,e),this._handleProjectCreateClickedAnalyticsData({eventName:"createClicked",extraData:t})},handleFormatCreateFromScratch:function(e){this._handleProjectCreateClickedAnalytics(e),this._isLoggedOut,this._handleNewDocRequest(this._headerSearchView,e,null,"createClicked")},_sendHomeTemplatePressedAnalytics:function(e){this._sendTemplatePressedAnalyticsForAsset({asset:e.asset||{},categoryName:"homeTemplates",extendedData:e.eventData,templateLocation:"home"})},sendTemplatePressedAnalyticsFromNPW:function(e){this._sendTemplatePressedAnalyticsForAsset({asset:e.useCase,categoryName:"visualBrowse",extendedData:e.extendedData,templateLocation:"npw"})},sendTemplatePressedAnalyticsFromSearchResult:function(e,t){var s=t.asset||t.detailOptions&&t.detailOptions.asset;if(s&&"post"===s.app){var r,i=e._options;r="editor:post"===i.context?"editorPost":"npw"===i.context||"header"===i.context?"search":"unknown";var a="none";t.detailOptions?a=t.detailOptions.analytics.context:t.createOptions&&(a=t.createOptions.analytics.context);var l={categoryName:e.SearchRequestsController.getLastTemplateResultsAnalyticsTriggerCategory(),templateLocation:r,eventAction:a,asset:s,extendTemplatePressed:i.extendTemplatePressed,isFromSearchResult:!0,keyword:t.createOptions.analytics.searchTerm,tagFilters:t.createOptions.analytics.tagFilters||[]};this._sendTemplatePressedAnalyticsForAsset(l)}},_sendTemplatePressedAnalyticsForAsset:function(e){var t=e.asset,s=e.templateLocation,r=e.eventAction,i=e.categoryName,a={templateId:t.id||"none",contextualData3:"categoryName:"+i,contextualData4:"templateLocation:"+s,contextualData5:"tagNames:"+this.getTagNamesAnalyticValForAsset(t),contextualData6:"templateType:"+(t.isPremiumTemplate||t.premium?"premium":"free")};if(e.isFromSearchResult)if(t.isRecommended?t.isFakeRecommend?a.contextualData18="section:fakeRecommended":a.contextualData18="section:recommended":a.contextualData18="section:searchResults",a.contextualData8="keyword:"+(e.keyword||""),e.tagFilters){var l=e.tagFilters.map((function(e){return e.id}));a.contextualData9="tagFilters:["+l.join(",")+"]"}else a.contextualData9="tagFilters:[]";r&&(a.eventAction=r),this._userFlagTemplatesData.animationEnabled&&"post"===t.app&&(a.contextualData10="hasAnimation:"+(t.animated?"true":"false")),e.extendTemplatePressed&&e.extendTemplatePressed(a),this._trackEvent("templatePressed",a)},handleCreateFromHomeTemplateThumb:function(e){var s=t.cloneDeep(this._initialHomeModuleOriginalQuery);delete s.limit,delete s.forceLowerLimit,s.trigger="homeTemplates",e.searchInfoForReopen={results:this._initialHomeModuleResults,query:s},e.previewLocation="home",e.searchAnalytics=this._initialHomeModuleResults.searchAnalytics,this._headerSearchView.showCreateConfirmWithoutGrid(e);var r=e.asset,i=e.analytics;this._sendHomeTemplatePressedAnalytics({asset:r,eventData:i})},handleHomeCreateFromScratchInSearch:function(e,t,s){this._hideSearchView(),this._handleHomeCreateFromScratch(t,s,e)},handleHomeCreateFromScratch:function(e,t){this._handleHomeCreateFromScratch(e,t,null)},_handleHomeCreateFromScratch:function(e,t,s){"video"===e.app?this.doNewNonPost(e,"video"):"page"===e.app?this.doNewNonPost(e,"page"):"refapp"===e.app?this.doNewNonPost(e,"refapp"):"brandedTemplatePicker"===e.id?this.doPostBrandedTemplate(t,s):this.doPostBlank(e,t)},queryStringFromObject:function(e,s){var r=new URLSearchParams;return t.each(e,(function(e,t){r.set(t,e)})),(s?"?":"")+r},doPostBrandedTemplate:function(e,t){var s,r=e.templateData.asset,i=e.templateData.kit,a=e.templateData.fromScratch,l=e.templateData.app,o=i.getId(),h={workflow:"blank",fallbackThresh:"default",trigger:"CreateProjectMenu"};a?(s="design/"+l+"/new",h.branded=!0,h.sizeCategory="popular"):s=r.remixUrl,s+=this.queryStringFromObject(h,!0),n.hasFeature("entitle-brand-kit")?this._navigateRequiringLogin(s,{trigger:!0,replace:!1}):t?this.navigateToBrandingFromCreateProjectMenu(t,o):this._navigateRequiringLogin("branding/"+(o||""),{trigger:!0})},doPostBlank:function(e,s){var r={"instagram-story":{aspectId:"InstagramStory"},"instagram-post":{aspectId:"Instagram"},"facebook-post":{aspectId:"Facebook"},"facebook-cover":{aspectId:"Facebook"},collage:{sizeCategory:"popular",pickImage:"beforeSize",search:"keys=collage"},flyer:{aspectId:"Poster",search:"flyer"},"custom-size-graphic":{sizeCategory:"custom"},custom:{sizeCategory:"custom"},sizePicker:{}}[e.id]||{};t.assign(r,t.pick(e,["aspectId","search","sizeCategory","pickImage"]));var i={workflow:"blank",fallbackThresh:"default",trigger:"CreateProjectMenu"};t.assign(i,r);var a="/design/post/new"+this.queryStringFromObject(i,!0);this._navigateRequiringLogin(a,{trigger:!0,replace:!1})},doNewNonPost:function(e,t){var s="/design/";t||("refapp"===e.id?t="refapp":(b.warn("unknown action in doNewNonPost",{action:e}),t="page")),s+=t+"/new",this._navigateRequiringLogin(s,{trigger:!0,replace:!1})},navigateToBrandingFromCreateProjectMenu:function(e,t){this._navigateRequiringLogin("branding/"+(t||""),{trigger:!0}),e.returningToHome()},autoPlayVideo:function(e,t){var s;e.play?s=e:e.length&&e[0].play&&(s=e[0]),s.muted=!0;try{var r=s.play();r&&r.then((function(){t&&t({})}),(function(e){b.info("muted video failed to play",e),t&&t({err:e})}))}catch(i){b.info("muted video failed to play",i),t&&t({err:i})}}}))}.apply(t,r))||(e.exports=i)},825:function(e,t,s){var r,i;r=[s(7),s(2),s(6),s(1),s(45)],void 0===(i=function(e,t,s,r,i){"use strict";var a=i.default;return new(s.Model.extend({initialize:function(){this._messagingProviders=[],this._providerEvents={},this._eventHandlers={},this._messageViews={}},registerProvider:function(e){this._messagingProviders.push(e),e.messagingController=this,e.interestedEvents.forEach(this._addProviderEvent.bind(this,e))},registerMessageView:function(e){e.MessageViewCls?this._messageViews[e.MessageViewCls.prototype.cachename]={class:e.MessageViewCls,parentSelector:e.parentSelector,controller:e.controller,cache:null}:this._messageViews[e.name]=t.assign({},e)},_addProviderEvent:function(e,t){var s=this._providerEvents[t];s?s.push(e):(s=[e],this._providerEvents[t]=s,this._registerEventHandler(t))},_registerEventHandler:function(e){if(this._eventHandlers[e])throw new Error("BUG: Attempt to register event handler more than once!");var s=function(){var s=Array.prototype.slice.call(arguments),i=[];this._providerEvents[e].forEach((function(t){var r=t.handleEvent.apply(t,[e].concat(s));i.push(r)})),r.allSettled(i).then(function(s){var r={default:[]};t.flatten(s.filter((function(t){if("fulfilled"===t.state)return t.value;marvel.logger.error("A message provider failed to handle event "+e+"!",t.reason)})).map((function(e){return e.value}))).forEach(function(e){try{var s=this._getMessageView(e),i=t.get(s,"class.pattern")||s.pattern;i?r[i]?r[i].push(e):r[i]=[e]:r.default.push(e)}catch(a){marvel.logger.error("Error attempting to handle message!",{message:e,error:a})}}.bind(this)),t.each(r,function(e){e.length&&this._displayMessage(e[0])}.bind(this))}.bind(this))}.bind(this);this._eventHandlers[e]=s,a.on(e,s)},_displayMessage:function(e){return this._renderView(e)},_renderView:function(t){var s,r,i;try{r=(s=this._getMessageView(t)).parentSelector?e(s.parentSelector):null,s.class?(s.cache?(i=s.cache).model=t.model:(i=Object.create(s.class.prototype),r&&(i.el=r),s.class.call(i,{model:t.model}),s.cache=i),s.controller?s.controller.attachView(i,t.model):i.render()):s.show(t.params)}catch(a){marvel.logger.error("Failed to render messaging view!",{message:t,messageView:s,error:a})}},_getMessageView:function(e){var t=e.viewCachename||e.view,s=this._messageViews[t];if(!s){var r=new Error("Message with unknown view "+t);throw r.badMessage=e,r}return s}}))}.apply(t,r))||(e.exports=i)},836:function(e,t,s){"use strict";s.r(t);var r=s(61),i=s.n(r),a=s(882),l=s.n(a),o=s(14),n=s.n(o),h=s(207),c=s(23),d=s.n(c),u=s(825),g=s.n(u),m=s(18),p=s(25),f=s.n(p),v=s(11),w=s.n(v),b=function(e){var t=e.template.getTemplateDcxRepresentation(),s=t&&void 0!==t.brandUrn;l.a.showWaitView(n.a.getString("template-create-from-dialog-wait-message"));var r="TemplatesPreviewCompleted";m.SparkPerformanceTracker.mark(r),window.marvel.logger.info("[Templates:Preview] Started creating from template"),h.default.createDocumentFromTemplate(e.template,"/assets/adobe-theo").then((function(t){l.a.hide(),t.ok&&t.createdUrn?(window.marvel.logger.info("[Templates:Preview] Completed creating from template",{templateId:e.template.id,libraryId:e.template.library.id,result:t}),m.SparkPerformanceTracker.measure("".concat(r,":end"),r),window.marvel.navigate("/design/post/"+t.createdUrn,{trigger:!0}),f.a.trackEvent("libraries:createdFromTemplate",{contextualdata15:"cclType:".concat(e.template.library.isSharedWithUser()?"shared":"personal"),contextualData10:"createFromLocation:".concat(e.analyticsContext?e.analyticsContext.createLocation:""),contextualData23:"brandStatus:".concat(s?"isBranded":"notBranded"),contextualData11:"messageAdded:".concat(e.template.description?"yes":"no")})):window.marvel.logger.error("[Templates:Preview] unexpected error creating from template",{templateId:e.template.id,libraryId:e.template.library.id,result:t})})).catch((function(t){window.marvel.logger.error("[Templates:Preview] unexpected error creating from template",{templateId:e.template.id,libraryId:e.template.library.id,error:t}),l.a.hide()}))};g.a.registerMessageView({name:"librarytemplateupgrade",pattern:"librarytemplateupgrade",show:function(){window.marvel.events.trigger("create-from-template")}});var _={show:function(e){var t=this;Promise.all([Promise.all([s.e("m-react-spectrum"),s.e(0),s.e(1),s.e("vendors~auth-not-required-app~brand-kit-context-views~brand-kit-editor~brandswitcher~logged-in-app~n~567f5255"),s.e("templatepreviewdlg")]).then(s.bind(null,1107)),Promise.all([s.e("m-react-spectrum"),s.e(0),s.e(1),s.e("vendors~auth-not-required-app~brand-kit-context-views~brand-kit-editor~brandswitcher~logged-in-app~n~567f5255"),s.e("react")]).then(s.bind(null,693))]).then((function(s){var r=d.a.hasFeature("is-paid-user"),a=e.template&&e.template.library.isPublic(),l=r||a,o="template-preview-dlg",c=s[0],u=s[1].default,g=document.getElementById(o);if(!g){var m=document.body;(g=document.createElement("div")).id=o,g.className="template-preview-dlg spectrum--light spectrum--medium",m.appendChild(g)}var p=c.default,f=u.wrapComponent(p);t.templatePreviewInstance=new f({modelJSON:{fromEditor:e.fromEditor,projectIsEdited:e.projectIsEdited,displayPaywall:!l,onCreate:function(s,r){var a,o,c=e.currentProject;if(e.onCreate&&e.onCreate(s,r),l){if(!window.adobeIMS||!window.adobeIMS.isSignedInUser())return a=s.id,o="".concat(window.location.href,"?redirectAction=createProjectFromLibraryTemplate"),w.a._saveRedirectURI(o),h.default.saveSelectedTemplateId(a),void(window.location.href="/sp/login");if(r&&c){i.a.showWaitView(n.a.getString("template-dialog-saving-wait-project"));c.saveChanges((function(){})).then((function(){i.a.hide(),b(e)}))}else b(e)}else window.marvel.events.trigger("spark-library-template-upgrade");t.templatePreviewInstance.remove()},onCancel:function(){e.onCancel&&e.onCancel(),t.templatePreviewInstance.remove()},template:e.template},el:g}),t.templatePreviewInstance.render()}))},hide:function(){this.templatePreviewInstance.remove()},createFromTemplate:function(e){b(e)}};t.default=_},882:function(e,t,s){var r,i;r=[s(7),s(2),s(6),s(14),s(389),s(927),s(928)],void 0===(i=function(e,t,s,r,i,a,l){"use strict";return new(i.extend({cachename:"templatesharingwaitview",el:".template-sharing-wait-overlay",initialize:function(){t.bindAll(this,t.functionsIn(this)),this.defaultWaitTitle=r.getString("template-dialog-default-wait-title")},setText:function(e,t){e=e||"",t=t||this.text$,e.jquery?(t.html(""),t.append(e)):t.text(e)},showWaitView:function(e){this.waitMessage=e,this.render()},render:function(){this.$el.html(r.mustacheRender(a)),this.waitTitleEl$=this.$el.find(".wait-view-dialog-title"),this.setText(this.defaultWaitTitle,this.waitTitleEl$),this.waitMessageEl$=this.$el.find(".wait-view-dialog-msg"),this.setText(this.waitMessage,this.waitMessageEl$),this.$el.removeClass("hide")},hide:function(){return this.$el.addClass("hide"),this.$el.empty(),this}}))}.apply(t,r))||(e.exports=i)},927:function(e,t){e.exports='<div class="wait-view-bg mrvl-overlay-overlay-bg">\n</div>\n<div class="wait-view-shell mrvl-overlay-shell" data-auto="wait-view-shell">\n    <div class="wait-view-content-shell">\n        <div class="wait-main-content">\n            <div class="wait-view-video">\n                <video src="/images/shared-templates/Template_Sharing_Loading.mp4" loop muted autoplay class="wait-view-video"></video>\n            </div>\n            <div class="wait-view-text">\n                <div class="wait-view-dialog-title">{{wait-view-default-title}}</div>\n                <div class="wait-view-dialog-msg">{{wait-view-message}}</div>\n            </div>\n        </div>\n    </div>\n</div>\n'},928:function(e,t,s){var r=s(929);"string"==typeof r&&(r=[[e.i,r,""]]);var i={hmr:!0,transform:void 0,insertInto:void 0};s(202)(r,i);r.locals&&(e.exports=r.locals)},929:function(e,t,s){var r=s(203);(e.exports=s(201)(!1)).push([e.i,".mrvl-overlay-overlay-bg{z-index:106;position:fixed;left:0;right:0;top:0;bottom:0;background-color:rgba(0,0,0,.8)}.mrvl-overlay-shell{z-index:106;position:fixed;background-color:#fff;border-radius:10px;width:580px;height:500px;top:50%;left:50%;-webkit-transform:translateX(-50%) translateY(-50%);transform:translateX(-50%) translateY(-50%)}.mrvl-overlay-shell .marvel-overlay-shell-content{background-color:#fff;border-radius:5px;position:absolute;top:30px;bottom:0;width:100%}.mrvl-overlay-shell .mrvl-overlay-content-shell{padding:30px 30px 25px}.mrvl-overlay-shell .mrvl-overlay-content{margin-bottom:80px}.mrvl-overlay-shell .mrvl-overlay-content p{font-size:1.38em;font-weight:400;line-height:1.5;color:#35414c;word-wrap:break-word}.mrvl-overlay-shell .dialog-title{font-size:2em;font-weight:700;background-color:#f2f4f5;text-align:left;font-family:brandon-grotesque,adobe-clean,sans-serif;color:#35414c;margin:0;padding:20px 25px;border-top-left-radius:10px;border-top-right-radius:10px}.mrvl-overlay-shell h2{font-size:2.4em;color:#484848}.mrvl-overlay-shell h2,.mrvl-overlay-shell h3{font-weight:300;text-align:center;margin:30px 0 16px}.mrvl-overlay-shell h3{font-size:1.8em;color:#666}.mrvl-overlay-shell .x-close-btn{position:absolute;right:20px;top:20px;background-color:transparent;border:none;outline:none;color:#999;cursor:pointer;font-size:1.4em}.mrvl-overlay-shell .cancel-btn,.mrvl-overlay-shell .done-btn{background-color:transparent;color:#ccc;border:1px solid #ccc}.mrvl-overlay-shell .mrvl-dlg-btn-acts{position:absolute;bottom:27px;text-align:right;right:25px;width:100%}.mrvl-overlay-shell .mrvl-dlg-btn-acts .cancel-btn{background-color:#9aa6af}.mrvl-overlay-shell .mrvl-dlg-btn-acts .cancel-btn:hover{background-color:#82919b}.mrvl-overlay-shell .mrvl-dlg-btn-acts .confirm-btn{background-color:#35657c}.mrvl-overlay-shell .mrvl-dlg-btn-acts .confirm-btn:hover{background-color:#35414c}.mrvl-overlay-shell .mrvl-dlg-btn-acts .confirm-btn a{color:#fff;background-color:#35657c}.mrvl-overlay-shell .mrvl-dlg-btn-acts .confirm-btn:hover a,.mrvl-overlay-shell .mrvl-dlg-btn-acts .confirm-btn a:hover{background-color:#35414c}.mrvl-overlay-shell .mrvl-dlg-btn-acts .cancel-btn,.mrvl-overlay-shell .mrvl-dlg-btn-acts .confirm-btn,.mrvl-overlay-shell .mrvl-dlg-btn-acts .done-btn{padding:10px 16px;color:#fff;text-decoration:none;border-radius:40px;font-weight:700;font-size:1.23em;margin:0;line-height:1;height:36px;border:0}@-moz-document url-prefix(){.mrvl-overlay-shell .mrvl-dlg-btn-acts .cancel-btn,.mrvl-overlay-shell .mrvl-dlg-btn-acts .confirm-btn,.mrvl-overlay-shell .mrvl-dlg-btn-acts .done-btn{line-height:-moz-block-height!important}}.mrvl-overlay-shell .mrvl-dlg-btn-acts .mrvl-btn{display:inline-block;margin:0 5px;overflow:hidden;position:relative}.mrvl-overlay-shell .mrvl-dlg-btn-acts .mrvl-btn:last-child{margin-right:0}.mrvl-overlay-shell.short{height:250px}.mrvl-overlay-shell .flag-toggle{width:62px;height:28px;cursor:pointer;display:inline-block;position:relative}.mrvl-overlay-shell .flag-toggle.selected .toggle-values{left:0}.mrvl-overlay-shell .flag-toggle.selected .toggle-handle{left:33px}.mrvl-overlay-shell .flag-toggle:not(.selected) .toggle-handle{left:-3px}.mrvl-overlay-shell .flag-toggle .toggle-handle,.mrvl-overlay-shell .flag-toggle .toggle-values{transition-property:left;transition:left .19s linear;transition-duration:.19s;transition-timing-function:linear;transition-delay:0s}.mrvl-overlay-shell .flag-toggle .toggle-values{width:116px;height:24px;position:absolute;z-index:0;left:-58px}.mrvl-overlay-shell .flag-toggle .toggle-values .toggle-values-off,.mrvl-overlay-shell .flag-toggle .toggle-values .toggle-values-on{width:58px;line-height:24px;text-transform:uppercase;display:inline-block;font-size:11px;font-weight:700}.mrvl-overlay-shell .flag-toggle .toggle-values .toggle-values-off.toggle-values-on,.mrvl-overlay-shell .flag-toggle .toggle-values .toggle-values-on.toggle-values-on{background-color:#1473e6;text-align:left;color:#1473e6;padding-left:10px}.mrvl-overlay-shell .flag-toggle .toggle-values .toggle-values-off.toggle-values-off,.mrvl-overlay-shell .flag-toggle .toggle-values .toggle-values-on.toggle-values-off{background-color:#82909b;text-align:right;color:#82909b;padding-right:10px}.mrvl-overlay-shell .flag-toggle .toggle-mask{position:absolute;overflow:hidden;width:58px;height:24px;z-index:1;top:2px}.mrvl-overlay-shell .flag-toggle .toggle-mask .toggle-values-image-mask{position:absolute;top:0;left:0;width:58px;height:24px;z-index:1;background-image:url("+r(s(393))+");background-size:cover}.mrvl-overlay-shell .flag-toggle .toggle-handle{height:28px;width:28px;border-radius:14px;background-color:#dce0e3;position:absolute;z-index:2}.mrvl-overlay-shell .flag-toggle .toggle-handle .dot{background-color:#81919b;width:6px;height:6px;border-radius:3px;position:absolute;left:50%;top:50%;-webkit-transform:translate(-50%,-50%);transform:translate(-50%,-50%)}.template-sharing-wait-overlay .mrvl-overlay-overlay-bg{background-color:rgba(25,34,38,.5)}.template-sharing-wait-overlay .wait-view-shell{width:440px;height:440px;border-radius:8px}.template-sharing-wait-overlay .wait-view-video{border-radius:8px 8px 0 0;height:280px}.template-sharing-wait-overlay .wait-view-text{height:160px;display:-webkit-flex;display:flex;-webkit-justify-content:center;justify-content:center;-webkit-align-items:center;align-items:center;-webkit-flex-direction:column;flex-direction:column}.template-sharing-wait-overlay .wait-view-text .wait-view-dialog-title{font-size:28px;font-weight:900}.template-sharing-wait-overlay .wait-view-text .wait-view-dialog-msg{font-size:14px;margin-top:10px}",""])}}]);
//# sourceMappingURL=search-controller-358475bc.js.map