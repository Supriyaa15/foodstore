(window.webpackJsonptheoWebApp=window.webpackJsonptheoWebApp||[]).push([[42],{"16hp":function(e,t,o){var n,r=t,i=o("oAGj"),a=o("CaSj"),l=o("UGKO"),s=o("FNB+"),u=o("cmoc"),c=o("eiag"),g=o("xe42"),h=o("OYRJ"),f=o("9Lk3"),p=o("fdtz"),d=o("lmwz"),m=o("fNpk"),C=o("3DEm"),y=o("K0Rh"),v=o("enh0"),S=o("sIWg"),k=o("1NAc");r.FormaPlacementSuggester=(n=function(e,t){a.DesignSuggester.call(this,e,t),this.maxSuggestions=3},i.defineClass({name:"FormaPlacementSuggester",ctor:n,superName:"DesignSuggester",statics:{KIND:{get:function(){return"FormaPlacementSuggester"}},createPlacementInputs:function(e,t){var o=[],n=[],r=[],a=[],l=[],g=[];return t.visitAll(s.FormaTraversal.PreOrder,(function(t){if(!(i.eq(s._equality_Forma_Forma,e,t)||t instanceof v.TextForma||null==t.controller)){var c=t.finalFrame;null!=c?((t.isBackgroundImage()||f.GridController.isBackgroundColoredCell(t))&&g.push(t),t instanceof u.FrameForma&&(n.push(c),l.push(t),e.originalID!=t.originalID&&a.push(c)),t.isTypeLockup()&&(o.push(c),e.originalID!=t.originalID&&a.push(c)),null!=t.controller&&t.controller.floating&&t.kind!=p.ImageForma.KIND&&e.originalID!=t.originalID&&(r.push(c),a.push(c))):m.LegacyCoreAssert.fail("something is wrong with this document. a forma has a nil frame",void 0,"FormaPlacementSuggester.createPlacementInputs","FormaPlacementSuggester.swift",201)}})),new c.FormaPlacementInput(e,a,r,o,n,l,g)},createPlacementSuggestion:function(e,t,o,n,r){for(var a=0,l=0,s=0,u=i.iter(i.range(0,n.imageRects.length,!1));!u.done;u.next()){var c=u.value,f=n.imageRects[c];if(null!=(N=t.intersectionWith(f))&&N.area==t.area&&f.area>t.area){var p=n.images[c];a=C.MathUtils.maxDouble(a,p.controller.getAverageEdge(t)),l=C.MathUtils.maxDouble(l,p.controller.getFaceIntersections(t))}else null!=N&&(s+=N.area)}for(var d=o,m=0,y=i.iter(n.backgroundRegions);!y.done;y.next()){var v=y.value;(N=t.intersectionWith(v.finalFrame))&&(Math.abs(N.area-t.area)>100?m+=1:d=v.finalFrame)}r.setFeature(g.FormaPlacementScore.Features.REGION_BOUNDARY_OVERLAP,i.toDouble(m)),r.setFeature(g.FormaPlacementScore.Features.DISTANCE_TO_CENTER,t.center.distanceTo(o.center)/Math.max(o.width,o.height)),r.setFeature(g.FormaPlacementScore.Features.FACE,l),r.setFeature(g.FormaPlacementScore.Features.EDGE,a),r.setFeature(g.FormaPlacementScore.Features.IMAGE_EDGE_OVERLAP,s/o.area),r.setFeature(g.FormaPlacementScore.Features.SIZE,t.area/o.area);var S=1-Math.abs(t.width/o.width-2*t.height/o.height);r.setFeature(g.FormaPlacementScore.Features.ASPECT_RATIO,S);var k=t.minX-d.minX,P=d.maxX-t.maxX,I=1-Math.abs(k-P)/d.width;I<.98&&(I=0),r.setFeature(g.FormaPlacementScore.Features.XSYMM,I);var L=t.minY-d.minY,A=d.maxY-t.maxY,F=1-Math.abs(L-A)/d.height;F<.98&&(F=0),r.setFeature(g.FormaPlacementScore.Features.YSYMM,F);for(var T=0,b=i.iter(n.textRects);!b.done;b.next()){var D=b.value;Math.abs(D.center.x-t.center.x)<3&&(T+=1),Math.abs(D.minY-t.minY)<3?T+=.25:Math.abs(D.center.y-t.center.y)<3&&(T+=.1)}r.setFeature(g.FormaPlacementScore.Features.ALIGNMENT,T);for(var x=0,M=i.iter(n.textRects);!M.done;M.next()){var R=M.value;null!=(N=t.intersectionWith(R))&&(x+=N.area)}r.setFeature(g.FormaPlacementScore.Features.TEXT_OVERLAP,x/o.area);for(var _=0,E=i.iter(n.floatingRects);!E.done;E.next()){var N,w=E.value;(N=t.intersectionWith(w))&&(_+=N.area)}return r.setFeature(g.FormaPlacementScore.Features.FLOATING_ELEMENT_OVERLAP,_/o.area),new h.FormaPlacementSuggestion(e,t,r)}},props:{createSuggestions:function(){return this.createPlacementSuggestions(!0)},createPlacementSuggestions:function(e,t){if(void 0===t&&(t=null),null==this.group.frame)return[];var o=this.group.frame;this.group.kind==y.RootForma.KIND&&(o=S.TheoRect.fromSize(this.group.page.pageSize));var r,a=t;null==a&&this.forma.isImage()&&(r=d.ImageFacade.getImageFormaForForma(this.forma))&&(a=i.opt(r.bounds,(function(e){return e.aspectRatio})));var s=n.createPlacementInputs(this.forma,this.group),u=i.clone(this.getSearchLocations(this.forma,o,s,e,a));if(0==u.length){var c,h=o;if(null!=(c=a)){var f=o.fitAspectRatioWithin(c);h=S.TheoRect.fromSize(f).offset(o.origin)}u.push(h)}for(var p,m=-1/0,v=new g.FormaPlacementScore(s),k=[],P=i.iter(u);!P.done;P.next()){var I=P.value,L=n.createPlacementSuggestion(this.forma,I,o,s,v);L.weightedScore.reject()||(k.push(L),v=new g.FormaPlacementScore(s)),L.score>m&&(m=L.score,p=L,v=new g.FormaPlacementScore(s))}if(e)return n.createPlacementSuggestion(this.forma,p.location,o,s,v),[i.as(p,l.IDesignSuggestion)];var A=[];A.push(p),i.sortInPlace(k,(function(e,t){return e.score>t.score}));for(var F=k.length,T=0,b=i.iter(i.range(0,this.maxSuggestions,!1));!b.done;b.next()){var D=null;for(T+=1;T<F;){for(var x=9999,M=i.iter(i.range(0,A.length,!1));!M.done;M.next()){var R=M.value;x=C.MathUtils.minDouble(x,k[T].distanceTo(A[R]))}if(x>.1){D=k[T];break}T+=1}if(null==D)break;A.push(D)}return A=A.slice(1,A.length),i.sortInPlace(A,(function(e,t){return e.location.center.x<t.location.center.x})),i.info("finished suggester"),[i.as(p,l.IDesignSuggestion)].concat(A)},fastPlacement:function(){var e=i.clone(this.createPlacementSuggestions(!0));return e.length>0?e[0]:null},getSearchLocations:function(e,t,o,n,r){void 0===r&&(r=null);var a=[],l=[],s=[],u=[],c=S.TheoRect.fromXXYY(C.MathUtils.minDouble(t.width/4,200),t.width-10,C.MathUtils.minDouble(t.height/4,100),t.height-10);n&&(c=S.TheoRect.fromXXYY(C.MathUtils.minDouble(t.width/4,200),t.width-10,C.MathUtils.minDouble(t.height/4,100),t.height-10));var g=t.area/10,h=t.area/5,f=c.minX,p=c.maxX,d=c.minY,y=c.maxY,v=t.width/20,P=t.height/20,I=n?5:8;null!=r&&(I*=I);var L=c.width/I,A=c.height/I;n&&(v=C.MathUtils.maxDouble(t.width/20,30),P=C.MathUtils.maxDouble(t.height/20,30)),l.push((t.minX+t.maxX)/2),s.push((t.minY+t.maxY)/2);for(var F=i.iter(o.otherRects.concat(o.backgroundRegions.map((function(e){return e.finalFrame}),this)));!F.done;F.next()){var T=F.value;l.push(T.center.x),s.push(T.center.y),s.push(T.minY)}for(var b=t.minX+5;b<t.maxX-5;)l.push(b),b+=v;for(var D=t.minY+5;D<t.maxY-5;)s.push(D),D+=P;var x=f;if(null==r)for(;x<p;){for(var M=d;M<y;)x*M>=g&&x*M<=h&&u.push(new k.TheoSize(x,M)),M+=A;x+=L}else{for(var R,_=0;x<p;){var E=x*(M=x/r);if(E>=g&&E<=h)u.push(new k.TheoSize(x,M));else if(0==u.length){var N=E<g?E/g:h/E;N>_&&(_=N,R=new k.TheoSize(x,M))}x+=L}0==u.length&&null!=R&&u.push(R)}for(var w=i.iter(l);!w.done;w.next())for(var O=w.value,B=i.iter(s);!B.done;B.next())for(var U=B.value,V=i.iter(u);!V.done;V.next()){var G=V.value;if(x=G.width,M=G.height,b=O-G.width/2,D=U-G.height/2,!(b+x>=t.maxX-5||D+M>=t.maxY-5||b<=t.minX+5||D<=t.minY+5||x/M<.5)){var W=S.TheoRect.fromXYWH(b,D,x,M);null!=r&&m.LegacyCoreAssert.isTrue(Math.abs(W.aspectRatio-r)<.001,"invalid candidate location: does not match aspect ratio",void 0,"FormaPlacementSuggester.getSearchLocations","FormaPlacementSuggester.swift",519),a.push(W)}}return a}}}),n)},"4ZS9":function(e,t,o){var n,r=t,i=o("oAGj"),a=o("gXiO"),l=o("mGL3"),s=o("3UhB");r.FontSuggestionContext=(n=function(){this.currentDocumentFonts_=new l.OrderedFontSet,this.recentlyUsedFonts_=new l.OrderedFontSet,a.CoreObject.call(this)},i.defineClass({name:"FontSuggestionContext",ctor:n,superName:"CoreObject",props:{snapshotCurrentFonts:function(e){this.currentDocumentFonts_=s.TypeLockupUtils.fontsInDocument(e)},currentDocumentFonts:{get:function(){return this.currentDocumentFonts_}},addRecentlyUsedFont:function(e){var t=this,o=null;if(this.recentlyUsedFonts_.contains(e)){var n=e.displayFamilyName;o=i.clone(this.recentlyUsedFonts_.facesInFamily(n))}i.opt(o,(function(e){return e.forEach((function(e){return t.recentlyUsedFonts_.remove(e)}))})),i.opt(o,(function(e){return e.forEach((function(e){return t.recentlyUsedFonts_.append(e)}))})),this.recentlyUsedFonts_.append(e)},clearRecentFonts:function(){this.recentlyUsedFonts_=new l.OrderedFontSet},recentlyUsedFonts:{get:function(){return this.recentlyUsedFonts_}}}}),n)},"9BFu":function(e,t,o){var n,r,i=t,a=o("oAGj"),l=o("gXiO"),s=o("fNpk"),u=o("jC54");i.ScoreComponent=(n=function(e,t,o,n){this.std=1,this.mean=0,this.feature=e,this.weight=t,this.functionParam=o,this.featureName=n},a.defineClass({name:"ScoreComponent",ctor:n,props:{normalFeature:{get:function(){return(this.feature-this.mean)/this.std}}}}),n),i.applyFieldWidth=function(e,t){var o=e.length;return o>=t?e:a.toString(" ",t-o)+e},i.WeightedScore=(r=function(e){this.initScore=-1*a.toDouble(a.MAXFLOAT),this.components_=[],this.score_=0,this.recalculateScore_=!0,this.versionNumber=1;for(var t=a.iter(a.range(0,e,!1));!t.done;t.next())this.components_.push(new i.ScoreComponent(0,1,1e-5,"Feature"));l.CoreObject.call(this)},a.defineClass({name:"WeightedScore",ctor:r,superName:"CoreObject",props:{setFeature:function(e,t){this.recalculateScore_=!0,this.components_[e].feature=t},setStd:function(e,t){t>0&&(this.recalculateScore_=!0,this.components_[e].std=t)},setMean:function(e,t){this.recalculateScore_=!0,this.components_[e].mean=t},getFeatureValue:function(e){return this.components_[e].feature},setWeight:function(e,t){this.recalculateScore_=!0,this.components_[e].weight=t},getWeights:function(){for(var e=[],t=a.iter(this.components_);!t.done;t.next()){var o=t.value;e.push(o.weight)}return e},getNames:function(){for(var e=[],t=a.iter(this.components_);!t.done;t.next()){var o=t.value;e.push(o.featureName)}return e},getFeatures:function(){for(var e=[],t=a.iter(this.components_);!t.done;t.next()){var o=t.value;e.push(o.feature)}return e},setWeights:function(e){this.recalculateScore_=!0;for(var t=a.iter(a.range(0,e.length,!1));!t.done;t.next()){var o=t.value;this.components_[o].weight=e[o]}},setFunctionParam:function(e,t){this.recalculateScore_=!0,this.components_[e].functionParam=t},setFeatureName:function(e,t){this.components_[e].featureName=t},clearFeatures:function(){this.components_.forEach((function(e){e.feature=0}))},score:{get:function(){return this.recalculateScore_&&this.calculateScore(),isNaN(this.score_)&&s.LegacyCoreAssert.fail("nan score",void 0,"WeightedScore","WeightedScore.swift",132),this.score_}},calculateScore:function(){var e=0;this.components_.forEach((function(t){return e+=Math.atan(t.normalFeature*t.functionParam)/Math.atan(t.functionParam)*t.weight})),this.recalculateScore_=!1,this.score_=e},asString:{get:function(){return this.getOutputString(!1,!1)}},nonZeroValues:{get:function(){return this.getOutputString(!0,!0)}},asSortedString:{get:function(){return this.getOutputString(!0,!1)}},getOutputString:function(e,t){void 0===e&&(e=!1),void 0===t&&(t=!1);var o="",n=this.score,r=0;if(this.components_.length>0){o+="Features:\n";var l=[];this.components_.forEach((function(e){if(!t||0!=e.normalFeature){var o=Math.atan(e.normalFeature*e.functionParam)/Math.atan(e.functionParam);r+=e.weight*o;var n=Math.round(1e3*e.feature)/1e3,a=Math.round(1e3*e.normalFeature)/1e3,s=Math.round(1e3*e.mean)/1e3,u=Math.round(1e3*e.std)/1e3,c=Math.round(1e3*e.weight)/1e3,g=Math.round(100*c*a)/100,h=" "+i.applyFieldWidth(e.featureName,10)+":\t ("+n+" - "+s+") / "+u+" * "+c+": "+g+" \n";l.push({value:c*a,out:h})}})),e&&a.sortInPlace(l,(function(e,t){return e.value<t.value}));for(var s=a.iter(l);!s.done;s.next())o+=s.value.out}return Math.abs(r-n)>.001&&(o+="ERROR. scores don't match: "+r+", "+n+" \n"),o+="Total: "+Math.round(1e3*n)/1e3+" \n"},reject:function(){return!1},getVersion:function(){return"v"+this.versionNumber},writeFeatureDict:function(e,t){var o=this,n=0;a.each(t,(function(t,r){var i=u.ModelWeightLibrary.getData(e,t);o.setFeatureName(n,t),o.setMean(n,i.mean),o.setStd(n,i.std),o.setWeight(n,i.weight),o.setFeature(n,r),n+=1}))}}}),r)},CaSj:function(e,t,o){var n,r=t,i=o("oAGj");r.DesignSuggester=(n=function(e,t){this.maxSuggestions_=100,this.forma_=e,this.group_=t},i.defineClass({name:"DesignSuggester",ctor:n,superName:"CoreObject",statics:{perms:function(e){return n.permute(e,[])},permute:function(e,t){if(0==e.length)return[t];for(var o=[],r=i.iter(i.range(0,e.length,!1));!r.done;r.next()){var a=r.value,l=i.clone(e),s=i.clone(t);s.push(l[a]),l.splice(a,1),i.append(o,n.permute(l,s))}return o},getPermutations:function(e,t){void 0===t&&(t=50);var o=[];if(e<5){var r=i.toArray(i.range(0,e,!1));(o=i.clone(n.perms(r))).length>t&&(i.shuffleInPlace(o),o=o.slice(0,t))}else for(var a=i.iter(i.range(0,t,!1));!a.done;a.next())r=i.toArray(i.range(0,e,!1)),i.shuffleInPlace(r),o.push(r);return o}},props:{maxSuggestions:{get:function(){return this.maxSuggestions_},set:function(e){this.maxSuggestions_=e}},forma:{get:function(){return this.forma_}},group:{get:function(){return this.group_}},createSuggestions:function(){return[]}}}),n)},HG3C:function(e,t,o){var n,r,i=t,a=o("oAGj"),l=o("YSlt"),s=o("FNB+"),u=o("iCxV"),c=o("c+uM"),g=o("TkOd"),h=o("3DEm"),f=o("35Q0"),p=o("8t9B"),d=o("3UhB");i.ReadabilityInformation=(n=function(e,t){this.readabilityScore=e,this.readabilityString=t},a.defineClass({name:"ReadabilityInformation",ctor:n,props:{clone:function(){return new n(this.readabilityScore,this.readabilityString)}}}),n),i.LockupReadabilityEvaluator=(r=function(e,t){this.currentVersion="1.1",this.backgroundVariance=e,this.currentPosition=t.placement},a.defineClass({name:"LockupReadabilityEvaluator",ctor:r,statics:{calculateBackgroundVariance:function(e){var t,o=new l.ColorRankSuggester,n=[];if(t=a.as(e.controller,p.TypeLockupController))for(var r=a.iter(t.getBackgroundColorsFullList());!r.done;r.next()){var i=r.value;n.push(l.ColorForComparison.init_c063(i,1))}return o.getVarianceOfColors(n)}},props:{getAllLockupVisualWeights:function(e){var t=this,o={};return e.root.page.root.visitAll(s.FormaTraversal.PreOrder,(function(e){var n=e.formaID;if(a.as(e.controller,p.TypeLockupController)){var r=a.clone(t.getLockupVisualWeight(e));o[n]=a.clone(r)}})),o},getLockupReadabilityInformation:function(e,t){var o;if(this.updateVarianceIfPositionHasChanged(e),null!=(o=this.getDensity(e,t))){var n=this.getBackgroundColorVariance(e,t);n<=.01&&(n=.01);var r=this.getLockupContrast(e,t),a=this.getPointSize(e),l=o/100*(r/n)/100*a/100,s="{score:"+h.MathUtils.roundDoubleToString(l,6)+",density:"+h.MathUtils.roundDoubleToString(o,6)+",variance:"+h.MathUtils.roundDoubleToString(n,6)+",backVar:"+h.MathUtils.roundDoubleToString(this.backgroundVariance,6)+",contrast:"+h.MathUtils.roundDoubleToString(r,6)+",size:"+h.MathUtils.roundDoubleToString(a,6)+",ver:"+this.currentVersion+"}";return new i.ReadabilityInformation(l,s)}return null},getLockupVisualWeight:function(e){var t,o=[1,1,1],n=this.getLockupSize(e),r=this.getLockupContrast(e,e.style);return null!=(t=this.getDensity(e,e.style))?{Contrast:r,Density:t,Size:n,VisualWeight:r*o[0]+t*o[1]+n*o[2]}:{Contrast:r,Density:-1,Size:n,VisualWeight:r*o[0]+n*o[2]}},getDensity:function(e,t){var o,n,r;return null!=(o=a.opt(t.font,(function(e){return e.fontData.postScriptName})))&&(n=d.TypeLockupUtils.getFontDescriptorFromPostScriptName(e,o))&&null!=(r=n.characterFeatures.area_perimeter_ratio)?r:null},getLockupSize:function(e){var t,o,n=0;return(t=a.as(e.controller,p.TypeLockupController))&&(o=t.size)&&(n=o.area),o=n/e.page.pageSize.area},getLockupContrast:function(e,t){var o,n,r=new g.InterestingPageData(e),i=new l.ColorRankSuggester,s=g.lockupStyleToLockupStyleAttributes(t,e.page.document),h=(f.ShapeLibrary.shapeDictionary[s.backing]||f.ShapeLibrary.shapeDictionary.none).filled,p=c.LockupStyle.isKnockoutLook(t.textLook),d=s.primaryColor,m=[];if(p?(n=e.page.colorLibraryController.getSolidColorForKey(s.secondaryColor))&&m.push(n):(n=e.page.colorLibraryController.getSolidColorForKey(d))&&m.push(n),0==m.length)return u.Host.logging.warning("no color choices were available"),0;var C,y=[];if(0==h||p)for(var v=a.iter(r.colorsBehindSelectedLockup);!v.done;v.next()){var S=v.value;y.push(l.ColorForComparison.init_c063(S,1))}else(C=e.page.colorLibraryController.getSolidColorForKey(s.secondaryColor))&&y.push(l.ColorForComparison.init_c063(C,1));return 0==y.length?(u.Host.logging.warning("no color comparisons were available"),0):0==(o=a.clone(i.weightedColorContrastRanker(y,m))).length?(u.Host.logging.warning("no base weights were available"),0):o[0]/a.toDouble(y.length)},getBackgroundColorVariance:function(e,t){var o=g.lockupStyleToLockupStyleAttributes(t,e.page.document),n=0;return 0==(f.ShapeLibrary.shapeDictionary[o.backing]||f.ShapeLibrary.shapeDictionary.none).filled&&(n=this.backgroundVariance),n},getPointSize:function(e){var t,o=0;return(t=a.as(e.controller,p.TypeLockupController))&&(o=t.getAverageFontSize()),o},updateVarianceIfPositionHasChanged:function(e){e.placement.equal(this.currentPosition)||(this.currentPosition=e.placement,this.backgroundVariance=r.calculateBackgroundVariance(e))}}}),r)},HWAX:function(e,t,o){var n,r=t,i=o("oAGj"),a=o("yhkb"),l=o("C42b"),s=o("YSlt"),u=o("fNpk"),c=o("jcfx"),g=o("7Ta2");r.ColorSelectorUtils=(n=function(){},i.defineClass({name:"ColorSelectorUtils",ctor:n,statics:{getLightDarkColorToPreventIllegibility:function(e,t){for(var o=null,r=e.page.colorLibraryController.getProfilingColorKeys().concat(e.page.colorLibraryController.getThemeColorKeys()).concat(a.ColorLibraryController.BW_KEYS),l=[],u=i.iter(i.range(0,r.length,!1));!u.done;u.next()){var c,g=u.value;(c=e.page.colorLibraryController.getSolidColorForKey(r[g]))&&l.push(c)}var h,f=new s.ColorRankSuggester,p=i.clone(f.weightedColorContrastRanker(t,l));return null!=(h=n.getIndexOfContrastingColorChoice(p))&&(o=r[h]),o},getIndexOfContrastingColorChoice:function(e){var t=null,o=i.clone(e);i.sortInPlace(o);for(var n=0,r=o.length>5?o.length-5:0,a=i.iter(i.range(r,o.length,!1).reversed());!a.done;a.next()){var s=a.value;o[s]>0&&(n=o[s])}for(var u=!1;!u&&n>0;){var c=l.CoreRandom.nextIntUniform(100)%e.length;e[c]>=n&&(t=c,u=!0)}return t},getComparisonColors:function(e,t,o){var n=[];if(null!=t)for(var r=i.iter(t);!r.done;r.next()){var a=r.value;n.push(s.ColorForComparison.init_c063(a,1))}return null!=o&&n.push(o),n},getSolidColorForChoices:function(e,t,o){for(var n=[],r=i.iter(i.range(0,o.length,!1));!r.done;r.next()){var a,l=r.value;(a=e.page.colorLibraryController.getSolidColorForKey(o[l]))&&n.push(a)}return n},mapInferredRoleToProfilingRole:function(e,t){void 0===t&&(t=null);var o=i.clone(t||(new g.RoleSuggester).getRole(e));return(new c.ProfilingColorMap).getProfilingCategoryForInferredRole(o)},makeFinalDecisionOnColorChoice:function(e,t,o,r,a,l,c){if(void 0===a&&(a=!1),void 0===c&&(c=!1),0==o.length)return null;var g,h,f,p,d=new s.ColorRankSuggester,m=i.clone(d.weightedColorContrastRanker(t,r,a)),C=null,y=i.max(m);null!=y&&y>0?C=this.getContrastingChoice(c,m,o):(null==(C=n.getLightDarkColorToPreventIllegibility(e,t))&&(h=e.root)&&(f=e.finalFrame)&&(p=h.finalFrame)&&(f.intersects(p)||(C=o[0])),u.LegacyCoreAssert.isTrue(null!=C,"Error: we couldn't find a legible color :(",void 0,"ColorSelectorUtils.makeFinalDecisionOnColorChoice","ColorSelectorUtils.swift",155));if(null!=(g=C)){var v,S=this.handlePaletteMappingOverride(g,e,l,m,o);(v=e.page.colorLibraryController.getSolidColorForKey(S))&&(0!=i.clone(d.weightedColorContrastRanker(t,[v],a))[0]||l)&&(C=S)}return null==C&&(C=o[0]),C},getContrastingChoice:function(e,t,o){var n=null,r=i.max(t);if(e)n=o[i.indexOf(t,r)];else for(var a=i.iter(i.range(0,t.length,!1));!a.done;a.next()){var l=a.value;if(0!=t[l]){n=o[l];break}}return n},handlePaletteMappingOverride:function(e,t,o,n,r){var i="None";return i=o?t.formaID+c.ProfilingColorMap.backingColorKey:t.formaID,(new c.ProfilingColorMap).overridePaletteMappingDueToContrastAndForceDifference(e,i,n,r)},compareTwoColorStringsWithMargin:function(e,t){for(var o=!0,r=i.clone(n.convertColorStringToInt(e)),a=i.clone(n.convertColorStringToInt(t)),l=i.iter(i.range(0,r.length,!1));!l.done;l.next()){var s=l.value;r[s]!=a[s]&&r[s]!=a[s]-1&&r[s]!=a[s]+1&&(o=!1)}return o},convertColorStringToInt:function(e){for(var t=[],o=i.iter(i.range(0,i.toInt(e.length/3),!1));!o.done;o.next()){var n,r=o.value,a=e.substr(3*r,3);null!=(n=i.toInt(a))&&t.push(n)}return t}}}),n)},OYRJ:function(e,t,o){var n,r=t,i=o("oAGj"),a=o("UGKO"),l=o("fNpk"),s=o("K0Rh");r.FormaPlacementSuggestion=(n=function(e,t,o){l.LegacyCoreAssert.isTrue(e.kind!=s.RootForma.KIND,"forma placement suggester does not support the root forma",void 0,"FormaPlacementSuggestion.init","FormaPlacementSuggestion.swift",17),this.forma_=e,this.score_=o,this.location_=t},i.defineClass({name:"FormaPlacementSuggestion",ctor:n,statics:{_implements:function(e){return"IDesignSuggestion"==e}},props:{location:{get:function(){return this.location_}},distanceTo:function(e){var t=e,o=0,n=this.forma_.page.pageSize.hypotenuse;return o+=a.distancePositionWeight*this.location_.center.distanceTo(t.location.center)/n,o+=a.distanceSizeWeight*Math.abs(this.location_.width-t.location.width)/n,o+=a.distanceSizeWeight*Math.abs(this.location_.height-t.location.height)/n},apply:function(){this.forma_.controller.fit(this.location_)},score:{get:function(){return this.score_.score}},weightedScore:{get:function(){return this.score_}},forma:{get:function(){return this.forma_}}}}),n)},Ohrj:function(e,t,o){var n,r,i,a=t,l=o("oAGj"),s=o("yhkb"),u=o("HWAX"),c=o("fNpk"),g=o("jcfx");a.ProfilingColorSelector=(n=function(e,t){var o;this.inertiaRatio=1,this.weights=[],this.weightSum=0,this.currentIndividualIndex=0,this.numIndividualChoices=5,this.isBacking=!1,this.forma=e,this.isBacking=t,(o=l.opt(this.forma,(function(e){return e.controller})))?this.colorsBehindForma=l.clone(o.getBackgroundColors()):this.colorsBehindForma=[],this.values=e.page.colorLibraryController.getThemeColorKeys().concat(e.page.colorLibraryController.getProfilingColorKeys())},l.defineClass({name:"ProfilingColorSelector",ctor:n,props:{updateBackgroundColors:function(e){this.colorsBehindForma=l.clone(e||l.opt(l.opt(this.forma,(function(e){return e.controller})),(function(e){return e.getBackgroundColors()})))},selectColorForGlobalRecolor:function(e,t,o,n){void 0===e&&(e=!0),void 0===t&&(t=null),void 0===o&&(o=!1),void 0===n&&(n=null);var r=s.ColorLibraryController.BW_KEYS[0];if(null!=this.forma){var i=u.ColorSelectorUtils.mapInferredRoleToProfilingRole(this.forma,n),a=l.clone(u.ColorSelectorUtils.getComparisonColors(this.forma,e?this.colorsBehindForma:null,t)),c=l.clone(this.getListOfColorChoicesForRoleGlobal(i));if(c.length>0){var g,h=l.clone(u.ColorSelectorUtils.getSolidColorForChoices(this.forma,i,c));null!=(g=u.ColorSelectorUtils.makeFinalDecisionOnColorChoice(this.forma,a,c,h,o,this.isBacking,!1))&&(r=g)}}return r},selectColorForIndividualRecolor:function(e,t,o,n){void 0===e&&(e=!0),void 0===t&&(t=null),void 0===n&&(n=null);var r=s.ColorLibraryController.THEME_DERIVED_BW_KEYS[0];if(null!=this.forma){var i=u.ColorSelectorUtils.mapInferredRoleToProfilingRole(this.forma,n),a=l.clone(u.ColorSelectorUtils.getComparisonColors(this.forma,e?this.colorsBehindForma:null,t)),c=l.clone(this.getListOfColorChoicesForRoleIndividual(i));if(c.length>0){var g=l.clone(u.ColorSelectorUtils.getSolidColorForChoices(this.forma,i,c)),h=this.currentIndividualIndex%c.length,f=c.concat();f.splice(0,0,c[h]);var p,d=g.concat();d.splice(0,0,g[h]),null!=(p=u.ColorSelectorUtils.makeFinalDecisionOnColorChoice(this.forma,a,f,d,o,this.isBacking))&&(r=p)}}return this.currentIndividualIndex=(this.currentIndividualIndex+1)%this.numIndividualChoices,r},getListOfColorChoicesForRoleGlobal:function(e){return c.LegacyCoreAssert.fail("base color selector not implemented. use primary or background",void 0,"ProfilingColorSelector.getListOfColorChoicesForRoleGlobal","ColorSelector.swift",116),[]},getListOfColorChoicesForRoleIndividual:function(e){return c.LegacyCoreAssert.fail("base color selector not implemented. use primary or background",void 0,"ProfilingColorSelector.getListOfColorChoicesForRoleIndividual","ColorSelector.swift",121),[]}}}),n),a.ProfilingPrimaryColorSelector=(r=function(e,t){a.ProfilingColorSelector.call(this,e,t)},l.defineClass({name:"ProfilingPrimaryColorSelector",ctor:r,superName:"ProfilingColorSelector",props:{getListOfColorChoicesForRoleGlobal:function(e){return(new g.ProfilingColorMap).getPrimaryColorsForRoleGlobal(e,this.forma.formaID,this.forma.page)},getListOfColorChoicesForRoleIndividual:function(e){return(new g.ProfilingColorMap).getPrimaryColorsForRoleIndividual(this.forma.page,e,this.numIndividualChoices)}}}),r),a.ProfilingBackgroundColorSelector=(i=function(e,t){a.ProfilingColorSelector.call(this,e,t)},l.defineClass({name:"ProfilingBackgroundColorSelector",ctor:i,superName:"ProfilingColorSelector",props:{getListOfColorChoicesForRoleGlobal:function(e){return(new g.ProfilingColorMap).getBackgroundColorsForRoleGlobal(e,this.forma.formaID,this.forma.page)},getListOfColorChoicesForRoleIndividual:function(e){return(new g.ProfilingColorMap).getBackgroundColorsForRoleIndividual(this.forma.page,e,this.numIndividualChoices)}}}),i)},PXFs:function(e,t,o){var n,r,i,a=t,l=o("oAGj"),s=o("SpAV"),u=o("yGNn"),c=o("C42b"),g=o("QbzR"),h=o("iCxV"),f=o("xYeW"),p=o("kJ8p"),d=o("c+uM"),m=o("3DEm"),C=o("7Ta2"),y=o("35Q0"),v=o("EoOi"),S=o("8t9B"),k=o("3UhB"),P=o("oKI3"),I=o("uUew");a.PostTextStylesData=(n=function(e,t,o,n,r,i,a,l,s,u,c,g,h,f,p,d,m){this.role=e,this.msl=t,this.tracking=o,this.spacing=n,this.width=r,this.height=i,this.pageWidth=a,this.pageHeight=l,this.fontDensity=s,this.variance=u,this.backgroundVariance=c,this.contrast=g,this.numWords=h,this.numLines=f,this.fontSize=p,this.guid=d,this.limit=m},l.defineClass({name:"PostTextStylesData",ctor:n,props:{parameters:{get:function(){var e,t,o,n,r="role="+((e=this.role)||null!=e?e:C.InferredRoleType.Undefined)+"&msl="+this.msl+"&tracking="+(null!=this.tracking?m.MathUtils.roundDoubleToString(this.tracking,4):"-1.0")+"&spacing="+(null!=this.spacing?m.MathUtils.roundDoubleToString(this.spacing,4):"-1.0")+"&width="+(null!=this.width?m.MathUtils.roundDoubleToString(this.width,4):"-1.0")+"&height="+(null!=this.height?m.MathUtils.roundDoubleToString(this.height,4):"-1.0")+"&page_width="+this.pageWidth+"&page_height="+this.pageHeight+"&font_density="+(null!=this.fontDensity?m.MathUtils.roundDoubleToString(this.fontDensity,4):"-1.0")+"&variance="+(null!=this.variance?m.MathUtils.roundDoubleToString(this.variance,4):"-1.0")+"&background_variance="+(null!=this.backgroundVariance?m.MathUtils.roundDoubleToString(this.backgroundVariance,4):"-1.0")+"&contrast="+(null!=this.contrast?m.MathUtils.roundDoubleToString(this.contrast,4):"-1.0")+"&num_words="+((t=this.numWords)||null!=t?t:-1)+"&num_lines="+((o=this.numLines)||null!=o?o:-1)+"&avg_font_size="+(null!=this.fontSize?m.MathUtils.roundDoubleToString(this.fontSize,4):"-1.0")+"&guid="+((n=this.guid)||null!=n?n:"Null")+"&limit="+this.limit;return l.replaceAll(r," ","%20")}},clone:function(){return new n(this.role,this.msl,this.tracking,this.spacing,this.width,this.height,this.pageWidth,this.pageHeight,this.fontDensity,this.variance,this.backgroundVariance,this.contrast,this.numWords,this.numLines,this.fontSize,this.guid,this.limit)}}}),n),a.layoutAlignmentData=(r=function(e,t){this.layout=e,this.alignment=t},l.defineClass({name:"layoutAlignmentData",ctor:r,props:{clone:function(){return new r(this.layout,this.alignment)}}}),r),a.PostTextStylesServiceInterface=(i=function(e,t){var o;this.suggestedStyle=null,this.serviceAPIKey="Theo2",this.stylesAPIUrl="https://posttextstylesservice.adobe.io/styles?",this.emphasisAPIUrl="https://posttextstylesservice.adobe.io/text/emphasis",this.apiCallLimit=225,this.limitToEvaluate=4,this.thresholdToCallEmphasisService=3,this.maxThresholdToCallEmphasisService=30,this._advancedFeatures=!1,this.forma=e,this.readabilityInfo=t,this.stylesAPICache=[],this.tokenCache=[],this.emphasisAPICache=[],this.autoTextCache=[],this.styleRanges=[],this.emphasisIndex=0,this.originalText="",(o=l.as(this.forma.controller,S.TypeLockupController))&&(o.styleController.setSessionContainerSize(o.size),o.styleController.setSessionContainerCenter(l.opt(this.forma.frame,(function(e){return e.center}))))},l.defineClass({name:"PostTextStylesServiceInterface",ctor:i,superName:"CoreObject",statics:{PROBABILITY_STYLE_CHANGE:.5,PROBABILITY_STANDARD_LAYOUT:.3,PROBABILITY_MAGIC_LAYOUT:.5,PROBABILITY_PATH_LAYOUT:.7,PROBABILITY_GRID_LAYOUT:.8,PATH_LAYOUT_MIN_TRACKING:0,PATH_LAYOUT_MAX_TRACKING:.45,PATH_LAYOUT_MIN_CHARACTERS:12,PATH_LAYOUT_MAX_CHARACTERS:30},props:{advancedFeatures:{get:function(){return this._advancedFeatures},set:function(e){this._advancedFeatures=e}},overrideAPIKey:function(e){this.serviceAPIKey=e},resetAutoTextCache:function(){var e;this.autoTextCache.splice(0),(e=l.as(this.forma.controller,S.TypeLockupController))&&(this.originalText=e.text,this.autoTextCache=l.clone(v.TypographyComposer.getApplicableLayouts(e.text)),this.styleRanges=l.clone(e.charStyleRanges))},getAdvancedTextStyleSuggestion:function(e){var t,o=null;if(t=l.as(this.forma.controller,S.TypeLockupController)){if(this.originalText!=t.text&&(this.resetAutoTextCache(),t.styleController.resetSessionContainerSize(),t.styleController.resetSessionContainerCenter()),t.styleController.setSessionContainerSize(t.size),t.styleController.setSessionContainerCenter(l.opt(this.forma.frame,(function(e){return e.center}))),t.beginBlockedUpdate(),l.toDouble(c.CoreRandom.nextInt)/l.toDouble(c.CoreRandom.randMax)<i.PROBABILITY_STYLE_CHANGE&&(o=this.getTextStyleSuggestion(e)),null==o){(o=t.lockupStyle).pathID=P.TextPathID.UNSET;var n=l.toDouble(c.CoreRandom.nextInt)/l.toDouble(c.CoreRandom.randMax);if(n<i.PROBABILITY_STANDARD_LAYOUT){if(o.layout==d.LockupLayout.Standard){for(var r=d.LockupAlignment.toCaseValue(l.toInt(Math.round(2*l.toDouble(c.CoreRandom.nextInt)/l.toDouble(c.CoreRandom.randMax))));r==o.alignment;)r=d.LockupAlignment.toCaseValue(l.toInt(Math.round(2*l.toDouble(c.CoreRandom.nextInt)/l.toDouble(c.CoreRandom.randMax))));o.alignment=r}else o.layout=d.LockupLayout.Standard,o.alignment=d.LockupAlignment.toCaseValue(l.toInt(Math.round(2*l.toDouble(c.CoreRandom.nextInt)/l.toDouble(c.CoreRandom.randMax))));t.charStyleRanges=l.clone(this.styleRanges)}else if(n<i.PROBABILITY_MAGIC_LAYOUT&&o.layout!=d.LockupLayout.FitJustified)o.layout=d.LockupLayout.FitJustified,o.alignment=d.LockupAlignment.UNSET,t.charStyleRanges=l.clone(this.styleRanges);else if(n<i.PROBABILITY_PATH_LAYOUT&&t.text.length>i.PATH_LAYOUT_MIN_CHARACTERS){o.alignment=d.LockupAlignment.UNSET;var a=1+l.toInt(Math.round(2*l.toDouble(c.CoreRandom.nextInt)/l.toDouble(c.CoreRandom.randMax)));if(o.layout==d.LockupLayout.Path)for(;P.TextPathID.toCaseValue(a)==o.pathID;)a=1+l.toInt(Math.round(2*l.toDouble(c.CoreRandom.nextInt)/l.toDouble(c.CoreRandom.randMax)));else o.layout=d.LockupLayout.Path;o.pathID=P.TextPathID.toCaseValue(a);var s=this.calcPathTracking(t.text.length);a>1&&(s/=2),o.tracking=s,t.charStyleRanges=l.clone(this.styleRanges)}else if(n<i.PROBABILITY_GRID_LAYOUT||0==this.autoTextCache.length){if(o.layout==d.LockupLayout.LetterGrid){for(r=d.LockupAlignment.toCaseValue(l.toInt(Math.round(2*l.toDouble(c.CoreRandom.nextInt)/l.toDouble(c.CoreRandom.randMax))));r==o.alignment;)r=d.LockupAlignment.toCaseValue(l.toInt(Math.round(2*l.toDouble(c.CoreRandom.nextInt)/l.toDouble(c.CoreRandom.randMax))));o.alignment=r}else o.layout=d.LockupLayout.LetterGrid,o.alignment=d.LockupAlignment.toCaseValue(l.toInt(Math.round(2*l.toDouble(c.CoreRandom.nextInt)/l.toDouble(c.CoreRandom.randMax))));t.charStyleRanges=l.clone(this.styleRanges)}else{var u,g=!1;if(this.autoTextCache.length>0&&o.layout!=d.LockupLayout.Auto)o.layout=d.LockupLayout.Auto,r=this.autoTextCache[l.toInt(l.toDouble(this.autoTextCache.length)*l.toDouble(c.CoreRandom.nextInt)/l.toDouble(c.CoreRandom.randMax))],(u=v.TypographyComposer.getWeightingForAlignment(r,t.text))&&(t.autoTextRanges=l.clone(u),g=!0,o.alignment=r);if(!g){for(o.layout=d.LockupLayout.Standard,r=d.LockupAlignment.toCaseValue(l.toInt(Math.round(2*l.toDouble(c.CoreRandom.nextInt)/l.toDouble(c.CoreRandom.randMax))));r==o.alignment;)r=d.LockupAlignment.toCaseValue(l.toInt(Math.round(2*l.toDouble(c.CoreRandom.nextInt)/l.toDouble(c.CoreRandom.randMax))));o.alignment=r}t.charStyleRanges=l.clone(this.styleRanges)}o.backing!=d.LockupBacking.None&&(y.ShapeLibrary.isBackingShapeStyleCompatible(o,o.backing,o.backingArtworkID)||(o.backing=d.LockupBacking.SVGBackground,o.backingArtworkID="square_001",y.ShapeLibrary.isBackingShapeStyleCompatible(o,o.backing,o.backingArtworkID)||(o.backing=d.LockupBacking.None,o.backingArtworkID=null)))}return t.endBlockedUpdate(),o}return this.getTextStyleSuggestion(e)},calcPathTracking:function(e){if(e>i.PATH_LAYOUT_MAX_CHARACTERS)return i.PATH_LAYOUT_MIN_TRACKING;if(e<i.PATH_LAYOUT_MIN_CHARACTERS)return i.PATH_LAYOUT_MAX_TRACKING;var t=i.PATH_LAYOUT_MAX_CHARACTERS-i.PATH_LAYOUT_MIN_CHARACTERS,o=i.PATH_LAYOUT_MAX_TRACKING-i.PATH_LAYOUT_MIN_TRACKING,n=e-i.PATH_LAYOUT_MIN_CHARACTERS,r=(1-l.toDouble(n)/l.toDouble(t))*o;return i.PATH_LAYOUT_MIN_TRACKING+r},getTextStyleSuggestion:function(e){var t,o=null;if(this.stylesAPICache.length>0&&(t=l.as(this.forma.controller,S.TypeLockupController))){for(var n=t.styleController,r=0;null==o&&r<this.limitToEvaluate&&0!=this.stylesAPICache.length;)o=n.updateLockupStyleWithNewColors(this.decodeStyleAPIObject(this.stylesAPICache.shift())),null!=e&&(r+=1,o=e.lockupStyleEvaluator.styleEvaluatedWithReadability(o));null==o&&this.stylesAPICache.length>0&&(o=n.updateLockupStyleWithNewColors(this.decodeStyleAPIObject(this.stylesAPICache.shift())),l.opt(o,(function(e){return e.wheelUsed=!0})))}return o},getNextTextEmphasisSuggestion:function(){return this.emphasisAPICache.length>0?(this.emphasisIndex+=1,this.emphasisAPICache[this.emphasisIndex%this.emphasisAPICache.length]):null},getCurrentTextEmphasisSuggestion:function(){return this.emphasisAPICache.length>0?this.emphasisAPICache[this.emphasisIndex%this.emphasisAPICache.length]:null},getNumStylesInCache:function(){return this.stylesAPICache.length},getEmphasisCache:function(){return this.emphasisAPICache},getEmphasisTokens:function(){return this.tokenCache},resetStyleSuggestions:function(e){return void 0===e&&(e=!1),this.advancedFeatures&&(this.resetAutoTextCache(),this.resetEmphasisSuggestions(!0)),this.stylesAPICache=[],this.stylesPromise=null,this.populateStylesCacheWithAPISuggestions(e)},resetEmphasisSuggestions:function(e){return this.emphasisAPICache=[],this.tokenCache=[],this.emphasisIndex=0,this.emphasisPromise=null,this.populateEmphasisCacheWithAPISuggestions(e)},getNLPInformtionForCurrentEmphasized:function(){var e,t=[];if(e=l.as(this.forma.controller,S.TypeLockupController))for(var o=l.clone(e.charStyleRanges),n=l.iter(o);!n.done;n.next()){for(var r=n.value,i="",a=l.iter(this.tokenCache);!a.done;a.next()){var s,u,c,g,h,f=a.value;if(null!=(s=l.as(f.offset,"Int"))&&s>=r.start&&s<r.end&&null!=(u=l.as(f.index,"Int"))&&null!=(c=l.as(f.pos,"String"))&&null!=(g=l.as(f.relation,"String"))&&null!=(h=l.as(f.tag,"String"))){var p=null,d=null,m=null;u>=0&&u<=this.tokenCache.length&&(p=l.as(this.tokenCache[u].pos,"String"),d=l.as(this.tokenCache[u].relation,"String"),m=l.as(this.tokenCache[u].tag,"String"));var C="";C+="{",C+="index:"+l.toString(u),C+="\\,pos:"+c,C+="\\,rela:"+g,C+="\\,tag:"+h,C+="\\,depPos:"+(null!=p?p:"none"),C+="\\,depRela:"+(null!=d?d:"none"),C+="\\,depTag:"+(null!=m?m:"none"),i+=C+="}"}}i.length>0&&t.push(i)}return t},getStylesPromise:function(e){var t,o,n=this,r=l.as(this.forma.controller,S.TypeLockupController),i=l.clone(new a.PostTextStylesData((new C.RoleSuggester).getRole(this.forma).role,((t=l.opt(r,(function(e){return e.charStyleRanges.length})))||null!=t?t:0)>0||e,l.opt(l.opt(r,(function(e){return e.lockupStyle})),(function(e){return e.tracking})),l.opt(l.opt(r,(function(e){return e.lockupStyle})),(function(e){return e.spacing})),l.opt(l.opt(r,(function(e){return e.size})),(function(e){return e.width})),l.opt(l.opt(r,(function(e){return e.size})),(function(e){return e.height})),this.forma.page.pageSize.width,this.forma.page.pageSize.height,l.opt(r,(function(e){return null!=e.lockupStyle?l.opt(n.readabilityInfo,(function(e){return e.getDensity(n.forma,r.lockupStyle)})):null})),l.opt(r,(function(e){return null!=e.lockupStyle?l.opt(n.readabilityInfo,(function(e){return e.getBackgroundColorVariance(n.forma,r.lockupStyle)})):null})),l.opt(r,(function(e){return null!=e.lockupStyle?l.opt(n.readabilityInfo,(function(e){return e.backgroundVariance})):null})),l.opt(r,(function(e){return null!=e.lockupStyle?l.opt(n.readabilityInfo,(function(e){return e.getLockupContrast(n.forma,r.lockupStyle)})):null})),l.opt(r,(function(e){return e.wordCount()})),l.opt(r,(function(e){return e.numLines()})),l.opt(r,(function(e){return e.getAverageFontSize()})),null,this.apiCallLimit));if(o=h.Host.network){var s=new p.HostNetworkRequest(this.stylesAPIUrl+i.parameters);return s.method=p.HostNetworkRequestMethod.get,s.headers["x-api-key"]=this.serviceAPIKey,s.headers["x-live-data"]="false",o.request(s)}return u.CorePromise.reject("Unable to create Host network request")},getEmphasisPromise:function(){var e,t,o,n=l.as(this.forma.controller,S.TypeLockupController);if((e=h.Host.network)&&(t=h.Host.dataFactory)&&null!=(o=l.opt(n,(function(e){return e.text})))){var r,i=new p.HostNetworkRequest(this.emphasisAPIUrl);return i.headers["x-api-key"]=this.serviceAPIKey,(r=this.getEmphasisHostDataProtocol(o,t))?(i.method=p.HostNetworkRequestMethod.post,i.data=t.createFromFormData(r),e.request(i)):u.CorePromise.resolve("No valid data object to sent")}return u.CorePromise.reject("Unable to create Host network request")},getEmphasisHostDataProtocol:function(e,t){var o,n=l.replaceAll(e,"\n"," ");return n=l.replaceAll(n,"\r"," "),n=l.replaceAll(n,"\t"," "),this.containsLetters(n)&&(o=t.createFromString(n,"text/plain"))?{text:new f.HostNetworkFormDatum(o)}:null},containsLetters:function(e){for(var t=l.iter(l.range(0,e.length,!1));!t.done;t.next()){var o=t.value,n=e.substr(o,1);if(n>="a"&&n<="z"||n>="A"&&n<="Z")return!0}return!1},populateStylesCacheWithAPISuggestions:function(e){var t,o=this;return this.stylesPromise=this.getStylesPromise(e),(t=this.stylesPromise)?t.then((function(e){var t;return(t=l.opt(l.opt(l.as(e,p.HostNetworkResponse),(function(e){return e.data})),(function(e){return e.asJSON()})))?t.then((function(e){var t,n;if((t=l.as(e,["Dictionary","String","Any"]))&&(n=l.as(t.styles,["Array",["Dictionary","String","Any"]]))){for(var r=l.iter(n);!r.done;r.next()){var i=r.value;o.stylesAPICache.push(i)}return u.CorePromise.resolve(null)}return u.CorePromise.reject("Unable to decode object")})):u.CorePromise.reject("Unable to process response")})):u.CorePromise.reject("unable to get styles promise")},decodeStyleAPIObject:function(e){var t=this.getPrimaryStyleFromDict(e);if(null!=e.hasMSL){var o=this.getSecondaryStyleFromDict(e,t);t.setCharacterStyle(S.TypeLockupController.HIGHLIGHT_STYLE,o)}return t},populateEmphasisCacheWithAPISuggestions:function(e){var t,o=this;if(null!=(t=this.getBaselineEmphasisSuggestions())&&(t<this.thresholdToCallEmphasisService||t>this.maxThresholdToCallEmphasisService))return u.CorePromise.resolve("No need to use emphasis service, just cycle through options");var n=this.getEmphasisPromise();return this.emphasisPromise=n,n.then((function(t){var n,r;return(n=l.as(t,p.HostNetworkResponse))&&(r=l.opt(n.data,(function(e){return e.asJSON()})))?r.then((function(t){var r;return(r=o.decodeEmphasisResponse(t))&&e&&(o.emphasisAPICache=l.clone(r)),u.CorePromise.resolve(n)})):u.CorePromise.resolve("Unable to process emphasis response")}))},getBaselineEmphasisSuggestions:function(){var e;if(this.advancedFeatures){if(e=l.as(this.forma.controller,S.TypeLockupController)){var t=[],o=l.clone(v.TypographyComposer.getWordRanges(e.text,null));if(o.length>1){for(var n=l.iter(o);!n.done;n.next()){var r=n.value;t.push([r])}this.emphasisAPICache=l.clone(t)}return t.length}}else if(e=l.as(this.forma.controller,S.TypeLockupController)){var i=l.clone(e.getAllTextFormae());if(t=[],i.length<10)for(var a=l.iter(i);!a.done;a.next()){var s=a.value;t.push([s.rangeInLockup])}else for(var u=l.iter(l.range(0,l.toInt(i.length/2),!1));!u.done;u.next()){var c=2*u.value,g=c+1;t.push([i[c].rangeInLockup,i[g].rangeInLockup])}return t.length>1&&(this.emphasisAPICache=l.clone(t)),t.length}return null},decodeNLP:function(e,t,o){for(var n=l.iter(t);!n.done;n.next()){var r,i=n.value;if(r=l.as(i.categories,["Array","Int"]))for(var a=l.clone(e.getAllTextFormae()),s=l.iter(a);!s.done;s.next()){var u=s.value;if(u.text.toLowerCase().includes(i.text.toLowerCase())&&i.offset==u.rangeInLockup.start){for(var c=l.iter(r);!c.done;c.next())o[c.value].push(u.rangeInLockup);break}}}},decodeNLPAdvanced:function(e,t,o){for(var n=e.text,r=l.iter(t);!r.done;r.next()){var i,a,s,u=r.value;if((i=l.as(u.categories,["Array","Int"]))&&null!=(a=l.as(u.text,"String"))&&null!=(s=l.as(u.offset,"Int"))&&n.substr(s,a.length)==a)for(var c=l.iter(i);!c.done;c.next())o[c.value].push(new I.TextRange(s,s+a.length))}},decodeEmphasisResponse:function(e){var t,o,n,r;if((h=l.as(e,["Dictionary","String","Any"]))&&(t=l.as(h.emphasis,["Array",["Dictionary","String","Any"]]))&&(o=l.as(t[0].words,["Array",["Dictionary","String","Any"]]))&&(n=l.as(t[0].categories,["Array","Int"]))&&(r=l.as(t[0].tokens,["Array",["Dictionary","String","Any"]]))){this.tokenCache=l.clone(r);for(var i,a={},s=l.iter(n);!s.done;s.next())a[s.value]=[];(i=l.as(this.forma.controller,S.TypeLockupController))&&(this.advancedFeatures?this.decodeNLPAdvanced(i,o,a):this.decodeNLP(i,o,a));for(var u=[],c=l.sort(l.keys(a,"numeric")),g=l.iter(c);!g.done;g.next()){var h,f=g.value;(h=l.clone(a[f])).length>0&&u.push(h)}return u}return null},decodeNLPResponse:function(e){var t,o,n,r;if((h=l.as(e,["Dictionary","String","Any"]))&&(t=l.as(h.emphasis,["Array",["Dictionary","String","Any"]]))&&(o=l.as(t[0].words,["Array",["Dictionary","String","Any"]]))&&(n=l.as(t[0].categories,["Array","Int"]))&&(r=l.as(t[0].tokens,["Array",["Dictionary","String","Any"]]))){this.tokenCache=l.clone(r);for(var i,a={},s=l.iter(n);!s.done;s.next())a[s.value]=[];(i=l.as(this.forma.controller,S.TypeLockupController))&&(this.advancedFeatures?this.decodeNLPAdvanced(i,o,a):this.decodeNLP(i,o,a));for(var u=[],c=l.sort(l.keys(a,"numeric")),g=l.iter(c);!g.done;g.next()){var h,f=g.value;(h=l.clone(a[f])).length>0&&u.push(h)}return u}return null},getPrimaryStyleFromDict:function(e){var t,o,n,r,i,a,s,u,c,g,h,f,p=(t=l.as(e.textOpacity,"Double"))||null!=t?t:d.LockupStyle.DEFAULT_TEXTOPACITY,m=(o=l.as(e.backingOpacity,"Double"))||null!=o?o:d.LockupStyle.DEFAULT_BACKINGOPACITY,C=(n=l.as(e.spacing,"Double"))||null!=n?n:d.LockupStyle.DEFAULT_SPACING,y=(r=l.as(e.tracking,"Double"))||null!=r?r:d.LockupStyle.DEFAULT_TRACKING,v=(i=l.as(e.padding,"Double"))||null!=i?i:d.LockupStyle.DEFAULT_PADDING,S=null==l.as(e.backing,"Int")||!(a=d.LockupBacking.toCaseValue(e.backing))&&null==a?d.LockupBacking.None:a,k=(s=l.as(e.backingArtworkID,"String"))||null!=s?s:null,I=(u=l.as(e.shadowAngle,"Double"))||null!=u?u:d.LockupStyle.DEFAULT_SHADOWANGLE,L=null==l.as(e.textLook,"Int")||!(c=d.LockupTextLook.toCaseValue(e.textLook))&&null==c?d.LockupTextLook.Fill:c,A=(g=l.as(e.shadowOffset,"Double"))||null!=g?g:d.LockupStyle.DEFAULT_SHADOWOFFSET,F=(h=l.as(e.strokeWeight,"Double"))||null!=h?h:d.LockupStyle.DEFAULT_STROKEWEIGHT,T=this.getTheoFont(e,"primaryFont"),b=l.clone(this.getLayoutAlignment(e)),D=P.TextPathID.UNSET;if(b.layout==d.LockupLayout.Path){var x=l.as(e.pathId,"Int");D=null==x||!(f=P.TextPathID.toCaseValue(x))&&null==f?P.TextPathID.Circle:f}return S=this.checkBackingValid(S,k),L=this.checkTextLookValid(L),d.LockupStyle.init_f3fd(p,m,null,T,C,y,v,S,k,I,b.layout,b.alignment,L,A,F,D)},getSecondaryStyleFromDict:function(e,t){var o,n,r,i,a,s=d.LockupStyle.createDefaultCharacterStyle(t);s.font=this.getTheoFont(e,"mslFont"),s.textOpacity=(o=l.as(e.mslOpacity,"Double"))||null!=o?o:g.FormaStyle.OPACITY_UNSET,s.padding=(n=l.as(e.mslPadding,"Double"))||null!=n?n:d.LockupStyle.DEFAULT_PADDING;var u=null==l.as(e.mslBacking,"Int")||!(r=d.LockupBacking.toCaseValue(e.mslBacking))&&null==r?d.LockupBacking.None:r;return s.backingArtworkID=(i=l.as(e.mslBackingArtworkID,"String"))||null!=i?i:null,s.textLook=null==l.as(e.mslTextLook,"Int")||!(a=d.LockupTextLook.toCaseValue(e.mslTextLook))&&null==a?d.LockupTextLook.Fill:a,s.textLook=this.checkTextLookValid(s.textLook),s.backing=this.checkBackingValid(u,s.backingArtworkID),s},checkBackingValid:function(e,t){return e==d.LockupBacking.SVGBackground&&null==t?(s.CoreAssert.fail("Backing set to SVG, but no backing artwork ID found",void 0,"PostTextStylesServiceInterface.checkBackingValid","PostTextStylesServiceInterface.swift",822),d.LockupBacking.None):e},checkTextLookValid:function(e){return e<0?d.LockupTextLook.Fill:e},getTheoFont:function(e,t){var o,n,r=null;return null!=(o=l.as(e[t],"String"))&&(n=k.TypeLockupUtils.getFontDescriptorFromPostScriptName(this.forma,o))&&(r=k.TypeLockupUtils.createTheoFont(n,null)),r},getLayoutAlignment:function(e){var t,o,n,r,i=l.clone(new a.layoutAlignmentData(d.LockupLayout.FitJustified,d.LockupAlignment.UNSET)),u=(t=l.as(e.layout,"Int"))||null!=t?t:d.LockupLayout.UNSET;return(r=this.fixLegacyLayout(u))?(i.layout=r.layout,i.alignment=r.alignment):(i.layout=(o=d.LockupLayout.toCaseValue(u))||null!=o?o:d.LockupLayout.FitJustified,i.alignment=null==l.as(e.alignment,"Int")||!(n=d.LockupAlignment.toCaseValue(e.alignment))&&null==n?d.LockupAlignment.UNSET:n,i.layout==d.LockupLayout.FitJustified&&s.CoreAssertDebugOnly.isTrue(i.alignment==d.LockupAlignment.UNSET,"If layout is FitJustified, alignment should be UNSET",void 0,"PostTextStylesServiceInterface.getLayoutAlignment","PostTextStylesServiceInterface.swift",859)),i},fixLegacyLayout:function(e){var t;if(null!=(t=d.LockupLayout.toCaseValue(e)))switch(t){case 3:return new a.layoutAlignmentData(d.LockupLayout.Standard,d.LockupAlignment.Center);case 1:return new a.layoutAlignmentData(d.LockupLayout.Standard,d.LockupAlignment.Left);case 2:return new a.layoutAlignmentData(d.LockupLayout.Standard,d.LockupAlignment.Right);default:return null}return null}}}),i)},UGKO:function(e,t,o){var n,r,i=t,a=o("oAGj"),l=o("fNpk"),s=o("8t9B");i.distanceColorWeight=1,i.distanceSizeWeight=.25,i.distancePositionWeight=.5,i.IDesignSuggestion=a.defineProtocol("IDesignSuggestion",{apply:"() -> Void",distanceTo:"(IDesignSuggestion) -> Double",score:"Double",weightedScore:"WeightedScore",forma:"Forma"}),i.DesignTextSuggestion=(n=function(e,t){this.text_=t;var o=a.as(e.controller,s.TypeLockupController);l.LegacyCoreAssert.isTrue(null!=o,"must be type lockup controller",void 0,"DesignTextSuggestion.init","DesignSuggestion.swift",31),this.forma_=e},a.defineClass({name:"DesignTextSuggestion",ctor:n,statics:{_implements:function(e){return"IDesignSuggestion"==e}},props:{apply:function(){var e=this,t=a.as(this.forma_.controller,s.TypeLockupController);a.opt(a.opt(t,(function(e){return e.contentNode})),(function(t){return t.text=e.text_})),a.opt(t,(function(e){return e.updateGroup()})),a.opt(a.opt(this.forma_.page.document,(function(e){return e.controller})),(function(e){return e.controllerSettingsState.settings=null}))},distanceTo:function(e){return l.LegacyCoreAssert.fail("no distance",void 0,"DesignTextSuggestion.distanceTo","DesignSuggestion.swift",45),0},score:{get:function(){return null}},weightedScore:{get:function(){return null}},forma:{get:function(){return this.forma_}}}}),n),i.AddFormaSuggestion=(r=function(e,t){this.parent_=t,this.forma_=e},a.defineClass({name:"AddFormaSuggestion",ctor:r,statics:{_implements:function(e){return"IDesignSuggestion"==e}},props:{apply:function(){this.parent_.appendChild(this.forma_)},distanceTo:function(e){return l.LegacyCoreAssert.fail("no distance",void 0,"AddFormaSuggestion.distanceTo","DesignSuggestion.swift",68),0},score:{get:function(){return null}},weightedScore:{get:function(){return null}},forma:{get:function(){return this.forma_}}}}),r)},UqVc:function(e,t,o){var n,r=t,i=o("oAGj");r.SuggestionUtils=(n=function(){},i.defineClass({name:"SuggestionUtils",ctor:n,props:{normalizedWeights:function(e){var t,o,n=[];if(null!=(t=i.min(e))&&null!=(o=i.max(e)))for(var r=o-t==0,a=i.iter(e);!a.done;a.next()){var l=a.value;if(r)n.push(1);else{var s=(l-t)/(o-t);n.push(s)}}return n},weightsEqualNaNOrEmpty:function(e){if(0==e.length==1)return!0;for(var t=i.iter(e);!t.done;t.next()){var o=t.value;if(1==isNaN(o))return!0}return!1}}}),n)},YSlt:function(e,t,o){var n,r,i=t,a=o("oAGj"),l=o("iCxV"),s=o("3DEm"),u=o("Zifs");i.ColorForComparison=(n=function(){this.role=""},a.defineClass({name:"ColorForComparison",ctor:n,props:{init_c063:function(e,t,o){void 0===o&&(o=""),this.color=e,this.weight=t,this.role=o},init_implicit:function(e,t,o){void 0===o&&(o=""),this.color=e,this.weight=t,this.role=o},clone:function(){return n.init_implicit(this.color,this.weight,this.role)}}}),n),i.ColorRankSuggester=(r=function(){},a.defineClass({name:"ColorRankSuggester",ctor:r,superName:"CoreObject",props:{weightedColorContrastRanker:function(e,t,o){var n;void 0===o&&(o=!1);var r=15*a.toDouble(e.length);o&&(r*=2);for(var i=a.repeat(0,t.length),l=a.iter(a.range(0,t.length,!1));!l.done;l.next()){for(var s=l.value,c=t[s],g=0,h=a.iter(a.range(0,e.length,!1));!h.done;h.next()){var f,p=h.value;if(f=e[p].color){var d=(n=e[p].weight)||null!=n?n:1;if(a.eq(u._equality_SolidColor_SolidColor,c,f))g+=1;else{var m=(1*f.perceptualDifference(c)+50*Math.pow(f.lightnessDifference(c)/50,2)*.7)/2;i[s]+=m*d}}}var C=a.toDouble(g)/a.toDouble(e.length);C>.4||g==e.length||i[s]<r?i[s]=0:i[s]*=1-C}return i},getVarianceOfColors:function(e){if(e.length<1)return a.opt(l.Host.logging,(function(e){return e.info("ColorRankSuggester.getVarianceOfColors() has no colors in listOfCompared")})),0;var t=[];t.push([]),t.push([]),t.push([]),t.push([]);for(var o=a.iter(e);!o.done;o.next()){var n;(n=(d=o.value).color)&&(t[0].push(n.red),t[1].push(n.green),t[2].push(n.blue),t[3].push(n.alpha))}for(var r=[],i=a.iter(t);!i.done;i.next()){var c,g=i.value;null!=(c=s.MathUtils.getMean(g))&&r.push(c)}if(4!=r.length)return a.opt(l.Host.logging,(function(e){return e.info("ColorRankSuggester.getVarianceOfColors(): Unable to get complete avgRGBA values. # Values = "+a.toString(r.length))})),0;for(var h=new u.SolidColor(r[0],r[1],r[2],r[3]),f=[],p=a.iter(e);!p.done;p.next()){var d;(d=p.value.color)&&f.push(d.perceptualDifference(h))}return this.getVarianceFromDifferences(f)},getVarianceFromDifferences:function(e){for(var t=0,o=a.iter(e);!o.done;o.next()){var n=o.value;t+=n*n}return t/a.toDouble(e.length)}}}),r)},ZLO9:function(e,t,o){var n,r=t,i=o("oAGj"),a=o("gXiO");r.RetargetDocumentData=(n=function(e,t,o,n,r,l,s,u,c,g,h,f,p){this.docID=e,this.size=t,this.lockupStrings=i.clone(o),this.focus=n,this.numImages=r,this.edgeMap=i.clone(s),this.layoutID=u,this.numMoveable=l,this.numGridCells=c,this.textRoles=i.clone(g),this.shapeRoles=i.clone(h),this.salientCoverage=f,this.visualGroupInfo=i.clone(p),a.CoreObject.call(this)},i.defineClass({name:"RetargetDocumentData",ctor:n,superName:"CoreObject"}),n)},eiag:function(e,t,o){var n,r=t,i=o("oAGj"),a=o("gXiO");r.FormaPlacementInput=(n=function(e,t,o,n,r,l,s){this.forma=e,this.otherRects=i.clone(t),this.floatingRects=i.clone(o),this.textRects=i.clone(n),this.imageRects=i.clone(r),this.images=i.clone(l),this.backgroundRegions=i.clone(s),a.CoreObject.call(this)},i.defineClass({name:"FormaPlacementInput",ctor:n,superName:"CoreObject"}),n)},h8Q5:function(e,t,o){var n,r=t,i=o("oAGj"),a=o("hb8m"),l=o("PXFs");r.WheelSuggestionEvaluator=(n=function(e){this.lockupStyleEvaluator=new a.LockupStyleEvaluator(e),this.postTextStylesServiceInterface=new l.PostTextStylesServiceInterface(e,this.lockupStyleEvaluator.getLockupReadabilityEvaluator())},i.defineClass({name:"WheelSuggestionEvaluator",ctor:n,superName:"CoreObject",props:{getTextStyleSuggestion:function(e){return this.postTextStylesServiceInterface.advancedFeatures?this.postTextStylesServiceInterface.getAdvancedTextStyleSuggestion(e):this.postTextStylesServiceInterface.getTextStyleSuggestion(e)}}}),n)},hb8m:function(e,t,o){var n,r=t,i=o("oAGj"),a=o("wc1n"),l=o("xRbc"),s=o("HG3C"),u=o("c+uM"),c=o("35Q0");r.LockupStyleEvaluator=(n=function e(t){this.forma_=t,this.initialStyle_=t.style,this.backgroundVariance=s.LockupReadabilityEvaluator.calculateBackgroundVariance(t),this.lockupVisualWeightEvaluator=new s.LockupReadabilityEvaluator(this.backgroundVariance,t),this.oldReadabilityInformation=i.clone(this.lockupVisualWeightEvaluator.getLockupReadabilityInformation(this.forma_,this.initialStyle_)),this.featuresNeeded=[l.LockupRoleFeatures.SurroundingAlignment];var o=a.FeatureExtractorFactory.getFeatureExtractor(a.FeatureExtractorType.LockupStyle,this.forma_,this.featuresNeeded);this.majorityAlignment=e.getSurroundingAlignment(o)},i.defineClass({name:"LockupStyleEvaluator",ctor:n,superName:"CoreObject",statics:{getCollisionPercentage:function(e){var t,o=0;return null!=(t=e.numericFeatureForKey(l.LockupRoleFeatures.CollisionPercentage))&&(o=t),o},getSurroundingAlignment:function(e){var t,o,n=u.LockupAlignment.UNSET;return null!=(t=e.featureForKey(l.LockupRoleFeatures.SurroundingAlignment))&&null!=(o=i.as(t,u.LockupAlignment))&&(n=o),n}},props:{getMajorityAlignment:function(){return this.majorityAlignment},styleEvaluatedWithReadability:function(e){var t=e;return 1==e.wheelUsed||e.isEqualTo(this.initialStyle_)?e:(this.newReadabilityInformation=i.clone(this.lockupVisualWeightEvaluator.getLockupReadabilityInformation(this.forma_,e)),e.backing==u.LockupBacking.Knockout&&(t=null),null!=t&&this.replaceBadBackingShapes(t),e.layout!=u.LockupLayout.FitJustified&&e.layout!=u.LockupLayout.Path&&e.layout!=u.LockupLayout.LetterGrid&&this.majorityAlignment!=u.LockupAlignment.UNSET&&e.alignment!=this.majorityAlignment&&(t=null),null!=this.newReadabilityInformation&&null!=this.oldReadabilityInformation&&this.newReadabilityInformation.readabilityScore<=this.oldReadabilityInformation.readabilityScore/2&&(t=null),t)},replaceBadBackingShapes:function(e){if(e.backing==u.LockupBacking.SVGBackground){var t=e.backing,o=e.backingArtworkID;c.ShapeLibrary.isBackingShapeAutoLayoutCompatible(t,o)||(e.backingArtworkID="square_001")}},initializeReadabilityInformation:function(e){this.newReadabilityInformation=i.clone(this.lockupVisualWeightEvaluator.getLockupReadabilityInformation(this.forma_,e))},getOldReadabilityInformation:function(){return this.oldReadabilityInformation},getNewReadabilityInformation:function(){return this.newReadabilityInformation},getLockupReadabilityEvaluator:function(){return this.lockupVisualWeightEvaluator}}}),n)},jcfx:function(e,t,o){var n,r,i,a=t,l=o("oAGj"),s=o("C42b"),u=o("HWAX"),c=o("FNB+"),g=o("9Lk3"),h=o("NkBu"),f=o("fNpk"),p=o("c+uM"),d=o("7Ta2"),m=o("JO5d"),C=o("8t9B");a.ProfilingCategories=l.defineEnum("ProfilingCategories",{Title:0,Subtitle:1,Body:2,Action:3,GraphicContent:4,Backing:5,Background:6,Separator:7,Decoration:8,NUM_CATEGORIES:9}),a.ColorProfiles=(n=function(){this.PrimaryProfileMedians={},this.BackgroundProfileMedians={},this.PrimaryProfileMedians[a.ProfilingCategories.Title]=[.12545,.09302,.94901],this.PrimaryProfileMedians[a.ProfilingCategories.Subtitle]=[.077319,.04819,.94901],this.PrimaryProfileMedians[a.ProfilingCategories.Body]=[.044715,.12156,.94901],this.PrimaryProfileMedians[a.ProfilingCategories.Action]=[.06959,.04819,.97647],this.BackgroundProfileMedians[a.ProfilingCategories.Title]=[.12581,.20392,.94901],this.BackgroundProfileMedians[a.ProfilingCategories.Subtitle]=[.079709,.44815,.94313],this.BackgroundProfileMedians[a.ProfilingCategories.Body]=[.07142,.20129,.96274],this.BackgroundProfileMedians[a.ProfilingCategories.Action]=[.5,.46886,.89803],this.PrimaryProfileMedians[a.ProfilingCategories.GraphicContent]=[.5,.6,1],this.PrimaryProfileMedians[a.ProfilingCategories.Backing]=[.5,.3,1],this.PrimaryProfileMedians[a.ProfilingCategories.Background]=[.5,.3,1],this.PrimaryProfileMedians[a.ProfilingCategories.Separator]=[.5,.3,1],this.PrimaryProfileMedians[a.ProfilingCategories.Decoration]=[.5,.6,1]},l.defineClass({name:"ColorProfiles",ctor:n}),n),a.ProfilingColorMap=(r=function e(){this.colorSet=[];for(var t=l.iter(this.profilingCatgoriesCases());!t.done;t.next()){var o=t.value;null==e.currentPrimaryIndices[o]&&(e.currentPrimaryIndices[o]=0),null==e.currentBackgroundIndices[o]&&(e.currentBackgroundIndices[o]=0)}},i={},l.defineClass({name:"ProfilingColorMap",ctor:r,statics:{PrimaryMap:{},BackgroundMap:{},currentPrimaryIndices:{},currentBackgroundIndices:{},paletteMappingDictionary:{},paletteMappingSelection:{},currentDocumentID:"",backingColorKey:"_Backing",lockupMSLPrimaryColorKey:"_MSLPrimary",lockupMSLBackingColorKey:"_MSLBacking",noKeyFound:"noKeyFound",textCategories:{get:function(){return void 0===i.textCategories&&(i.textCategories=[a.ProfilingCategories.Title,a.ProfilingCategories.Subtitle,a.ProfilingCategories.Body,a.ProfilingCategories.Action]),i.textCategories}},shapeCategories:{get:function(){return void 0===i.shapeCategories&&(i.shapeCategories=[a.ProfilingCategories.GraphicContent,a.ProfilingCategories.Backing,a.ProfilingCategories.Background,a.ProfilingCategories.Separator,a.ProfilingCategories.Decoration]),i.shapeCategories}}},props:{reset:function(){r.PrimaryMap={},r.BackgroundMap={},r.currentPrimaryIndices={},r.currentBackgroundIndices={},r.paletteMappingDictionary={},r.paletteMappingSelection={},r.currentDocumentID=""},updateRoleProfilingColorMap:function(e){var t;(t=e.document)&&(r.currentDocumentID=t.uuid),this.colorSet=e.colorLibraryController.getThemeColorKeys().concat(e.colorLibraryController.getProfilingColorKeys()),(new r).eraseCurrentPaletteMappingSelection(),r.PrimaryMap={},r.BackgroundMap={};for(var o=new a.ColorProfiles,n=l.iter(this.profilingCatgoriesCases());!n.done;n.next()){var i=n.value;if(null!=o.PrimaryProfileMedians[i]){var s=this.colorSet.length;r.PrimaryMap[i]=l.clone(this.selectRoleProfilingColors(e,i,!1,!0,s))}}for(var u=l.iter(this.profilingCatgoriesCases());!u.done;u.next())i=u.value,null!=o.BackgroundProfileMedians[i]&&(s=this.colorSet.length,r.BackgroundMap[i]=l.clone(this.selectRoleProfilingColors(e,i,!0,!0,s)))},updateIfCurrentDocumentHasChanged:function(e){var t;(t=e.document)&&r.currentDocumentID!=t.uuid&&this.updateRoleProfilingColorMap(e)},updateCurrentColorIndices:function(){for(var e=l.iter(this.profilingCatgoriesCases());!e.done;e.next()){var t=e.value;if(i=r.PrimaryMap[t]){var o=s.CoreRandom.nextIntUniform(i.length);r.currentPrimaryIndices[t]=o}}for(var n=l.iter(this.profilingCatgoriesCases());!n.done;n.next()){var i;if(t=n.value,(i=r.BackgroundMap[t])&&i.length>0){var a=null==r.currentBackgroundIndices[t]?-1:r.currentBackgroundIndices[t];r.currentBackgroundIndices[t]=(a+1)%i.length}}},checkIfMappingIsEmpty:function(){return null==r.PrimaryMap[a.ProfilingCategories.Title]},checkIfTwoFormaAreInSamePaletteMappingGroup:function(e,t){for(var o=!1,n=l.iter(l.keys(r.paletteMappingDictionary));!n.done;n.next()){var i=n.value;r.paletteMappingDictionary[i].includes(e)&&r.paletteMappingDictionary[i].includes(t)&&(o=!0)}return o},getMappingKeyForFormaID:function(e){for(var t=r.noKeyFound,o=l.iter(l.keys(r.paletteMappingDictionary));!o.done;o.next()){var n=o.value;r.paletteMappingDictionary[n].includes(e)&&(t=n)}return t},overridePaletteMappingDueToContrast:function(e,t){var o,n=this.getMappingKeyForFormaID(t),i=e;return n!=r.noKeyFound&&(null!=(o=r.paletteMappingSelection[n])?i=o:r.paletteMappingSelection[n]=e),i},overridePaletteMappingDueToContrastAndForceDifference:function(e,t,o,n){var i=this.getMappingKeyForFormaID(t),a=e;if(i!=r.noKeyFound)if(null!=(c=r.paletteMappingSelection[i]))a=c;else{if(this.checkIfColorAlreadyAssignedToPaletteMapping(a))for(var s=l.iter(l.range(0,o.length,!1));!s.done;s.next()){var c,g=s.value;if(null!=(c=u.ColorSelectorUtils.getContrastingChoice(!1,[o[g]],[n[g]]))&&!this.checkIfColorAlreadyAssignedToPaletteMapping(c)){a=c;break}}r.paletteMappingSelection[i]=a}return a},checkIfColorAlreadyAssignedToPaletteMapping:function(e){for(var t=!1,o=l.iter(l.keys(r.paletteMappingSelection));!o.done;o.next()){var n=o.value;r.paletteMappingSelection[n]==e&&(t=!0)}return t},eraseCurrentPaletteMappingSelection:function(){r.paletteMappingSelection={}},eraseCurrentPaletteMappingDictionary:function(){r.paletteMappingDictionary={}},setPaletteMappingForFormaWithSameRGBColor:function(e){var t,o=this;if(this.eraseCurrentPaletteMappingDictionary(),t=e.root.controller){var n=l.clone(t.getCurrentColors(e.root.style));n.length>0&&this.updateMappingDictionary(n[0].rgbString,e.root.formaID)}e.root.visitAll(c.FormaTraversal.PreOrder,(function(e){var t,n,i,a,s,u,c=e.formaID;if((a=l.as(e.controller,C.TypeLockupController))&&((s=e.style.colors.fieldPrimary)&&o.updateMappingDictionary(s.rgbString,c),(u=e.style.colors.fieldSecondary)&&null!=(t=l.opt(l.as(e.style,p.LockupStyle),(function(e){return e.backing})))&&t!=p.LockupBacking.None&&o.updateMappingDictionary(u.rgbString,c+r.backingColorKey),(n=a.getCurrentMSLPrimaryColor())&&o.updateMappingDictionary(n.rgbString,c+r.lockupMSLPrimaryColorKey),(i=a.getCurrentMSLBackingColor())&&o.updateMappingDictionary(i.rgbString,c+r.lockupMSLBackingColorKey)),l.as(e.controller,m.ShapeController)&&(s=e.style.colors.fieldPrimary)&&o.updateMappingDictionary(s.rgbString,c),a=l.as(e.controller,g.GridController))for(var f=l.clone(a.getCellIdsGroupedByColor()),d=l.iter(l.keys(f));!d.done;d.next())for(var y=d.value,v=l.iter(f[y]);!v.done;v.next())c=v.value,o.updateMappingDictionary(y,c);l.as(e.controller,h.ImageController)&&null!=e.style.filter&&((s=e.style.colors.fieldPrimary)&&o.updateMappingDictionary(s.rgbString,c),(u=e.style.colors.fieldSecondary)&&o.updateMappingDictionary(u.rgbString,c+r.backingColorKey))}))},getNumPaletteMappingGroups:function(){return l.keys(r.paletteMappingDictionary).length},getCurrentPaletteMapping:function(){return l.clone(r.paletteMappingDictionary)},updateMappingDictionary:function(e,t){for(var o=!1,n=l.iter(l.keys(r.paletteMappingDictionary));!n.done;n.next()){var i=n.value;u.ColorSelectorUtils.compareTwoColorStringsWithMargin(i,e)&&(r.paletteMappingDictionary[i].includes(t)||r.paletteMappingDictionary[i].push(t),o=!0)}o||(r.paletteMappingDictionary[e]=[t])},getPrimaryColorsForRoleGlobal:function(e,t,o){var n,i,a=[];if(this.updateIfCurrentDocumentHasChanged(o),(n=r.PrimaryMap[e])&&null!=(i=r.currentPrimaryIndices[e]))if(i<n.length){for(var s=l.iter(l.range(i,n.length,!1));!s.done;s.next()){var u=s.value;a.push(n[u])}for(var c=l.iter(l.range(0,i,!1));!c.done;c.next())u=c.value,a.push(n[u])}else a=l.clone(n);return a},getBackgroundColorsForRoleGlobal:function(e,t,o){var n,i,a=[];if(this.updateIfCurrentDocumentHasChanged(o),(n=r.BackgroundMap[e])&&null!=(i=r.currentBackgroundIndices[e]))if(i<n.length){for(var s=l.iter(l.range(i,n.length,!1));!s.done;s.next()){var u=s.value;a.push(n[u])}for(var c=l.iter(l.range(0,i,!1));!c.done;c.next())u=c.value,a.push(n[u])}else a=l.clone(n);return a},getPrimaryColorsForRoleIndividual:function(e,t,o){return this.colorSet=e.colorLibraryController.getThemeColorKeys().concat(e.colorLibraryController.getProfilingColorKeys()),this.selectRoleProfilingColors(e,t,!1,!1,o)},getBackgroundColorsForRoleIndividual:function(e,t,o){return this.colorSet=e.colorLibraryController.getThemeColorKeys().concat(e.colorLibraryController.getProfilingColorKeys()),this.selectRoleProfilingColors(e,t,!0,!1,o)},getProfilingCategoryForInferredRole:function(e){var t=a.ProfilingCategories.Body;return e.role==d.InferredRoleType.Title||e.role==d.InferredRoleType.Quote?t=a.ProfilingCategories.Title:e.role==d.InferredRoleType.SubTitle?t=a.ProfilingCategories.Subtitle:e.role==d.InferredRoleType.Social||e.role==d.InferredRoleType.Action?t=a.ProfilingCategories.Action:e.role==d.InferredRoleType.Body||e.role==d.InferredRoleType.Contact?t=a.ProfilingCategories.Body:e.role==d.InferredRoleType.GraphicContent||e.role==d.InferredRoleType.Logo?t=a.ProfilingCategories.GraphicContent:e.role==d.InferredRoleType.Seperator?t=a.ProfilingCategories.Separator:e.role==d.InferredRoleType.Backing?t=a.ProfilingCategories.Backing:e.role==d.InferredRoleType.Background?t=a.ProfilingCategories.Background:e.role==d.InferredRoleType.Decoration?t=a.ProfilingCategories.Decoration:f.LegacyCoreAssert.fail("role not supported",void 0,"ProfilingColorMap.getProfilingCategoryForInferredRole","ProfilingColorMap.swift",471),t},countColorUsage:function(e,t){for(var o=0,n=[r.PrimaryMap,r.BackgroundMap],i=l.clone(this.profilingCatgoriesCases()),a=l.iter(n);!a.done;a.next())for(var s=a.value,u=l.iter(i);!u.done;u.next()){var c,g=u.value;if(this.anyCategoryOverlap(t,g)&&(c=s[g]))for(var h=l.iter(c);!h.done;h.next())h.value==e&&(o+=1)}return o},anyCategoryOverlap:function(e,t){return!(!r.textCategories.includes(e)||!r.textCategories.includes(t))||!(!r.shapeCategories.includes(e)||!r.shapeCategories.includes(t))},selectRoleProfilingColors:function(e,t,o,n,r){void 0===r&&(r=2);var i=[],s=new a.ColorProfiles,u=[];if(o&&null==s.BackgroundProfileMedians[t]||!o&&null==s.PrimaryProfileMedians[t])return f.LegacyCoreAssert.fail("category not supported in selectRoleProfilingColors",void 0,"ProfilingColorMap.selectRoleProfilingColors","ProfilingColorMap.swift",524),[];for(var c=l.iter(this.colorSet);!c.done;c.next()){var g,h=c.value;if(g=e.colorLibraryController.getSolidColorForKey(h)){var p=0,d=0;o?p=this.getColorHSBDistance(g,s.BackgroundProfileMedians[t]):(p=this.getColorHSBDistance(g,s.PrimaryProfileMedians[t]),d=(n?1e3:0)*l.toDouble(this.countColorUsage(h,t))),i.push(p+d)}}for(var m=l.iter(l.range(0,r,!1));!m.done;m.next()){var C=l.min(i);if(null!=C){var y=l.indexOf(i,C);u.push(this.colorSet[y]),i[y]+=1e3}}return u},profilingCatgoriesCases:function(){for(var e=[],t=a.ProfilingCategories.NUM_CATEGORIES,o=l.iter(l.range(0,t,!1));!o.done;o.next()){var n=o.value;e.push(a.ProfilingCategories.toCaseValue(n))}return e},getColorHSBDistance:function(e,t){var o=[e.asHSB.h,e.asHSB.s,e.asHSB.b],n=Math.min(Math.abs(o[0]-t[0]),360-Math.abs(o[0]-t[0]));n/=180;var r=Math.abs(o[1]-t[1]),i=Math.abs(o[2]-t[2])/255;return Math.sqrt(n*n+r*r+i*i)}}}),r)},lq1z:function(e,t,o){var n,r,i,a,l=t,s=o("oAGj"),u=o("gXiO"),c=o("iCxV"),g=o("3lr5"),h=o("fNpk"),f=o("uj1m"),p=o("txj3"),d=o("K0Rh"),m=o("nrTo"),C=o("djAF"),y=o("ThKb");l.useNNModel=!0,l.linearLearningRate=.5,l.nnLearningRate=.005,s.gvar(l,"sharedSuggester_",(function(){return new l.FontSuggester})),l.concatSecondIntoFirst=function(e,t){for(var o=s.iter(t.descriptors);!o.done;o.next()){var n=o.value;e.append(n)}},l.FontSuggester=(n=function(){u.CoreObject.call(this)},r={},s.defineClass({name:"FontSuggester",ctor:n,superName:"CoreObject",statics:{sharedSuggester:{get:function(){return l.sharedSuggester_}},cache:{get:function(){return void 0===r.cache&&(r.cache=new m.PredictionCacheDouble),r.cache},set:function(e){r.cache=e}}},props:{getFontFeatures:function(e,t){var o,r,i=s.clone(e.selectedLockup.pts),a=i[0].x,u=i[0].y,c=i[3].x,g=i[3].y,h=(a+c)/2,f=(u+g)/2,p=e.width,m=e.height,y=e.selectedLockup.wordCount,v=e.selectedLockup.width,S=e.selectedLockup.height,k=e.numImages,P="root";if(r=s.opt(t.root,(function(e){return e.filterWithCallback((function(e){return null!=e.finalFrame&&null!=e.controller&&!e.controller.moveable&&(e.isBackgroundImage()||e.kind==C.ShapeForma.KIND||e.kind==d.RootForma.KIND)}))})))for(var I=s.iter(r);!I.done;I.next()){var L=I.value;L.isBackgroundImage()&&L.finalFrame.outsetXY(20,20).contains(t.finalFrame)?P="image":L.kind==C.ShapeForma.KIND&&(P="shape")}o=[p,m,p*m,Math.atan2(m,p),s.toDouble(e.lockups.length),s.toDouble(k),a/p,u/m,h/p,f/m,c/p,g/m,s.toDouble(y),v,S,v*S/s.toDouble(y),"root"==P?1:0,"image"==P?1:0,"shape"==P?1:0];var A=e.selectedLockup.styleAttributes.backing,F=e.selectedLockup.styleAttributes.layout;return n.cache.cleanup(t.page.document.uuid),new l.FontFeatures(o,A,F)},suggestFonts:function(e,t){if(null!=c.Host.fontProvider){var o=c.Host.fontProvider.getIncludedFonts(g.ANY_DOCUMENT),n=e.currentDocumentFonts.clone();l.concatSecondIntoFirst(n,e.recentlyUsedFonts),l.concatSecondIntoFirst(n,o),t(n)}},onlineLearning:function(e,t){var o,n;if(l.useNNModel){if(o=f.MLPModel.loadNNModel("Font")){var r=t.regularFeatures.concat(),i=s.repeat(0,58),a=s.repeat(0,4);null!=(M=s.indexOf(o.shapes,t.shape))&&(i[M]=1),null!=(R=s.indexOf(o.layouts,t.layout))&&(a[R]=1),r=r.concat(i).concat(a),h.LegacyCoreAssert.isTrue(81==r.length,"unexpected feature vector size",{count:r.length},"FontSuggester.onlineLearning","FontSuggester.swift",115);var u=s.clone(o.fonts),g=o.coefficients.length,d=s.repeat(0,o.coefficients[g-1].rows),m=new y.TheoMatrix([r]).subtract(o.featureScalingMean).divide(o.featureScalingStd);if(null!=(_=s.indexOf(u,e.postScriptName))&&_>=0&&_<d.length){d[_]=1;var C=new y.TheoMatrix([d]),v=new p.NNMLPClassifier(o.coefficients,o.intercepts),S=s.clone(v.forwardPropagate(m.transpose())),k=S.AL,P=s.clone(S.caches),I=s.clone(v.backwardPropagate(k,C.transpose(),P)),L=s.clone(I.dWs),A=s.clone(I.dbs);s.info("nn cost: "+v.computeCost(k,C.transpose())+")");for(var F=[],T=[],b=s.iter(s.range(0,g,!1));!b.done;b.next()){var D=b.value;F.push(o.coefficients[D].subtract(L[D].multiplyConstant(l.nnLearningRate))),T.push(o.intercepts[D].subtract(A[D].multiplyConstant(l.nnLearningRate)))}h.LegacyCoreAssert.isTrue(F.length==o.coefficients.length,"count mismatch: new weights and model coefficients",void 0,"FontSuggester.onlineLearning","FontSuggester.swift",138),h.LegacyCoreAssert.isTrue(T.length==o.intercepts.length,"count mismatch: new biases and model intercepts",void 0,"FontSuggester.onlineLearning","FontSuggester.swift",139);var x=new f.MLPModel(o.featureScalingMean,o.featureScalingStd,F,T,o.shapes,o.fonts,o.layouts,o.roles);s.opt(c.Host.learning,(function(e){return e.updateFontSuggestionNNModel(x)}))}}}else if(n=s.opt(c.Host.learning,(function(e){return e.loadFontSuggestionLinearModel()}))){var M,R,_;if(r=t.regularFeatures.concat(),i=s.repeat(0,58),a=s.repeat(0,4),null!=(M=s.indexOf(n.shapes,t.shape))&&(i[M]=1),null!=(R=s.indexOf(n.layouts,t.layout))&&(a[R]=1),r=r.concat(i).concat(a),h.LegacyCoreAssert.isTrue(81==r.length,"unexpected feature vector size",{count:r.length},"FontSuggester.onlineLearning","FontSuggester.swift",160),m=new y.TheoMatrix([r]).subtract(n.featureScalingMean).divide(n.featureScalingStd),u=s.clone(n.fonts),d=s.repeat(0,u.length),null!=(_=s.indexOf(u,e.postScriptName))&&_>=0&&_<d.length){d[_]=1,C=new y.TheoMatrix([d]);var E=m.matrixMultiply(n.coefficient.transpose()).add(n.intercept).sigmoid().subtract(C),N=n.coefficient.subtract(E.transpose().matrixMultiply(m).multiplyConstant(l.linearLearningRate)),w=n.intercept.subtract(E.multiplyConstant(l.linearLearningRate));x=new l.FontLinearModel(n.featureScalingMean,n.featureScalingStd,N,w,n.shapes,n.fonts,n.layouts),s.opt(c.Host.learning,(function(e){return e.updateFontSuggestionLinearModel(x)}))}}},clearCache:function(){n.cache.clearCache()},getScores:function(e,t){var o=t.getUniqueKey();if(null==n.cache.getCacheValue(o)){var r,i,a=[];if(l.useNNModel){if(r=f.MLPModel.loadNNModel("Font")){var u=t.regularFeatures.concat(),g=s.repeat(0,58),d=s.repeat(0,4);null!=(F=s.indexOf(r.shapes,t.shape))&&(g[F]=1),null!=(T=s.indexOf(r.layouts,t.layout))&&(d[T]=1),u=u.concat(g).concat(d),h.LegacyCoreAssert.isTrue(81==u.length,"unexpected feature vector size",{count:u.length},"FontSuggester.getScores","FontSuggester.swift",205);for(var m=new y.TheoMatrix([u]).subtract(r.featureScalingMean).divide(r.featureScalingStd),C=new p.NNMLPClassifier(r.coefficients,r.intercepts).predict(m.transpose()),v=s.clone(C.transpose().asArray),S=s.clone(r.fonts),k={},P=s.iter(s.toSequence(v[0]));!P.done;P.next()){var I=P.value,L=I.offset,A=I.element;k[S[L]]=A}e.forEach((function(e){var t;null!=(t=k[e.postScriptName])?a.push(t):a.push(0)}))}}else if(i=s.opt(c.Host.learning,(function(e){return e.loadFontSuggestionLinearModel()}))){var F,T;u=t.regularFeatures.concat(),g=s.repeat(0,58),d=s.repeat(0,4),null!=(F=s.indexOf(i.shapes,t.shape))&&(g[F]=1),null!=(T=s.indexOf(i.layouts,t.layout))&&(d[T]=1),u=u.concat(g).concat(d),h.LegacyCoreAssert.isTrue(81==u.length,"unexpected feature vector size",{count:u.length},"FontSuggester.getScores","FontSuggester.swift",239),C=(m=new y.TheoMatrix([u]).subtract(i.featureScalingMean).divide(i.featureScalingStd)).matrixMultiply(i.coefficient.transpose()).add(i.intercept),v=s.clone(C.sigmoid().asArray),S=s.clone(i.fonts),k={};for(var b=s.iter(s.toSequence(v[0]));!b.done;b.next()){var D=b.value;L=D.offset,A=D.element,k[S[L]]=A}e.forEach((function(e){var t;null!=(t=k[e.postScriptName])?a.push(t):a.push(0)}))}n.cache.setCacheValue(o,a)}return n.cache.getCacheValue(o)}}}),n),l.FontFeatures=(i=function(e,t,o){this.regularFeatures=s.clone(e),this.shape=t,this.layout=o},s.defineClass({name:"FontFeatures",ctor:i,props:{getUniqueKey:function(){for(var e="",t=s.iter(this.regularFeatures);!t.done;t.next()){var o=t.value;e=e+s.toString("%.2f",o)+"-"}return e=(e=e+this.shape+"-")+this.layout+"-"}}}),i),l.FontLinearModel=(a=function(e,t,o,n,r,i,a){this.featureScalingMean=e,this.featureScalingStd=t,this.coefficient=o,this.intercept=n,this.shapes=s.clone(r),this.fonts=s.clone(i),this.layouts=s.clone(a),this.fontMap={}},s.defineClass({name:"FontLinearModel",ctor:a,props:{data:function(){return s.clone(s.as({model:{coef:this.coefficient.asArray,intercept:this.intercept.asFlatArray,shapes:this.shapes,fonts:this.fonts,layouts:this.layouts},featureScalingMean:this.featureScalingMean.asFlatArray,featureScalingStd:this.featureScalingStd.asFlatArray},["Dictionary","String","Any"]))}}}),a)},nrTo:function(e,t,o){var n,r,i,a=t,l=o("oAGj"),s=o("iCxV");a.RolePredictionCacheProtocol=l.defineProtocol("RolePredictionCacheProtocol",{getCacheValue:"(String) -> InferredRole",setCacheValue:"(String, InferredRole) -> Void",cleanup:"(String) -> Void"}),a.RolePredictionCache=(n=function(){},l.defineClass({name:"RolePredictionCache",ctor:n,statics:{_implements:function(e){return"RolePredictionCacheProtocol"==e}},props:{getCacheValue:function(e){return l.opt(s.Host.logging,(function(e){return e.error("This method must be overridden")})),null},setCacheValue:function(e,t){l.opt(s.Host.logging,(function(e){return e.error("This method must be overridden")}))},cleanup:function(e){l.opt(s.Host.logging,(function(e){return e.error("This method must be overridden")}))}}}),n),a.PredictionCacheDouble=(r=function(){},l.defineClass({name:"PredictionCacheDouble",ctor:r,statics:{cache:{},currentDocID:""},props:{getCacheValue:function(e){return r.cache[e]},setCacheValue:function(e,t){r.cache[e]=l.clone(t)},cleanup:function(e){e!=r.currentDocID&&(r.currentDocID=e,r.cache={})},clearCache:function(){r.cache={}}}}),r),a.PredictionCacheInferredRole=(i=function(){a.RolePredictionCache.call(this)},l.defineClass({name:"PredictionCacheInferredRole",ctor:i,superName:"RolePredictionCache",statics:{cache:{},currentDocID:"",_implements:function(e){return"RolePredictionCacheProtocol"==e}},props:{getCacheValue:function(e){return i.cache[e]},setCacheValue:function(e,t){i.cache[e]=l.clone(t)},cleanup:function(e){e!=i.currentDocID&&(i.currentDocID=e,i.cache={})}}}),i)},vYM0:function(e,t,o){var n,r=t,i=o("oAGj"),a=o("yhkb"),l=o("C42b"),s=o("iCxV"),u=o("umUn");r.ColorLibraryMap=(n=function(){},i.defineClass({name:"ColorLibraryMap",ctor:n,statics:{remapColors:function(e,t,o,r){var a=[];e.forEachColor((function(e,l,s){var u;if(u=null==l?s:i.opt(t.color(l),(function(e){return e.rgbColor}))){var c=i.opt(r,(function(e){return e[u.hex]}));null==c&&(c=n.findACloseColor(u,o),null!=r&&(r[u.hex]=c)),a.push({key:e,value:c})}})),e.setColorIDs(a)},detachFromLibrary:function(e,t,o){void 0===o&&(o=null);var n=[];e.forEachColor((function(e,t,o){return n.push({role:e,colorID:t,color:o})}));for(var r=i.iter(n);!r.done;r.next()){var a,l,s=r.value;(a=null==s.colorID?s.color:i.opt(t.color(s.colorID),(function(e){return e.rgbColor})))&&(null!=(l=i.opt(o,(function(e){return e.getKeyOfColorInTheme(u.TheoColor.init_5344(a))})))?e.setColorId(s.role,l):e.setColor(s.role,a))}},findACloseColor:function(e,t,o){void 0===o&&(o=20);var n=e.lightness,r=null,u=[];if(t.forEachColor((function(e,t){if(e.startsWith("theme")){var r=Math.abs(t.rgbColor.lightness-n);r<=o&&u.push({id:e,distance:r})}})),0==u.length)i.opt(s.Host.logging,(function(e){return e.info("Unable to find closest color in ColorLibraryMap.findACloseColor")})),r=a.ColorLibraryController.BLACK_KEY;else{var c=i.sort(u,(function(e,t){return e.distance<t.distance}));r=c[l.CoreRandom.nextIntUniform(Math.min(c.length,3))].id}return r}}}),n)},xe42:function(e,t,o){var n,r,i=t,a=o("oAGj"),l=o("9BFu");i.FormaPlacementScore=(n=function e(t){this.rejectThreshold=-100,l.WeightedScore.call(this,e.Features.NUM_FEAT),this.setWeight(e.Features.XSYMM,10),this.setWeight(e.Features.YSYMM,10),this.setWeight(e.Features.CONTRAST,1),0==t.textRects.length?(this.setWeight(e.Features.EDGE,-500),this.setWeight(e.Features.FACE,-1e3)):(this.setWeight(e.Features.EDGE,-50),this.setWeight(e.Features.FACE,0)),this.setWeight(e.Features.SIZE,100),this.setWeight(e.Features.TEXT_OVERLAP,-5e3),this.setWeight(e.Features.FLOATING_ELEMENT_OVERLAP,-1e3),this.setWeight(e.Features.DISTANCE_TO_CENTER,-20),this.setWeight(e.Features.IMAGE_EDGE_OVERLAP,-500),this.setWeight(e.Features.REGION_BOUNDARY_OVERLAP,-40),this.setWeight(e.Features.ALIGNMENT,50),this.setWeight(e.Features.ASPECT_RATIO,t.forma.isImage()?0:20),this.setFeatureName(e.Features.XSYMM,"X- Symmetry"),this.setFeatureName(e.Features.YSYMM,"Y- Symmetry"),this.setFeatureName(e.Features.CONTRAST,"Contrast"),this.setFeatureName(e.Features.EDGE,"Edges"),this.setFeatureName(e.Features.FACE,"Faces"),this.setFeatureName(e.Features.SIZE,"Size"),this.setFeatureName(e.Features.TEXT_OVERLAP,"Text Overlap"),this.setFeatureName(e.Features.FLOATING_ELEMENT_OVERLAP,"Floating Element Overlap"),this.setFeatureName(e.Features.DISTANCE_TO_CENTER,"Distance To Center"),this.setFeatureName(e.Features.IMAGE_EDGE_OVERLAP,"Image Edge Overlap"),this.setFeatureName(e.Features.REGION_BOUNDARY_OVERLAP,"Region Boundary Overlap"),this.setFeatureName(e.Features.ALIGNMENT,"Alignment"),this.setFeatureName(e.Features.ASPECT_RATIO,"Aspect Ratio")},r={},a.defineClass({name:"FormaPlacementScore",ctor:n,superName:"WeightedScore",statics:{Features:{get:function(){return void 0===r.Features&&(r.Features=a.defineEnum("Features",{XSYMM:1,YSYMM:2,CONTRAST:3,EDGE:4,FACE:5,SIZE:6,TEXT_OVERLAP:7,FLOATING_ELEMENT_OVERLAP:8,IMAGE_EDGE_OVERLAP:9,REGION_BOUNDARY_OVERLAP:10,DISTANCE_TO_CENTER:11,ALIGNMENT:12,ASPECT_RATIO:13,NUM_FEAT:14})),r.Features}}},props:{reject:function(){return this.score<this.rejectThreshold}}}),n)}}]);
//# sourceMappingURL=vendors_npm_spark_b84bf841-1c1f4555.js.map