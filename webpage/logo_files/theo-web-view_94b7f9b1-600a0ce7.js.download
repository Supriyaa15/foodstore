(window.webpackJsonptheoWebApp=window.webpackJsonptheoWebApp||[]).push([[106,83,94],{"+VG/":function(e,t,r){var o,n;o=[r("xeH2"),r("YLtl"),r("KFmL")],void 0===(n=function(e,t,r){return function(e){(e=e||{}).tag=e.tag||"DIV",e.width=e.width||57,e.height=e.height||40,e.label=e.label,e.iconTemplate=e.iconTemplate||"<i></i>",e.template=e.iconTemplate+(e.label?"<label>"+e.label+"</label>":"");var t=new r(e),o=t.update;return t.update=function(t){void 0!==t.label&&(t.template=e.iconTemplate+(t.label?"<label>"+t.label+"</label>":"")),o(t)},t.el.className+=" post-icon-button",t.el.style.width=e.width+"px",t.el.style.height=e.height+"px",t}}.apply(t,o))||(e.exports=n)},"/nf9":function(e,t,r){var o,n;o=[r("xeH2"),r("YLtl"),r("2Fsf")],void 0===(n=function(e,t,r){return function(e){var o=(e=e||{}).arrowDirection?"tooltip-arrow-"+e.arrowDirection:"tooltip-arrow-down";e.message||0===e.message?e.template="<p>"+e.message+'</p><p class="'+o+'"></p>':e.template='<p></p><p class="'+o+'"></p>';var n=new r(e),s=n.show,i=n.hide;return n.show=function(e=!0){e?(n.$el.addClass("fade"),t.delay((function(){n.$el.removeClass("fade")}),200),s()):n.hide()},n.hide=function(){n.$el.addClass("fade"),t.delay((function(){i(),n.$el.removeClass("fade")}),200)},n.el.className+=" post-tooltip",n}}.apply(t,o))||(e.exports=n)},"1pXj":function(e,t,r){"use strict";r.r(t),r.d(t,"default",(function(){return u}));var o=r("LbXs"),n=r("MnDd"),s=r("YLtl"),i=r.n(s),a=r("Avqh"),l=r.n(a);function c(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,o)}return r}function d(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?c(Object(r),!0).forEach((function(t){h(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):c(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function h(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class u extends l.a{constructor(e){super(d(d({},e),{},{tag:n.a.elementName})),h(this,"typedEl",void 0),h(this,"baseUpdate",void 0),h(this,"baseHide",void 0),h(this,"coreWrapper",null),h(this,"controller",void 0),h(this,"cutoutBrushMode",o.RefineCutoutBrushMode.NONE),h(this,"isCutoutMode",!1),h(this,"cutoutEffectiveBrushSize",0),h(this,"parentElement",null),h(this,"rootToSelectedFormaTransform",null),h(this,"selectedFormaTotalRotation",0),h(this,"selectedFormaTotalScaleX",1),h(this,"selectedFormaTotalScaleY",1),h(this,"lastPointerMove",null),h(this,"setElementStyle",(e=0,t=0)=>{this.typedEl.setAttribute("style",`left: ${e}px; top: ${t}px; transform: rotate(${-this.selectedFormaTotalRotation}rad)`)}),h(this,"handleZoom",()=>{this.lastPointerMove&&this.handlePointerMove(this.lastPointerMove)}),h(this,"handlePointerMove",e=>{if(!this.controller||!this.coreWrapper||!this.rootToSelectedFormaTransform)return;const t=this.controller.getPosterRelativePoint(e.pageX,e.pageY),r=this.coreWrapper.getViewToDocMatrix().transformPoint(t),o=this.rootToSelectedFormaTransform.transformPoint(r),n=this.coreWrapper.getViewScale();this.setElementStyle(o.x*n*this.selectedFormaTotalScaleX,o.y*n*this.selectedFormaTotalScaleY),this.lastPointerMove=e}),h(this,"throttledPointerMoveHandler",i.a.throttle(e=>{this.handlePointerMove(e)},33.3)),h(this,"handleShown",()=>{if(this.parentElement=this.typedEl.parentElement,this.parentElement&&this.coreWrapper){this.parentElement.style.cursor="none";const e=this.coreWrapper.getSelectedForma();if(e){const t=e.totalPlacement,r=t.transformValues;this.rootToSelectedFormaTransform=t.inverse,this.selectedFormaTotalRotation=Math.atan2(r.rotSine,r.rotCosine),this.selectedFormaTotalScaleX=Math.abs(r.xscale),this.selectedFormaTotalScaleY=Math.abs(r.yscale)}this.parentElement.addEventListener("pointermove",this.throttledPointerMoveHandler)}}),h(this,"overriddenHide",()=>{this.baseHide(),this.parentElement&&(this.parentElement.removeEventListener("pointermove",this.throttledPointerMoveHandler),this.parentElement.style.cursor="auto",this.parentElement=null)}),h(this,"overriddenUpdate",e=>{const t=e&&e.state||{};if(!this.coreWrapper)return;void 0!==t.controller&&(this.controller=t.controller),void 0!==t.isCutoutMode&&(this.isCutoutMode=t.isCutoutMode),void 0!==t.cutoutEffectiveBrushSize&&(this.cutoutEffectiveBrushSize=t.cutoutEffectiveBrushSize),void 0!==t.cutoutBrushMode&&(this.cutoutBrushMode=t.cutoutBrushMode);const r=this.coreWrapper.getViewScale();this.typedEl.size=this.cutoutEffectiveBrushSize*r,this.typedEl.isAdditive=this.cutoutBrushMode===o.RefineCutoutBrushMode.ADDITIVE,this.isCutoutMode&&this.cutoutBrushMode!==o.RefineCutoutBrushMode.NONE?this.show():this.hide(),this.baseUpdate(t)}),h(this,"setCoreWrapper",e=>{this.coreWrapper=e}),this.typedEl=this.el,this.baseUpdate=this.update,this.update=this.overriddenUpdate,this.baseHide=this.hide,this.hide=this.overriddenHide,this.controller=e.controller,this.typedEl.className+=" post-image-cutout-cursor",this.events.subscribe("shown",this.handleShown),this.setElementStyle(),this.update(e)}}},"5XZA":function(e,t,r){"use strict";r.d(t,"a",(function(){return d}));var o=r("ApVh"),n=r.n(o),s=r("Uwho"),i=r.n(s),a=r("cNpz"),l=r.n(a);function c(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class d{static async convertUrlToBlob(e,t){let r,o="";t&&(o=await n.a.getAccessToken()),r=o?{"x-api-key":d.key,Authorization:"Bearer "+o}:{"x-api-key":d.key};const s={originalUrl:e};return window.fetch(e,{method:"GET",headers:new window.Headers(r)}).then(e=>e.blob()).then(e=>{const t=URL.createObjectURL(e);return s.blobUrl=t,s}).catch(e=>(s.error=e,s))}static async convertUrlToBlobWithHeaders(e,t){let r=d.cachedImageUrls[e];return r||(r=await d.convertUrlToBlob(e,t),d.cachedImageUrls[e]=r),Promise.resolve(r)}static getMatrixHref(e,t,r){return l.a.parse(e).expand({size:t,type:r})}static async getRenditionFromInfo(e,t,r,o){const n=e.templated?d.getMatrixHref(e.href,t,r):e.href;return d.convertUrlToBlobWithHeaders(n,o)}static getRenditionLinkFromInfo(e,t,r){return`${e.templated?d.getMatrixHref(e.href,t,r):e.href}?api_key=${d.key}`}}c(d,"cachedImageUrls",{}),c(d,"key",i.a.sparkContentSearchApiKey)},"8UVJ":function(e,t,r){var o,n;const s="DESIGN_ASSETS_PANEL_CLOSE",i="THUMBNAIL_CLICK_EVENT",a="DESIGN_ASSETS_PANEL_BACK",l="THEO_DESIGN_ASSETS_PANEL_SEARCH",c="COLLECTION_SHOW_MORE_ITEMS",d="BREADCRUMB_LABEL_CLICK",h="SEARCH_INPUT_CHANGE",u="SEARCH_CLEAR_ALL",p="SEARCH_TOPIC_CLICK",m="TOPIC_DESELECTED",f="THUMBNAIL_DRAGSTART_EVENT",g="INFINITE_SCROLL_SHOW_MORE_ITEMS",b="deselect",v="add-logo-to-canvas",I="add-logo-to-panel";o=[r("N/Dz"),r("279a"),r("2Fsf"),r("YLtl"),r("Pbp+"),r("3xm6"),r("8TtT"),r("bBG2")],void 0===(n=function(e,t,r,o,n,T,y,w){return function(S){S.tag=e.TheoAssetRail.elementName;const E=new r(S),C=E.update,P=t.ASSET_RAIL_LIST,k=S.navList,F=S.clickCb,L=S.panelCloseCb,D=S.parentController,x=S.designAssetsControllers,A=w.default,_={title:T.translate("app.assetRailNav.designAssets"),ctaText:T.translate("app.helpModal.kCtaText"),ctaLink:"https://adobespark.zendesk.com/hc/en-us/categories/202688167-Adobe-Spark",assetUrl:"https://"+window.location.host+"/images/help-videos/design_assets.gif",placement:"right-bottom",id:"designAssets"},O={title:T.translate("app.assetRailNav.backgrounds"),ctaText:T.translate("app.helpModal.kCtaText"),ctaLink:"https://adobespark.zendesk.com/hc/en-us/categories/202688167-Adobe-Spark",assetUrl:"https://"+window.location.host+"/images/help-videos/l_backgrounds.gif",placement:"right-bottom",id:"backgrounds"};let R=!1;const N=function({hide:e=!1}={}){if(E.el.hide=e,E.el.setAttribute("navList",JSON.stringify(k)),E.el.navList=k,T.currentLanguage.startsWith("en")){let e=!1;n.run("testShowPanelHelpVideos*",{helpModalVariant:()=>{e=!0,E.el.enableHelpModal=e},control:()=>{}}).then(()=>{}).done()}},$=function(e){const t=P[e.originalEvent.detail.id];F(t)},H=function(e){const{panelEvent:t,panelId:r}=e.originalEvent.detail,{detail:o,type:n}=t;switch(n){case b:L(r);break;case v:D.addExistingLogo(o.id);break;case I:D.addNewLogo()}},M=function(e){const{panelEvent:t,panelId:r}=e.originalEvent.detail,{detail:o,type:n}=t,b=x[r];let v;switch(n){case s:L(r);break;case i:b.handleThumbClicked(o.item);break;case l:b.executePanelSearch(o.options,!0);break;case h:b.executePanelSearch({q:o.inputText.trim()},!0);break;case c:b.handleMoreClick(o.collectionId);break;case a:b.handleNavBack();break;case d:b.handleNavBack(o.id);break;case u:b.searchCleared();break;case g:b.handleLoadMore();break;case p:t.currentTarget.shadowRoot&&t.currentTarget.shadowRoot.activeElement&&t.currentTarget.shadowRoot.activeElement.shadowRoot&&(v=t.currentTarget.shadowRoot.querySelector("theo-search")),b.searchTopicClick(o.item,v);break;case m:b.searchTopicDeselected(o.topic,o.searchInputText);break;case f:b.handleDragStart(o.item,o.originalEvent)}},B=function(e){var t=e.originalEvent.detail.link;window.open(t,"_blank"),A.publish("tutorialCtaPressed")},j=function(e){var t=e.originalEvent.detail.id;_.id===t?A.publish("tutorialPlayed",{contextualData1:"tutorialName:addAsset",contextualData2:"tutorialFormat.gif"}):O.id===t&&A.publish("tutorialPlayed",{contextualData1:"tutorialName:addBackgroundDeleteBackground",contextualData2:"tutorialFormat.gif"})},U=function(){R=!1,E.$el.off("ASSET_RAIL_NAV_SELECTION",$),E.$el.off("DESIGN_ASSETS_PANEL_EVENT",M),E.$el.off("LOGO_PANEL_EVENT",H),E.$el.off(y.HELP_POPUP_CTA_CLICK_EVENT,B),E.$el.off(y.HELP_POPUP_ANCHOR_HOVER_EVENT,j)},G=function(){R||(R=!0,E.$el.on("ASSET_RAIL_NAV_SELECTION",$),E.$el.on("DESIGN_ASSETS_PANEL_EVENT",M),E.$el.on("LOGO_PANEL_EVENT",H),E.$el.on(y.HELP_POPUP_CTA_CLICK_EVENT,B),E.$el.on(y.HELP_POPUP_ANCHOR_HOVER_EVENT,j))};E.bind=G,E.show=function(){N({hide:!1})},E.hide=function(){N({hide:!0})},E.update=function({eleProps:e,attributes:t,state:r}){o.isEmpty(e)||(e.left=E.parent.getWidth()+20,C(e)),r&&function(e){const t=e.assetRailSelectedId||"";E.el.setAttribute("selectedId",t),E.el.selectedId=t,o.isEmpty(e.designAssetsState)?e.designAssetsState=void 0:(e.designAssetsState.listOfLoadingAssets=e.listOfLoadingAssets,e.designAssetsState.helpModalContent=_,E.el.designAssetsState=e.designAssetsState),o.isEmpty(e.backgroundsState)?e.backgroundsState=void 0:(e.backgroundsState.listOfLoadingAssets=e.listOfLoadingAssets,e.backgroundsState.helpModalContent=O,E.el.backgroundsState=e.backgroundsState);const r=E.el.logoPanelState||{};r.isReplaceMode=e.isLogoReplaceMode,r.primaryLogo=e.primaryLogo,r.secondaryLogos=e.secondaryLogos,r.disableAddLogo=e.disableAddLogo,E.el.logoPanelState=r}(r),t&&N(t)};return N(),E.events.subscribe("shown",G),E.events.subscribe("hidden",U),E}}.apply(t,o))||(e.exports=n)},Avqh:function(e,t,r){var o,n;o=[r("xeH2"),r("YLtl"),r("rCSV"),r("3xm6")],void 0===(n=function(e,t,r,o){const n=r.default;e(document.body);var s=0,i={},a={};function l(t){return{el:t,$el:e(t),events:new n,isHidden:function(){return!1}}}return function(t){var r,c,d={},h=(t=t||{}).template||"",u=!!t.hidden,p="none";function m(){r=d.parent.events.subscribe("change:size",f),c=d.parent.events.subscribe("change:hidden",g),u||(d.localize("initial-render"),d.parent.el.appendChild(d.el))}function f(e){d.handleParentResize(e)}function g(e){!1===u&&(d.events.publish("change:hidden",e),!1===e.hidden?d.events.publish("shown"):d.events.publish("hidden"))}return d.data=t.data,d.context=t.context,d.events=new n,d.id=t.id||"component-"+s++,d.parent=function(e){return"string"==typeof e.parent?i[e.parent]:"object"==typeof e.parent?e.parent:l(e.parentDomElement||document.body)}(t),d.el=t.el||document.createElement(t.tag||"DIV"),d.$el=e(d.el),d.update=function(e){const t=d.el.tagName.includes("THEO-");void 0!==(e=e||{}).hidden&&d.show(!e.hidden),void 0!==e.parentDomElement&&e.parentDomElement!=d.parent.el&&(e.parent=l(e.parentDomElement)),void 0!==e.parent&&(r&&r.remove(),c&&c.remove(),d.$el.remove(),d.parent=e.parent,m());var o=void 0!==e.template;o&&(d.el.innerHTML=e.template),void 0!==e.data&&(d.data=e.data);var n,s=void 0!==e.context;s&&(d.context=e.context),n=o?"content-updated":s?"context-updated":"salient-update",t||d.localize(n)},d.insert=function(){e.contains(d.parent.$el,d.$el)||(d.localize("initial-render"),d.parent.el.appendChild(d.el))},d.show=function(e){!1!==e?u&&(d.insert(),u=!1,d.isHidden()||(d.events.publish("change:hidden",{hidden:u}),d.events.publish("shown")),"none"!=p&&a[p].forEach((function(e){e.id!==d.id&&e.hide()}))):d.hide()},d.remove=function(){u||d.parent.el.removeChild(d.el)},d.hide=function(){if(!u){d.remove();var e=d.isHidden();u=!0,e||(d.events.publish("change:hidden",{hidden:u}),d.events.publish("hidden"))}},d.localize=function(e){if(d.$el&&d.$el.localize){var t=o.localizeContext(d.context);o.transformNodeForLocalization(d.$el,e,t),d.$el.localize(t)}},d.isHidden=function(){return!0===u||!0===d.parent.isHidden()},d.handleParentResize=function(e){},d.getComponentById=function(e){return i[e]},d.republish=function(e,t,r){return e.subscribe(t,(function(){var e=[r||t].concat([].slice.apply(arguments));d.events.publish.apply(d.events,e)}))},d.bindToEventsWithHandlers=function(e){const t=[];for(const r in e)t.hasOwnProperty(r)||t.push(d.events.subscribe(r,e[r]));return t},d.unbindEvents=function(e){e.forEach(e=>{e&&"function"==typeof e.remove&&e.remove()})},function(){if(d.el.id=d.id,d.el.className+=" post-component",t.class&&(d.el.className+=" "+t.class),t.attributes){if(!(t.attributes instanceof Object))throw new Error("config.attributes is not an Object");for(var e in t.attributes)d.el.setAttribute(e,t.attributes[e])}h&&(d.el.innerHTML=h),t.visibilityGroup&&(p=t.visibilityGroup,a[p]?a[p].push(d):a[p]=[d]),m(),i[d.id]=d,o.events.subscribe("change:language",(function(){d.localize("language-changed")}))}(),d}}.apply(t,o))||(e.exports=n)},EQmB:function(e,t,r){"use strict";r.r(t),r.d(t,"default",(function(){return f}));var o=r("cNpz"),n=r.n(o),s=r("Na8G"),i=r.n(s),a=r("mpVL"),l=r("5XZA"),c=r("MGCh");function d(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,o)}return r}function h(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}const u=r.n(c).a.channel("designAssetsUtil"),p=r("+Ltv"),m=r("PsNr");class f{static isReallyRandom(e){if(0===e.contentType.indexOf("image/")){const t=e.contentType.split("image/")[1];if("jpg"===t||"jpeg"===t||"png"===t)return!1}return!0}static isReallyPng(e){return"image/png"===e.contentType}static isReallySvg(e){return"image/svg+xml"===e.contentType}static shouldRenderAsPng(e){return"image/png"===e.contentType||(!!f.isReallySvg(e)||f.isReallyRandom(e))}static getMimeType(e){return f.shouldRenderAsPng(e)?"image/png":e.contentType}static getMatrixHref(e,t){return n.a.parse(e).expand({size:t})}static getHigherResRenditionLink(e,t){let r="";if(e){e.licensingCategory===a.a.Premium||(r=l.a.getRenditionLinkFromInfo(e._links[a.c],t))}return r}static async fetchHigherResRendition(e,t,r){if(e){const o=e.licensingCategory===a.a.Premium;return l.a.getRenditionFromInfo(e._links[a.c],t,void 0,r&&o).then(t=>t.blobUrl?t.blobUrl:l.a.getRenditionLinkFromInfo(e._links[a.c],a.b))}return""}static getEditorConsumableAddItem({contentItem:e,searchProps:t={},searchFiltersStr:r="",userIsPremium:o,triggerUpgradeMessage:n}){const s=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?d(Object(r),!0).forEach((function(t){h(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):d(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({},e),i=s._links,l=i[a.d.RENDER_LINK_PRIMARY];if(!o&&s.licensingCategory===a.a.Premium)return n&&n(),null;s.schema=s.schema||"ASSET",s.source={name:"CC Light Design Assets"},s.license={short_name:s.licensingCategory},s.owner={name:"Adobe"},s.searchProps=JSON.stringify(t),s.title=s.name,s.design_intent=s.path,s.created_date=Date.parse(s.createDate),s.modified_date=Date.parse(s.modifyDate),s.tags=s.topics,s.context=l,s.searchText=t.text,s.searchFiltersStr=r;const c={link:l.href,width:s.width,height:s.height},u=f.getHigherResRenditionLink(e,512);let g;u||(g=f.fetchHigherResRendition(e,512,o));let b=512,v=512;if(c.width!==c.height&&(c.width>c.height?v/=c.width/c.height:b/=c.height/c.width),f.shouldRenderAsPng(s)&&!f.isReallyPng(s)){const e=i[a.c],t=p.maxImageSizeFromStorage;c.link=f.getMatrixHref(e.href,t),c.width===c.height?(c.width=t,c.height=t):c.width>c.height?(c.width=t,c.height=t*(c.height/c.width)):(c.height=t,c.width=t*(c.width/c.height))}let I=[{original:c,source:"CC Light Design Assets",mimeType:f.getMimeType(s),small:{blobPromise:g,link:u,width:b,height:v}}];return I=m.cleanUpFiles(I),{files:I,info:s}}static getItemUpgradePreviewLink(e){return e?l.a.getRenditionLinkFromInfo(e._links[a.c],a.b):""}static triggerUpgradeMessage({contentItem:e,panelId:t="backgrounds",app:r="post",totalAssets:o=0,analyticsPage:n="editor:post",analyticsDataExtend:s}){i.a.showMerchMessagingModal({totalAssets:o,analyticsPage:n,analyticsDataExtend:s,workflow:"addPremiumAssetFromEditor",asset:{app:r,id:e.id,urn:e.urn,alias:e.alias,tags:e.tags,animated:e.animated,isPremiumTemplate:!0,remixable:!0,remixpaid:!0,type:"designAsset_"+t,width:e.width,height:e.height,preloadedRenditionUrl:f.getItemUpgradePreviewLink(e)},pickerId:t,editor:"post",assetType:"designAsset"})}static getUserSelectedAsset(e,t=!1,r="backgrounds"){let o;try{o=sessionStorage.getItem(e),o=o?JSON.parse(o):null}catch(t){u.warn(`Error fetching assetId: ${e} from the sessionStorage`,{error:t})}return o?f.getEditorConsumableAddItem({contentItem:o,userIsPremium:t,searchProps:{},searchFiltersStr:"",triggerUpgradeMessage:()=>{f.triggerUpgradeMessage({contentItem:o,panelId:r,app:"post",totalAssets:0,analyticsPage:"home",analyticsDataExtend:{contextualData1:"isStarterLibrary:false"}})}}):(u.warn("No asset retrieved from the sessionStorage with key : "+e),null)}}},KFmL:function(e,t,r){var o,n;o=[r("xeH2"),r("YLtl"),r("Avqh"),r("Lo4C")],void 0===(n=function(e,t,r,o){return function(t){if((t=t||{}).tag=t.tag||"BUTTON",!t.template){var n=t.label||"i18n.common.kOK";t.hoverLabel?t.template="<span>"+n+"</span>":"icon"===t.closeButtonType?t.template="<i></i>":t.template=n}var s=!0;"boolean"==typeof t.enabled&&(s=t.enabled);var i=new r(t),a=i.update,l=null;function c(){i.$el.off("click",h)}function d(){i.$el.on("click",h)}function h(e){s&&("function"==typeof t.onClick&&t.onClick(e),i.handleClick(e))}return i.handleClick=function(){},i.isEnabled=function(){return s},i.enable=function(){s=!0,i.$el.removeClass("post-button-disabled")},i.disable=function(){s=!1,i.$el.addClass("post-button-disabled")},i.hideHoverLabel=function(){l&&l.hide()},i.updateLabel=function(t){if(l){var r=i.$el.find("span");e(r[0]).text(t)}else i.$el.text(t);i.localize("content-updated")},i.update=function(e){void 0!==(e=e||{}).hoverLabel&&l&&l.update({message:e.hoverLabel,context:e.context}),a(e)},i.el.className+=" post-button",s||(i.el.className+=" post-button-disabled"),t.hoverLabel&&(l=new o({parent:i,hoverLabelPosition:t.hoverLabelPosition,class:t.hoverClass,message:t.hoverLabel}),i.events.subscribe("hidden",l.hide)),i.events.subscribe("shown",d),i.events.subscribe("hidden",c),i.isHidden()||d(),i}}.apply(t,o))||(e.exports=n)},Lo4C:function(e,t,r){var o,n;o=[r("xeH2"),r("YLtl"),r("2Fsf")],void 0===(n=function(e,t,r){return function(e){var t=(e=e||{}).hoverEl||e.parent.$el,o=e.hoverLabelPosition?e.hoverLabelPosition:"above",n="below"===o?"pointer-up":"pointer-down";e.message||0===e.message?e.template="<p>"+e.message+'</p><p class="pointer '+n+'"></p>':e.template='<p></p><p class="'+n+'"></p>';var s=new r(e),i=s.update;var a=null;return s.show=function(){null!=a&&(clearTimeout(a),a=null),a=setTimeout((function(){s.$el.addClass("visible")}),750)},s.hide=function(){null!=a&&(clearTimeout(a),a=null),s.$el.removeClass("visible")},s.update=function(t){(e.message||0===e.message)&&(t.template="<p>"+t.message+'</p><p class="pointer '+n+'"></p>'),i(t)},s.el.className+=" post-hover-label post-hover-label-"+o,t.hover(s.show,s.hide),s}}.apply(t,o))||(e.exports=n)},WPh2:function(e,t,r){var o,n;o=[r("xeH2"),r("YLtl"),r("KFmL"),r("+Ltv")],void 0===(n=function(e,t,r,o){var n={};return function(e){(e=e||{}).height=e.height||48,e.label=e.label||"",e.template=e.template||"<div class='tab-button-icon'></div><div class='tab-button-inner'>"+e.label+"</div>";var t,s=new r(e),i=e.group||"default",a=e.defaultSelected||!1,l=!1,c=e.isPremium,d=e.isEntitled,h=s.show;return s.handleClick=function(){l?"function"==typeof e.handleClickOnSelected&&e.handleClickOnSelected():s.select({userActivated:!0})},s.show=function(r){if(!0,h(r=r||{}),"function"!=typeof e.onShown||r.silent||e.onShown(),t=o[e.group],r.rememberLastSelectedTab&&t){for(var i=n[groupId],a=0;a<n[groupId].length;a++)if(i[a].id===t&&!i[a].isSelected()){i[a].select();break}}else r.preventSelection||s.select()},s.getSelectedTab=function(){for(var t=n[e.group],r=t.length-1;r>=0;r--)if(t[r].isSelected())return t[r]},s.isSelected=function(){return l},s.deselect=function(){l&&(s.$el.removeClass("post-tab-selected"),l=!1,s.events.publish("deselect"))},s.select=function(t){(t=t||{},"function"!=typeof e.onTrySelect||e.onTrySelect())&&("function"!=typeof e.onSelect||t.silent||e.onSelect(t.userActivated),s.$el.addClass("post-tab-selected"),l=!0,o[e.group]=s.id,n[e.group].forEach((function(e){e.id!==s.id&&e.deselect()})),t.silent||s.events.publish("select"))},s.$el.addClass("post-tab-button"),c&&s.$el.addClass("premium"),d&&s.$el.addClass("entitled"),n[i]?n[i].push(s):n[i]=[s],a&&s.select(),s}}.apply(t,o))||(e.exports=n)},"WPm+":function(e,t,r){"use strict";var o=r("ApVh"),n=r.n(o),s=r("MGCh"),i=r.n(s),a=r("tpS0"),l=r.n(a);t.a=function(e,t,r,o){const s=t.cid,a=e.currentDoc,c=r,d=t.PGMRenderServiceEndpoint,h="png"===c&&o,u=i.a.channel("component:downloadList:renderImage"),p=a.getProjectName(),m=new l.a({headerText:"i18n.dialogs.imageRenderSpinner.kHeaderText",contentText:'<div class="postspinner postspinner-large"></div>',dismissable:!1});function f(e){return e.returnValue="","Your download is not ready. If you close this window, you’ll have to download your file again."}function g(){window.removeEventListener("beforeunload",f)}function b(){m.show();const e=a.id,t=`${d}/render/${e}/format/${h?"png-transparent":c}`;return n.a.getAccessToken().then(e=>function(e,t){const r={headers:{Authorization:"Bearer "+t,"X-Api-Key":s}};return function(){window.addEventListener("beforeunload",f)}(),fetch(e,r).then(v).then(I).catch(T)}(t,e))}function v(e){const t=e.headers.get("content-type"),r=e.headers.get("X-Request-Id"),o="image/png"===t||"image/jpeg"===t,n=t.startsWith("application/json");if(e.ok&&o)return e.blob();if(!e.ok&&n){const t=new Error(e.statusText);throw t.response=e,t.requestId=r,t}}function I(e){const t=new Blob([e],{type:"image/"+c}),r=`${p}.${c}`;if(window.navigator&&window.navigator.msSaveOrOpenBlob)return navigator.msSaveOrOpenBlob(t,r),m.hide(),void g();const o=document.createElement("a");o.href=window.URL.createObjectURL(t),o.download=r,document.body.appendChild(o),o.click(),document.body.removeChild(o),m.hide(),g()}function T(e){if(m.hide(),g(),e.response&&e.requestId){const t=t=>{const r=t.message,o=t.error_code;y(r+"&#013;&#010;code: "+o+"&#013;&#010;requestId: "+e.requestId,e.response),u.error(r,"code:"+o,"requestId:"+e.requestId)};e.response.json().then(t)}else y(e.message),u.error(e.message)}function y(e,t){const r=t&&t.status>=500?S():"",o=new l.a({headerText:'<span class="image-render-error-modal-header">\n                    <span>\n                        i18n.dialogs.imageRenderError.kHeaderText\n                    </span>\n                    <i class="image-render-error-modal-header__icon"></i>\n                </span>',contentText:w(e,r),dismissable:!0,buttons:[{class:"pill pill-primary-on-light",label:"i18n.common.kDone",onClick:()=>{o.hide()}}]}),n=e=>{const t=e.target;if(t.hasAttribute("js-retry-button"))return o.hide(),void b();if(t.hasAttribute("js-copy-to-clipboard")){const e=t.parentElement;e.previousElementSibling.firstElementChild.select(),document.execCommand("copy"),e.classList.add("is-copied-text"),setTimeout((function(){e.classList.remove("is-copied-text")}),5e3)}};document.addEventListener("click",n),o.show();window.marvel.events.on("spark-dialog-closed",()=>{document.removeEventListener("click",n)})}function w(e,t){return`<div class="image-render-error-modal-content">\n                    ${t?S():""}\n                    <p>\n                        <span>i18n.dialogs.imageRenderError.kPleaseText</span>\n                        <a class="image-render-error-modal-content__link" href="https://adobespark.zendesk.com/hc/en-us/requests/new">\n                            i18n.dialogs.imageRenderError.kContactSupportText\n                        </a>\n                        <span>i18n.dialogs.imageRenderError.kWithFollowingErrorText</span>\n                    </p>\n                    <div class="image-render-error-modal-content__erro-block">\n                        <textarea class="image-render-error-modal-content__erro-block__textarea">\n                            ${e}\n                        </textarea>\n                    </div>\n                    <div class="image-render-error-modal-content__clipboard">\n                        <span js-copy-to-clipboard>\n                            i18n.dialogs.imageRenderError.kClickToCopyText\n                        </span>\n                        <span>\n                            i18n.dialogs.imageRenderError.kErrorCodeCopiedText\n                        </span>\n                    </div>\n                </div>`}function S(){return'<p class="image-render-error-modal-content__retry">\n                    <span>\n                        i18n.dialogs.imageRenderError.kPleaseTryText\n                    </span>\n                    <a href="#" role="button" class="image-render-error-modal-content__link" js-retry-button>\n                        i18n.dialogs.imageRenderError.kDownloadingAgainText\n                    </a>\n                </p>'}return b()}},Y7qu:function(e,t,r){var o,n;o=[r("xeH2"),r("YLtl"),r("2Fsf")],void 0===(n=function(e,t,r){return function(e){var o=(e=e||{}).arrowDirection?"tooltip-arrow-"+e.arrowDirection:"tooltip-arrow-down";e.message||0===e.message?e.template="<p>"+e.message+'</p><p class="'+o+'"></p>':e.template='<p></p><p class="'+o+'"></p>';var n=new r(e),s=n.show,i=n.hide,a=n.update;return n.show=function(){n.$el.addClass("fade"),t.delay((function(){n.$el.removeClass("fade")}),200),s()},n.hide=function(){n.$el.addClass("fade"),t.delay((function(){i(),n.$el.removeClass("fade")}),200)},n.update=function(t){(e.message||0===e.message)&&(t.template="<p>"+t.message+'</p><p class="'+o+'"></p>'),a(t)},n.el.className+=" post-slider-tooltip",n}}.apply(t,o))||(e.exports=n)},aOoP:function(e,t,r){"use strict";var o=r("ApVh"),n=r.n(o),s=r("MGCh"),i=r.n(s),a=r("tpS0"),l=r.n(a);function c(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class d extends Error{constructor(...e){super(...e),c(this,"response",void 0),c(this,"requestId",void 0)}}let h,u,p,m,f,g;const b=i.a.channel("component:downloadList:pdfDownload"),v=e=>(e.returnValue="","Your download is not ready. If you close this window, you’ll have to download your file again."),I=()=>{window.removeEventListener("beforeunload",v)},T=(e,t)=>{const r=t&&t.status>=500?'<p class="pdf-download-error-modal-content__retry"><span>i18n.dialogs.pdfDownloadError.kPleaseTryText</span> <a href="#" role="button" class="pdf-download-error-modal-content__link" js-retry-button>i18n.dialogs.pdfDownloadError.kDownloadingAgainText</a></p>':"",o=new l.a({headerText:'<span class="pdf-download-error-modal-header"><span>i18n.dialogs.pdfDownloadError.kHeaderText</span> <i class="pdf-download-error-modal-header__icon"></i></span>',contentText:`<div class="pdf-download-error-modal-content">${r}<p><span>i18n.dialogs.pdfDownloadError.kPleaseText</span> <a class="pdf-download-error-modal-content__link" href="https://adobespark.zendesk.com/hc/en-us/requests/new">i18n.dialogs.pdfDownloadError.kContactSupportText</a> <span>i18n.dialogs.pdfDownloadError.kWithFollowingErrorText</span></p><div class="pdf-download-error-modal-content__erro-block"><textarea class="pdf-download-error-modal-content__erro-block__textarea">${e}</textarea></div><div class="pdf-download-error-modal-content__clipboard"><span js-copy-to-clipboard>i18n.dialogs.pdfDownloadError.kClickToCopyText</span><span>i18n.dialogs.pdfDownloadError.kErrorCodeCopiedText</span></div></div>`,dismissable:!0,buttons:[{class:"pill pill-primary-on-light",label:"i18n.common.kDone",onClick(){o.hide()}}]})},y=e=>{const t=e.headers.get("content-type"),r=e.headers.get("X-Request-Id"),o="application/pdf"===t,n=t.startsWith("application/json");if(e.ok&&o)return e.blob();if(!e.ok&&n){const t=new d(e.statusText);throw t.response=e,t.requestId=r,t}return Promise.reject("Unable to validate response. Unrecognized response type.")},w=e=>{const t=new Blob([e],{type:"application/pdf"}),r=u+".pdf";if(g&&g(),window.navigator&&window.navigator.msSaveOrOpenBlob)return navigator.msSaveOrOpenBlob(t,r),p.hide(),void I();const o=document.createElement("a");o.href=window.URL.createObjectURL(t),o.download=r,document.body.appendChild(o),o.click(),document.body.removeChild(o),p.hide(),I()},S=e=>{if(p.hide(),I(),e.response&&e.requestId){const t=t=>{const r=t.message,o=t.error_code,n=`${r}&#013;&#010;code: ${o}&#013;&#010;requestId: ${e.requestId}`;T(n,e.response),b.error(r,"code:"+o,"requestId:"+e.requestId)};e.response.json().then(t)}else T(e.message),b.error(e.message)};function E(){p.show(),u=m.getProjectName();const e=m.id,t=`${f}/pdfs/${e}`;n.a.getAccessToken().then(e=>{const r={headers:{Authorization:"Bearer "+e,"X-Api-Key":h}};window.addEventListener("beforeunload",v),fetch(t,r).then(y).then(w).catch(S)})}t.a=function(e,t,r){m=e.currentDoc,f=t.PDFExportServiceEndpoint,h=t.cid,g=r,p=new l.a({headerText:"i18n.dialogs.pdfDownloadSpinner.kHeaderText",contentText:'<div class="postspinner postspinner-large"></div>',dismissable:!1}),E()}},"d/MO":function(e,t,r){var o,n;o=[r("ym4+"),r("Avqh")],void 0===(n=function(e,t){return function(r){(r=r||{}).tag=r.tag||e.TheoDownloadOptions.elementName,r.label=r.label||"",r.submitButtonLabel=r.submitButtonLabel||"",r.optionsList=r.optionsList||[];const o=new t(r),n=o.update;let s=!0;"boolean"==typeof r.enabled&&(s=r.enabled);const i=e=>s&&"function"==typeof e,a=e=>void 0!==e,l=({name:e,label:t,ariaLabel:r,tooltipMessage:n,submitButtonLabel:s,selectedOption:i,optionsList:l})=>{a(e)&&(o.el.name=e),a(t)&&(o.el.buttonLabel=t),a(r)&&(o.el.buttonAriaLabel=r),a(n)&&(o.el.buttonTooltipMessage=n),a(s)&&(o.el.submitLabel=s),a(i)&&(o.el.selectedOption=i),a(l)&&l.length&&(o.el.optionsList=l)},c=function(e){i(r.onPDFDownload)&&r.onPDFDownload(e)},d=function(e){i(r.onIMGDownload)&&r.onIMGDownload(e)},h=function(e){i(r.onMP4Download720p)&&r.onMP4Download720p(e)},u=function(e){i(r.onIMGDownloadV2)&&r.onIMGDownloadV2(e)};o.update=function(e){l(e),n(e)};const p=function(){if(i(r.onOptionsShown)){o.el.isDownloadListVisible()&&r.onOptionsShown()}},m=function(){o.$el.off("DOWNLOAD_FILE_IMG_PNG",d),o.$el.off("DOWNLOAD_FILE_IMG_JPG",d),o.$el.off("DOWNLOAD_FILE_IMG_PNG_V2",u),o.$el.off("DOWNLOAD_FILE_IMG_JPEG_V2",u),o.$el.off("DOWNLOAD_FILE_PDF",c),o.$el.off("DOWNLOAD_FILE_MP4_SEVEN_TWENTY_P",h),o.$el.off("OPTIONS_RENDERED",p)},f=function(){o.$el.on("DOWNLOAD_FILE_IMG_PNG",d),o.$el.on("DOWNLOAD_FILE_IMG_JPG",d),o.$el.on("DOWNLOAD_FILE_IMG_PNG_V2",u),o.$el.on("DOWNLOAD_FILE_IMG_JPEG_V2",u),o.$el.on("DOWNLOAD_FILE_PDF",c),o.$el.on("DOWNLOAD_FILE_MP4_SEVEN_TWENTY_P",h),o.$el.on("OPTIONS_RENDERED",p)};return l(r),o.events.subscribe("shown",f),o.events.subscribe("hidden",m),o.isHidden()||f(),o}}.apply(t,o))||(e.exports=n)},epRH:function(e,t,r){"use strict";r.d(t,"a",(function(){return h}));var o=r("Avqh"),n=r.n(o),s=r("yiV4"),i=r("+Ltv"),a=r.n(i);function l(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,o)}return r}function c(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?l(Object(r),!0).forEach((function(t){d(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):l(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function d(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class h extends n.a{constructor(e){super(c(c({},e),{},{tag:s.a.elementName})),d(this,"typedEl",void 0),d(this,"baseUpdate",void 0),d(this,"baseShow",void 0),d(this,"baseHide",void 0),d(this,"overriddenUpdate",e=>{const t=e||{};"function"==typeof t.onSaveButtonClicked&&this.typedEl.addEventListener("THEO-ASSET-SUBMITTER-SAVE-BUTTON-CLICKED",t.onSaveButtonClicked),"object"==typeof t.localizedStrings&&(this.typedEl.localizedStrings=t.localizedStrings),this.baseUpdate(t)}),d(this,"overriddenShow",e=>{!1===e?this.overriddenHide():(a.a.disableCustomKeyboardShortcuts=!0,this.typedEl.show(),this.baseShow(e))}),d(this,"overriddenHide",()=>{a.a.disableCustomKeyboardShortcuts=!1,this.typedEl.hide(),this.baseHide()}),this.typedEl=this.el,this.typedEl.addEventListener("THEO-ASSET-SUBMITTER-CLOSE-GESTURE-PERFORMED",this.overriddenHide),this.baseUpdate=this.update,this.update=this.overriddenUpdate,this.baseShow=this.show,this.show=this.overriddenShow,this.baseHide=this.hide,this.hide=this.overriddenHide,this.update(e)}}},mpVL:function(e,t,r){"use strict";r.d(t,"a",(function(){return E})),r.d(t,"c",(function(){return D})),r.d(t,"b",(function(){return A}));var o=r("cNpz"),n=r.n(o),s=r("5XZA"),i=r("Uwho"),a=r.n(i),l=r("3xm6"),c=r.n(l),d=r("M76B"),h=r.n(d),u=r("MGCh"),p=r.n(u),m=r("bBG2"),f=r("rCSV"),g=r("E+oP"),b=r.n(g),v=r("EQmB");function I(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,o)}return r}function T(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?I(Object(r),!0).forEach((function(t){y(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):I(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function y(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}const w=p.a.channel("design-assets-data-controller");var S;let E;var C,P,k;!function(e){e.asset="asset",e.group="group"}(S||(S={})),function(e){e.Premium="premium",e.Free="free"}(E||(E={})),function(e){e.none="none",e.stickers="stickers",e.designAssets="designAssets",e.backgrounds="backgrounds",e.rootAssets="rootAssets"}(C||(C={})),function(e){e.Folder="folder",e.Collection="collection",e.File="file"}(P||(P={})),function(e){e.Collection="application/vnd.adobe.light.collection+json",e.Folder="application/vnd.adobecloud.directory+json"}(k||(k={}));const F={[P.Folder]:"vnd.adobecloud.directory+json",[P.File]:"image*",[P.Collection]:"vnd.adobe.light.collection+json"},L={"cy-GB":"en-US"},D="http://ns.adobe.com/adobecloud/rel/rendition",x=!0,A=160,_={Stickers:{key:"stickers",value:"Stickers",dal1:C.stickers,maxSearchGroupingLevel:1,path:"/Stickers"},DesignAssets:{key:"designAssets",value:"Design Assets",dal1:C.designAssets,maxSearchGroupingLevel:2,path:"/Design Assets"},RootAssets:{key:"rootAssets",value:"Root Assets",dal1:C.rootAssets,maxSearchGroupingLevel:2,path:""},Backgrounds:{key:"backgrounds",value:"Backgrounds",dal1:C.backgrounds,maxSearchGroupingLevel:1,path:"/Backgrounds"}};class O{constructor(e){y(this,"events",new f.default),y(this,"topItem",void 0),y(this,"id",void 0),y(this,"daL1",void 0),y(this,"currentTop",void 0),y(this,"currentTopFolder",void 0),y(this,"currentPathItems",[]),y(this,"mainDataReadyPromise",void 0),y(this,"defaultLocale","en-US"),y(this,"searchHost",""),y(this,"userIsPremium",!1),y(this,"dragAndDropEnabled",!1),y(this,"defaultNumSearchResults",100),y(this,"defaultNumFolderEnumerationResults",100),y(this,"cachedFolderAggs",{}),y(this,"use2XThumbs",!1),y(this,"uiStateController",void 0),y(this,"awaitingHandleMoreClick",!1),y(this,"clickBlocked",!1),y(this,"searchLocale",void 0),y(this,"allGroupItemsByPath",{}),y(this,"assetTypes",[P.File]),y(this,"rootFolder",{type:S.group,title:"Root"}),y(this,"currentRenderDetails",{collectionItems:[],photoGridItems:[],showFlatThumbnailView:!1,flatIs2:!1,title:"",breadcrumbItems:[],searchSuggestedTopics:[],searchInputText:"",searchPlaceholder:"",photoGridResultsLabel:"",totalPhotoGridItemsCount:0,premiumBadgeVariant:"crown",isLoading:!1}),this.id=e.topL1,this.searchHost=e.searchHost,this.topItem=O.itemFromSelectKey(e.topL1),this.currentRenderDetails.title=this.topItem.value,this.currentRenderDetails.premiumBadgeVariant=e.premiumBadgeVariant,this.userIsPremium=e.userIsPremium,this.dragAndDropEnabled=e.dragAndDropEnabled,this.use2XThumbs=window.devicePixelRatio>=2,this.uiStateController=e.uiStateController;let t=h.a.getLocale();L[t]&&(t=L[t]),this.searchLocale=t}filtersAnalyticsValueFromFilters(e){return e?e.map(e=>e.id||e).join(","):""}sendSearchAnalytics(e){e&&m.default.publish("search:keywordEntered",{contextualData1:"keyword:"+e.q,contextualData2:"filters:"+this.filtersAnalyticsValueFromFilters(e.filters),contextualData3:"type:"+this.id,contextualData4:"location:editor",contextualData5:"resultsCount:"+e.total})}async resolveFolderForTitle(e){var t;const r=((null===(t=e.loadPath)||void 0===t?void 0:t.split("/"))||[]).join("%2F"),o=await this.fetchezLaVache("/resolve?path="+r),{_links:n}=o;if(n){const t=o;e.title=this.titleFromContentItem(t),e.id=t.id,e.contentItem=t,this.allGroupItemsByPath[t.path]=e}}async navToFolder(e,t){if(this.currentTop){if(e===this.rootFolder)this.currentPathItems.splice(1),this.setCurrentSearch();else{const{contentItem:t}=e;if(!t)return;const r="/content/assets/publish"+this.topItem.path,o=(t.path.split(r+"/")[1]||"").split("/");if(o.pop(),this.currentPathItems.splice(1),o.length){let e=r;const t=[];o.forEach(r=>{e=`${e}/${r}`;const o=this.allGroupItemsByPath[e];if(o)this.currentPathItems.push(o);else{const o={loadPath:e,type:S.group,title:r};this.currentPathItems.push(o),t.push(this.resolveFolderForTitle(o))}}),t.length&&await Promise.all(t)}this.currentPathItems.push(e)}return this.pathItemsUpdated(),this.currentTop.bottomItem=e,t.q||t.filters.length?await this.executePanelSearch(t):(await this.ensureFolderContentsLoaded(e),await this.loadFolderTags(e),this.setCurrentSearch(),this.currentTop.searchInfo.q=""),this.updateUiController(),this.currentTop.bottomItem}}pathItemsUpdated(){1===this.currentPathItems.length?this.currentRenderDetails.breadcrumbItems=[]:this.currentRenderDetails.breadcrumbItems=this.currentPathItems.map(e=>({id:e.id||"",label:e.title}))}async resetToTop(e){await this.navToFolder(this.rootFolder,{q:"",filters:[]}),e&&e()}async showingFromSearchPropsEvent(e,t){let r;if(this.mainDataReadyPromise||(this.currentRenderDetails.isLoading=!0,this.updateUiController(!0),this.mainDataReadyPromise=this.initMainBrowseData(this.topItem)),await this.mainDataReadyPromise,e){const{context:t,routeQuery:o}=e;if(t&&t.search_props)if("string"==typeof t.search_props){const{search_props:e}=t;try{r=JSON.parse(e)}catch(t){w.warn("show error parsing searchProps",{error:t,propsString:e})}}else r=t.search_props;else o&&(r={},o.assetSearchFilters&&(r.filters=o.assetSearchFilters),o.assetFolderId&&(r.folderId=o.assetFolderId),o.assetSearchQ&&(r.text=o.assetSearchQ),o.assetSearchPath&&(r.path=o.assetSearchPath),b()(r)&&(r=void 0))}if(r)await this.showingFromSearchProps(r);else if(!e||!e.keepPreviousState)return void this.resetToTop(t);t&&t()}async showingFromSearchProps(e){var t,r,o,n;let s;const i="/content/assets/publish"+e.path,a=e.folderId||e.collId,l={filters:[],q:e.text||""};if(e.filters){const t=e.filters.split(",");l.filters=t.map(e=>({id:e,label:e,count:0,selected:!0}))}var c;if(e.folderId===this.rootFolder.id||(null===(t=this.rootFolder.contentItem)||void 0===t?void 0:t.path)===i)s=null===(c=this.currentTop)||void 0===c?void 0:c.rootItem;else if(!(null===(r=this.currentTop)||void 0===r?void 0:r.bottomItem)||a!==this.currentTop.bottomItem.id&&i!==(null===(o=this.currentTop.bottomItem.contentItem)||void 0===o?void 0:o.path)){if(s=this.allGroupItemsByPath[i],!s){const t=e.folderId||e.collId;s=Object.values(this.allGroupItemsByPath).find(e=>e.id===t)}}else{var d;s=null===(d=this.currentTop)||void 0===d?void 0:d.bottomItem}if(s)await this.navToFolder(s,l);else{if(e.folderId||e.collId){const t=e.folderId?"folders":"collections",r=await this.fetchezLaVache(`/${t}/${a}`),{_links:o}=r;if(o){const e=r,t={contentItem:e,type:S.group,title:this.titleFromContentItem(e),id:e.id};return t.contentsLoader=this.loadFolderContents(t),await t.contentsLoader,void await this.navToFolder(t,l)}}if(e.path){var h;const t=(null===(h=this.rootFolder.contentItem)||void 0===h?void 0:h.name)||"",r=e.path.split("/");""===r[0]&&r.shift(),r[0]!==t&&r.unshift(t),""===r[r.length-1]&&r.pop();const o="/content/assets/publish".split("/").concat(r).join("%2F"),n=await this.fetchezLaVache("/resolve?path="+o),{_links:s}=n;if(s){const e=n,t={contentItem:e,type:S.group,title:this.titleFromContentItem(e),id:e.id};return t.contentsLoader=this.loadFolderContents(t),await t.contentsLoader,void await this.navToFolder(t,l)}}(null===(n=this.currentTop)||void 0===n?void 0:n.bottomItem)&&await this.navToFolder(this.currentTop.bottomItem,l)}}static itemFromSelectKey(e){switch(e){case _.Stickers.key:return _.Stickers;case _.DesignAssets.key:return _.DesignAssets;case _.RootAssets.key:return _.RootAssets;case _.Backgrounds.key:return _.Backgrounds}return _.RootAssets}static getAssetTypesToSearchStrings(e=[]){const t=[];return e.forEach(e=>{const r=F[e];r&&t.push(r)}),t}static getAssetTypesPramString(e=[]){let t;const r=O.getAssetTypesToSearchStrings(e);return r.length&&(t=r.join(",")),t}static addAssetTypesToSearchFiltersStr(e,t){const r=O.getAssetTypesToSearchStrings(t);if(!r.length)return e;let o;return o=1===r.length?r[0]:`(${r.join(" OR ")})`,e?`${e} AND contentType:${o}`:o}static getEnumerationMatrixHref(e,t,r=100,o,s=0,i){const a=o&&o.join(",")||void 0,l=O.getAssetTypesPramString(t),c=O.getAssetTypesPramString(i);return n.a.parse(e).expand({limit:r,contentType:l,heroContentType:c,heroLimit:s||void 0,orderBy:a})}async getAllResults(e){let t=[];return this.fetchezLaVache(e).then(async e=>{const r=e._embedded;t=r&&(r.children||r.results)||[];const o=this.getNextHrefFromResults(e);if(o){const e=await this.getAllResults(o);return t.concat(e)}return t})}async fetchFolderContents(e,t,r,o){if(!e.contentItem)return O.getFolderContentsForErrorReturn("404","no contentItem for fetching folder contents");let n,s,i=[],a="",l=0;const c=[],{_links:d}=e.contentItem,h=d["http://ns.adobe.com/light/rel/folder-enumeration"]||d["http://ns.adobe.com/light/rel/collection-enumeration"];if(e.contentItem.contentType===k.Folder){const t=e===this.rootFolder?3:6;let o=this.defaultNumFolderEnumerationResults;t*o>100&&(o=Math.floor(100/t)),n=O.getEnumerationMatrixHref(h.href,[P.Folder,P.Collection],o,["priority","-createDate"],t,r||this.assetTypes);const s=this.getAllResults(n).then(e=>{i=i.concat(e)});c.push(s)}if(!t){s=O.getEnumerationMatrixHref(h.href,r||this.assetTypes,o||this.defaultNumFolderEnumerationResults,["priority","-createDate"]);const e=this.fetchezLaVache(s).then(e=>{const t=e._embedded;t&&(a=this.getNextHrefFromResults(e),l=t.total,l&&(i=i.concat(t.children||t.results||[])))});c.push(e)}if(await Promise.all(c),i.length){const t=this.folderContentsFromContentItems(i,e);return t.totalFiles=l,t.nextFilesHref=a,t}return O.getFolderContentsForErrorReturn("404","no contents fetching folder contents")}titleFromContentItem(e,t){let r;const o=null==e?void 0:e.title;return o&&(r=o[this.searchLocale]||o[this.defaultLocale]),r||(r=e.name||"",t&&-1!==r.indexOf(".collection")&&(r=r.substring(0,r.indexOf(".collection")))),r}folderContentsFromContentItems(e,t,r){const o=[],n=r,s=e.reduce((e,t)=>{if(n&&t.directory!==n)return e;const{contentType:r}=t;if(0===r.indexOf("image")){const{_links:r}=t;r&&r[D]?e.files.push({contentItem:t,type:S.asset,title:this.titleFromContentItem(t),id:t.id}):w.info("image contentItem had no rendition",t)}else if(r===k.Folder){const r={contentItem:t,type:S.group,title:this.titleFromContentItem(t),id:t.id,subs:[],items:[]};e.folders.push(r);const o=t.path;this.allGroupItemsByPath[o]=r}else if(r===k.Collection){const r={contentItem:t,type:S.group,title:this.titleFromContentItem(t,!0),id:t.id,subs:[],items:[]};e.collections.push(r);const o=t.path;this.allGroupItemsByPath[o]=r}else o.push(t);return e},{files:[],folders:[],collections:[]});if(o.length&&(s.misteryoso=o),(s.folders.length||s.collections.length)&&s.files.length&&t&&t.contentItem){const e={title:c.a.translate("app.designAssets.miscFolderName",{folderName:this.titleFromContentItem(t.contentItem)}),isDanglingSubFolder:!0,folderContents:{files:s.files,folders:[],collections:[]},contentItem:t.contentItem,type:S.group,id:t.id,subs:[],items:s.files};s.files=[],s.folders.push(e)}return s}static getFolderContentsForErrorReturn(e,t){return{error:{error:e,errorText:t},files:[],totalFiles:0,folders:[],collections:[]}}static tagsFromAggregates(e){let t;const r={},{topics:o}=e,n=[];return o&&o.buckets.forEach(e=>{if(e.key){let{label:o}=e;o||(o=e.key[0].toUpperCase()+e.key.substring(1)),t={label:o,id:e.key,count:e.docCount},r[t.id]=t,n.push(t)}}),n.sort((e,t)=>t.count-e.count),{ordered:n,byId:r}}async loadFolderTags(e){const t=e.id||"";let r=this.cachedFolderAggs[t];if(!r){const o={filters:O.addAssetTypesToSearchFiltersStr(this.getDirectoryOrCollectionFilter(e),this.assetTypes),q:"*",limit:"1",qLoc:this.searchLocale,aggs:"topics",orderBy:"-createDate",aggsLimit:"20",schema:"ASSET"},n=await this.fetchezLaVache("",o),{_embedded:s}=n,i=s;r={daTags:O.tagsFromAggregates(i.aggregations),totalAssets:i.total},this.cachedFolderAggs[t]=r}return e.daTags=r.daTags,e.totalAssets=r.totalAssets,e.daTags}logContentFetchErrorReturnAsContentResponse(e,t){return w.info("fetch had error",T(T({},e),{},{uri:t})),e}async resolveByPath(e){return this.fetchezLaVache("/resolve?path="+e)}async fetchezLaVache(e,t){let r=e;if(-1===e.indexOf("https:")&&(r=`https://${this.searchHost}/v2/content${e}`),t){const e=new URLSearchParams(t);r=`${r}?${e}`}const o={"x-api-key":a.a.sparkContentSearchApiKey};return window.fetch(r,{method:"GET",headers:new window.Headers(o)}).then(e=>e.status<300?200===e.status?e.json().then(e=>e):{status:e.status}:(e.status,this.logContentFetchErrorReturnAsContentResponse({error:e.status,errorText:e.statusText},r))).catch(e=>this.logContentFetchErrorReturnAsContentResponse({error:e,errorText:"fetch-error"},r))}static doesAssetHaveFilters(e,t,r){return!!e.tags&&(1===t.length?e.tags[t[0].id]:r?!t.find(t=>!e.tags||!e.tags[t.id]):!!t.find(t=>!e.tags||e.tags[t.id]))}assetSelectDataFromThumbId(e){var t,r;const o=null===(t=this.currentTop)||void 0===t?void 0:t.bottomItem;let n;if(o)return(null===(r=this.currentTop)||void 0===r?void 0:r.searchInfo.currentSearch)&&this.currentTop.searchInfo.currentSearch.assets&&(n=this.currentTop.searchInfo.currentSearch.assets.find(t=>t.id===e),!n&&this.currentTop.searchInfo.currentSearch.searchSubs&&this.currentTop.searchInfo.currentSearch.searchSubs.find(t=>{var r;return!!(null===(r=t.searchInfo.assets)||void 0===r?void 0:r.length)&&(n=t.searchInfo.assets.find(t=>t.id===e),!!n)})),n||(o.subs&&o.subs.length?o.subs.find(t=>(n=t.heroes&&t.heroes.find(t=>t.id===e),n)):o.items&&(n=o.items.find(t=>t.id===e))),n&&this.extendAssetDataForSelectEvent(n)}extendAssetDataForSelectEvent(e){if(!this.currentTop||!this.currentTopFolder)return;let t=this.currentTopFolder;1!==this.currentTop.pathItems.length&&(t=this.currentTop.bottomItem);const r=t.contentItem;if(!r)return;const o=r.path.split("/content/assets/publish")[1];let n="";if(this.currentTop.searchInfo.currentSearch){const{filters:e}=this.currentTop.searchInfo.currentSearch;e&&e.length&&(n=e.map(e=>e.id).join(","))}const s={text:this.currentTop.searchInfo.q,path:o,filters:n};r.contentType===k.Collection?s.collId=r.id:s.folderId=r.id;return{item:e,searchProps:s,searchText:this.currentTop.searchInfo.q,searchFiltersStr:n}}async ensureAssetItemContentItem(e){return e.contentItem?e.contentItem:e.hero?this.resolveByPath(e.hero.path).then(t=>{const r=T({},t),{_links:o}=r;if(o){const t=r;return e.contentItem=t,t}}):void 0}async ensureFolderContentsLoaded(e){if(!e.loadPath&&e.contentsLoader)return;if(e.contentItem)return e.loadPath=void 0,e.contentsLoader=this.loadFolderContents(e),e.contentsLoader;const t=(e.loadPath||"").split("/").join("%2F");return this.fetchezLaVache("/resolve?path="+t).then(t=>{const r=T({},t),{_links:o}=r;if(o){const t=r;return e.loadPath=void 0,e.title=this.titleFromContentItem(t),e.id=t.id,e.contentItem=t,e.contentsLoader=this.loadFolderContents(e),e.contentsLoader}})}async handleNavBack(e){var t;if(!this.currentTop)return;if(e){let t=-1;this.currentPathItems.find((r,o)=>r.id===e&&(t=o,!0)),-1!==t&&this.currentPathItems.splice(t+1)}else this.currentPathItems.length>1&&this.currentPathItems.pop();this.pathItemsUpdated();const r=this.currentPathItems[this.currentPathItems.length-1];this.currentTop.searchInfo.currentSearch&&(this.currentTop.searchInfo.currentSub=this.currentPathItems.length>1?r:void 0),this.currentTop.bottomItem=r,(null===(t=this.currentTop.searchInfo.currentSearch)||void 0===t?void 0:t.searchOptions)?await this.executePanelSearch(this.currentTop.searchInfo.currentSearch.searchOptions):(await this.ensureFolderContentsLoaded(r),this.recalculateCurrentSearchTopics()),this.updateUiController()}updateUiController(e=!1){e||this.getRenderDetails({colSizes:{2:126,3:80},flat2ColThreshold:20}),this.uiStateController&&this.uiStateController.handleDesignAssetsChanged(T({},this.currentRenderDetails),this.id)}handleDragStart(e,t){var r;const o=this.assetSelectDataFromThumbId(e.id);if(!o)return void w.warn("could not find matching data from thumb drag",e);const n=JSON.stringify(o);null===(r=t.dataTransfer)||void 0===r||r.setData("text",n)}async handleThumbClicked(e){if(this.clickBlocked)return;this.clickBlocked=!0,setTimeout(()=>{this.clickBlocked=!1},1e3);const t=this.assetSelectDataFromThumbId(e.id);if(!t)return void w.warn("could not find matching data from thumb click",e);const{item:r,searchProps:o,searchFiltersStr:n}=t,s=await this.ensureAssetItemContentItem(r),i=v.default.getEditorConsumableAddItem({searchProps:o,searchFiltersStr:n,contentItem:s,userIsPremium:this.userIsPremium,triggerUpgradeMessage:()=>{v.default.triggerUpgradeMessage({contentItem:s,panelId:this.id,app:"post",totalAssets:this.getTotalAssets(),analyticsPage:"editor:post",analyticsDataExtend:{contextualData1:"isStarterLibrary:false"}})}});i&&this.events.publish("item-selected",T(T({},i),{},{designAssetsPanelId:this.id}))}async handleMoreClick(e){var t;const r=+e;if(!this.currentTop)return;if(this.awaitingHandleMoreClick)return;if(this.currentTop.searchInfo.currentSearch){var o;if(this.currentTop.searchInfo.currentSearch.subs){const e=this.currentTop.searchInfo.currentSearch.subs[r];this.currentTop.searchInfo.currentSub=e,this.currentTop.bottomItem=e}else{if(!(null===(o=this.currentTop.bottomItem)||void 0===o?void 0:o.subs))return;{const e=this.currentTop.bottomItem.subs[r];this.currentTop.searchInfo.currentSub=e,this.currentTop.bottomItem=e}}}else{const e=this.currentTop.bottomItem.subs||this.currentTop.bottomItem.items;if(!e)return;{const t=e[r];if(!t)return;this.awaitingHandleMoreClick=!0,t.contentsLoader||(t.contentsLoader=this.loadFolderContents(t)),await t.contentsLoader,await this.loadFolderTags(t),this.awaitingHandleMoreClick=!1,this.currentTop.bottomItem=t}}let n;var s,i;(this.awaitingHandleMoreClick=!0,this.currentPathItems.push(this.currentTop.bottomItem),this.pathItemsUpdated(),null===(t=this.currentTop.searchInfo.currentSearch)||void 0===t?void 0:t.searchOptions)?(await this.executePanelSearch(this.currentTop.searchInfo.currentSearch.searchOptions),this.updateUiController(),n={assetPath:null===(s=this.currentTop.bottomItem.contentItem)||void 0===s?void 0:s.path,assetId:this.currentTop.bottomItem.id,searchInput:this.currentTop.searchInfo.currentSearch.searchOptions.q,filters:this.currentTop.searchInfo.currentSearch.searchOptions.filters}):(this.recalculateCurrentSearchTopics(),this.updateUiController(),n={assetPath:null===(i=this.currentTop.bottomItem.contentItem)||void 0===i?void 0:i.path,assetId:this.currentTop.bottomItem.id});let a=n.filters&&this.filtersAnalyticsValueFromFilters(n.filters||[]),l=n.searchInput;l||a||(l="null",a="null"),n&&m.default.publish("editor:morePressed",{contextualData1:"assetPath:"+n.assetPath,contextualData4:"assetID:"+n.assetId,contextualData2:"filters:"+a,contextualData3:"keyword:"+l}),this.awaitingHandleMoreClick=!1}async searchCleared(){if(this.currentTop&&this.currentTop.bottomItem!==this.rootFolder){const{bottomItem:e}=this.currentTop;e.contentsLoader||(e.contentsLoader=this.loadFolderContents(e)),await e.contentsLoader,await this.loadFolderTags(e)}this.setCurrentSearch(),this.updateUiController()}static getCollectionsFromSubs(e){return e.filter(e=>{var t;return(null===(t=e.contentItem)||void 0===t?void 0:t.contentType)===k.Collection})}async searchTopicDeselected(e,t){if(!this.currentTop)return;const{searchInfo:r}=this.currentTop;let o=r.currentSearch&&r.currentSearch.filters&&r.currentSearch.filters.length&&r.currentSearch.filters||[];return o=o.filter(t=>t.id!==e.id),this.executePanelSearch({q:t,filters:o},!0)}async searchTopicClick(e,t){var r;if(!this.currentTop)return;const{searchInfo:o}=this.currentTop,n=o.currentTags.ordered.find(t=>t.id===e.id);if(!n)return;n.selected=!e.isSelected;let s=[];o.currentSearch&&o.currentSearch.filters&&o.currentSearch.filters.length&&(s=[...o.currentSearch.filters]);let i=-1;const a=s.find((t,r)=>t.id===e.id&&(i=r,!0));e.isSelected?a&&s.splice(i,1):a||s.push(n),t&&t.hideSearch(),this.executePanelSearch({q:(null===(r=o.currentSearch)||void 0===r?void 0:r.q)||"",filters:s},!0)}recalculateCurrentSearchTopics(){if(!this.currentTop)return;const{searchInfo:e,bottomItem:t}=this.currentTop,r=e.currentSearch&&e.currentSearch.daTags||t&&t.daTags||e.daTags,o=e.currentSearch&&e.currentSearch.filters&&e.currentSearch.filters.length&&e.currentSearch.filters,n=[],s=[];r.ordered.forEach(e=>{const t={label:e.label,id:e.id,isSelected:!(!o||!o.find(t=>e.id===t.id))};t.isSelected?n.push(t):s.push(t)}),e.currentTags=r,this.currentRenderDetails.searchSuggestedTopics=n.concat(s)}async loadMoreForCurrentBottom(){if(!this.currentTop)return 0;const{bottomItem:e}=this.currentTop,{folderContents:t}=e;if(!t)return 0;const{nextFilesHref:r}=t;return r?this.fetchezLaVache(r).then(r=>{const{_embedded:o,error:n}=r;if(n)return 0;const s=o;t.totalFiles=s.total,t.nextFilesHref=this.getNextHrefFromResults(r);const i=this.folderContentsFromContentItems(s.children||s.results||[]);return t.files=t.files.concat(i.files),e.items=t.files,t.files.length}):0}async handleLoadMore(){if(!this.currentTop)return 0;const{currentSearch:e}=this.currentTop.searchInfo;if(!e)return await this.loadMoreForCurrentBottom(),void this.updateUiController();const{nextHref:t}=e;return t?this.fetchezLaVache(t).then(t=>{var r;const{_embedded:o,error:n}=t;if(n)return 0;e.nextHref=this.getNextHrefFromResults(t);const s=o,i=this.folderContentsFromContentItems(s.results);if(e.total=s.total,e.assets=null===(r=e.assets)||void 0===r?void 0:r.concat(i.files),this.currentTop){const t=this.currentTop.searchInfo.cachedResults[e.cacheId||""];t&&(t.total=e.total,t.assets=e.assets,t.nextHref=e.nextHref)}return this.updateUiController(),i.files.length}):0}cleanUserString(e){return e.replace(/[.,\/#!$%\^&\*;:{}\]\[=\_"`~()\\]/g," ").replace(/ +/g," ").trim()}async executePanelSearch(e,t){var r;if(!this.currentTop)return;let o=this.currentTopFolder,n=(null===(r=this.currentTop.rootItem.subs)||void 0===r?void 0:r.length)&&this.currentTop.pathItems.length<this.currentTop.searchInfo.maxSearchGroupingLevel&&this.currentTop.rootItem.subs;if(1!==this.currentTop.pathItems.length&&(o=this.currentTop.bottomItem),!o)return;let{filters:s,q:i=""}=e;if(i=this.cleanUserString(i),!s){const{searchInfo:e}=this.currentTop;s=e.currentSearch&&e.currentSearch.filters&&e.currentSearch.filters.length&&e.currentSearch.filters||[]}if(!i&&!s.length)return void this.navToFolder(this.currentTop.bottomItem,{q:i,filters:s});const a=i.toLowerCase();let l=`${o.id||""}:${a}`;s&&s.length&&(l+="_::"+s.map(e=>e.id).join(":")),this.currentTop.searchInfo.q=i;let c=this.currentTop.searchInfo.cachedResults[l],d=this.currentTop.searchInfo.currentSearch&&this.currentTop.searchInfo.currentSearch.daTags,h=e;if(!c){h=T(T({},e),{},{q:i,filters:s}),c=await this.executeRealSearch(o,h);const t=n&&O.getCollectionsFromSubs(n)||[];if(n&&!c.error&&c.assets&&(c.total>c.assets.length||t.length)){const e=[];c.searchSubs=e,c.assets=[],c.total||(n=t),c.total=0;const r=n.map((t,r)=>this.executeRealSearch(t,T(T({},h),{},{limit:3,assetTypes:this.assetTypes,orderBy:["-_score","-createDate"],customOrFiltersStr:"hero:true^5",pathBoost:0})).then(o=>{c.total+=o.total,o.assets&&(c.assets=(c.assets||[]).concat(o.assets)),e[r]={group:t,searchInfo:o}}));await Promise.all(r)}c.pathItems=this.currentTop.pathItems,c.daTags=c.aggregations&&O.tagsFromAggregates(c.aggregations),c.cacheId=l,this.currentTop.searchInfo.cachedResults[l]=c}return c.daTags&&c.daTags.ordered.length?d=c.daTags:d&&!d.ordered.length&&(d=void 0),this.setCurrentSearch(T(T({},c),{},{daTags:d})),this.currentTop.searchInfo.currentSearch&&(this.currentTop.searchInfo.currentSearch.searchOptions=h),this.currentPathItems=c.pathItems,this.pathItemsUpdated(),c.pathItems.length>1?this.currentTop.searchInfo.currentSub=c.pathItems[c.pathItems.length-1]:this.currentTop.searchInfo.currentSub=void 0,t&&(this.sendSearchAnalytics(c),this.updateUiController()),c}getNextHrefFromResults(e){const{_links:t}=e;let r=t&&t.next&&t.next.href;return r&&r.startsWith("/v2/content")&&(r=r.split("/v2/content")[1]),r||""}getDirectoryOrCollectionFilter(e){var t;let r;var o;(null===(t=e.contentItem)||void 0===t?void 0:t.contentType)===k.Collection?r=`collections:("${e.id}")`:r=`directory:("${null===(o=e.contentItem)||void 0===o?void 0:o.path}/")`;return r}async executeRealSearch(e,t){const r=t.orderBy?[...t.orderBy]:["-createDate"],{filters:o=[],multiFiltersIsAnd:n=x,q:s}=t;let i;var a;(!t.orderBy&&s&&"*"!==s&&r.unshift("-_score"),t.rootOnly)&&(r.unshift("directory"),i=null===(a=e.contentItem)||void 0===a?void 0:a.path);let l=this.getDirectoryOrCollectionFilter(e);if(void 0!==t.pathBoost&&(l=`${l}^${t.pathBoost}`),o&&o.length){l=`${l} AND (topics:${o.map(e=>e.id).join(n?" AND ":" OR ")})`}l=O.addAssetTypesToSearchFiltersStr(l,t.assetTypes||this.assetTypes),t.customOrFiltersStr&&(l=`${l} OR (${t.customOrFiltersStr})`);const c={q:s||"*",limit:""+(t.limit||this.defaultNumSearchResults),qLoc:this.searchLocale,orderBy:r.join(","),schema:"ASSET",filters:l};let d={};return d=t.noAggs?c:T(T({},c),{},{aggs:"topics",aggsLimit:20}),this.fetchezLaVache("",d).then(e=>{const{_embedded:t,error:r}=e;if(r){return{q:s,filters:o,depth:1,total:0,assets:[],subs:[],pathItems:[]}}const n=t,a=this.folderContentsFromContentItems(n.results,void 0,i);return{folderContents:a,nextHref:this.getNextHrefFromResults(e),q:s,filters:o,count:n.count,total:n.total,depth:1,assets:a.files,aggregations:n.aggregations,pathItems:[]}})}async loadFolderContents(e){return e.contentItem?e.isDanglingSubFolder?(e.folderContents||(e.folderContents=O.getFolderContentsForErrorReturn("null folderContents","loadFolderContents danglingSubFolder had no contents")),e.folderContents):this.fetchFolderContents(e,!1).then(t=>(e.folderContents=t,e.subs=t.collections.concat(t.folders),e.items=t.files,t.folders.length||t.collections.length?this.initFolderSubs(e).then(()=>t):t)):O.getFolderContentsForErrorReturn("fakery","loadFolderContents fakery")}async heroesFromFolder(e){if(e.contentItem&&e.contentItem.heroes&&(e.heroes=e.contentItem.heroes.map(e=>({hero:e,id:e.id,type:S.asset}))),e.heroes&&e.heroes.length)return e.heroes;const t=e===this.rootFolder?3:6,r=this.assetTypes;return this.executeRealSearch(e,{assetTypes:r,q:"",limit:t,rootOnly:e.isDanglingSubFolder,orderBy:["-_score","priority","-createDate"],customOrFiltersStr:"hero:true^5",pathBoost:0,noAggs:!0}).then(t=>{e.heroes=t.assets||[];const o=e.contentItem&&e.contentItem.path,n=`hero fallback returned ${e.heroes.length?`some results (${e.heroes.length})`:"zero results"} for ${O.getAssetTypesPramString(r)} in ${o}`;return w.info(n),e.heroes})}async initFolderSubs(e){const{folderContents:t}=e;if(!t||!e.contentItem)return[];const r=[];return t.collections.forEach(e=>{e.heroesPromise=this.heroesFromFolder(e),r.push(e.heroesPromise)}),t.folders.forEach(e=>{e.heroesPromise=this.heroesFromFolder(e),r.push(e.heroesPromise)}),Promise.all(r).then(()=>t.collections.concat(t.folders))}getTotalAssets(){return this.currentTopFolder&&this.currentTopFolder.totalAssets||0}async getInitialDaDataPrivate(){const{dal1:e=C.none,maxSearchGroupingLevel:t=0}=this.topItem;let r=this.currentTop;if(r)return r;const o=this.rootFolder;this.currentTopFolder=o,o.subs=await this.initFolderSubs(o),o.items=[];const n=await this.loadFolderTags(o);return r={dal1:e,rootItem:o,pathItems:[o],bottomItem:o,searchInfo:{daTags:n,maxSearchGroupingLevel:t,q:"",cachedResults:{},currentTags:n}},this.currentTop=r,this.currentTop.bottomItem=r.bottomItem,this.recalculateCurrentSearchTopics(),this.currentTop.searchInfo.currentSearch?this.currentPathItems=this.currentTop.searchInfo.currentSearch.pathItems:this.currentPathItems=this.currentTop.pathItems,this.pathItemsUpdated(),r}async initMainBrowseData(e){this.topItem=e,this.daL1=e.dal1;const t=("/content/assets/publish"+e.path).split("/").join("%2F");return this.fetchezLaVache("/resolve?path="+t).then(e=>{const t=T({},e),{_links:r}=t;if(r){const e=t;return this.rootFolder={contentItem:e,type:S.group,title:this.titleFromContentItem(e),id:e.id},this.rootFolder.contentsLoader=this.fetchFolderContents(this.rootFolder,!0),this.rootFolder.contentsLoader.then(async e=>(this.rootFolder.folderContents=e,this.getInitialDaDataPrivate().then(e=>(this.currentTop=e,this.currentRenderDetails.isLoading=!1,this.updateUiController(),e))))}})}setCurrentSearch(e){this.currentTop&&(this.currentTop.searchInfo.currentSearch=e,e||(this.currentTop.searchInfo.q=""),this.recalculateCurrentSearchTopics())}getFlatItemsFromSubs(e,t){let r=t;return e.forEach(e=>{e.items&&e.items.length&&(r=r.concat(e.items)),e.subs&&e.subs.length&&(r=this.getFlatItemsFromSubs(e.subs,r))}),r}getAllItemsFromItem(e){let t=[];return e.items&&(t=t.concat(e.items)),e.subs&&e.subs.length&&(t=this.getFlatItemsFromSubs(e.subs,t)),t}getGroupForItems(e,t="",r,o,n=!1,s){return{isFromSearchResult:n,title:t,collectionId:""+r,totalCollectionCount:""+(void 0!==s?s:""),items:e.map(e=>this.getAssetForRender(e,3,o))}}renderFlatItems(e,t){let r=3;e.length<=t.flat2ColThreshold&&(r=2);return{itemsForRender:e.map(e=>this.getAssetForRender(e,r,t)),flatIs2:2===r}}isItemPremium(e){return(e.contentItem&&e.contentItem.licensingCategory||e.hero&&e.hero.licensingCategory||"")===E.Premium}getPremiumBadgeType(e){if("text"===this.currentRenderDetails.premiumBadgeVariant)return this.userIsPremium?e?"premium-text-premium-user":"":e?"":"free-text-non-premium-user";if(!e)return"";const t=this.userIsPremium?"premium-user":"non-premium-user";return`${this.currentRenderDetails.premiumBadgeVariant}-${t}`}getAssetForRender(e,t,r){let o="",n="";const{contentItem:i,hero:a}=e,l=this.isItemPremium(e);if(i||a){let e=r.colSizes[""+t]||A;this.use2XThumbs&&(e*=2),e>A&&l&&(e=A),i?(o=i.id,n=s.a.getRenditionLinkFromInfo(i._links[D],e)):a&&(o=a.id,n=s.a.getRenditionLinkFromInfo(a._links[D],e))}return{id:o,url:n,isPremium:l,premiumType:this.getPremiumBadgeType(l),isDraggable:this.dragAndDropEnabled}}renderGroup(e,t,r,o,n,s){if(s&&!s.length)return;const i=e.heroes,a=s||i||e.items||[],l=!!s,c=n||a.length;if(!c)return;let d;d=1===r?3:3*r;const h=Math.min(d,c),u=a.slice(0,h);return this.getGroupForItems(u,e.title,t,o,l,n)}getCurrentSearchResultsForRender(e,t){var r;const{currentSearch:o,maxSearchGroupingLevel:n}=e;if(!o)return{};const{searchSubs:s,assets:i=[]}=o;let a;const l=[],c={},d=this.currentPathItems.length;if(a=null===(r=this.currentTop)||void 0===r?void 0:r.bottomItem,!s&&i.length&&d<n&&a&&a.subs&&a.subs.length>1){var h;const e=(null===(h=a.subs[0].contentItem)||void 0===h?void 0:h.directory)+"/";a.subs.forEach(t=>{var r;const o=(null===(r=t.contentItem)||void 0===r?void 0:r.path.split(e)[1])||"",n={group:t,assets:[]};c[o]=n,l.push(n)}),i.forEach(t=>{var r;const o=((null===(r=t.contentItem)||void 0===r?void 0:r.directory.split(e)[1])||"").split("/")[0],n=c[o];n&&n.assets.push(t)})}if(!i.length||!s&&!l.length)return{totalPhotoGridItemsCount:o.total,flatItems:this.renderFlatItems(i,t)};const u=[];return s?s.forEach((e,r)=>{const o=this.renderGroup(e.group,r,1,t,e.searchInfo.total,e.searchInfo.assets);o&&u.push(o)}):l.length?l.forEach((e,r)=>{const o=this.renderGroup(e.group,r,1,t,e.assets.length,e.assets);o&&u.push(o)}):o&&o.subs&&o.subs.forEach((e,r)=>{const o=this.renderGroup(e,r,1,t);o&&u.push(o)}),{collectionItems:u}}getRenderDetails(e){var t;const{currentTop:r}=this;let o=[],n=[],s=!1,i=!0,a="",l="",d=0;if(r){if(this.currentRenderDetails.title=r.bottomItem.title,r.searchInfo.currentSearch){const t=this.getCurrentSearchResultsForRender(r.searchInfo,e);t.flatItems?(n=t.flatItems.itemsForRender,s=!0,i=t.flatItems.flatIs2,d=t.totalPhotoGridItemsCount):t.collectionItems&&(o=t.collectionItems)}else if(r.bottomItem.subs&&r.bottomItem.subs.length){const t=r.pathItems.length>1?2:1;r.bottomItem.subs.forEach((r,n)=>{const s=this.renderGroup(r,n,t,e);s&&o.push(s)})}else{var h;const t=r.bottomItem,o=t.heroes,a=t.items&&t.items.length&&t.items||o||[],l=this.renderFlatItems(a,e),c=(null===(h=t.folderContents)||void 0===h?void 0:h.totalFiles)||a.length;n=l.itemsForRender,d=c,s=!0,i=l.flatIs2}a=c.a.translate("app.designAssets.searchPlaceholder",{folderName:this.currentRenderDetails.title}),s&&(l=c.a.translate("app.designAssets.gridResultsLabel",{count:n.length,total:d}))}return this.currentRenderDetails.photoGridItems=n,this.currentRenderDetails.showFlatThumbnailView=s,this.currentRenderDetails.flatIs2=i,this.currentRenderDetails.collectionItems=o,this.currentRenderDetails.searchInputText=(null===(t=this.currentTop)||void 0===t?void 0:t.searchInfo.q)||"",this.currentRenderDetails.searchPlaceholder=a,this.currentRenderDetails.totalPhotoGridItemsCount=d,this.currentRenderDetails.photoGridResultsLabel=l,this.currentRenderDetails}}y(O,"RENDER_LINK_PRIMARY","http://ns.adobe.com/adobecloud/rel/primary"),t.d=O},pEL3:function(e,t,r){var o,n;o=[r("xeH2"),r("YLtl"),r("2Fsf"),r("KFmL"),r("8DU0"),r("bBG2")],void 0===(n=function(e,t,r,o,n,s){const i=n.default,a=s.default;var l={},c=0;return function(n){(n=n||{}).height=n.height||"auto",n.width=n.width||280,n.top=n.top||"auto",n.left=n.left||"auto",n.right=n.right||"auto",n.bottom=n.bottom||"auto",n.offsetX=n.offsetX||0,n.offsetY=n.offsetY||0,n.variant=n.variant||"default",n.standardPadding=n.standardPadding||!1,n.learnMore=n.learnMore||null,n.dismissable="boolean"!=typeof n.dismissable||n.dismissable,n.showCloseButton="boolean"!=typeof n.showCloseButton||n.showCloseButton,n.removeOnHidden="boolean"!=typeof n.removeOnHidden||n.removeOnHidden,n.closeButtonType=n.closeButtonType||"text";var s=n.userSettingFlag,d=n.arrowDirection?"coachmark-arrow-"+n.arrowDirection:"coachmark-arrow-right",h="center"===n.textAlign?"center-align":"",u="post-coachmark-"+n.variant;n.template="",n.hasHeroImage&&(n.template+='<div class="hero-bg"><p class="hero"></p></div>'),"none"!==n.arrowDirection&&(n.template+='<p class="'+d+'"></p>');var p=new r(n),m=p.show,f=p.hide,g="";if("default"===n.variant&&n.title){const e=n.coachmarkTag?`<span class="tag">${n.coachmarkTag}</span>`:"";g+=`<p class=title "${h}">\n                            <span>${n.title||""}</span>\n                            ${e}\n                          </p>`}g+='<p class="body '+h+'">'+(n.message||"")+" "+(n.learnMore||"")+"</p>";var b=new r({parent:p,class:"message",template:g});p.anchorElement=n.anchorElement;var v=n.onHide||function(){},I=n.onCloseClick||function(){};if(n.showCloseButton)new o({class:"coachmark-close",label:"i18n.components.coachmarks.common.kOK",closeButtonType:n.closeButtonType,parent:b,onClick:function(){T(),p.handleHide(),I()}});function T(){delete l[p.priority]}function y(e){return new Promise(r=>{t.delay(r,e)})}function w(t){e(t.target).is(".post-coachmark")||e(t.target).parents(".post-coachmark").length||e.contains(p.$el,t.target)||p.handleHide()}function S(){var e=p.anchorElement.$el[0].getBoundingClientRect();"down"===n.arrowDirection?p.update({left:e.left-(n.width-e.width)/2+n.offsetX,top:e.top+n.offsetY}):"left"===n.arrowDirection?p.update({left:e.right+7+n.offsetX,top:e.top+n.offsetY}):"up"===n.arrowDirection?p.update({left:e.left-(n.width-e.width)/2+n.offsetX,top:e.bottom+7+n.offsetY}):"top-right"===n.arrowDirection?p.update({left:e.right-n.width+n.offsetX,top:e.bottom+7+n.offsetY}):p.update({left:e.left-n.width+7+n.offsetX,top:e.top+n.offsetY})}return n.showCloseButton||n.title?n.standardPadding?p.$el.addClass("no-close-with-padding"):p.$el.addClass("no-close"):p.$el.addClass("message-only"),p.handleHide=function(){return n.coachmarkViewedTrackingEvent&&a.publish(n.coachmarkViewedTrackingEvent),p.hide(),s&&i.setSetting(s,!0),v(),n.removeOnHidden&&T(),y(100).then(()=>{!function(){for(var e=0;e<=c;e++){var t=l[e];if(t&&!t.anchorElement.isHidden()&&t.id!==p.id){t.show();break}}}()})},p.priority=n.priority,p.show=function(){return y(200).then(()=>{if(p.isHidden()&&!p.anchorElement.isHidden()){var t=!0,r=null;if("number"==typeof p.priority)for(var o=0;o<p.priority;o++){if((i=l[o])&&!i.anchorElement.isHidden()){r=i;break}}if(!r){for(var s=0;s<=c;s++){var i;if((i=l[s])&&!i.isHidden()){t=!1;break}}return t?(S(),p.$el.addClass("fade"),m(),e(window).on("resize",S),y(0).then(()=>(n.dismissable&&e("#PostEditorContent").on("click touchend pointerup MSPointerUp","#PostApp",{isCoachmark:!0},w),y(200))).then(()=>{p.$el.removeClass("fade")})):void 0}r.show()}})},p.hide=function(){return e("#PostEditorContent").off("click touchend pointerup MSPointerUp",w),e(window).off("resize",S),p.$el.addClass("fade"),y(200).then(()=>{f(),p.$el.removeClass("fade")})},"number"==typeof p.priority&&(l[p.priority]=p,c=Math.max(c,p.priority)),p.reposition=function(){S()},p.el.className+=" post-coachmark "+u,p}}.apply(t,o))||(e.exports=n)},sggK:function(e,t,r){var o,n;o=[r("xeH2"),r("YLtl"),r("Avqh")],void 0===(n=function(e,t,r){var o={};return function(e){(e=e||{}).hidden="boolean"!=typeof e.defaultActive||!e.defaultActive;var n,s=new r(e),i=e.tabGroup||"default",a=!1,l=s.show,c=s.hide,d="boolean"==typeof e.rememberLastTab&&e.rememberLastTab;return s.registerTab=function(e){o[i].push(e),e.events.subscribe("select",(function(){!function(e){n=e.id,s.isHidden()&&s.show()}(e)}))},s.isActive=function(){return a},s.deselectSelected=function(){var e=o[i];for(var t in e)e[t].deselect()},s.hide=function(r){a=!1,s.$el.addClass("slide-right-fade-out"),t.delay((function(){s.$el.removeClass("slide-right-fade-out")}),200),c(r),"function"==typeof e.onHidden&&e.onHidden()},s.show=function(r){if(r=r||{},a=!0,s.$el.addClass("slide-left-fade-in"),r.noSelect||t.delay((function(){s.$el.removeClass("slide-left-fade-in")}),200),l(r),"function"!=typeof e.onShown||r.silent||e.onShown(),!r.noSelect&&d&&n)for(var c=o[i],h=0;h<o[i].length;h++)if(c[h].id===n&&!c[h].isSelected()){c[h].select();break}},s.$el.addClass("post-tab-set"),o[i]=[],s}}.apply(t,o))||(e.exports=n)},xX9p:function(e,t,r){"use strict";var o=r("ApVh"),n=r.n(o),s=r("bBG2"),i=r("MGCh"),a=r.n(i),l=r("1geK"),c=r("tpS0"),d=r.n(c);function h(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}let u,p,m,f,g,b;const v=a.a.channel("component:downloadList:mp4Download"),I=/[\/\?<>\\:\*\|"]/g,T=/[\x00-\x1f\x80-\x9f]/g,y=/^\.+$/,w=/^(con|prn|aux|nul|com[0-9]|lpt[0-9])(\..*)?$/i,S=/[\. ]+$/;var E;!function(e){e[e.SEVEN_TWENTY_P=1280]="SEVEN_TWENTY_P",e[e.TEN_EIGHTY_P=1920]="TEN_EIGHTY_P"}(E||(E={}));class C extends Error{constructor(...e){super(...e),h(this,"response",void 0),h(this,"requestId",void 0)}}const P=e=>(e.returnValue="","Your download is not ready. If you close this window, you’ll have to download your file again."),k=()=>{window.removeEventListener("beforeunload",P)},F=e=>{const t=e.headers.get("X-Request-Id");if(e.ok)return e.blob();const r=new C(e.statusText);throw r.response=e,r.requestId=t,r};const L=(e,t,r,o)=>{const n=new Blob([e],{type:"application/mp4"}),i=function(e,t){if("string"!=typeof e)throw new Error("Input must be string");return e.replace(I,t).replace(T,t).replace(y,t).replace(w,t).replace(S,t)}(p+".mp4","");if(b&&b(),window.navigator&&window.navigator.msSaveOrOpenBlob)return navigator.msSaveOrOpenBlob(n,i),m.hide(),void k();const a=document.createElement("a");a.href=window.URL.createObjectURL(n),a.download=i,document.body.appendChild(a),a.click(),document.body.removeChild(a),m.hide(),k();const l=new Date;s.default.publish("download:mp4:succeeded",{projectId:t,xRequestId:o,timeSpent:Number(l)-Number(r)+"ms"})},D=(e,t,r)=>{m.hide(),k();const o=(e,t,o)=>{((e,t)=>{const r=t&&t.status>=500?'<p class="mp4-download-error-modal-content__retry"><span>i18n.dialogs.mp4DownloadError.kPleaseTryText</span> <a href="#" role="button" class="mp4-download-error-modal-content__link" js-retry-button>i18n.dialogs.mp4DownloadError.kDownloadingAgainText</a></p>':"",o=new d.a({headerText:'<span class="mp4-download-error-modal-header">\n            <span>i18n.dialogs.mp4DownloadError.kHeaderText</span>\n            <i class="mp4-download-error-modal-header__icon"></i>\n        </span>',contentText:`<div class="mp4-download-error-modal-content">${r}\n            <p>\n                <span>i18n.dialogs.mp4DownloadError.kPleaseText</span>\n                <a class="mp4-download-error-modal-content__link" href="https://adobespark.zendesk.com/hc/en-us/requests/new">\n                    i18n.dialogs.mp4DownloadError.kContactSupportText\n                </a>\n                <span>i18n.dialogs.mp4DownloadError.kWithFollowingErrorText</span>\n            </p>\n            <div class="mp4-download-error-modal-content__erro-block">\n                <textarea class="mp4-download-error-modal-content__erro-block__textarea">${e}</textarea>\n            </div>\n            <div class="mp4-download-error-modal-content__clipboard">\n                <span js-copy-to-clipboard>i18n.dialogs.mp4DownloadError.kClickToCopyText</span>\n                <span>i18n.dialogs.mp4DownloadError.kErrorCodeCopiedText</span>\n            </div>\n        </div>`,dismissable:!0,buttons:[{class:"pill pill-primary-on-light",label:"i18n.common.kDone",onClick(){o.hide()}}]}),n=e=>{const t=e.target;if(t.hasAttribute("js-retry-button"))return o.hide(),void x();if(t.hasAttribute("js-copy-to-clipboard")){const e=t&&t.parentElement;if(e&&e.previousElementSibling){const t=e.previousElementSibling.firstElementChild;t&&(t.select(),document.execCommand("copy"),e.classList.add("is-copied-text"),setTimeout(()=>{e.classList.remove("is-copied-text")},5e3))}}};document.addEventListener("click",n),o.show();window.marvel.events.on("spark-dialog-closed",()=>{document.removeEventListener("click",n)})})(t,o);const n=new Date;v.error(`[mp4 download] failed, projectId: ${e}, time spent: ${Number(n)-Number(r)}ms, error: ${t}`);let i="",a="";o&&(i=o.status,a=o.url),s.default.publish("download:mp4:failed",{projectId:e,timeSpent:Number(n)-Number(r)+"ms",error:t,status:i,url:a})};if(e.response)e.response.json().then(r=>{const n=`${r.message}&#013;&#010;code: ${r.error_code||e.response.status}&#013;&#010;requestId: ${e.requestId}`;o(t,n,e.response)});else{let r="unknown error";if(e.message)r=e.message;else if("object"==typeof e&&null!==e)try{r=JSON.stringify(e,null,2)}catch(e){r="unknown error - JSON.stringify: "+e}else"string"==typeof e&&(r=e);o(t,r)}},x=(e=E.SEVEN_TWENTY_P)=>{m.show(),p=f.getProjectName();const t=f.id,r=new Date;s.default.publish("download:mp4:started",{projectId:t});let o=null;try{o=l.default.getPgmGraphForPublish(u)}catch(e){return void D(e,t,r)}window.addEventListener("beforeunload",P);const i=l.default.getPublishRequestBody({publishTitle:"",authorFull:"",isPublic:!0,removeBranding:!1});i.pgmGraph=o.encode();const a=u.getCurrentAnimationStyle();a?i.animationType=a.asString:v.error("[mp4 download] error, current animationStyle is null");const c=e,d=o.bounds.aspectRatio,h=d<1?c:Math.round(c/d),b=d<1?Math.round(c*d):c;i.renderOptions={videoHeight:h,videoWidth:b,scaleType:0},s.default.publish("download:mp4:send-pgm-request",{projectId:t});l.default.sendPgmPublishRequestForDownload(t,i,(e,t,r)=>{if("progress"===e){const e=m.$el.find("progress");e&&e.prop("value",t)}}).then(e=>{const o=e.downloadUrl,i=e.xRequestId;s.default.publish("download:mp4:received-download-url",{projectId:t,downloadUrl:o}),n.a.getAccessToken().then(e=>{fetch(o,{headers:{Authorization:"Bearer "+e,"X-Api-Key":g}}).then(F).then(e=>L(e,t,r,i)).catch(e=>{D(e,t,r)})})}).catch(e=>{m.hide(),D(e,t,r)})};t.a=function(e,t,r,o,n){f=e.currentDoc,u=r,g=t.cid,b=n,m=new d.a({id:"PostMP4DownloadModaloverlay",headerText:"i18n.dialogs.mp4DownloadModal.kHeaderText",contentText:'\n        <div class="mp4-download-modal-content">\n          <p>i18n.dialogs.mp4DownloadModal.kBodyText</p>\n          <progress id="render_progress" max="100" value="0" style="width:100%;"></progress>\n        </div>\n        ',dismissable:!0}),x(o)}}}]);
//# sourceMappingURL=theo-web-view_94b7f9b1-600a0ce7.js.map