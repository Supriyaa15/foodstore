(window.webpackJsonptheoWebApp=window.webpackJsonptheoWebApp||[]).push([[79,98],{"1geK":function(e,t,o){"use strict";o.r(t);var r=o("wHG3"),a=o("ApVh"),n=o.n(a),s=o("Uwho"),i=o.n(s),l=o("UFvF"),c=o.n(l),d=o("lulf"),u=o("MGCh"),p=o.n(u),h=o("65r0");function g(e,t,o){return t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}const{GraphTransportUtils:m}=r.PixiJSApp,f=new d.default,b=p.a.channel("web-animation-snapi");class y extends Error{constructor(...e){super(...e),g(this,"response",void 0)}}const S=new class{constructor(){g(this,"endpoint","https://"+i.a.postsnapi),g(this,"invocationMode","async"),f.loadFeatures().then(()=>{(f.featureEnabled("post-use-new-postsnapi-server")||Object(h.b)())&&(this.endpoint="https://"+i.a.postsnapi2,this.invocationMode="sync")})}getEtag(e){const t=`https://${i.a.ss}/assets/adobe-theo/${e}/manifest`,o=c.a.defer();return n.a.ajax({url:t,type:"GET",headers:{"x-api-key":i.a.key},success:(t,r,a)=>(b.debug(`snapi: get etag succeeded [projectId: ${e}]`),o.resolve(a.getResponseHeader("ETag"))),error:(t,r,a)=>(b.error(`snapi: error - fail to get etag, [projectId: ${e}], [message: ${r}], [error: ${a}], [response: ${JSON.stringify(t,null,2)}]`),o.reject(t))}),o.promise}pollUntilReady(e,t,o,r,a,s,l){if(!o){const t=new Error("called without full xhr");return b.error(`snapi: error - polling 1 [requestId: ${s}], [error:${t}]`),e.reject(t)}if(200===o.status){let n;if("object"==typeof t)n=t;else try{n=JSON.parse(t.replace(/^[^{]*/,""))}catch(t){return b.error(`snapi: error - polling 2 [requestId: ${s}], [error:${t}]`),e.reject(t)}if(n["error-response"]){const t=new y("poll returned error from server: "+JSON.stringify(n));return b.error(`snapi: error - polling 3 [requestId: ${s}], [error: ${t}]`),t.response=n,e.reject(t)}return r&&"function"==typeof l&&l("progress",100,a),n.xRequestId=o.getResponseHeader("x-request-id"),e.resolve(n)}if(202!==o.status){const t=new Error("unexpected status in poll "+o.status);return b.error(`snapi: error - polling 4 [requestId: ${s}], [status: ${o.status}], [error: ${t}]`),e.reject(t)}let d;if(t.href)d=t;else try{d=JSON.parse(t)}catch(t){return b.error(`snapi: error - polling 5 [requestId: ${s}], [error: ${t}]`),e.reject(t)}if(!d||!d.href){const t=new Error("publish failed: "+o.response);return b.error(`snapi: error - polling 6 [requestId: ${s}], [error: ${t}]`),e.reject(t)}const u=d.progress>0?d.progress:1;let p;try{p=o.getResponseHeader("retry-after"),isNaN(p)&&(p=5)}catch(e){p=5}p=1,r&&"function"==typeof l&&l("progress",u,a);const h=d.href,g=this;return c.a.delay(1e3*p).then(()=>{n.a.ajax({url:`${this.endpoint}/${h}`,type:"GET",headers:{"x-api-key":i.a.cid,"x-request-id":s},success(t,o,n){s!==n.getResponseHeader("x-request-id")&&b.warn(`snapi: warn - polling 7 [message: x-request-id mismatch] [expected:${s}, got:${n.getResponseHeader("x-request-id")}]`),b.debug(`snapi: polling... [requestId:${s}], [response: ${JSON.stringify(t,null,2)}]`),g.pollUntilReady(e,t,n,r,a,s,l)},error:(t,o,r)=>(b.error(`snapi: error - polling 8 [href: ${h}], [requestId: ${s}], [message: ${o}], [error: ${r}], [response:${JSON.stringify(t,null,2)}]`),e.reject(t))})}),e.promise}sendPgmPublishRequestImpl(e,t,o,r,a){const s=this;return this.getEtag(t).then(l=>{const d=c.a.defer();return n.a.ajax({type:"POST",url:e,dataType:"json",contentType:"application/json",headers:{"Content-Type":"application/json","x-project-etag":l,"x-api-key":i.a.cid},data:JSON.stringify(o),success(e,o,n){const i=n.getResponseHeader("x-request-id");b.debug(`snapi: about to poll [requestId:${i}], ${JSON.stringify(e,null,2)}`),a&&(a.value=i),s.pollUntilReady(d,e,n,!0,t,i,r)},error:(t,o,r)=>(b.error(`snapi: error - send pgm publish failed, response: ${JSON.stringify(t,null,2)}, message: ${o}, error: ${r}, snapiUrl: ${e}`),d.reject(t))}),d.promise})}validatePgmResourcesSection(e){if(!e.resources)throw new Error("Pgm graph missing resources section.");e.resources.forEach((e,t)=>{if(!t.storage||!t.storage.kind)throw new Error("Pgm resource missing storage data.");if(t.contentType&&t.contentType.startsWith("image")&&"content-literal"===t.storage.kind)throw new Error("Pgm has temporary image resource.")})}getPgmGraphForPublish(e){if(!e)throw new Error("coreWrapper is null.");e.generateKeyFrames();const t=e.getGraph(!0);if(t.duration<=0)throw b.warn("Zero PGM duration"),new Error("Animation duration is 0.");const o=m.convertAllLocalCompositeToExternalCC(t,e.documentId());return this.validatePgmResourcesSection(o),o}sendPgmPublishRequestForUpload(e,t,o,r,a){const n=`${this.endpoint}/project/${e}/pgmpublish?invocation_mode=${this.invocationMode}&partial=1&pubType=1&cpDest=${t}`;return this.sendPgmPublishRequestImpl(n,e,o,a,r)}sendPgmPublishRequestForDownload(e,t,o){const r=`${this.endpoint}/project/${e}/pgmpublish?invocation_mode=${this.invocationMode}&partial=3&pubType=1`;return this.sendPgmPublishRequestImpl(r,e,t,o,null)}getPublishRequestBody(e){const t=e.publishTitle||"",o=e.authorFull||"",r=!e.isPublic;return{metadata:{title:t,custom:{author:o,sub_title:"",removeBranding:!!e.removeBranding},sub_category_ids:["other"],category_id:"theos",undiscoverable:r},update:!1,options:{withoutBranding:!!e.removeBranding}}}};t.default=S},"2PxR":function(e,t,o){"use strict";o.r(t),o.d(t,"IMAGE_SOURCES",(function(){return l})),o.d(t,"getImageMediaMetadata",(function(){return c}));var r=o("UzQk"),a=o.n(r);function n(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,r)}return o}function s(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?n(Object(o),!0).forEach((function(t){i(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):n(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}function i(e,t,o){return t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}let l;function c(e,t=!1){let o={};if(e){let t="unknown",r="unknown";const a={};e.source&&e.source.name&&(e.source.name===l.STOCK?t="adobestock":e.source.name===l.UNSPLASH||e.source.name===l.PIXABAY||e.source.name===l.NOUN?t="dooplo":e.source.name===l.CCL?t="ccl":e.source.name===l.CCLIGHTDESIGNASSETS&&(t="cclight"),e.source.name===l.NOUN?r=e.id:e.source.name===l.CCL?r=e.assetID:e.image_id?r=e.image_id.toString():e.id&&(r=e.id),e.source.name===l.CCL?a.ccl={created_date:e.created_date,modified_date:e.modified_date,library_id:e.albumId,library_name:e.albumName}:e.source.name===l.CCLIGHTDESIGNASSETS&&(a.cclight={search_props:e.searchProps,created_date:e.created_date,modified_date:e.modified_date,design_intent:e.design_intent})),o={source:t,search:e.searchText,rootProperties:s({license:{asset_id:r,owner:e.owner?e.owner.name:"unknown",photo_name:e.title,source_name:e.source?e.source.name:"unknown",source_url:e.context?e.context.href:"unknown",tags:e.tags instanceof Array?e.tags.join(","):"",type:e.license?e.license.short_name:"unknown"}},a)}}const r=a.a.MediaMetadata.fromProperties(o);return r&&t&&(r.designIntent=a.a.MediaMetadata.DESIGNINTENT_LOGO),r}!function(e){e.STOCK="Adobe Stock",e.UNSPLASH="Unsplash",e.PIXABAY="pixabay",e.NOUN="The Noun Project",e.CCL="Creative Cloud Libraries",e.CCLIGHTDESIGNASSETS="CC Light Design Assets"}(l||(l={}))},"5d+0":function(e,t,o){"use strict";o.r(t),o.d(t,"ShortcutConstants",(function(){return r}));const r={kConfirmText:"confirmText",kRotation:"rotation",kSendForward:"sendForward",kSendToFront:"sendToFront",kSendBackward:"sendBackward",kSendToBack:"sendToBack",kDuplication:"duplication",kGroup:"group",kUngroup:"ungroup",kNudge:"nudge",kMarqueeSelect:"marqueeSelect",kMultiselect:"multiselect",kDeselectAll:"deselectAll",kSelectAll:"selectAll",kRedo:"redo",kUndo:"undo",kExitSpecialSelectionMode:"exitSpecialSelectionMode",kSelectSibling:"selectSibling",kSelectParent:"selectParent",kSelectChild:"selectChild",kActualSize:"actualSize",kFitToView:"fitToView",kFillToView:"fillToView",kZoomOut:"zoomOut",kZoomIn:"zoomIn",kPanView:"panView",kPanKey:"panKey",kZoomInKey:"zoomInKey",kZoomOutKey:"zoomOutKey"}},"65r0":function(e,t,o){"use strict";o.d(t,"b",(function(){return n}));var r=o("ApVh"),a=o.n(r);function n(){const e=a.a.getUserEmail();return/@adobe(test)?.com$/gi.test(e)}t.a=n},"8DU0":function(e,t,o){"use strict";o.r(t),o.d(t,"default",(function(){return s}));var r=o("ApVh"),a=o.n(r);function n(e,t,o){return t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}class s{static getSetting(e){return new Promise((t,o)=>{s.hasSetting(e)?t(s.settings[e]):s.getSettings().then(o=>{s.settings=o,t(s.settings[e])}).catch(e=>{o(e)})})}static setSetting(e,t){return e?void 0===t?Promise.reject(new Error("UserSettings: cannot set setting to an undefined value")):(s.settings[e]=t,new Promise((o,r)=>{a.a.getAccessToken().then(a=>{const n=s.apiEndPoint+encodeURIComponent(e),i={headers:{Authorization:"Bearer "+a,"Content-Type":"application/json;charset=UTF-8"},method:"PUT",body:JSON.stringify({value:t})};fetch(n,i).then(t=>{t.ok?o(t):r(new Error(`UserSettings: Error trying to set key=${e}: [${t.status}] ${t.statusText}`))}).catch(r)})})):Promise.reject(new Error("UserSettings: cannot set an undefined key"))}static hasSetting(e){return void 0!==s.settings[e]}static getSettings(){return s.getSettingsPromise&&s.promiseResolved||(s.getSettingsPromise=new Promise((e,t)=>{a.a.getAccessToken().then(o=>{const r={headers:{Authorization:"Bearer "+o}};fetch(s.apiEndPoint,r).then(o=>{if(o.ok)e(o.json()),s.promiseResolved=!0;else{const e=new Error(`UserSettings: Error trying to get settings: [${o.status}] ${o.statusText}`);t(e)}}).catch(e=>{t(e)})})})),s.getSettingsPromise}}n(s,"apiEndPoint","/api/post/v1/usersettings/"),n(s,"getSettingsPromise",void 0),n(s,"settings",{}),n(s,"promiseResolved",!1)},"8Jtx":function(e,t,o){"use strict";async function r(e,t){let o=null;const r=new Promise((e,r)=>{o=setTimeout(()=>{r(new Error(`Request timed out after ${t} ms.`))},t)});try{return await Promise.race([e,r])}finally{o&&clearTimeout(o)}}o.r(t),o.d(t,"resolvePromiseOrTimeout",(function(){return r})),t.default=r},"9SnX":function(e,t,o){var r,a;r=[o("ApVh"),o("xeH2"),o("UFvF"),o("Uwho"),o("MGCh"),o("Pbp+"),o("lulf"),o("bBG2")],void 0===(a=function(e,t,o,r,a,n,s,i){const l=i.default;var c={},d=a.channel("design-variations");return c.getVariations=function(a,n){return function(a){const n=o.defer(),s=performance.now();return e.getAccessToken().then(e=>{t.ajax({type:"POST",url:r.designVariationsServiceV2Endpoint+"/suggestions",contentType:"application/json",data:JSON.stringify(a.metadata),dataType:"json",headers:{Authorization:"Bearer "+e,"x-api-key":r.cid}}).fail((function(e,t){d.error("Failed to fetch response from Design Variations Service V2"),n.reject(t)})).done((function(e){const t=performance.now()-s;d.info("Design Variations Service V2 response in: "+t),l.publish("designVariationsServiceV2Used",{contextualData1:t}),n.resolve(e)}))}),n.promise}(a)},c}.apply(t,r))||(e.exports=a)},Dcjk:function(e,t,o){var r;void 0===(r=function(){var e=window.navigator.userAgent;return e.indexOf("Trident/")>0?11:e.indexOf("MSIE ")>0?10:e.indexOf("Edge/")>0&&12}.apply(t,[]))||(e.exports=r)},Dvuo:function(e,t,o){var r,a;r=[o("3xm6"),o("UzQk")],void 0===(a=function(e,t){var o={numberStringForValue:function(e,o){const r=t.PageFacade.getNumDecimalPlacesForUnits(o);return t.Host.locale.formatNumber(e,r)},getUnitsOptionString:function(){for(var e=[],r=t.PageExportFormat.PIXELS;r<=t.PageExportFormat.INCHES;r++)e.push(o.getUnitsStringForFormat(r));var a="";return e.forEach((function(e){a+="<option>"+e+"</option>"})),a},getUnitsStringForFormat:function(o){var r;switch(o){case t.PageExportFormat.PIXELS:r=e.translate("forms.custom-size.kPixelsAbbr");break;case t.PageExportFormat.MILLIMETERS:r=e.translate("forms.custom-size.kMillimetersAbbr");break;case t.PageExportFormat.INCHES:r=e.translate("forms.custom-size.kInchesAbbr");break;default:log.assert(!1,"invalid units format: "+o),r="px"}return r},currentUnitToPixels:function(e,o,r,a){var n=t.PageFacade.unitsToPixelsFactor(r,a);return new t.TheoSize(e*n,o*n)},pixelsToCurrentUnit:function(e,o,r,a){var n=t.PageFacade.unitsToPixelsFactor(r,a);return new t.TheoSize(e/n,o/n)}};return o}.apply(t,r))||(e.exports=a)},EUgP:function(e,t,o){"use strict";o.d(t,"a",(function(){return O}));var r=o("KpqY"),a=o("qcxC"),n=o("MOGj"),s=o.n(n);async function i(e,t,o,r){const n=Object(a.default)();return s.a.AdobeDCXCompositeXfer.uploadComponent(e,t,o,r,async(t,r)=>{if(t)throw t;o.current.updateComponentWithUploadResults(e,r),n.resolve(o)}),n.promise}async function l(e,t,o,r,n,i,l,c){const d=Object(a.default)();return s.a.AdobeDCXCompositeXfer.uploadNewComponent(t,o,l,e,c,async(e,t)=>{if(e)throw e;l.current.addComponentWithUploadResults(r,n,i,l.current.rootNode,t),d.resolve(l)}),d.promise}var c=o("j5+N"),d=o.n(c),u=o("UzQk"),p=o.n(u),h=o("uTW7"),g=o("14LO"),m=o("3xm6"),f=o.n(m),b=o("MGCh"),y=o.n(b),S=o("ApVh"),v=o.n(S),C=o("Uwho"),w=o.n(C),P=o("tY4j"),k=o.n(P),T=o("1geK"),x=o("2ofD"),I=o.n(x);let A;!function(e){e[e.FAILED=0]="FAILED",e[e.IN_PROGRESS=1]="IN_PROGRESS",e[e.PASSED=2]="PASSED"}(A||(A={}));const F=["Other"],E=window.location.protocol,D=window.location.host.includes("local.adobeprojectm.com")?E+"//dev.adobeprojectm.com":`${E}//${window.location.host}`;function R(e,t,o){return t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}const L=y.a.channel("modules:util:cp-publisher");class O{constructor(e){R(this,"apiKey",void 0),R(this,"communitySession",void 0),R(this,"coreWrapper",void 0),R(this,"currentJob",void 0),R(this,"waitForQuietSaveToFinish",void 0),R(this,"getDocumentRendition",void 0),R(this,"storageSession",void 0),this.currentJob={progress:{localCompositeCreated:!1,localCompositeBound:!1,localCompositeTransformed:!1,compositeCopyPushed:!1,compositePublished:!1,sourceDocumentUpdatedWithPublishData:!1,remixURLCreated:!1,publishedCompositeUpdated:!1}},this.apiKey=w.a.key,this.coreWrapper=e.coreWrapper,this.waitForQuietSaveToFinish=e.waitForQuietSaveToFinish,this.getDocumentRendition=e.getDocumentRendition,this.storageSession=s.a.dcxSession,this.communitySession=s.a.dcx.createCommunitySession(s.a.dcxService,`${E}//${w.a.cps}`)}async publishDoc(e){const{associatedCategories:t,categories:o,keyTerms:r,language:a,title:n,task:i}=e;if(this.currentJob.status=A.IN_PROGRESS,I.a.currentDoc.isPublished()){L.error("[publishDoc] Republishing currently not supported.");const e=A.FAILED;return this.currentJob.status=e,this.resetPublisher(),Promise.reject({status:e,errorMessage:f.a.translate("app.templatePublisher.templateRepublishFailure.kContentText")})}const l="/pubs/"+s.a.AdobeDCXUtil.generateUuid();this.currentJob.compositeCopy=await this.copyAndTransformComposite(I.a.currentDoc.getDCXComposite(),l),this.currentJob.alias=await this.reserveAliasWithRetry();const c=this.getRemixData(),d=this.getPublicationRecord(t,o,this.currentJob.compositeCopy,r,a,l,n,i),u=this.getMachineTags(t),p=await this.publishComposite(d,c,u);return this.resetPublisher(),p}async copyAndTransformComposite(e,t){const o=this.copyComposite(e);this.currentJob.progress.localCompositeCreated=!0;const r=await this.createCompositeCopy(o,t);this.currentJob.progress.localCompositeBound=!0;const a=await this.transformCompositeBeforePublish(r);this.currentJob.progress.localCompositeTransformed=!0;const n=await this.pushCompositeCopy(a);return this.currentJob.progress.compositeCopyPushed=!0,n}copyComposite(e){return s.a.AdobeDCXComposite.newCompositeAsCopyOf(e,e.current.name,e.current.type)}async createCompositeCopy(e,t){try{return await async function(e,t,o,r){const n=Object(a.default)();return s.a.AdobeDCXCompositeXfer.createComposite(e,t,o,r,async(t,o)=>{if(t)throw t;n.resolve(e)}),n.promise}(e,t,!1,this.storageSession)}catch(e){L.error("[createCompositeCopy] Unable to create composite copy.",e);const t=A.FAILED;return this.currentJob.status=t,await this.handleFailure(),Promise.reject({status:t,errorMessage:f.a.translate("app.templatePublisher.templatePublishFailure.contentText.kCreateCompositeCopyFailure")})}}async transformCompositeBeforePublish(e){const t=await this.setUsageReportedFlagsToFalse(e),o=this.getComponentIdForPreview(t)?t:await this.addPreviewImageToComposite(t),r=this.coreWrapper.hasAnimationStyle()?await this.addVideoRenditionToComposite(o):o;return await this.clearCompositeCopyPublishData(r)}async setUsageReportedFlagsToFalse(e){if(!this.coreWrapper.hasReportedIcons())return e;const t=new g.DCXDocumentComposite({composite:e}),o=t.current;if(o&&p.a.DocumentPersistenceFactory.usesJsonDocumentEncoding(o)){const t=p.a.JSONDocumentDecoder.getRequiredSynchronousComponents(o);await Promise.all(t.map(async t=>{const r=await s.a.getComponent(t,e),a=JSON.parse(r);o.registerContentForComponent(t,a)}))}const a=p.a.TheoDocument.decodeDocument(t,e=>{throw o.releaseRegisteredContent(),e});try{o&&o.releaseRegisteredContent(),a.history.postEntry("open,src=CC,was-vers="+a.versionDecoded.rawValue);const e=r.default.beginTransaction(a,"updatePublishData");a.content.root.visitAll(e=>{e instanceof p.a.VectorContentNode&&e.isUsageReported()&&e.setUsageReported(!1)}),r.default.endTransaction(e,!0);const n=new h.DCXDocumentBranch({branch:t.dcxComposite.current}),s=p.a.DocumentPersistenceFactory.encoderFor(n);a.encode(s),s.finish();const l=n.getDeferredComponents().find(e=>"dom"===e.relationship);if(!l)throw new Error("[setUsageReportedFlagsToFalse] Failed to find deferred DOM Component.");const c=l.content,d=t.dcxComposite,u=d.current.getComponentWithId(l.componentId);if(!u)throw new Error(`[setUsageReportedFlagsToFalse] Failed to find DOM Component with id: ${l.componentId}.`);return await i(u,JSON.stringify(c),d,this.storageSession)}catch(e){L.error("[setUsageReportedFlagsToFalse] Failed to update usage reported to no where applicable.",e);const t=A.FAILED;return this.currentJob.status=t,await this.handleFailure(),Promise.reject({status:t,errorMessage:f.a.translate("app.templatePublisher.templatePublishFailure.contentText.kUpdateUsageReportedFailure")})}}getComponentIdForPreview(e){let t;const o=this.getPreviewComponent(e);return o?t=o.id:e.current.getComponentWithId("preview")&&(t="preview"),t}getPreviewComponent(e){var t,o;const r=null!==(t=e.current)&&void 0!==t?t:{},a=(null!==(o=r.rootNode)&&void 0!==o?o:{}).absolutePath,n=a&&"/"!==a?a+"/preview.jpg":"/preview.jpg";return r.getComponentWithAbsolutePath(n)}async addPreviewImageToComposite(e){try{const t=1200,o=.94,r=await this.getDocumentRendition({imageQuality:o,width:t});if(!r)throw new Error("[addPreviewImageToComposite] Failed to generate preview rendition.");const a=s.a.AdobeDCXUtil.generateUuid();return await l(a,r,"image/jpeg","preview.jpg","rendition","preview.jpg",e,this.storageSession)}catch(e){L.error("[addPreviewImageToComposite] Failed to upload preview rendition component.",e);const t=A.FAILED;return this.currentJob.status=t,await this.handleFailure(),Promise.reject({status:t,errorMessage:f.a.translate("app.templatePublisher.templatePublishFailure.contentText.kAddPreviewRenditionFailure")})}}async addVideoRenditionToComposite(e){const t=await this.downloadVideoRendition(),o=await this.addOrUpdateVideoRendition(e,t.fileBlob),r=o.current.getComponentWithId("videoRendition");return await this.setVideoRenditionMetadata(o,r,t)}async downloadVideoRendition(){const e=this.coreWrapper.getDocument().id;let t=null;try{t=T.default.getPgmGraphForPublish(this.coreWrapper)}catch(t){L.error(`[downloadVideoRendition] PGM Graph Error for documentId:${e} = ${t}`);const o=A.FAILED;return this.currentJob.status=o,await this.handleFailure(),Promise.reject({status:o,errorMessage:f.a.translate("app.templatePublisher.templatePublishFailure.contentText.kDownloadVideoRenditionFailure")})}const o=T.default.getPublishRequestBody({publishTitle:"",authorFull:"",isPublic:!0,removeBranding:!1});o.pgmGraph=t.encode();const r=this.coreWrapper.getCurrentAnimationStyle();r?o.animationType=r.asString:L.error("[mp4 download] error, current animationStyle is null");const a=t.bounds.aspectRatio,n=a<1?1280:Math.round(1280/a),s=a<1?Math.round(1280*a):1280;o.renderOptions={videoHeight:n,videoWidth:s,scaleType:0};const i=(await T.default.sendPgmPublishRequestForDownload(e,o,(e,t,o)=>{"progress"===e&&100===t&&L.info("Video rendition download completed.")})).downloadUrl,l=await v.a.getAccessToken(),c={headers:{"X-Api-Key":this.apiKey,Authorization:"Bearer "+l}};return fetch(i,c).then(e=>{if(!e.ok)throw new Error(`[downloadVideoRendition] Failed to download video at URL:${i}. [${e.status}] ${e.statusText}`);return e.blob()}).then(e=>Promise.resolve({fileBlob:e,videoHeight:n,videoWidth:s})).catch(async e=>{L.error(`[downloadVideoRendition] Failed to download video at URL:${i}. Error: ${e.message}`);const t=A.FAILED;return this.currentJob.status=t,await this.handleFailure(),Promise.reject({status:t,errorMessage:f.a.translate("app.templatePublisher.templatePublishFailure.contentText.kDownloadVideoRenditionFailure")})})}async addOrUpdateVideoRendition(e,t){const o=e.current.getComponentWithId("videoRendition");try{let r;return r=o?await i(o,t,e,this.storageSession):await l("videoRendition",t,"video/mp4","videoRendition","rendition","videoRendition.mp4",e,this.storageSession),r}catch(e){L.error("[addOrUpdateVideoRendition] Failed to add or update video rendition component.",e);const t=o?"app.templatePublisher.templatePublishFailure.contentText.kUpdateVideoRenditionFailure":"app.templatePublisher.templatePublishFailure.contentText.kCreateVideoRenditionFailure",r=A.FAILED;return this.currentJob.status=r,await this.handleFailure(),Promise.reject({status:r,errorMessage:f.a.translate(t)})}}async setVideoRenditionMetadata(e,t,o){try{const{fileBlob:r,videoHeight:a,videoWidth:n}=o;t.width=n,t.height=a,t.name="videoRendition";return await i(t,r,e,this.storageSession)}catch(e){L.error("[setVideoRenditionMetadata] Failed to update video rendition component with video metadata.",e);const t=A.FAILED;return this.currentJob.status=t,await this.handleFailure(),Promise.reject({status:t,errorMessage:f.a.translate("app.templatePublisher.templatePublishFailure.contentText.kAddVideoRenditionMetadataFailure")})}}async clearCompositeCopyPublishData(e){return e.current.rootNode.removeValue("cp#projectId"),e.current.rootNode.removeValue("cp#shortId"),e.current.rootNode.removeValue("cp#assetId"),e.current.rootNode.removeValue("cp#publishedEtag"),e.current.rootNode.removeValue("theo#cp-discoverable"),e}async pushCompositeCopy(e){try{return await async function(e,t,o){const r=Object(a.default)();return s.a.AdobeDCXCompositeXfer.pushComposite(e,t,o,async(t,o)=>{if(t)throw t;r.resolve(e)}),r.promise}(e,!1,this.storageSession)}catch(e){L.error("[pushCompositeCopy] Unable to push composite copy.",e);const t=A.FAILED;return this.currentJob.status=t,await this.handleFailure(),Promise.reject({status:t,errorMessage:f.a.translate("app.templatePublisher.templatePublishFailure.contentText.kPushCompositeCopyFailure")})}}async reserveAliasWithRetry(){const e=k()(this.reserveAlias.bind(this),{maxAttempts:3});try{return await e()}catch(e){const t=A.FAILED;return this.currentJob.status=t,await this.handleFailure(),Promise.reject({status:t,errorMessage:f.a.translate("app.templatePublisher.templatePublishFailure.contentText.kReserveAliasFailure")})}}async reserveAlias(){const e=`${E}//${w.a.cps}/api/v2/theo/alias/`,t=await v.a.getAccessToken(),o={headers:{"X-Api-Key":this.apiKey,Authorization:"Bearer "+t},method:"POST"};return fetch(e,o).then(e=>{if(!e.ok)throw new Error(`[reserveAlias] Error reserving alias: [${e.status}] ${e.statusText}`);return e.json()}).then(e=>e.alias).catch(e=>{L.error("[reserveAlias] Unable to fetch published template to perform updates. Error: "+e.message,e);const t=new Error("[reserveAlias] "+e.message);return Promise.reject(t)})}getRemixData(){const e=s.a.dcx.createRemixData();return e.originURL=`${E}//${w.a.cps}/api/v2/theo/assets/${this.currentJob.alias}`,e.licenseType="by-nc",e}getPublicationRecord(e,t,o,r,a,n,i,l){var c;const d=this.getMetadata(o),u=this.getTags(e,t,r,a,l),p=null!==(c=this.coreWrapper.getCurrentDocumentDescription())&&void 0!==c?c:"",h=s.a.dcx.createCommunityPublicationRecord();return h.communityId="theo",h.title=i,h.description=p,h.alias=this.currentJob.alias,h.discoverable=!0,h.tags=u,h.categoryId="Theos",h.subCategoryIds=F,h.custom=d,h.resourcePath=n,h.artworkComponentId=this.getComponentIdForPreview(o),h}getMetadata(e){var t,o;const r={remixable:!0,creator:"theo",documentFormatVersion:p.a.TheoDocument.CURRENT_VERSION,sparkTemplate:!0,publishOrigin:"web"},a=(null!==(t=this.getPreviewComponent(e))&&void 0!==t?t:{}).etag;a&&(r.contentEtag=a);const n=null!==(o=window.adobeIMS.getUserProfile().displayName)&&void 0!==o?o:f.a.translate("app.templatePublisher.kAccountUnknownLabel");return r.author=n,r}getTags(e,t,o,r,a){const n=[];return e.forEach(e=>{"remixpaid"!==e&&"remixanimation"!==e&&"remixpending"!==e||n.push(e)}),t.forEach(e=>{n.push("explore-"+e)}),o.forEach(e=>{n.push("spterm-"+e)}),n.push("sploc-"+r),n.push("spcase-"+a),n}getMachineTags(e){const t=["remixable"];return e.includes("remixpending")&&t.push("remixpending"),t}async publishComposite(e,t,o){const r=Object(a.deferred)();try{return s.a.AdobeCommunityPlatform.publishCompositeAlreadyPushedToPubs(this.currentJob.compositeCopy,e,t,"theo",this.communitySession,async(t,a)=>{if(t)throw t;{this.currentJob.progress.compositePublished=!0;const t=await this.publishSuccessHandler(o,e.tags);r.resolve(t)}}),r.promise}catch(e){return this.publishFailureHandler(e)}}async publishSuccessHandler(e,t){let o;if(!this.currentJob.alias||!this.currentJob.compositeCopy)return L.error("[publishSuccessHandler] alias and/or compositeCopy is undefined"),o=A.FAILED,this.currentJob.status=o,await this.handleFailure(),Promise.reject({status:o,errorMessage:f.a.translate("app.templatePublisher.templatePublishFailure.contentText.kPublishFailure")});const r=await this.fetchAssetWithRetry(this.currentJob.alias),a=await this.generateBranchURLString(r),n=a&&""!==a?a:this.getURLforPost(this.currentJob.alias,!0);return this.currentJob.progress.remixURLCreated=!0,await this.updateAssetWithRetry(r,a,e,t),this.currentJob.progress.publishedCompositeUpdated=!0,await this.updateCompositeWithPublishData(this.currentJob.compositeCopy,r),this.currentJob.progress.sourceDocumentUpdatedWithPublishData=!0,o=A.PASSED,this.currentJob.status=o,Promise.resolve({status:o,remixURL:n})}async fetchAssetWithRetry(e){const t=k()(this.fetchAsset.bind(this),{maxAttempts:3});try{return await t(e)}catch(e){const t=A.FAILED;return this.currentJob.status=t,await this.handleFailure(),Promise.reject({status:t,errorMessage:f.a.translate("app.templatePublisher.templatePublishFailure.contentText.kFetchAssetFailure")})}}async fetchAsset(e){const t=`${E}//${w.a.cps}/api/v2/theo/assets/${e}`,o=await v.a.getAccessToken(),r={headers:{"X-Api-Key":this.apiKey,Authorization:"Bearer "+o},method:"GET"};return fetch(t,r).then(e=>{if(!e.ok)throw new Error(`[fetchAsset] Error fetching published template: [${e.status}] ${e.statusText}`);return e.json()}).catch(t=>{L.error("[fetchAsset] Unable to fetch published template to perform updates. Error: "+t.message,t);const o=new Error(`[fetchAsset] ${t.message} for ${e}`);return Promise.reject(o)})}async generateBranchURLString(e){const t=`${D}/sp/design-remix/post/${e.alias}`,o=e._links.rendition.href.replace("{format}","jpg").replace("{dimension}","width").replace("{size}","1200"),r={campaign:"seodefaulttask",channel:"seolandingpagetemplates",feature:"userGeneratedRemixablePostFeature",data:{$marketing_title:"seoautogenerated",$desktop_url:t,remixable_post_cpid:e.alias,$og_title:f.a.translate("app.templatePublisher.branchIOData.kBranchIODescription"),$og_description:f.a.translate("app.templatePublisher.branchIOData.kBranchIOTitle"),$canonical_url:t,$canonical_identifier:t}};return o&&(r.data.$og_image_url=o),d.a.link(r).catch(t=>(L.error(`[generateBranchURLString] Failed to generate branchURL for ${e.alias}. Error: ${t.message}`,t),Promise.resolve("")))}getURLforPost(e,t){let o="";if(t){const e=new Date("2001-01-01T00:00:00.000Z");o="?w="+10*((new Date).getTime()-e.getTime())}return`${D}/post/${e}${o}`}async updateAssetWithRetry(e,t,o,r){const a=k()(this.updateAsset.bind(this),{maxAttempts:3});try{return await a(e,t,o,r)}catch(e){const t=A.FAILED;return this.currentJob.status=t,await this.handleFailure(),Promise.reject({status:t,errorMessage:f.a.translate("app.templatePublisher.templatePublishFailure.contentText.kUpdateAssetFailure")})}}async updateAsset(e,t,o,r){const{alias:a,custom:n}=e,s=`${E}//${w.a.cps}/api/v2/theo/assets/${a}`,i=await v.a.getAccessToken();t&&""!==t&&(n.branchURL=t);const l={custom:n,tags:r,machine_tags:o,sub_category_ids:F},c={body:JSON.stringify(l),headers:{"X-Api-Key":this.apiKey,"Content-Type":"application/json",Authorization:"Bearer "+i},method:"PUT"};return fetch(s,c).then(e=>{if(!e.ok)throw new Error(`[updateAsset] Error updating published template: [${e.status}] ${e.statusText}`)}).catch(e=>{L.error("[updateAsset] Unable to update published template with branch URL and other metadata. Error: "+e.message,e);const t=new Error(`[updateAsset] ${e.message} for ${a}`);return Promise.reject(t)})}async updateCompositeWithPublishData(e,t){var o;const r=t.resource_path,a=t.id,n=t.alias,s=(null!==(o=this.getPreviewComponent(e))&&void 0!==o?o:{}).etag||"";this.coreWrapper.updatePublishData({cPProjectID:r,cPAlias:n,cPAssetID:a,cPublishedEtag:s}),I.a.currentDoc.saveChanges(e=>{e.setValue("cp#projectId",r),e.setValue("cp#shortId",n),e.setValue("cp#assetId",a),e.setValue("cp#publishedEtag",s)}),await this.waitForQuietSaveToFinish()}async publishFailureHandler(e){L.error("[publishFailureHandler] Unable to publish template to the Community Platform.",e);const t=A.FAILED;return this.currentJob.status=t,await this.handleFailure(),Promise.reject({status:t,errorMessage:f.a.translate("app.templatePublisher.templatePublishFailure.contentText.kPublishFailure")})}async deleteAssetWithRetry(){if(!this.currentJob.alias){L.error("[deleteAssetWithRetry] Failed to delete published asset after error was thrown copy - alias is undefined");const e=new Error("[deleteAssetWithRetry] Failed to delete published asset after error was thrown copy - alias is undefined");return Promise.reject(e)}const e=k()(this.deleteAsset.bind(this),{maxAttempts:3});return await e(this.currentJob.alias)}async deleteAsset(e){const t=`${E}//${w.a.cps}/api/v2/theo/assets/${e}`,o=await v.a.getAccessToken(),r={headers:{"X-Api-Key":this.apiKey,Authorization:"Bearer "+o},method:"DELETE"};return fetch(t,r).then(e=>{if(!e.ok)throw new Error(`[deleteAsset] Error deleting published template: [${e.status}] ${e.statusText}`)}).catch(t=>{L.error(`[deleteAsset] Failed to delete published template.Please delete manually remove template with ${e}. Error: ${t.message}`,t);const o=new Error(`[deleteAsset] ${t.message} for ${e}`);return Promise.reject(o)})}async handleFailure(){var e;const{progress:t}=null!==(e=this.currentJob)&&void 0!==e?e:{};if(t)try{const{compositeCopyPushed:e,compositePublished:o}=t;e&&await this.deletePushedCompositeCopy(),o&&await this.deleteAssetWithRetry()}catch(e){L.error("[handleFailure] Cleanup task failed.",e)}this.resetPublisher()}async deletePushedCompositeCopy(){if(!this.currentJob.compositeCopy)throw L.error("[deletePushedCompositeCopy] Failed to delete composite copy. `this.currentJob.compositeCopy` is undefined"),new Error("[deletePushedCompositeCopy] Failed to delete composite copy. `this.currentJob.compositeCopy` is undefined");const e=Object(a.deferred)();this.storageSession.deleteComposite(this.currentJob.compositeCopy,t=>{t?(L.error("[deletePushedCompositeCopy] Unable to delete composite copy.",t),e.reject(t)):e.resolve()}),await e.promise}resetPublisher(){this.currentJob={alias:void 0,compositeCopy:void 0,progress:{localCompositeCreated:!1,localCompositeBound:!1,localCompositeTransformed:!1,compositeCopyPushed:!1,compositePublished:!1,remixURLCreated:!1,publishedCompositeUpdated:!1,sourceDocumentUpdatedWithPublishData:!1}}}}},EbV1:function(e,t,o){"use strict";o.r(t),o.d(t,"default",(function(){return V}));var r=o("UzQk"),a=o("3xm6"),n=o.n(a),s=o("9KYx"),i=o("f5T3"),l=o("YLtl");const c=window.THEO_BUNDLE_PATH,d=[{id:"2",name:"row",backing:r.LockupBacking.Rows,artworkID:"none"},{id:"9",name:"banner",backing:r.LockupBacking.BannerHorizontal,artworkID:"none"},{id:"11",name:"knockout",backing:r.LockupBacking.Knockout,artworkID:"none"}],u={title:n.a.translate("app.textPanel.title"),ctaText:n.a.translate("app.helpModal.kCtaText"),ctaLink:"https://adobespark.zendesk.com/hc/en-us/categories/202688167-Adobe-Spark",assetUrl:`https://${window.location.host}/images/help-videos/edit_text.gif`,placement:"bottom-left",id:"editText"};function p(e,t,o){const a=e.map(e=>r.Host.locale.formatNumber(e,1));return Object(l.uniq)(a).map(e=>({emphasized:t,value:e,id:`${o}${e}`,separatorBefore:!1}))}function h(e,t,o,a){const l=e.controller,h=l.styleController,g=h.targetedLockupStyle,m="Highlight"===h.targetedLockupStyleName,f=r.LockupStyle.isPath(e.style.layout),b=r.LockupStyle.isLetterGrid(e.style.layout),y=h.targetedTextLook;let S=t.getUserFontSizeOfSelectedForma();S=isNaN(S)?0:S,S=r.Host.locale.formatNumber(S,1);const v=function(e,t){const o=[];for(const a of d){const n="banner"===a.name,s="knockout"===a.name,i=!e;t&&!r.ShapeLibrary.isBackingShapeStyleCompatible(t,a.backing,null)||(e&&(n||s&&!i)||o.push(a))}const a=r.ShapeLibrary.displayOrderForCategories();for(let s=0;s<a.length;s++){const i=a[s];if(e&&"SOCIAL"===i)continue;const l=t?t.layout:r.LockupLayout.Standard,c=t&&t.pathID,d=r.ShapeLibrary.displayOrderForCompatibleShapeIDs(i,l,c,e,!0);for(var n=0;n<d.length;n++)o.push({id:d[n],name:d[n],backing:r.LockupBacking.SVGBackground,artworkID:d[n]})}return o.map(e=>e.backing===r.LockupBacking.SVGBackground?{id:e.id,url:`${c}/images/images/shapes/icon/${e.id}.svg`,backing:e.backing,artworkID:e.artworkID}:{id:e.id,url:`${c}/images/images/shapes/icon/backing_icon_${e.name}.png`,backing:e.backing,artworkID:e.artworkID})}(t.inCharStyleMode,e.style);let C=t.getShapeOfSelectedLockup();b&&m&&-1===C&&(C=t.getShapeOfSelectedLockup(null,!0));const w=(!m||!f)&&(0!==C&&-1!==C),P=l.getCharacterStyleRanges().length>0||t.inCharStyleMode,k=!t.isSpacingAvailableForSelectedLockup(),T=t.inCharStyleMode;let x=p(t.getUserFontSizesInDocument(),!0,"doc");const I=p(r.TextFacade.getStandardFontSizes(),!1,"std");I.length&&(I[0].separatorBefore=!0),x=x.concat(I);const A=r.LockupStyle.isShadowLook(y),F=r.LockupStyle.isOutlineLook(y),E=r.LockupStyle.isKnockoutLook(y),D=r.LockupStyle.isOutlineWithTransparentTextLook(y),R=function(e,t,o){const r={};return t||(r.textColor={color:e.colors.fieldPrimary.hex}),o&&(r.effectsColor={color:e.colors.fieldSecondary.hex}),r.borderColor={color:e.colors.border.hex},r.shadowColor={color:e.colors.shadow.hex},r}(g,E||D,w),{disableKnockout:L,disableOutlineWithTransparentText:O,disableShadow:M,disableOutline:U}=function(e,t,o,a,n,s){let i=!1,l=!1;if(o&&(l=!0),a&&(i=!0),!i){const e=s.find(e=>{const t=parseInt(e.id,10);return isNaN(t)?e.id===n:t===n}),t=e?r.ShapeLibrary.shapeDictionary[Object(r.getBackingStringForBackingEnumAndArtworkId)(e.backing,e.artworkID)]:null;i=!(null==t?void 0:t.filled)}return{disableKnockout:i,disableOutlineWithTransparentText:l,disableShadow:!1,disableOutline:!1}}(0,0,E,D,C,v),{disableShape:B,disableShapePicker:j,disableAllAlignments:N,currentAlignment:$}=function(e,t){const o=e.getLockupLayouts(),a=e.getLockupAlignments(),n=e.getSelectedForma().style,s=n.layout;let l=!1,c=!1,d=-1;switch(s){case r.LockupLayout.FitJustified:d=i.a.capitalizeAndFit;break;case o.Standard:case o.LetterGrid:switch(e.getAlignmentOfSelectedLockup()){case a.Center:d=s===o.Standard?i.a.center:i.a.gridCenter;break;case a.Right:d=s===o.Standard?i.a.right:i.a.gridRight;break;default:d=s===o.Standard?i.a.left:i.a.gridLeft}break;case o.Path:l=t,c=t;const u=n.pathID,p=e.getTextPathIDs();switch(u){case p.Circle:d=i.a.circle;break;case p.SemiCircleUp:d=i.a.semicircle;break;case p.SemiCircleDown:d=i.a.semicircleInverted}break;case o.Auto:switch(r.TextFacade.getCategoryForAutoAlignment(n.alignment)){case r.TypographyLayoutCategory.DropCap:d=i.a.autoDropCap;break;case r.TypographyLayoutCategory.Rotate:d=i.a.autoRotate;break;case r.TypographyLayoutCategory.Triplet:d=i.a.autoTriplet;break;case r.TypographyLayoutCategory.RotateFit:d=i.a.autoFitRotate}}return s===o.FitJustified&&(d=3),{disableShape:c,disableShapePicker:l,disableAllAlignments:!1,currentAlignment:d}}(t,m),{label:V,postScriptName:W}=h.targetedFont.fontData,_=s.default.isStandardFontSelectable(W)?V:n.a.translate("panels.textstyles.kLegacyFont"),H=t.getOpacityValuesOfLockupAsScalars(),G=!E||A||F,J=(window.localStorage.getItem("text-area-focused-count")?Number(window.localStorage.getItem("text-area-focused-count")):0)<3,z=[];return t.hasValidAutoAlignmentByCategory(r.TypographyLayoutCategory.DropCap)&&z.push(r.TypographyLayoutCategory.DropCap),t.hasValidAutoAlignmentByCategory(r.TypographyLayoutCategory.Rotate)&&z.push(r.TypographyLayoutCategory.Rotate),t.hasValidAutoAlignmentByCategory(r.TypographyLayoutCategory.Triplet)&&z.push(r.TypographyLayoutCategory.Triplet),t.hasValidAutoAlignmentByCategory(r.TypographyLayoutCategory.RotateFit)&&z.push(r.TypographyLayoutCategory.RotateFit),{currentFont:_,hasShadow:A,hasOutline:F,currentFontSize:S,listOfShapes:v,selectedShapeId:C,disableKnockout:L,disableShadow:M,disableOutline:U,fontSizes:x,hasSecondaryStyle:P,disableShape:B,disableShapePicker:j,disableAllAlignments:N,autoAlignmentSupported:z,currentAlignment:$,hideLineHeight:k,hideLetterSpacing:T,colorInfo:R,showCoachmark:J,isOutlineOnly:D,disableOutlineOnly:O,selectedMSLTab:m?"secondary":"main",primarySwatch:"text",currentLineHeight:t.getSelectedFormaLineHeightAsScalar(),currentLetterSpacing:t.getSelectedFormaLetterSpacingAsScalar(),hasShapes:w,shapePadding:t.getSelectedFormaShapePaddingAsScalar(),shapeMaskText:E,shadowDistance:t.getSelectedFormaShadowDistanceAsScalar(),shadowDirection:t.getSelectedFormaShadowAngleAsScalar(),outlineThickness:t.getSelectedFormaOutlineThicknessAsScalar(),currentOpacity:H.text,shapeOpacity:H.shape,selectedItemsCanBeDeleted:!0,selectedItemsCanBeEdited:!1,disableTextOpacity:!G||E&&!F,disableShapeSizeSlider:11===C,textPanelHelpModalContent:u}}function g(e,t){return{colorInfo:{color:e.style.colors.fieldPrimary.hex},selectedItemsCanBeDeleted:t.getGridForma().style.numBackgroundCells>1,selectedItemsCanReordered:!1}}function m(e,t,o){let r={};const a=[],n=o.getCurrentBrandElements();let s=!0;return n&&(n.logos&&n.logos.forEach(e=>{e.acRoles.indexOf("primary-logo")>=0?r={id:e.id,url:e.fullResUrl}:a.push({id:e.id,url:e.fullResUrl})}),s=!n.belongsToUser),{primaryLogo:r,secondaryLogos:a,disableAddLogo:s,isLogoSelected:e&&e.isLogo&&e.isLogo(),currentOpacity:t.getOpacityValueOfSelectedFormaAsScalar(),selectedItemsCanBeDeleted:!0,selectedItemsCanBeReplaced:!0}}function f(e,t){return{currentOpacity:t.getOpacityValueOfSelectedFormaAsScalar(),colorInfo:{color:e.style.colors.fieldPrimary.hex},selectedItemsCanBeDeleted:!0,selectedItemsCanBeReplaced:!0,selectedItemsHaveSourceInfo:t.hasImageAttribution(),showBlendMode:t.canHaveBlendMode(e),currentBlendMode:t.getAppliedBlendMode(e)}}function b(e,t){return{currentOpacity:t.getOpacityValueOfSelectedFormaAsScalar(),disableUngroup:!t.getGroupFeatures().canUngroup,selectedItemsCanBeDeleted:!0,selectedItemsCanReordered:t.getNumLayers()-1!=0}}function y(e,t){return{currentHorizontalAlignment:-1,currentVerticalAlignment:-1,hasGroupSelected:t.getGroupFeatures().canUngroup,selectedItemsCanBeDeleted:!0,selectedItemsCanReordered:!1}}var S=o("UFvF"),v=o.n(S),C=o("wHG3"),w=o("TdwW"),P=o.n(w);const k=window.THEO_BUNDLE_PATH,{PNGEncoding:T,TargetRenderParameters:x,TargetTransformTypeEnum:I}=C.PixiJSApp,A={None:"none",Greyscale:"grayscale",Darken:"darken",Overlay:"contrast",Blend:"matte",Multiply:"multiply",DuoTone:"colorize",Screen:"lighten",NewDuoTone:"duotone"},F={blur:0,brightness:.5,contrast:.5,highlight:.5,saturation:.5,shadow:.5,sharpen:0,warmth:.5},E={title:n.a.translate("app.imagePanel.title"),ctaText:n.a.translate("app.helpModal.kCtaText"),ctaLink:"https://adobespark.zendesk.com/hc/en-us/categories/202688167-Adobe-Spark",assetUrl:`https://${window.location.host}/images/help-videos/edit_image.gif`,placement:"bottom-left",id:"editImage"};let D,R,L=[];function O(e,t,o,a,n){const s=r.ImageFacade.getMaskForForma(e),{blur:i,sharpness:l,contrast:c,saturation:d,brightness:u,shadows:p,highlights:h,warmth:g}=t.getSelectedFormaImageAdjustmentsAsScalars(),m={blur:i,contrast:c,saturation:d,brightness:u,warmth:g,shadow:p,sharpen:l,highlight:h},f=null!==e.controller.cutout,b=e.isImage()&&!e.isVideo(),y=t.getImageFormaBackgroundColor(e),S=null!==y,v={color:(null==y?void 0:y.rgbColor.hex)||"ffffffff"},C=t.getImagePreviewData(e),w=C.styleFilter.name,P=w===r.ImageStyle.NAME_NEWDUOTONE,T=t.getDocument().controller.selection,x=T.inCropMode,I=T.inRefineCutoutMode,O=t.getCutoutBrushMode(),M=t.getCutoutBrushSize(),U=t.getCutoutEffectiveBrushSize(),B=t.isCutoutPreviewVisible(),j=t.isAutoCutoutEnabled(),N=t.isClearCutoutEnabled(),$=t.isInvertCutoutEnabled(),V=!e.controller.moveable;let W=!1;for(const e in m)if("blur"!==e&&m[e]!==F[e]){W=!0;break}0===L.length&&(L=r.CropAssetLibrary.getListOfShapes().map(e=>({id:e.id,url:`${k}/images/images/shapes/svg/${e.id}.svg`})));const _=m.blur!==F.blur,H=e.controller.userGroupMember||e.isVideo();if(n&&!P){const e=t.getDocument().firstPage.imageFilterLibrary.getDefaultDuotonePreset(!0);R={shadows:e.shadows.rgbHex,highlights:e.highlights.rgbHex}}else{var G,J,z,K;R={shadows:P?null==C||null===(G=C.styleFilter)||void 0===G||null===(J=G.colors)||void 0===J?void 0:J.fieldShadows.rgbHex:R.shadows,highlights:P?null==C||null===(z=C.styleFilter)||void 0===z||null===(K=z.colors)||void 0===K?void 0:K.fieldHighlights.rgbHex:R.highlights}}return D||(D=t.getDocument().firstPage.imageFilterLibrary.getDuotonePresets().map(e=>({shadows:e.shadows.rgbHex,highlights:e.highlights.rgbHex,category:e.category}))),{hasBackgroundColor:S,colorInfo:v,imageEnhancements:m,showEnhancementsPanel:W,showBlurPanel:_,isBackgroundRemoved:f,isRemoveBackgroundEnabled:b,isCropMode:x,isCutoutMode:I,cutoutBrushMode:O,isCutoutPreviewVisible:B,isAutoCutoutEnabled:j,isRestoreBackgroundEnabled:N,isInvertMaskEnabled:$,cutoutBrushSize:M,cutoutEffectiveBrushSize:U,cutoutBrushRange:[1,100],isInBackgroundLayer:V,duotoneColorPairs:D,currentDuotoneColorPair:R,disableBGcheckbox:H,listOfCropShapes:L,backgroundColor:null==y?void 0:y.rgbColor.hex,imageRotation:t.getSelectedFormaRotationAsScalar(),imageScale:t.getSelectedFormaScaleAsScalar(),imageOpacity:t.getOpacityValueOfSelectedFormaAsScalar(),imageCropRotation:t.getSelectedFormaRotationAsScalar(),imageCropScale:t.getSelectedFormaScaleAsScalar(),selectedCropShapeId:s&&s.id,currentFilter:A[w],showBlendMode:t.canHaveBlendMode(e),currentBlendMode:t.getAppliedBlendMode(e),imagePanelHelpModalContent:E,selectedItemsCanBeReplaced:!x&&!I,selectedItemsCanBeDeleted:!x&&!I,selectedItemsHaveSourceInfo:!x&&!I&&t.hasImageAttribution(),selectedItemsCanBeDuplicated:!x&&!I&&t.allowDuplication(e),selectedItemsCanReordered:!x&&!I&&!V&&t.getNumLayers()-1!=0}}var M=o("LbXs");function U(e,t,o){return t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}class B{constructor(){U(this,"_state",void 0),U(this,"_stringifiedState",void 0),this._state={isReplaceMode:!1,selectedItemType:"",selectedItemId:"",listOfLoadingAssets:[],selectedLayerMaxIndex:0,selectedLayerCurIndex:0,selectedItemsCanBeGrouped:!1,selectedItemsCanBeUngrouped:!1,selectedItemsCanBeDuplicated:!1,selectedItemsCanReordered:!1,selectedItemsCanBeDeleted:!1,selectedItemsCanBeReplaced:!1,selectedItemsCanBeEdited:!1,selectedItemsHaveSourceInfo:!1,isInBackgroundLayer:!1,isBackgroundRemoved:!1,isRemoveBackgroundEnabled:!1,isCropMode:!1,isCutoutMode:!1,isCutoutPreviewVisible:!1,isAutoCutoutEnabled:!1,isRestoreBackgroundEnabled:!1,isInvertMaskEnabled:!1,cutoutBrushMode:M.RefineCutoutBrushMode.NONE,cutoutBrushSize:0,cutoutEffectiveBrushSize:0,cutoutBrushRange:[0,0],imageRotation:0,imageScale:0,imageOpacity:0,imageCropRotation:0,imageCropScale:0,selectedCropShapeId:"",hasBackgroundColor:!1,listOfCropShapes:[],imageEnhancements:{},showEnhancementsPanel:!1,showBlurPanel:!1,disableBGcheckbox:!1,listOfFilters:[],currentFilter:"",duotoneColorPairs:[],currentDuotoneColorPair:{},imagePanelHelpModalContent:{},annotationPriority:-1,annotationTitle:"",text:"",focusText:!1,selectAllText:!1,formaID:"",selectedMSLTab:"",fontSizes:[],currentFont:"",currentFontSize:"",primarySwatch:"",currentAlignment:0,currentLineHeight:0,currentLetterSpacing:0,hasShapes:!1,listOfShapes:[],selectedShapeId:"",shapePadding:0,shapeMaskText:!1,hasShadow:!1,shadowDistance:0,shadowDirection:0,hasOutline:!1,isOutlineOnly:!1,outlineThickness:0,hasSecondaryStyle:!1,disableKnockout:!1,disableOutlineOnly:!1,disableShadow:!1,disableOutline:!1,disableShape:!1,disableShapePicker:!1,disableAllAlignments:!1,autoAlignmentSupported:[],hideLineHeight:!1,hideLetterSpacing:!1,shapeOpacity:1,disableTextOpacity:!1,disableShapeSizeSlider:!1,showCoachmark:!0,textPanelHelpModalContent:{},isLogoSelected:!1,primaryLogo:{id:"0",url:"logo1.com"},secondaryLogos:[{id:"1",url:"logo2.com"},{id:"2",url:"logo3.com"}],disableAddLogo:!1,isLogoReplaceMode:!1,currentHorizontalAlignment:0,currentVerticalAlignment:0,hasGroupSelected:!0,colorInfo:{color:"ffffff",key:"2"},enableHelpModal:!1,currentOpacity:75,assetRailSelectedId:"",designAssetsState:{},backgroundsState:{},currentBlendMode:"normal",showBlendMode:!1,disableUngroup:!1},this._stringifiedState=""}destroy(){this._state={},this._stringifiedState=""}dirtyState(){this._stringifiedState=""}setProperties(e){let t=!1;for(const[o,r]of Object.entries(e))this._state.hasOwnProperty(o)&&r!==this._state[o]&&(this._state[o]=r,t=!0);t&&this.dirtyState()}get stringifiedState(){return this._stringifiedState||(this._stringifiedState=JSON.stringify(this._state)),this._stringifiedState}get state(){return JSON.parse(this.stringifiedState)}}var j=o("rCSV"),N=o("bBG2");function $(e,t,o){return t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}class V{constructor(e,t,o){$(this,"model",void 0),$(this,"coreWrapper",void 0),$(this,"brandkitWrapper",void 0),$(this,"postFeatureController",void 0),$(this,"events",void 0),$(this,"nodeStateGetterMap",{cell:g,image:O,text:h,logo:m,icon:f,group:b,multiselect:y}),this.coreWrapper=e,this.brandkitWrapper=t,this.postFeatureController=o,this.events=new j.default,this.model=new B,this.updateStateForSelectedItem(!1),this.events.publish("ui-state-updated")}clearSelectedItemState(){this.model.setProperties({listOfCropShapes:[],imageEnhancements:{},listOfFilters:[],fontSizes:[],listOfShapes:[],colorInfo:{}})}asyncUpdateFiltersListForSelectedImage(e){const t=this.coreWrapper.getImagePreviewData(e).styleFilter.name,o=this.coreWrapper.getDocument().controller.selection.inCropMode,a=this.coreWrapper.inRefineCutoutMode();"none"===t||o||a||function(e,t,o){const a=t.getImageFilters(),n=t.getImagePreviewData(e),s=n.styleFilter.detachFromDatabase(),i={},l=[],c=Math.round(82*e.bounds.width/Math.min(e.bounds.width,e.bounds.height)),d=Math.round(82*e.bounds.height/Math.min(e.bounds.width,e.bounds.height));for(let u=0;u<a.length;u++){a[u].name===s.name?(a[u].colorLibrary=n.forma.page.colorLibrary,a[u]=s):(a[u].adjustments=s.adjustments,a[u].name===r.ImageStyle.NAME_NEWDUOTONE&&(a[u].colors.fieldShadows=P.a.hex2SolidColor(R.shadows),a[u].colors.fieldHighlights=P.a.hex2SolidColor(R.highlights)));const p=t.beginTransaction("apply_styles_for_filter_thumbnails");r.ImageFacade.getImageFormaForForma(e).applyStyle(a[u]);const h=e.getGraph(r.PGMExportSettings.STATIC);p.rollback(),l.push(o.render(h,new x(I.FillCentered,c,d,T.AsDataURL())).then(e=>{const t=A[a[u].name];i[t]=e.data}))}return v.a.allSettled(l).then(()=>i)}(e,this.coreWrapper,this.coreWrapper.imageQueue()).then(t=>{this.model._state.selectedItemId===e.formaID&&(this.model.setProperties({listOfFilters:t}),this.events.publish("ui-state-updated",this.model.state))})}updateStateForSelectedItem(e){if(this.coreWrapper.isReordering())return;const t=this.coreWrapper.getSelectedForma(),o=this.coreWrapper.getSelectedFormaType(),a=this.coreWrapper.getSelectedFormaId(),n=this.nodeStateGetterMap[o],s=this.coreWrapper.getNumLayers()-1,i=this.coreWrapper.getLayerSliderValueOfSelectedForma(),l=this.coreWrapper.getGroupFeatures(),c=l.canGroup,d=l.canUngroup,u=!!t&&this.coreWrapper.allowDuplication(t),p=!!t&&0!==s;let h,g;if(h=this.coreWrapper.getTextForSelectedLockup(),h===r.TextFacade.kEmptyLockupString&&(h=""),g=this.coreWrapper.getSelectedFormaId(),this.model.setProperties({text:h,formaID:g,selectedItemType:o,selectedItemId:a,selectedLayerMaxIndex:s,selectedLayerCurIndex:i,selectedItemsCanBeGrouped:c,selectedItemsCanBeUngrouped:d,selectedItemsCanBeDuplicated:u,selectedItemsCanReordered:p,selectedItemsCanBeDeleted:!1,selectedItemsCanBeReplaced:!1,selectedItemsCanBeEdited:!1,selectedItemsHaveSourceInfo:!1}),n){const o=n(t,this.coreWrapper,this.brandkitWrapper,this.postFeatureController,e);this.model.setProperties(o)}"image"===o&&this.asyncUpdateFiltersListForSelectedImage(t)}forceUiStateUpdate(){this.updateStateForSelectedItem(!1),this.events.publish("ui-state-updated")}handleDocumentUpdated(){this.updateStateForSelectedItem(!1),this.events.publish("ui-state-updated")}handleEnterReplaceMode(){this.model.setProperties({isReplaceMode:!0}),this.events.publish("ui-state-updated")}handleLeaveReplaceMode(){this.model.setProperties({isReplaceMode:!1}),this.events.publish("ui-state-updated")}handleDoubleTapToEditText(e){this.model.setProperties({selectAllText:e,focusText:!0}),this.events.publish("ui-state-updated")}onFocusTextRequestHandled(){this.model.setProperties({focusText:!1,selectAllText:!1}),this.events.publish("ui-state-updated")}handleSelectionChanged(){if(this.coreWrapper.isReordering())return;this.model.setProperties({isReplaceMode:!1}),this.clearSelectedItemState(),this.updateStateForSelectedItem(!0),this.events.publish("ui-state-updated");const e=this.coreWrapper.getSelectedForma();let t="0";e&&e.kind===C.Core.RootForma.KIND?t="root":e&&(t=e.controller.getZOrder());const o={contextualData2:"method:"+(this.coreWrapper.selectFromLayerStack()?"layerWidget":"canvas"),contextualData3:"layer:"+t},r=this.coreWrapper.getSelectedFormaType();this.coreWrapper.inCharStyleMode||this.coreWrapper.exitingCharStyleMode||"no-selection"!==r&&N.default.publish(`editor:${r}Selected`,o),this.coreWrapper.exitingCharStyleMode=!1}addLoadingAssetId(e){const t=this.model._state.listOfLoadingAssets;if(t.includes(e))return;const o=t.slice();o.push(e),this.model.setProperties({listOfLoadingAssets:o}),this.events.publish("ui-state-updated")}removeLoadingAssetId(e){const t=this.model._state.listOfLoadingAssets;if(t){const o=t.indexOf(e);if(o>=0){const e=t.slice();e.splice(o,1),this.model.setProperties({listOfLoadingAssets:e})}this.events.publish("ui-state-updated")}}handleAnnotationsChanged(e,t){this.model.setProperties({annotationPriority:e,annotationTitle:t}),this.events.publish("ui-state-updated",{immediate:!0})}handleAssetRailNavChanged(e){this.model.setProperties({assetRailSelectedId:e}),this.events.publish("ui-state-updated")}handleDesignAssetsChanged(e,t){const o=t+"State";this.model.setProperties({[o]:e}),this.events.publish("ui-state-updated")}handleLogoPanelChanged(e){const t={};Object.entries(e).forEach(([e,o])=>{t[e]=o}),this.model.setProperties(t),this.events.publish("ui-state-updated")}destroy(){this.model.destroy()}}},Gklz:function(e,t,o){"use strict";o.r(t);var r=o("TdwW"),a=o.n(r);function n(e,t,o){return t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}t.default=class{constructor(e,t,o){n(this,"colorPicker",void 0),n(this,"postEditorContent",void 0),n(this,"handleEyeDropperEventCallback",void 0),n(this,"colorPickerEventListeners",[]),n(this,"pickerVisible",!1),n(this,"coreWrapper",void 0),n(this,"clickOutsideHandler",void 0),n(this,"role",0),this.colorPicker=e,this.postEditorContent=t,this.handleEyeDropperEventCallback=o,this.clickOutsideHandler=this.handleClickOutsideColorPicker.bind(this)}handleShown(){setTimeout(()=>{window.addEventListener("click",this.clickOutsideHandler)},0)}handleHidden(){window.removeEventListener("click",this.clickOutsideHandler),this.unbindListeners()}unbindListeners(){this.colorPickerEventListeners.forEach(e=>{e.remove()}),this.colorPickerEventListeners=[]}handleClickOutsideColorPicker(e){const t=e.target,o="colorPicker"===t.id,r=t.closest(".post-color-eyedropper-target"),a=t.closest("#colorPicker");let n=!1;const s=e.composedPath&&e.composedPath();s&&s.length&&s.forEach(e=>{"THEO-COLOR-SWATCH"===e.tagName&&(n=!0)}),o||a||r||n||(this.colorPicker.hide(),this.pickerVisible=!1)}colorChangeModal(e){"begin"===e.type?this.pickerVisible=!0:"confirm"!==e.type&&"cancel"!==e.type||(this.pickerVisible=!1)}colorChanged(e,t){const o=this.coreWrapper.getSelectedForma();if(this.pickerVisible){const r=a.a.hex2rgb(e.color);"duotone: shadows"===t||"duotone: highlights"===t?this.coreWrapper.updateDuotoneFilterColor("duotone: shadows"===t,{red:r.r,green:r.g,blue:r.b,id:e.id,roles:[this.role]}).done():o&&o.isTypeLockup()?this.coreWrapper.setColorWithRolesForSelection([{red:r.r,green:r.g,blue:r.b,id:e.id,roles:[this.role]}]):this.coreWrapper.setColorForSelection([{red:r.r,green:r.g,blue:r.b,id:e.id,roles:e.roles}])}}handleEyeDropperChanged(e){this.handleEyeDropperEventCallback(e,this.colorPicker),"click"===e.type&&(this.postEditorContent.removeClass("eye-dropper-scrim"),this.postEditorContent.find(".full-scrim").remove())}handleEnterEyeDropperMode(){this.postEditorContent.addClass("eye-dropper-scrim").append('<div class="full-scrim"></div>')}getSuggestedColors(e,t){const o="effects"===t?1:0;let r;if(r=e.isTypeLockup()?this.coreWrapper.getSuggestedColorsForLockup(e):this.coreWrapper.getSuggestedColors(e),!r)return null;return r.map(e=>e[o]?e[o]:null).filter(e=>e)}getCurrentPalette(){return this.coreWrapper.getColorPalette().map(e=>a.a.hex2rgb(e.color))}show(e){if(!e.color||!e.anchor)return;this.colorPickerEventListeners.length&&this.unbindListeners(),this.coreWrapper=e.coreWrapper,this.role=e.role,this.colorPicker.setAnchorElement($(e.anchor)),this.colorPicker.setContainingElement($(e.containingElement));const t=e.color.length>6?e.color.substring(0,6):e.color;this.colorPicker.setCurrentColor(t);const o=this.coreWrapper.getSelectedForma(),r=this.getCurrentPalette(),a=this.getSuggestedColors(o,e.colorToEdit);this.colorPicker.update({currentColors:r,suggestedColors:a,compact:e.compact,label:e.label}),this.pickerVisible=!1,this.colorPickerEventListeners=this.colorPicker.bindToEventsWithHandlers({shown:this.handleShown.bind(this),hidden:this.handleHidden.bind(this),colorChangeModal:this.colorChangeModal.bind(this),colorChanged:t=>{this.colorChanged(t,e.colorToEdit)},"eyedropper-changed":this.handleEyeDropperChanged.bind(this),"eye-dropper-mode":this.handleEnterEyeDropperMode.bind(this)}),this.colorPicker.show()}hide(){this.pickerVisible&&this.colorPicker.hide(),this.pickerVisible=!1}}},GnB6:function(e,t,o){"use strict";function r(){let e="Unknown",t="Unknown";const o=function(){const e=document.createElement("canvas");if(e)return e.getContext("webgl")||e.getContext("experimental-webgl");return null}();if(o){const r=o.getExtension("WEBGL_debug_renderer_info");r&&(e=o.getParameter(r.UNMASKED_VENDOR_WEBGL),t=o.getParameter(r.UNMASKED_RENDERER_WEBGL))}const{platform:r,userAgent:a}=navigator;return{vendor:e,renderer:t,platform:r,userAgent:a}}function a(){const[e,t]=function(){let e="",t="";const o=document;void 0!==o.hidden?(e="hidden",t="visibilitychange"):void 0!==o.msHidden?(e="msHidden",t="msvisibilitychange"):void 0!==o.webkitHidden&&(e="webkitHidden",t="webkitvisibilitychange");return[e,t]}(),o=document;return{isHidden:()=>o[e],addListener(r){void 0!==o.addEventListener&&""!==e&&o.addEventListener(t,r,!1)},removeListener(e){void 0!==o.removeEventListener&&o.removeEventListener(t,e,!1)}}}o.r(t),o.d(t,"getWebGLSystemInfo",(function(){return r})),o.d(t,"getPageVisibilityInfo",(function(){return a})),t.default={getWebGLSystemInfo:r}},INJi:function(e,t,o){"use strict";o.r(t);var r=o("YLtl"),a=o("UzQk"),n=o.n(a),s=o("MGCh"),i=o.n(s),l=o("WpJZ"),c=o("bBG2");const d=o("92tI"),u=i.a.channel("text-style-module");let p,h,g=!1,m=!1;let f=[],b=0,y=null,S=null,v=null,C=!1,w=!1,P=null,k=null,T=0;function x(e,t){const o=p.getSelectedForma();if(null==o||!o.isTypeLockup())return;const r=o.controller.text;if(o&&(o.formaID!==S||r!==y||null==h||0===b||0===h.postTextStylesServiceInterface.getNumStylesInCache())){u.info("Resetting wheel parameters."),d.eraseTextStyleCache(),d.updateTextStyleSuggestionAtIndex(0,o.style.clone(),"current style"),h=new n.a.WheelSuggestionEvaluator(o),h.postTextStylesServiceInterface.advancedFeatures=g,k=p.getStyleServiceMetaDataString(o),S!==o.formaID&&(T=0),S=o.formaID,v=o.placement,y=r,P=null,b=0;const a=!0,s=!0;return d.resetStyleSuggestions(a,s,h,e,t).finally(()=>{u.info(`Styles: ${e} Emphasis: ${t}`)})}}function I(e,t){C&&e&&function(){const e=p.getFormaById(S);let t=Object(l.getLockupStyleStringWithRole)(e,p.getDocument()),o=null,r=null;if(h){const e=h.lockupStyleEvaluator.getOldReadabilityInformation();e&&(r=e.readabilityString);const t=h.lockupStyleEvaluator.getNewReadabilityInformation();t&&(o=t.readabilityString)}if(t.length>0){P&&(t+=`{sugID:${P}}`);const e="location:WheelSuggestion";c.default.publish("lockupStyleCaptured",{contextualData1:"styleString:"+t,contextualData2:e,contextualData3:"oldRead:"+r,contextualData4:"newRead:"+o,contextualData5:"meta:"+k,contextualData6:"emphasisUsed:"+w}),C=!1}}(),w&&t&&function(){const e=d.getEmphasisLoggingInfo(h),t=[];e.forEach(e=>{t.push(e)});const o=JSON.stringify(t);if(o.length>0){const e="location:WheelSuggestion";c.default.publish("lockupEmphasisCaptured",{contextualData1:"emphasisString:"+o,contextualData2:e}),w=!1}}()}function A(e,t){I(e,t),x(e,t)}function F(){I(!0,!0),h=null,k=null,C=!1,w=!1,d.eraseTextStyleCache()}function E(){const e=p.getSelectedForma();e&&e.isTypeLockup()||(S=null,f.forEach(e=>{e.remove()}),f=[],F())}const D=Object(r.throttle)(()=>{u.info("Forma updated. Clearing styles/emphasis promises, then resetting spinner."),A(!0,!0)},400);function R(){const e=p.getSelectedForma();n.a.TextFacade.setFitContainerToArea(e,m),e.formaID!==S&&(f.push(p.events.subscribe("forma-selected",E)),f.push(p.events.subscribe("forma-text-updated",D)),x(!0,!0)),e&&e.isTypeLockup()&&(e.formaID!==S||v!==e.placement)&&(e.formaID!==S&&A(!0,!0),v!==e.placement&&A(!0,!1))}const L=new class{setCoreWrapper(e){p=e,d.setCoreWrapper(e)}setAdvancedTextLayoutEnabled(e){g=e}setAdvancedTextLayoutEnableBoundingBoxArea(e){m=e}handleStyleSliderValueChange(){R(),T+=1;b=(T+5e3)%50,C=0!==b,d.applyTextStyleSuggestion(b,h).then(()=>{const{id:e}=d.getTextStyleSuggestionAtIndex(b);P=e||null}).done()}};t.default=L},J9tZ:function(e,t,o){"use strict";async function r(e,t,o){try{return[null,await e]}catch(e){return t&&Object.assign(e,t),"function"==typeof o&&o(e),[e,void 0]}}o.d(t,"a",(function(){return r}))},K7z8:function(e,t,o){"use strict";o.r(t),o.d(t,"BrandkitTemplateUtils",(function(){return v}));var r=o("U44B"),a=o.n(r),n=o("hHO/"),s=o.n(n),i=o("3xdQ"),l=o.n(i),c=o("b2xK"),d=o.n(c),u=o("qnb0"),p=o.n(u),h=o("mwMu"),g=o.n(h),m=o("wPbz"),f=o("YYuT"),b=o("btxu"),y=o("MGCh");const S=o.n(y).a.channel("brandkit-template-utils");class v{static async renderCoreToDataUrl(e,t){const o=new b.default(e);return await o.render(t)}static async renderCoreToCanvasContext(e,t,o){const r=new b.default(e);await r.renderToCanvas(t,o)}static async createEmptyPostTemplate(e){const t=await e.composite.acquireNestedMap("themes"),o=e.composite.addChildPath(void 0,void 0,t);return o.setValue("type","application/vnd.adobe.adobesparkpost.theme+json"),o.setValue("ac#format","post"),o}static async copyTemplate(e,t,o){const r=o||await v.createEmptyPostTemplate(e);r.setValue("theme#data",t.getValue("theme#data"));const a=new l.a({persistSource:g.a.fromTemplate(e,t),persistSave:p.a.toTemplateLocal(e,r,p.a.CommitChanges.AUTO)});await a.whenInitialized();const n=await v.renderCoreToDataUrl(a,{longestSide:500});return await a.saveWithRenditions(void 0,s()(n)),r}static async renderTemplate(e,t,o,r){const a=new l.a({persistSource:g.a.fromTemplate(e,t),persistSave:d.a.toBlackHole()});await a.whenInitialized(),await v.renderCoreToCanvasContext(a,o,{longestSide:r||500})}static async setUsedBrandElementsData(e,t,o,r){const a=o||new l.a({persistSource:g.a.fromTemplate(e,t),persistSave:p.a.toTemplateLocal(e,t,r?p.a.CommitChanges.NEVER:p.a.CommitChanges.AUTO)});let n,s,i=e.getAllFonts();try{n=(await e.getColors()).map(e=>e.getId()).filter(e=>a.isSparkColorInUse(e));i=(i&&0!==i.length?i:await e.getFonts()).map(e=>e.getId()).filter(e=>a.areSparkFontsInUse([e]));s=(await e.getAuthoringContextLogos()).map(e=>e.getId()).filter(e=>a.areSparkLogosInUse([e]));const o=t.getValue("theme#data")||{};o.colors=n,o.fonts=i,o.logos=s,t.setValue("theme#data",o)}catch(e){const t=e?e.message:"";S.error("setUsedBrandElementsData error: "+t,e)}}static async createEmptyBrandedTemplate(e,t){const o=t||await v.createEmptyPostTemplate(e),r=new l.a({persistSource:new m.a({}),persistSave:p.a.toTemplateLocal(e,o,p.a.CommitChanges.AUTO)});await r.whenInitialized();const n=await f.default.getCoreBrandForTemplateGeneration(e);n?(a.a.setAuthoringContext(n),await r.brandDocument(n)):S.error("Failed to add branding to default template: Core brand is undefined."),await v.setUsedBrandElementsData(e,o,r,!0);const i=await v.renderCoreToDataUrl(r,{longestSide:500});return await r.saveWithRenditions(null,s()(i)),o}static getTemplateName(e){return(e.getValue("theme#data")||{}).name||""}static setTemplateName(e,t){const o=e.getValue("theme#data")||{};o.name=t,e.setValue("theme#data",o)}static setTemplateSourceID(e,t){const o=e.getValue("theme#data")||{};o.sourceTemplateID=t,e.setValue("theme#data",o)}}t.default=v},Mbmg:function(e,t,o){"use strict";o.d(t,"a",(function(){return l}));var r=o("xeH2"),a=o.n(r),n=o("3xm6"),s=o.n(n);function i(e,t,o){return t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}class l{static pageUnloadBlockingBegin(){window.addEventListener("beforeunload",l.pendingSavePageUnloadPrompt)}static pageUnloadBlockingEnd(){window.removeEventListener("beforeunload",l.pendingSavePageUnloadPrompt)}static beginTrackingPendingXhrRequests(){l.isTrackingXHRs||(l.isTrackingXHRs=!0,a()(document).on("ajaxSend",l.registerJqxhr),a()(document).on("ajaxComplete",l.unregisterJqxhr))}static endTrackingPendingXhrRequests(){l.isTrackingXHRs=!1,a()(document).off("ajaxSend",l.registerJqxhr),a()(document).off("ajaxComplete",l.unregisterJqxhr),l.xhrRequestsToAbortOnUnload=[]}static pendingSavePageUnloadPrompt(e){l.xhrRequestsToAbortOnUnload.forEach(e=>{e&&e.abort()});const t=s.a.translate("dialogs.savePageUnloadPrompt");return e&&(e.preventDefault(),e.returnValue=!!t),t}static registerJqxhr(e,t,o){l.xhrRequestsToAbortOnUnload.push(t)}static unregisterJqxhr(e,t,o){const r=l.xhrRequestsToAbortOnUnload.indexOf(t);l.xhrRequestsToAbortOnUnload.splice(r,1)}}i(l,"xhrRequestsToAbortOnUnload",[]),i(l,"isTrackingXHRs",!1),t.b=l},N5Mo:function(e,t,o){"use strict";o.d(t,"a",(function(){return h}));var r=o("MGCh"),a=o.n(r),n=o("3xdQ"),s=o.n(n),i=o("U44B"),l=o.n(i),c=o("8VGm"),d=o("b2xK"),u=o.n(d);const p=a.a.channel("template-generator");class h{constructor(e){this.instructions=e}generateOneTemplate(e,t){const o=new s.a({persistSource:new c.default({assetId:e.cpAssetId}),persistSave:new u.a}),r={template:e,coreWrapper:o};return o.whenInitialized().then(()=>(l.a.setAuthoringContext(t),o.addBranding(t))).then(()=>r).catch(e=>{throw p.error("generateOneTemplate failed:",e),e})}generateTemplates(){const{brand:e,documents:t}=this.instructions;return t.map(t=>this.generateOneTemplate(t,e))}}},PsNr:function(e,t,o){var r,a;r=[o("xeH2"),o("YLtl"),o("UFvF"),o("eZ+Q")],void 0===(a=function(e,t,o,r){var a={cleanUpFiles:function(e){e=e.map((function(e){return e.source=r.getServiceSource(e),e}));for(var t=["original","preview","thumbnail","small"],o=0;o<e.length;o++)for(var a=e[o],n=0;n<t.length;n++){var s=t[n];!a[s]||a[s].link||a[s].blobPromise||delete a[s]}return e}};return a}.apply(t,r))||(e.exports=a)},RhVb:function(e,t,o){var r;void 0===(r=function(){var e={},t=!1;function o(){t="visible"===document.visibilityState}return e.getPostTabRecoveryStatus=function(){return t},e.setPostTabRecoveryStatus=function(e){t=e},e.startWatchPostTabVisibility=function(){document.addEventListener("visibilitychange",o,!1)},e.endWatchTabVisibility=function(){t=!1,document.removeEventListener("visibilitychange",o,!1)},e}.apply(t,[]))||(e.exports=r)},UNP3:function(e,t,o){"use strict";o.r(t),o.d(t,"reportNounProjectIds",(function(){return c}));var r=o("ApVh"),a=o.n(r),n=o("MGCh"),s=o.n(n),i=o("WpJZ");const l=s.a.channel("noun-project-reporter");function c(e,t,o){const r=Object(i.getUnreportedNounProjectIds)(e);if(!r.length)return Promise.resolve();const n=`https://${t.dooplo}/api/v1/report/usage?api_key=MarvelCP1`;return a.a.getAccessToken().then(a=>{const s={method:"POST",headers:{Authorization:"Bearer "+a,"X-Api-Key":t.key,Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({ids:r})};return fetch(n,s).then(t=>{if(t.status>=400){const e=new Error("reportNounProjectIds returned an HTTP error");l.error(`Requested ${n}. Got back ${t.statusText}`,e)}else Object(i.setNounProjectIdsReported)(r,e),o()}).catch(e=>{l.error("error reporting Noun Project icon Ids",`Requested ${n}. Got back ${e}`)})})}},Wqmg:function(e,t,o){"use strict";async function r(e,t=""){const o="/api/post/v1/proxy?url="+encodeURIComponent(e);let r;try{r=await fetch(o)}catch(e){throw new Error("image blob failed to load through proxy. error details: "+e)}if(!r.ok)throw new Error("image blob failed to load through proxy. status: "+r.status);try{const e=await r.arrayBuffer(),o=new Uint8Array(e),a=t||r.headers.get("Content-Type")||"image/jpeg";return new Blob([o],{type:a})}catch(e){throw new Error("image blob failed to get created. error details: "+e)}}o.d(t,"a",(function(){return r}))},Wxmc:function(e,t,o){var r,a;r=[o("3xm6"),o("UzQk"),o("Dvuo")],void 0===(a=function(e,t,o){var r={},a="px",n=0,s=300;return r.isValidParsedInput=function(e){var o="number"==typeof e?e:t.Host.locale.convertStringToNumber(e);if(isNaN(o))return NaN;var r=t.PageFacade.convertPixelsToUnitsString(o,n,s);return!!t.PageFacade.pageDimensionIsInRange(r,n,s)&&o},r.updateRangeAndUnits=function(e,t){a=o.getUnitsStringForFormat(e),n=e,s=t},r.validateAndReturnValueForInput=function(o){var i=r.isValidParsedInput(o);if(i||0===o.length)return 0===o.length&&(i=2560),{isValid:!0,errorMsg:"",value:i};if(isNaN(i))return{isValid:!1,errorMsg:e.translate("forms.custom-size.kInvalidInput"),value:o};{const r=t.PageFacade.getMinPageDimensionForUnits(n,s),i=t.PageFacade.getMaxPageDimensionForUnits(n,s),l=t.PageFacade.getNumDecimalPlacesForUnits(n),c=t.Host.locale.formatNumber(r,l),d=t.Host.locale.formatNumber(i,l);return{isValid:!1,errorMsg:e.translate("forms.custom-size.kInvalidSizeWithUnit",{minimum:c,maximum:d,units:a}),value:o}}},r.validateInputsAndCheckAspectRatio=function(o,a){var n=r.validateAndReturnValueForInput(o),s=r.validateAndReturnValueForInput(a),i="";return n.isValid&&s.isValid&&t.PageFacade.aspectRatioIsVeryTallOrWide({width:n.value,height:s.value})&&(i=e.translate("forms.custom-size.kAspectRatioTip")),{width:n,height:s,tip:i}},r}.apply(t,r))||(e.exports=a)},Yzgm:function(e,t,o){var r,a;r=[o("YLtl"),o("UFvF"),o("hcqx"),o("7mGH"),o("4pbt"),o("1geK"),o("MGCh"),o("bBG2")],void 0===(a=function(e,t,o,r,a,n,s,i){const l=s.channel("theo-publish-impl"),c=i.default,d=n.default;return new function(){this.community=window.marvel.settings.theoc,this.communityCategory="theos",this.previewPath="preview.jpg",this.doPublish=function(e,o,r){return t(a.getDownloadImageBlobPromise(e,"image/jpeg")).then(e=>"function"==typeof e.arrayBuffer?e.arrayBuffer():new t.Promise((t,o)=>{const r=new FileReader;r.addEventListener("load",()=>{t(r.result)}),r.addEventListener("error",()=>{o(r.error)}),r.readAsArrayBuffer(e)})).then(t=>{const o={};o["preview.jpg"]={content:new Uint8Array(t),contentType:"image/jpeg"};const r=e.getDCXComposite(),a={"manifest-format-version":6,name:r.name,type:r.type,state:"unmodified",id:r.id,components:[{id:"preview",type:"image/jpeg",rel:"rendition",name:"preview.jpg",path:"preview.jpg",state:"unmodified",length:t.length}]};return o.manifest={raw:a,content:JSON.stringify(a),contentType:"application/vnd.adobe.dcx-manifest+json"},o})},this.resourceUploadReport=function(e,t,o){if(l.info(`uploaded ${t} version ${o.version}`),"preview.jpg"===t){const t=e.manifest.raw;t.components[0].etag=o.etag,t.components[0].version=o.version,e.manifest.content=JSON.stringify(t)}else"manifest"===t||l.error("got unexpected upload report for "+t)},this.reviseDoPublishAfterFilesUpdate=function(o,r){const n=o.manifest.raw,s={};return e.each(r,(function(e){e.track_version&&""!==e.version&&(s[e.destination]=e.version)})),e.each(n.components,(function(t){e.isUndefined(s[t.path])||(t.version=s[t.path])})),a.hasAnimationStyle()&&this.videoPubInfo&&n.components.push({id:"videoRendition",type:"video/mp4",rel:"rendition",name:"videoRendition",path:"videoRendition.mp4",state:"unmodified",height:this.videoPubInfo.height,width:this.videoPubInfo.width,length:this.videoPubInfo.videoLength,etag:this.videoPubInfo.video_resource_data.etag,version:this.videoPubInfo.video_resource_data.version}),o.manifest.content=JSON.stringify(n),t.resolve(o)},this.getUseProgressEvents=function(){return a.hasAnimationStyle()},this.trigger=function(e,t){"progress"===e&&this.videoProgress?(this.videoProgress.copyPct=t,this.sendVideoAndCopyProgress(this.videoProgress)):o.Model.prototype.trigger.apply(this,arguments)},this.updateSnapiProgress=function(e,t,o){"progress"===e&&this.videoProgress&&o===this.videoProgress.progressId&&(this.videoProgress.videoPct=t,this.sendVideoAndCopyProgress(this.videoProgress))},this.sendVideoAndCopyProgress=function(e){var t=Math.ceil((e.videoPct+e.copyPct)/2);o.Model.prototype.trigger.apply(this,["progress",t])},this.getFilesDataToCopyFromServerData=function(e,o,r){const n=o.getDCXComposite().current,s=[],i=e.id;if(this.videoProgress=null,r.showAvatar&&""!==r.authorAvatarUrl){const e=n.getComponentWithAbsolutePath(o.getMyApp().getStorageImpl().avatarComponentPath);e&&s.push({source:i+"/"+e.id,content_type:e.type,destination:e.path})}if(a.webAnimationEnabled()&&a.hasAnimationStyle()){const e=o.getMyApp().getStorageImpl().currentDoc.id,n=o.getMyApp().getCPProjectId(o);let i=null;try{i=a.getPgmGraphForPublish()}catch(e){return l.error("PGM graph error: "+e),t.resolve(s)}var u=d.getPublishRequestBody(r);u.pgmGraph=i.encode();var p=i.bounds.aspectRatio,h=p<1?1280:Math.round(1280/p),g=p<1?Math.round(1280*p):1280;u.renderOptions={videoHeight:h,videoWidth:g,scaleType:0};var m={},f={files:s,additionalCopyDefer:t.defer()};this.videoProgress={videoPct:0,copyPct:0,progressId:e};var b=new Date;return c.publish("publish:mp4:started",{projectId:e}),d.sendPgmPublishRequestForUpload(e,n,u,m,this.updateSnapiProgress.bind(this)).then(function(t){c.publish("publish:mp4:succeeded",{projectId:e,requestId:m.value,timeSpent:new Date-b+"ms"}),this.videoPubInfo=t,this.updateSnapiProgress("progress",100,e),f.additionalCopyDefer.resolve(t)}.bind(this)).catch((function(t){c.publish("publish:mp4:failed",{projectId:e,requestId:m.value,timeSpent:new Date-b+"ms",error:JSON.stringify(t,null,2)}),f.additionalCopyDefer.reject(t)})),t.resolve(f)}return this.videoPubInfo=null,t.resolve(s)},this.getData=function(e,t){if(!t)return void console.error("no doc for getData");let o=t.getMyApp().getStorageImpl().getData(e,t,"shareData");return void 0===o&&("publishTitle"===e?o=a.getCurrentDocumentSynthesizedName():"description"===e&&(o=a.getCurrentDocumentDescription())),o},this.setData=function(e,t,o){if(!o)return void console.error("no doc for setData");return o.getMyApp().getStorageImpl().setData(e,t,o,"shareData")},this.getDocumentCredits=function(e){return""},this.getDocumentDefaultCredits=function(e){return""},this.getDownloadUrl=function(e){const o=t.defer(),n=r.hasFeature("post-download-zip-of-pngs")?"application/zip":"image/jpeg",s=this.getDownloadFileName(e);return a.getDownloadImageBlobPromise(e,n).then((function(e){o.resolve((function(){if(window.navigator.msSaveBlob)window.navigator.msSaveBlob(e,s);else{const t=window.URL.createObjectURL(e),o=document.createElement("a");document.body.appendChild(o),o.setAttribute("href",t),o.setAttribute("download",s),o.click(),window.URL.revokeObjectURL(t),document.body.removeChild(o)}}))})),o.promise},this.getDownloadFileName=function(e){return e.getProjectName()+(r.hasFeature("post-download-zip-of-pngs")?".zip":".jpg")},this.augmentMetaData=function(t){t.custom=e.merge(t.custom||{},a.getDocumentSize()),e.assign(t,{description:a.getCurrentDocumentDescription()}),e.assign(t,{machine_tags:a.getRemixAncestorsIntoMachineTags(t.machine_tags)})},this.getPublishingSetup=function(){return{supportsDownload:!1,publishingSavesData:!1,assetType:"application/vnd.adobe.theo.document+dcx",supportedFields:["publishTitle","authorFull","showAuthor","authorAvatarUrl","isPublic","category"]}}}}.apply(t,r))||(e.exports=a)},dcsN:function(e,t,o){"use strict";o.r(t);var r=o("Na8G"),a=o.n(r);t.default=class{constructor(e){this.postFeatureController=e}isEntitledToFeature(e){return this.postFeatureController.featureEnabled("entitle-brand-kit")}tryPremiumFeature(e){return!!this.isEntitledToFeature(String(e.touchpointName))||(a.a.showMerchPopover(e),!1)}}},dlJo:function(e,t,o){"use strict";t.a=class{static promiseFetch(e,t={}){return new Promise((o,r)=>{fetch(e,t).then(e=>{if(e.ok)o(e.json());else{const t=new Error(e.statusText);r(t)}}).catch(e=>{r(e)})})}}},f5T3:function(e,t,o){"use strict";o.d(t,"a",(function(){return r}));const r={center:0,left:1,right:2,capitalizeAndFit:3,circle:4,semicircle:5,semicircleInverted:6,gridLeft:7,gridCenter:8,gridRight:9,autoDropCap:10,autoTriplet:11,autoRotate:12,autoFitRotate:13}},ibPQ:function(e,t,o){"use strict";o.r(t),o.d(t,"KeyboardShortcuts",(function(){return u}));var r=o("MGCh"),a=o.n(r),n=o("bBG2"),s=o("3xm6"),i=o.n(s),l=o("5d+0"),c=a.a.channel("keyboard-shorcuts"),d={confirmText:0,rotation:0,sendForward:0,sendToFront:0,sendBackward:0,sendToBack:0,duplication:0,group:0,ungroup:0,nudge:0,marqueeSelect:0,multiselect:0,selectSibling:0,selectParent:0,selectChild:0,exitSpecialSelectionMode:0,actualSize:0,fitToView:0,fillToView:0,zoomOut:0,zoomIn:0,panView:0,panKey:0,zoomInKey:0,zoomOutKey:0};class u{static get callbackKeys(){return{ENTER:"ENTER",SHIFT_ENTER:"SHIFT_ENTER",ESCAPE:"ESCAPE"}}constructor(){this.callCallbacksForKey=this.callCallbacksForKey.bind(this),this.addCallback=this.addCallback.bind(this),this.handleKeyEvent=this.handleKeyEvent.bind(this),this.getShortcutDescription=this.getShortcutDescription.bind(this),this.logShortcut=this.logShortcut.bind(this),this.callbacks={}}callCallbacksForKey(e,t){u.callbackKeys[e]?this.callbacks[e]&&(e===u.callbackKeys.SHIFT_ENTER&&this.logShortcut(l.ShortcutConstants.kConfirmText),this.callbacks[e].forEach((function(e){e(t)}))):c.error("can not call callback for unsupported key with value: "+e)}addCallback(e,t){u.callbackKeys[e]&&(this.callbacks[e]?this.callbacks[e].push(t):this.callbacks[e]=[t])}bindListeners(e,t,o){e.addEventListener(t,this.handleKeyEvent),o.forEach(e=>{this.addCallback(e.key,e.method)})}unbindListeners(e,t){e.removeEventListener(t,this.handleKeyEvent),this.callbacks={}}handleKeyEvent(e){if(0===e.type.indexOf("key")){var t=e.shiftKey;switch(e.which){case 13:if(t){this.callCallbacksForKey(u.callbackKeys.SHIFT_ENTER,e);break}this.callCallbacksForKey(u.callbackKeys.ENTER,e);break;case 27:this.callCallbacksForKey(u.callbackKeys.ESCAPE,e)}}else c.error("tried to process event of type : "+e.type+". should not try to process non-key events")}getShortcutDescription(e,t){var o="",r=navigator.appVersion.indexOf("Mac");return e.command&&(o+=r?i.a.translate("keyboard.kMacCommandKey"):i.a.translate("keyboard.kWinCtrlKey")),e.control&&r&&(o+=o.length>0?"+":"",o+=i.a.translate("keyboard.kMacControlKey")),e.option&&(o+=o.length>0?"+":"",o+=r?i.a.translate("keyboard.kMacOptionKey"):i.a.translate("keyboard.kWinAltKey")),e.shift&&(o+=o.length>0?"+":"",o+=i.a.translate("keyboard.kShiftKey")),o+=o.length<=1?t:"+"+t}logShortcut(e){d[e]+=1,n.default.publish("keyboardShortcut",{contextualData1:`actionCountInSession: ${e}_${d[e]}`,contextualData2:"actionDescription: "+e})}}},rnE3:function(e,t,o){"use strict";o.d(t,"a",(function(){return l}));var r=o("xeH2"),a=o.n(r),n=o("7mGH"),s=o.n(n),i=o("qcxC");class l{static getTemplateList(e){const t=Object(i.default)(),o=s.a.hasFeature("post-bktemplates-use-test-url")?"/api/post/v1-test/brandedtemplates":"/api/post/v1/brandedtemplates";let r;return r=e instanceof Array?e:"string"==typeof e?[e]:["modern"],s.a.hasFeature("post-bktemplates-use-hardcoded-list")?t.resolve(l.getTemplateListHardcodedData()):a.a.ajax({type:"GET",url:o,data:{font_categories:r.join(",")},dataType:"json"}).fail((e,o)=>{t.reject(o)}).done(e=>{t.resolve(e)}),t.promise}static getTemplateListHardcodedData(){return{documents:[{cpAssetId:"da41617f-dcba-4913-998f-9692b1d15a31",fontCategories:["modern"],title:"Thank You Note"},{cpAssetId:"dab66ebb-cf0e-4e5c-9236-4d0ef0ef0df8",fontCategories:["modern"],title:"Announcement"},{cpAssetId:"b4b558bd-f27e-409f-b4ee-4b17fad62e00",fontCategories:["modern"],title:"Quote"},{cpAssetId:"33f674a3-6214-4310-a87c-50e8536afbe9",fontCategories:["modern"],title:"Twitter Post"},{cpAssetId:"2f2548d7-1d9f-4b7d-801a-98060cc3f574",fontCategories:["modern"],title:"Facebook Ad"},{cpAssetId:"43adfdb5-e453-46a4-b48d-bdf189736cae",fontCategories:["modern"],title:"Facebook Post"},{cpAssetId:"f6956e61-82be-4be6-bdf0-361291439674",fontCategories:["modern"],title:"Instagram/Snapchat Story"},{cpAssetId:"6128f73e-f285-451f-89b6-e8a32e0c96a9",fontCategories:["modern"],title:"Poster"},{cpAssetId:"4dd7b216-e209-4863-9a9b-a8c21b32bb0f",fontCategories:["modern"],title:"Announcement "},{cpAssetId:"2cf62e84-fc0e-4c2a-963f-c100c3317afc",fontCategories:["modern"],title:"Business Card"}]}}}},yiIM:function(e,t,o){"use strict";o.d(t,"a",(function(){return r}));class r{static reload(){window.location.reload()}static getLocationPathname(){return window.location.pathname}}},ys7E:function(e,t,o){"use strict";o.r(t);var r=o("wHG3"),a=o("3xm6"),n=o.n(a),s=o("MGCh"),i=o.n(s),l=o("tpS0"),c=o.n(l);const d=i.a.channel("controller");let u;t.default=class{constructor(e){this.uiStateController=e}handleAnnotationsChanged(e){let t=-1,o="";if(e){t=e.priority;const a=e.id;switch(a){case r.Core.AnnotationID.TextTruncated:o=n.a.translate("dialogs.annotations.kTextTruncatedTitle");break;case r.Core.AnnotationID.TooMuchCurvedText:case r.Core.AnnotationID.TooMuchGridText:o=n.a.translate("dialogs.annotations.kTooMuchTextTitle");break;case r.Core.AnnotationID.MultipleReturns:o=n.a.translate("dialogs.annotations.kMultipleReturnsTitle");break;default:t=-1,d.warn("Unhandled annotation "+a)}}this.uiStateController.handleAnnotationsChanged(t,o)}handleAnnotationClicked(e){let t,o;const{id:a}=e;switch(a){case r.Core.AnnotationID.TextTruncated:t=n.a.translate("dialogs.annotations.kTextTruncatedTitle"),o=n.a.translate("dialogs.annotations.kTextTruncatedMessage");break;case r.Core.AnnotationID.TooMuchCurvedText:t=n.a.translate("dialogs.annotations.kTooMuchTextTitle"),o=n.a.translate("dialogs.annotations.kTooMuchCurvedTextMessage");break;case r.Core.AnnotationID.TooMuchGridText:t=n.a.translate("dialogs.annotations.kTooMuchTextTitle"),o=n.a.translate("dialogs.annotations.kTooMuchGridTextMessage");break;case r.Core.AnnotationID.MultipleReturns:t=n.a.translate("dialogs.annotations.kMultipleReturnsTitle"),o=n.a.translate("dialogs.annotations.kMultipleReturnsMessage");break;default:d.warn("Unhandled annotation "+a)}t&&o&&(u&&(u.hide(),u=void 0),u=this.createAnnotationsModal(t,o),u.show())}createAnnotationsModal(e,t){return new c.a({headerText:e,contentText:t,dismissable:!0,buttons:[{class:"pill pill-primary-on-light",label:n.a.translate("common.kOKGotIt"),onClick:()=>{u&&(u.hide(),u=void 0)}}]})}}},ywYV:function(e,t,o){var r;void 0===(r=function(){var e={};function t(e){return e*Math.PI/180}return e.radians=t,e.degrees=function(e){return 180*e/Math.PI},e.degreesBetweenPoints=function(e,t){return 180*Math.atan2(t.y-e.y,t.x-e.x)/Math.PI},e.radiansBetweenPoints=function(o,r){return t(e.degreesBetweenPoints(o,r))},e.distanceSquared=function(e,t){return Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2)},e.distanceBetweenPoints=function(t,o){return Math.sqrt(e.distanceSquared(t,o))},e.rotatePoint=function(e,o,r){var a=t(r);return{x:Math.cos(a)*(e.x-o.x)-Math.sin(a)*(e.y-o.y)+o.x,y:Math.sin(a)*(e.x-o.x)+Math.cos(a)*(e.y-o.y)+o.y}},e.rotatePoints=function(t,o,r){for(var a=[],n=0;n<t.length;n++)a.push(e.rotatePoint(t[n],o,r));return a},e.closestPointOfLineToAPoint=function(t,o,r){var a=((t.x-o.x)*(r.x-o.x)+(t.y-o.y)*(r.y-o.y))/e.distanceSquared(o,r);return{x:o.x+a*(r.x-o.x),y:o.y+a*(r.y-o.y)}},e.midpointOfTwoPoints=function(e,t){return{x:e.x+(t.x-e.x)/2,y:e.y+(t.y-e.y)/2}},e.closestPointOnLineSegment=function(e,t,o){var r=e.x-t.x,a=e.y-t.y,n=o.x-t.x,s=o.y-t.y,i=(r*n+a*s)/(n*n+s*s);return i<0||t.x==o.x&&t.y==o.y?t:i>1?o:{x:t.x+i*n,y:t.y+i*s}},e.pointDistanceToLineSegment=function(t,o,r){var a=e.closestPointOnLineSegment(t,o,r),n=t.x-a.x,s=t.y-a.y;return Math.sqrt(n*n+s*s)},e.closestPointOnEdgeOfShape=function(t,o){var r=o.length;if(0===r)return t;if(1===r)return o[0];for(var a=0,n=t,s=0;s<r;s++){var i=s===r-1?0:s+1,l=o[s],c=o[i],d=e.pointDistanceToLineSegment(t,l,c);(0===s||d<a)&&(a=d,n=e.closestPointOnLineSegment(t,l,c))}return n},e.pointSomeDistanceTowardsPoint=function(e,t,o){var r=o.x-e.x,a=o.y-e.y,n=Math.sqrt(r*r+a*a),s=t/(n/r),i=t/(n/a);return{x:e.x+s,y:e.y+i}},e.isPointInsideShape=function(e,t){for(var o=!1,r=-1,a=t.length,n=a-1;++r<a;n=r)(t[r].y<=e.y&&e.y<t[n].y||t[n].y<=e.y&&e.y<t[r].y)&&e.x<(t[n].x-t[r].x)*(e.y-t[r].y)/(t[n].y-t[r].y)+t[r].x&&(o=!o);return o},e.getScaledShapeVertices=function(t,o,r){for(var a,n,s=[],i=r.length,l=0;l<i;l++)a=r[l],n=e.distanceBetweenPoints(t,a)*o,s.push(e.pointSomeDistanceTowardsPoint(t,n,a));return s},e.pointJustAboveShape=function(e){for(var t,o=e[0].x,r=o,a=e[0].y,n=0,s=e.length;n<s;n++)(t=e[n]).x<o&&(o=t.x),t.x>r&&(r=t.x),t.y>a&&(a=t.y);return{x:Math.round(o+(r-o)/2),y:a}},e.decomposeMatrix2d=function(e){var t=Math.atan2(e[1],e[0]),o=Math.pow(e[0],2)+Math.pow(e[1],2),r=Math.sqrt(o),a=(e[0]*e[3]-e[2]*e[1])/r,n=Math.atan2(e[0]*e[2]+e[1]*e[3],o);return{angle:t/(Math.PI/180),scaleX:r,scaleY:a,skewX:n/(Math.PI/180),skewY:0,translateX:e[4],translateY:e[5],translate:{x:e[4],y:e[5]}}},e.transformMatrix=function(e,t){var o=e[0],r=e[1],a=e[2],n=e[3],s=e[4],i=e[5],l=t[0],c=t[1],d=t[2],u=t[3],p=t[4],h=t[5];return e[0]=o*l+a*c,e[1]=r*l+n*c,e[2]=o*d+a*u,e[3]=r*d+n*u,e[4]=o*p+a*h+s,e[5]=r*p+n*h+i,e},e}.apply(t,[]))||(e.exports=r)}}]);
//# sourceMappingURL=theo-publish-impl_5a11b65b-4a1160b8.js.map